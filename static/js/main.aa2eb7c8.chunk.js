(this["webpackJsonpmobilelibraries-website"]=this["webpackJsonpmobilelibraries-website"]||[]).push([[0],{120:function(e){e.exports=JSON.parse('{"api":"https://api.mobilelibraries.org/api","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","stopTiles":"https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt","tripTiles":"https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt"}')},866:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getPosition",(function(){return Ie})),n.d(r,"getCurrentPosition",(function(){return Le})),n.d(r,"getCurrentPostcode",(function(){return Pe})),n.d(r,"getPostcode",(function(){return Fe})),n.d(r,"getServiceDataFromPostcode",(function(){return Me})),n.d(r,"getNearestLibrary",(function(){return De})),n.d(r,"getNearestMobileLibrary",(function(){return Te})),n.d(r,"validatePostcode",(function(){return Be}));n(576),n(586);var a=n(0),o=n.n(a),i=n(22),c=n.n(i),s=n(13),l=n(912),u=n(390),p=n.n(u),d=n(380),b=n.n(d),j=n(183),h=n(911),m=n(2),f=Object(a.createContext)(),g=function(e){var t=e.reducer,n=e.initialState,r=e.children;return Object(m.jsx)(f.Provider,{value:Object(a.useReducer)(t,n),children:r})},O=function(){return Object(a.useContext)(f)},x=Object(a.createContext)(),y=function(e){var t=e.reducer,n=e.initialState,r=e.children;return Object(m.jsx)(x.Provider,{value:Object(a.useReducer)(t,n),children:r})},v=function(){return Object(a.useContext)(x)},S=Object(a.createContext)(),k=function(e){var t=e.reducer,n=e.initialState,r=e.children;return Object(m.jsx)(S.Provider,{value:Object(a.useReducer)(t,n),children:r})},w=function(){return Object(a.useContext)(S)},C=n(12),_=n.n(C),N=n(25),I=n(159),L=n(16),P=n(78),F=n(44),M=n(893),D=n(505),T=n(894),B=n(509),A=n(535),R=n(375),z=n(896),E=n(913),W=n(510),Z=n(506),J=n(547),H=n.n(J),G=n(112),U=n.n(G),q=n(163),X=n.n(q),Y=n(242),V=n.n(Y),$=n(548),K=n.n($),Q=n(545),ee=n.n(Q),te=n(314),ne=n.n(te),re=n(546),ae=n.n(re),oe=n(295),ie=n.n(oe),ce=n(313),se=n.n(ce),le=n(549),ue=n.n(le),pe=n(563),de=n(370),be=n(507),je=n(890),he=n(566),me=n(892),fe=n(286),ge=n(508),Oe=n(158),xe=n(540),ye=n.n(xe),ve=n(541),Se=n.n(ve),ke=n(542),we=n.n(ke),Ce=n(50),_e=n.n(Ce),Ne=n(120),Ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t,n){navigator.geolocation.getCurrentPosition(t,n,e)}))},Le=function(){var e=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={enableHighAccuracy:!0,timeout:1e4,maximumAge:0},e.next=3,Ie(t);case 3:return n=e.sent,e.abrupt("return",[n.coords.longitude,n.coords.latitude]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(N.a)(_.a.mark((function e(t,n){var r,a,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://api.postcodes.io/postcodes?lon=".concat(t,"&lat=").concat(n),e.prev=1,e.next=4,_e.a.get(r);case 4:if(200!==(a=e.sent).status){e.next=9;break}if(!((o=a.data.result).length>0)){e.next=9;break}return e.abrupt("return",o[0].postcode);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ne.postcodeApi+t);case 2:return n=e.sent,e.abrupt("return",{location:[n.data.longitude,n.data.latitude],library_service_name:n.data.library_service_name,library_service:n.data.library_service});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Me=function(){var e=Object(N.a)(_.a.mark((function e(t,n){var r,a;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(t);case 2:if(r=e.sent,!((a=n.filter((function(e){return e.code===r.library_service}))).length>0)){e.next=6;break}return e.abrupt("return",{service:a[0],location:r.location});case 6:return e.abrupt("return",{});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),De=function(){var e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ne.libraryApi+"?latitude="+t[1]+"&longitude="+t[0]);case 2:return n=e.sent,e.abrupt("return",n&&n.data&&n.data.length>0?n.data[0]:null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Te=function(){var e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ne.mobileLibraryApi+"?latitude="+t[1]+"&longitude="+t[0]);case 2:return n=e.sent,e.abrupt("return",n&&n.data&&n.data.length>0?n.data[0]:null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Be=function(e){return/^[A-Z]{1,2}\d[A-Z\d]? ?\d[A-Z]{2}$/.test(e.trim())},Ae=function(e,t){var n=new URLSearchParams(window.location.search);n.set("service",t),e.push(window.location.pathname+"?"+n.toString())},Re=n(68),ze=n(69),Ee=n(71),We=n.n(Ee),Ze=n(120),Je=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.organisationId=e.organisation_id,this.name=e.name,this.timetable=e.timetable,this.numberRoutes=e.number_routes,this.numberStops=e.number_stops,this}}]),e}(),He=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.mobileId=e.mobile_id,this.stopId=e.stop_id,this.stopName=e.stop_name,this.stopDistance=e.stop_distance,this}}]),e}(),Ge=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.mobileId=e.mobile_id,this.currentStopId=e.current_stop_id,this.currentStopDeparture=We()(e.current_stop_departure),this.currentStopName=e.current_stop_name,this.previousStopId=e.previous_stop_id,this.previousStopDeparture=We()(e.previous_stop_departure),this.previousStopName=e.previous_stop_name,this.nextStopId=e.next_stop_id,this.nextStopArrival=We()(e.next_stop_arrival),this.nextStopName=e.next_stop_name,this.updated=We()(e.updated),this.updateType=e.update_type,this.geoX=e.geox,this.geoY=e.geoy,this.routeSection=e.route_section,this}},{key:"getStatus",value:function(){var e=We()(),t="Not out today",n="Arriving at ",r="At ",a="Arriving at ",o="Finished for the day";if(!this.currentStopId&&!this.previousStopId&&this.nextStopId&&!this.nextStopArrival.isSame(e,"day"))return{type:"offRoad",textFormat:t,message:t};if(!this.currentStopId&&!this.previousStopId&&this.nextStopId&&this.nextStopArrival.isSame(e,"day")){var i=this.nextStopArrival.fromNow();return{type:"preRoute",message:n,textFormat:n+this.nextStopName+" "+i,args:[{stopName:this.nextStopName,stopId:this.nextStopId},i]}}if(this.currentStopId){var c=this.currentStopDeparture.fromNow(!0);return{type:"atStop",message:r,textFormat:r+this.currentStopName+" for "+c,args:[{stopName:this.currentStopName,stopId:this.currentStopId},c]}}if(!this.currentStopId&&this.previousStopId&&this.nextStopId&&this.previousStopDeparture.isSame(e,"day")&&this.nextStopArrival.isSame(e,"day")){var s=this.nextStopArrival.fromNow();return{type:"betweenStops",message:a,textFormat:a+this.nextStopName+" "+s,args:[{stopName:this.nextStopName,stopId:this.nextStopId},s]}}return this.previousStopId&&this.nextStopId&&this.previousStopDeparture.isSame(e,"day")&&!this.nextStopArrival.isSame(e,"day")?{type:"postRoute",message:o,text_format:o}:null}}]),e}();function Ue(){return qe.apply(this,arguments)}function qe(){return(qe=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ze.api+"/mobiles");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=8;break}return n=t.data.map((function(e){return(new Je).fromJson(e)})),e.abrupt("return",n);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xe(){return Ye.apply(this,arguments)}function Ye(){return(Ye=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ze.api+"/mobiles/locations");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=8;break}return n=t.data.map((function(e){return(new Ge).fromJson(e)})),e.abrupt("return",n);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ve(e,t){return $e.apply(this,arguments)}function $e(){return($e=Object(N.a)(_.a.mark((function e(t,n){var r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Ze.api+"/mobiles/nearest?longitude="+t[0]+"&latitude="+t[1]+"&distance="+n);case 2:if(!((r=e.sent)&&r.data&&r.data.length>0)){e.next=7;break}return e.abrupt("return",r.data.map((function(e){return(new He).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ke=Object(D.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:e.spacing()},iconProgress:{margin:e.spacing()},inputInput:{paddingTop:e.spacing(),paddingRight:e.spacing(),paddingBottom:e.spacing(),paddingLeft:e.spacing(2),fontWeight:e.typography.fontWeightBold},search:{position:"relative",border:"1px solid #E0E0E0",borderColor:e.palette.outline.main,borderRadius:e.shape.borderRadius,backgroundColor:Object(Oe.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(Oe.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(),display:"flex",maxWidth:240}}}));var Qe=Object(F.f)((function(e){var t=e.settings,n=O(),o=Object(L.a)(n,2),i=o[0].organisations,c=o[1],s=v(),l=Object(L.a)(s,2),u=l[0],p=u.searchType,d=u.searchPostcode,b=u.searchDistance,j=u.searchPosition,h=l[1],f=w(),g=Object(L.a)(f,2),x=g[0],y=x.loadingPostcode,S=x.loadingLocation,k=g[1],C=Object(a.useState)(d||""),I=Object(L.a)(C,2),P=I[0],F=I[1],M=Object(a.useState)(null),D=Object(L.a)(M,2),T=D[0],B=D[1],A=function(e){var t=Object(a.useRef)();return Object(a.useEffect)((function(){t.current=e})),t.current}({searchPostcode:d});Object(a.useEffect)((function(){A&&d!==A.searchPostcode&&F(d)}),[d,A]);var z=function(){var e=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S){e.next=16;break}if(k({type:"ToggleLoadingLocation"}),!(j.length>0)){e.next=6;break}e.t0=j,e.next=9;break;case 6:return e.next=8,Le();case 8:e.t0=e.sent;case 9:return t=e.t0,h({type:"SetLocation",searchPosition:t}),e.next=13,E(t);case 13:n=e.sent,k({type:"ToggleLoadingLocation"}),n&&""!==n&&G(n);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=6;break}return e.next=3,Pe.apply(r,Object(pe.a)(t));case 3:return n=e.sent,F(n),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){return B(null)},J=function(e){W(),h({type:"SetSearchDistance",searchDistance:e}),"postcode"===p&&G(P)},H=function(){var t;F(""),h({type:"ClearAll"}),t=e.history,new URLSearchParams(window.location.search).delete("service"),t.push(window.location.pathname)},G=function(){var t=Object(N.a)(_.a.mark((function t(){var n,r,a,o,s=arguments;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=s.length>0&&void 0!==s[0]?s[0]:P)&&""!==n){t.next=4;break}return k({type:"ShowNotification",notificationMessage:"Please enter a postcode before searching",notificationSeverity:"warning"}),t.abrupt("return");case 4:if(k({type:"ToggleLoadingPostcode"}),k({type:"LoadingPostcode"}),!Be(n)){t.next=21;break}return t.next=9,Me(n.trim(),i);case 9:return r=t.sent,h({type:"SetPostcodeSearch",searchPostcode:n,searchPosition:r.location}),h({type:"SetService",service:r.service}),t.next=14,Ve(r.location,b);case 14:a=t.sent,o={},a.forEach((function(e){o[e.mobileId]=e})),c({type:"UpdateMobilesNearest",mobilesNearest:a,mobilesNearestLookup:o}),Ae(e.history,r.service.systemName),t.next=22;break;case 21:k({type:"ShowNotification",notificationMessage:"We could not find that postcode",notificationSeverity:"error"});case 22:k({type:"ToggleLoadingPostcode"});case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),U=Ke();return Object(m.jsxs)("div",{className:U.search,children:[Object(m.jsx)(he.a,{placeholder:"Postcode",classes:{input:U.inputInput},value:P,onChange:function(e){return F(e.target.value.toUpperCase())},onKeyDown:function(e){13===e.keyCode&&G()},inputProps:{"aria-label":"search by postcode"}}),"postcode"===p?Object(m.jsx)(Z.a,{title:"Clear search",children:Object(m.jsx)(R.a,{"aria-label":"Clear search",className:U.iconButton,onClick:function(){return H()},children:Object(m.jsx)(ye.a,{})})}):null,Object(m.jsx)("div",{className:U.grow}),Object(m.jsx)(Z.a,{title:"Search by postcode",children:y?Object(m.jsx)(de.a,{position:"relative",display:"inline-flex",className:U.iconProgress,children:Object(m.jsx)(be.a,{size:22})}):Object(m.jsx)(R.a,{"aria-label":"Search",color:"primary",className:U.iconButton,onClick:function(){return G()},children:Object(m.jsx)(ie.a,{})})}),Object(m.jsx)(je.a,{orientation:"vertical",flexItem:!0}),Object(m.jsx)(Z.a,{title:"Use your current location",children:S?Object(m.jsx)(de.a,{position:"relative",display:"inline-flex",className:U.iconProgress,children:Object(m.jsx)(be.a,{size:22})}):Object(m.jsx)(R.a,{"aria-label":"Search by current location",color:"primary",className:U.iconButton,onClick:function(){return z()},children:Object(m.jsx)(Se.a,{})})}),t?Object(m.jsx)(Z.a,{title:"Change search settings",children:Object(m.jsx)(R.a,{"aria-label":"Open search settings menu",className:U.iconButton,color:"secondary",onClick:function(e){!function(e){B(e.currentTarget)}(e)},children:Object(m.jsx)(we.a,{})})}):null,Object(m.jsxs)(fe.a,{id:"mnu-settings",anchorEl:T,keepMounted:!0,open:Boolean(T),onClose:function(){return W()},children:[Object(m.jsx)(me.a,{disableSticky:!0,children:"Search distance"}),Object(m.jsx)(ge.a,{onClick:function(){return J(1609)},children:"1 mile"}),Object(m.jsx)(ge.a,{onClick:function(){return J(4827)},children:"3 miles"}),Object(m.jsx)(ge.a,{onClick:function(){return J(8045)},children:"5 miles"}),Object(m.jsx)(ge.a,{onClick:function(){return J(16090)},children:"10 miles"}),Object(m.jsx)(ge.a,{onClick:function(){return J(32180)},children:"20 miles"}),Object(m.jsx)(ge.a,{onClick:function(){return J(80450)},children:"50 miles"})]})]})})),et=n(536),tt=n(543),nt=n.n(tt),rt=n(544),at=n.n(rt),ot=Object(D.a)((function(e){return{button:{marginRight:e.spacing(1)},chip:{marginRight:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var it=function(){var e=O(),t=Object(L.a)(e,1)[0],n=t.organisations,r=t.organisationLookup,o=t.mobiles,i=t.mobileLookup,c=t.routeLookup,s=t.routes,l=v(),u=Object(L.a)(l,2),p=u[0],d=p.organisationFilter,b=p.mobileFilter,j=p.routeFilter,h=u[1],f=Object(a.useState)(null),g=Object(L.a)(f,2),x=g[0],y=g[1],S=Object(a.useState)(null),k=Object(L.a)(S,2),w=k[0],C=k[1],_=Object(a.useState)(null),N=Object(L.a)(_,2),I=N[0],P=N[1],F=function(){return y(null)},M=function(){return C(null)},D=function(){return P(null)},T=new Set(n.map((function(e){return e.country}))),A=ot();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:A.search,children:[0===d.length?Object(m.jsx)(Z.a,{title:"Choose library service",children:Object(m.jsxs)(B.a,{color:"primary",className:A.button,onClick:function(e){return t=e.currentTarget,y(t);var t},children:[Object(m.jsx)(nt.a,{className:A.leftIcon}),"Select service"]})}):Object(m.jsx)(et.a,{className:A.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearAll"})},label:r[d[0]].name}),d.length>0?0===b.length?Object(m.jsx)(Z.a,{title:"Choose mobile library",children:Object(m.jsxs)(B.a,{color:"primary",className:A.button,onClick:function(e){return t=e.currentTarget,C(t);var t},children:[Object(m.jsx)(X.a,{className:A.leftIcon}),"Select mobile"]})}):Object(m.jsx)(et.a,{className:A.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearMobileFilter"})},label:i[b[0]].name}):null,b.length>0?0===j.length?Object(m.jsx)(Z.a,{title:"Choose route",children:Object(m.jsxs)(B.a,{color:"primary",className:A.button,onClick:function(e){return t=e.currentTarget,P(t);var t},children:[Object(m.jsx)(at.a,{className:A.leftIcon}),"Select route"]})}):Object(m.jsx)(et.a,{className:A.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearRouteFilter"})},label:c[j[0]].name}):null]}),Object(m.jsx)(fe.a,{id:"menu-library-service",anchorEl:x,keepMounted:!0,open:Boolean(x),onClose:function(){return F()},children:Array.from(T).sort((function(e,t){return e.localeCompare(t)})).map((function(e,t){var r=[Object(m.jsx)(me.a,{disableSticky:!0,children:e},"lst_"+t)],a=n.sort((function(e,t){return e.name.localeCompare(t.name)})).filter((function(t){return t.country===e})).map((function(e){return Object(m.jsx)(ge.a,{onClick:function(){return t=e.id,h({type:"FilterByOrganisation",organisationId:t}),void F();var t},children:e.name},"mnu_itm_org_"+e.id)}));return r.concat(a)}))}),Object(m.jsx)(fe.a,{id:"menu-mobile-library",anchorEl:w,keepMounted:!0,open:Boolean(w),onClose:function(){return M()},children:o.filter((function(e){var t=!0;return d.length>0&&-1===d.indexOf(e.organisationId)&&(t=!1),t})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(m.jsx)(ge.a,{onClick:function(){return t=e.organisationId,n=e.id,h({type:"FilterByMobile",organisationId:t,mobileId:n}),void M();var t,n},children:e.name},"mnu_itm_mob_"+e.id)}))}),Object(m.jsx)(fe.a,{id:"menu-route",anchorEl:I,keepMounted:!0,open:Boolean(I),onClose:function(){return D()},children:s.filter((function(e){var t=!0;return b.length>0&&-1===b.indexOf(e.mobileId)&&(t=!1),t})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return Object(m.jsx)(ge.a,{onClick:function(){return t=e.id,h({type:"FilterByRoute",routeId:t}),void D();var t},children:e.name},"mnu_itm_route_"+e.id)}))})]})},ct=Object(D.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,position:"relative"},appBarTransparent:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)",position:"relative"},grow:{flexGrow:1},topIcon:{backgroundColor:"rgba(250, 250, 250, 0.8)","&:hover":{backgroundColor:"rgba(250, 250, 250, 0.8)"}},topTitle:{position:"relative",zIndex:e.zIndex.drawer+1}}}));var st=function(e){var t=e.site,n=v(),r=Object(L.a)(n,1)[0].currentServiceSystemName,o=Object(a.useState)(!1),i=Object(L.a)(o,2),c=i[0],s=i[1],l=Object(a.useState)(t),u=Object(L.a)(l,2),p=u[0],d=u[1],b=Object(F.e)(),j=ct(),h=function(e){return r?e+"?service="+r:e},f=[{title:"Library lab",url:"https://www.librarylab.uk",icon:Object(m.jsx)(se.a,{}),links:[{title:"About library lab",short:"Lab",icon:Object(m.jsx)(se.a,{}),to:"/"}]},{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:Object(m.jsx)(ee.a,{}),links:[{title:"Find service",short:"Find",icon:Object(m.jsx)(ie.a,{}),to:h("/")},{title:"Watch library TV",short:"Watch",icon:Object(m.jsx)(ae.a,{}),to:"/watch"},{title:"Read blogs",short:"Read",icon:Object(m.jsx)(H.a,{}),to:"/read"},{title:"Listen podcasts",short:"Listen",icon:Object(m.jsx)(K.a,{}),to:"/listen"},{title:"Check alerts",short:"Alerts",icon:Object(m.jsx)(ue.a,{}),to:"/alerts"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:Object(m.jsx)(X.a,{}),links:[{title:"Find my stop",short:"Stops",icon:Object(m.jsx)(V.a,{}),to:"/"},{title:"Mobile vans",short:"Vans",icon:Object(m.jsx)(X.a,{}),to:"/mobiles"},{title:"Map of stops",short:"Map",icon:Object(m.jsx)(ne.a,{}),to:"/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:Object(m.jsx)(ne.a,{}),links:[{title:"Find my library",short:"Find",icon:Object(m.jsx)(V.a,{}),to:h("/")},{title:"Map of libraries",short:"Map",icon:Object(m.jsx)(ne.a,{}),to:h("/map")}]}],g="/map"===b.pathname?j.appBarTransparent:j.appBar;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(M.a,{maxWidth:"lg",className:j.topTitle,children:Object(m.jsxs)(W.a,{children:[Object(m.jsx)(R.a,{"aria-label":"Toggle site menu",className:j.topIcon,color:"primary",onClick:function(){s(!c),d(t)},children:c?Object(m.jsx)(U.a,{}):Object(m.jsx)(se.a,{})}),Object(m.jsx)("span",{className:j.grow}),"/map"===b.pathname?Object(m.jsx)(it,{}):null]})}),c?Object(m.jsx)(T.a,{position:"static",color:"transparent",elevation:0,className:g,children:Object(m.jsx)(M.a,{maxWidth:"lg",children:Object(m.jsx)(E.a,{value:p,onChange:function(e,t){d(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"secondary",children:f.map((function(e,t){return Object(m.jsx)(z.a,{label:e.title,icon:e.icon},"tb_site_"+t)}))})})}):null,Object(m.jsx)(T.a,{position:"static",color:"transparent",elevation:0,className:g,children:Object(m.jsx)(M.a,{maxWidth:"lg",children:Object(m.jsxs)(W.a,{children:[Object(m.jsx)(A.a,{mdUp:!0,children:f[p].links.map((function(e,n){return Object(m.jsx)(Z.a,{title:e.title,children:Object(m.jsx)(B.a,{component:P.b,to:p===t?e.to:f[p].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon,children:e.short})},"icnb_menu_lg_"+n)}))}),Object(m.jsx)(A.a,{smDown:!0,children:f[p].links.map((function(e,n){return Object(m.jsx)(Z.a,{title:e.title,children:Object(m.jsx)(B.a,{component:P.b,to:p===t?e.to:f[p].url+e.to,disableRipple:b.pathname===e.to,disableFocusRipple:b.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon,children:e.title})},"icnb_menu_lg_"+n)}))}),Object(m.jsx)("span",{className:j.grow}),"/map"===b.pathname?Object(m.jsx)(Qe,{}):null]})})})]})},lt=n(897),ut=n(898),pt=n(116),dt=Object(D.a)((function(e){return{root:{paddingTop:e.spacing(5),marginTop:e.spacing(3),marginBottom:e.spacing(5),width:"100%"},bullet:{margin:e.spacing(2)},grid:{marginTop:e.spacing(2)},footerText:{verticalAlign:"middle",display:"inline-flex"},footerRight:{textAlign:"right"},tapTarget:{lineHeight:2.2,fontSize:16}}}));var bt=function(){var e=dt();return Object(m.jsxs)("div",{className:e.root,children:[Object(m.jsx)(je.a,{}),Object(m.jsxs)(lt.a,{container:!0,spacing:3,className:e.grid,children:[Object(m.jsxs)(lt.a,{item:!0,xs:12,sm:6,md:6,lg:6,xl:6,children:[Object(m.jsxs)(pt.a,{variant:"button",children:[Object(m.jsx)(ut.a,{component:P.b,to:"/accessibility",title:"How we make this site accessible",className:e.tapTarget,children:"Accessibility"}),Object(m.jsx)("span",{className:e.bullet,children:" \u2022 "}),Object(m.jsx)(ut.a,{component:P.b,to:"/privacy",title:"Your privacy on this site",className:e.tapTarget,children:"Privacy"}),Object(m.jsx)("span",{className:e.bullet,children:" \u2022 "}),Object(m.jsx)(ut.a,{component:P.b,to:"/data",title:"Data used on this site and licensing",className:e.tapTarget,children:"Data"})]}),Object(m.jsx)("br",{}),Object(m.jsx)(pt.a,{variant:"body2",className:e.footerText,children:"A Library Lab project by Libraries Hacked."})]}),Object(m.jsx)(lt.a,{className:e.footerRight,item:!0,xs:12,sm:6,md:6,lg:6,xl:6,children:Object(m.jsxs)(pt.a,{variant:"button",children:[Object(m.jsx)(ut.a,{href:"https://github.com/LibrariesHacked/mobilelibraries-website",target:"_blank",title:"Project on GitHub",className:e.tapTarget,children:"Open Source on GitHub"}),Object(m.jsx)("span",{className:e.bullet,children:" \u2022 "}),Object(m.jsx)(ut.a,{href:"https://www.librarylab.uk/docs/mobile-libraries",target:"_blank",title:"About the library lab projects and documentation for this project",className:e.tapTarget,children:"About this project"})]})})]})]})},jt=n(564),ht=n(550),mt=n(5),ft=Object(D.a)((function(e){return{listItem:{marginTop:e.spacing(1)},root:{"& table":{display:"block",wordBreak:"normal",width:"100%",overflowX:"auto",WebkitOverflowScrolling:"touch",borderCollapse:"collapse",marginBottom:"16px",borderSpacing:0,overflow:"hidden","& .prop-name":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace'},"& .required":{color:"light"===e.palette.type?"#006500":"#a5ffa5"},"& .prop-type":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',color:"light"===e.palette.type?"#932981":"#ffb6ec"},"& .prop-default":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',borderBottom:"1px dotted ".concat(e.palette.divider)}},"& td":Object(s.a)(Object(s.a)({},e.typography.body2),{},{borderBottom:"1px solid ".concat(e.palette.divider),padding:16,color:e.palette.text.primary}),"& th":{fontSize:14,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium,color:e.palette.text.primary,whiteSpace:"pre",borderBottom:"1px solid ".concat(e.palette.divider),padding:16}}}})),gt={overrides:{h1:{component:pt.a,props:{gutterBottom:!0,variant:"h4",color:"secondary"}},h2:{component:pt.a,props:{gutterBottom:!0,variant:"h5",color:"textPrimary"}},h3:{component:pt.a,props:{gutterBottom:!0,variant:"h6",color:"textPrimary"}},h4:{component:pt.a,props:{gutterBottom:!0,variant:"h6",paragraph:!0,color:"textPrimary"}},p:{component:pt.a,props:{paragraph:!0,color:"textPrimary"}},a:{component:ut.a},li:{component:Object(mt.a)(ft)((function(e){var t=e.classes,n=Object(jt.a)(e,["classes"]);return Object(m.jsx)("li",{className:t.listItem,children:Object(m.jsx)(pt.a,Object(s.a)({component:"span"},n))})}))}}};function Ot(e){var t=e.page,n=Object(a.useState)(""),r=Object(L.a)(n,2),o=r[0],i=r[1],c=ft();return Object(a.useEffect)((function(){function e(){return(e=Object(N.a)(_.a.mark((function e(){var n,r;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:return n=e.sent,e.next=5,n.text();case 5:r=e.sent,i(r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),Object(m.jsx)(ht.a,Object(s.a)(Object(s.a)({className:c.root,options:gt},e),{},{children:o}))}var xt=o.a.memo(Ot),yt=n(902),vt=Object(D.a)((function(e){return{search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var St=function(){var e=vt();return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(pt.a,{color:"secondary",component:"h2",variant:"h3",className:e.title,children:"Mobile libraries"}),Object(m.jsx)(pt.a,{component:"p",variant:"body1",className:e.subtitle,children:"Search by postcode or library service"}),Object(m.jsx)("div",{className:e.search,children:Object(m.jsx)(Qe,{settings:!0})}),Object(m.jsx)(it,{})]})},kt=n(899),wt=n(901),Ct=n(900),_t=n(297),Nt=n.n(_t),It=n(298),Lt=n.n(It),Pt=Object(D.a)((function(e){return{bullet:{display:"inline-block",margin:"0 2px",transform:"scale(1.2)"},card:{minWidth:275,border:"2px solid #c8e6c9"},cardHeader:{backgroundColor:"#e8f5e9",color:"#388e3c"},leftIcon:{marginRight:e.spacing(1)},title:{fontSize:12,fontWeight:500,align:"right"},verticalDivider:{width:1,height:28,margin:8},progress:{margin:e.spacing(2)}}}));var Ft=function(e){var t=this,n=e.mobile,r=e.organisation,a=e.location,o=v(),i=Object(L.a)(o,2);Object(I.a)(i[0]);var c=i[1],s=w(),l=Object(L.a)(s,2);Object(I.a)(l[0]);var u=l[1],p=function(e){return Object(m.jsx)(B.a,{color:"secondary",onClick:function(){return t=e.stopId,c({type:"SetCurrentStop",stopId:t}),void u({type:"SetStopDialog",stopDialogOpen:!0});var t},children:e.stopName})},d=Pt(),b=null;if(a){var j=a.getStatus();j&&"offRoad"===j.type&&(b=function(e){return Object(m.jsx)(pt.a,{children:e.message})}(j)),j&&"preRoute"===j.type&&(b=function(e){var t=p(e.args[0]);return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(pt.a,{children:[e.message,t,e.args[1]]})})}(j)),j&&"atStop"===j.type&&(b=function(e){var t=p(e.args[0]);return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(pt.a,{children:[e.message,t," for "+e.args[1]]})})}(j)),j&&"betweenStops"===j.type&&(b=function(e){var t=p(e.args[0]);return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)(pt.a,{children:[e.message,t,e.args[1]]})})}(j)),j&&"postRoute"===j.type&&(b=function(e){return Object(m.jsx)(pt.a,{children:e.message})}(j))}var h=Object(m.jsx)("span",{className:d.bullet,children:"\u2022"});return Object(m.jsxs)(kt.a,{className:d.card,elevation:0,children:[Object(m.jsx)(Ct.a,{className:d.cardHeader,children:Object(m.jsxs)(pt.a,{className:d.title,gutterBottom:!0,children:[n.numberRoutes+" route"+(n.numberRoutes>1?"s":""),h,n.numberStops+" stop"+(n.numberStops>1?"s":"")]})}),Object(m.jsxs)(Ct.a,{children:[Object(m.jsx)(pt.a,{variant:"h6",component:"h2",children:(r?r.name+" ":"")+n.name}),b]}),Object(m.jsxs)(wt.a,{children:[Object(m.jsx)(Z.a,{title:"See more mobile details",children:Object(m.jsx)(R.a,{size:"small",onClick:function(){return e=n.id,c({type:"SetCurrentMobileLibrary",mobileLibraryId:e}),void u({type:"SetMobileLibraryDialog",mobileLibraryDialogOpen:!0});var e},children:Object(m.jsx)(Nt.a,{})})}),Object(m.jsx)(je.a,{className:d.verticalDivider}),Object(m.jsx)(Z.a,{title:"Mobile library stops",children:Object(m.jsxs)(B.a,{component:P.b,to:"/",size:"small",color:"primary",className:d.button,onClick:function(){return e=r.id,t=n.id,void c({type:"FilterByMobile",organisationId:e,mobileId:t});var e,t},children:[Object(m.jsx)(V.a,{className:d.leftIcon}),"View stops"]})}),n.timetable?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(je.a,{className:d.verticalDivider}),Object(m.jsx)(Z.a,{title:"Website timetable",children:Object(m.jsx)(R.a,{className:d.button,onClick:function(){return t.goToWebsite()},children:Object(m.jsx)(Lt.a,{})})})]}):null]})]})},Mt=Object(D.a)((function(e){return{padding:{padding:e.spacing(0,2)},root:{flexGrow:1}}}));var Dt=function(){var e=O(),t=Object(L.a)(e,2),n=t[0],r=n.organisationLookup,o=n.mobiles,i=n.mobileLookup,c=n.mobileLocationLookup,s=n.mobilesNearestLookup,l=(n.routes,n.routeLookup),u=(t[1],v()),p=Object(L.a)(u,2),d=p[0],b=d.organisationFilter,j=d.mobileFilter,h=d.routeFilter,f=d.searchType,g=d.searchDistance,x=d.searchPostcode,y=(p[1],w()),S=Object(L.a)(y,2),k=S[0].loadingMobileLocations,C=(S[1],Object(a.useState)(0)),_=Object(L.a)(C,2),N=_[0],I=_[1],P=o.filter((function(e){var t=!0;return"gps"!==f&&"postcode"!==f||(t=s[e.id]),b.length>0&&-1===b.indexOf(e.organisationId)&&(t=!1),j.length>0&&-1===j.indexOf(e.id)&&(t=!1),t})),F=P.filter((function(e){if(c[e.id]){var t=c[e.id].getStatus();return t&&"offRoad"!==t.type&&"postRoute"!==t.type}return null})),M=b.length>0?r[b[0]].name:"",D=j.length>0?i[j[0]].name:"",T=h.length>0?l[h[0]].name:"",B="Mobile library vans";""!==M&&(B="Mobile library vans serving "+M),""!==D&&(B=M+" "+D),""!==T&&(B=M+" "+T),""!==x&&(B="Mobile library vans with stops within "+Math.round(g/1609)+" mile(s) of "+x),"gps"===f&&(B="Mobile library vans with stops within "+Math.round(g/1609)+" mile(s) of your location");var A=Mt(),R=(0===N?F:P).filter((function(e){var t=!0;return b.length>0&&-1===b.indexOf(e.organisationId)&&(t=!1),j.length>0&&-1===j.indexOf(e.id)&&(t=!1),t})).filter((function(e){return"gps"!==f&&"postcode"!==f||s[e.id]}));return Object(m.jsxs)("div",{className:A.root,children:[Object(m.jsx)(St,{}),Object(m.jsx)(me.a,{component:"span",disableSticky:!0,children:B}),Object(m.jsxs)(E.a,{variant:"standard",scrollButtons:"off",value:N,indicatorColor:"secondary",onChange:function(e,t){return function(e){I(e)}(t)},children:[Object(m.jsx)(z.a,{className:A.tab,label:Object(m.jsx)(yt.a,{className:A.padding,color:"secondary",badgeContent:F.length,children:"On the road"})}),Object(m.jsx)(z.a,{label:Object(m.jsx)(yt.a,{showZero:!0,className:A.padding,color:"secondary",badgeContent:P.length,children:"All vans"})})]}),Object(m.jsx)("br",{}),R.length>0?Object(m.jsx)(lt.a,{container:!0,spacing:3,children:R.map((function(e,t){return Object(m.jsx)(lt.a,{item:!0,xs:12,sm:6,md:4,lg:3,xl:3,children:Object(m.jsx)(Ft,{mobile:e,location:c[e.id],organisation:r[e.organisationId]})},"grd_"+e.name.replace(" ","")+"_"+t)}))}):k?null:Object(m.jsx)(pt.a,{component:"p",variant:"body1",children:"No mobile libraries currently on the road."})]})},Tt=n(903),Bt=n(906),At=n(905),Rt=n(904),zt=n(26),Et=n(876),Wt=Object(D.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#e8f5e9",border:"1px solid #c8e6c9",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)}}}));var Zt=function(){var e=O(),t=Object(L.a)(e,1)[0].mobileLookup,n=v(),r=Object(L.a)(n,1)[0].currentMobileLibraryId,o=w(),i=Object(L.a)(o,2),c=i[0].mobileLibraryDialogOpen,s=i[1],l=Object(a.useState)({}),u=Object(L.a)(l,2),p=u[0],d=u[1];Object(a.useEffect)((function(){null!=r&&t&&d(t[r])}),[r,t]);var b=function(){s({type:"SetMobileLibraryDialog",mobileLibraryDialogOpen:!1})},j=Object(zt.a)(),h=Wt(),f=Object(Et.a)(j.breakpoints.down("sm"));return Object(m.jsxs)(Tt.a,{fullScreen:f,disableBackdropClick:!0,open:c,onClose:b,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:h.dialog},children:[p?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Rt.a,{id:"dlg-title",children:p.name}),Object(m.jsxs)(At.a,{children:[Object(m.jsx)(me.a,{disableSticky:!0,children:"Actions"}),Object(m.jsx)("div",{className:h.dialogContentActions})]})]}):Object(m.jsx)(be.a,{className:h.progress,color:"primary",size:30}),Object(m.jsx)(Bt.a,{children:Object(m.jsx)(B.a,{onClick:function(){return b()},color:"secondary",endIcon:Object(m.jsx)(U.a,{}),children:"Close"})})]})},Jt=n(908),Ht=n(85),Gt=n(552),Ut=n.n(Gt),qt=n(914),Xt=n(551),Yt=n.n(Xt),Vt=Object(D.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var $t=function(){var e=v(),t=Object(L.a)(e,1)[0].searchType,n=Vt();return Object(m.jsx)(Z.a,{title:"Me",children:Object(m.jsx)(qt.a,{className:"gps"===t?n.avatarOn:n.avatar,children:Object(m.jsx)(Yt.a,{})})})},Kt=n(511),Qt=n(907),en=Object(D.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var tn=function(){var e=w(),t=Object(L.a)(e,2),n=t[0],r=n.mapSettings,a=n.mapSettingsDialogOpen,o=t[1],i=function(){o({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},c=en(),s=Object(zt.a)(),l=Object(Et.a)(s.breakpoints.down("sm"));return Object(m.jsxs)(Tt.a,{fullScreen:l,disableBackdropClick:!0,open:a,onClose:i,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:c.dialog},children:[Object(m.jsx)(Rt.a,{children:"Map settings"}),Object(m.jsx)(At.a,{children:Object(m.jsx)(Kt.a,{control:Object(m.jsx)(Qt.a,{checked:r.authorityBoundary,onChange:function(){o({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})}),Object(m.jsx)(Bt.a,{children:Object(m.jsx)(B.a,{onClick:i,color:"secondary",endIcon:Object(m.jsx)(U.a,{}),children:"Close"})})]})};function nn(e,t){var n;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(n=e.substring(1).split("")).length&&(n=[n[0],n[0],n[1],n[1],n[2],n[2]]),"rgba("+[(n="0x"+n.join(""))>>16&255,n>>8&255,255&n].join(",")+", "+t+")";throw new Error("Bad Hex")}var rn=Object(D.a)((function(e){return{fab:{margin:e.spacing(1),boxShadow:"none"}}}));var an=function(e){var t=w(),n=Object(L.a)(t,1)[0].mapZoom,r=e.location,a=e.organisation,o=r.getStatus(),i=n[0]<8?"small":n[0]<12?"medium":"large",c=n[0]<8?2:n[0]<12?3:4,s=rn();return Object(m.jsx)(Z.a,{title:o?o.textFormat:"",children:Object(m.jsx)(Jt.a,{size:i,className:s.fab,color:"primary",style:{backgroundColor:nn(a.colour,.8),color:"white",border:c+"px solid #FFFFFF"},children:Object(m.jsx)(X.a,{})})})},on=Object(D.a)((function(e){return{settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),cn=n(120),sn=Object(Ht.e)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),ln=[cn.stopTiles],un=[cn.tripTiles],pn=[cn.libraryAuthorityTiles];var dn=function(){var e=O(),t=Object(L.a)(e,2),n=t[0],r=n.organisations,o=n.organisationLookup,i=n.mobileLookup,c=n.mobileLocations,s=(t[1],v()),l=Object(L.a)(s,2),u=l[0],p=u.searchType,d=u.searchPosition,b=l[1],j=w(),h=Object(L.a)(j,2),f=h[0],g=f.mapZoom,x=f.mapPosition,y=f.mapSettings,S=f.mapSettingsDialogOpen,k=h[1],C=Object(a.useState)(null),_=Object(L.a)(C,2),N=_[0],I=_[1],P=Object(a.useState)(null),F=Object(L.a)(P,2),M=F[0],D=F[1];Object(a.useEffect)((function(){setInterval((function(){return I(We()())}),500)}),[]);var T=function(e){e&&e.features&&e.features.length>0&&e.features[0].properties&&(b({type:"SetCurrentStop",stopId:e.features[0].properties.id}),k({type:"SetStopDialog",stopDialogOpen:!0}))},B=["match",["get","utla19cd"]];r.forEach((function(e){B.push(e.code),B.push(e.colour)})),B.push("#a7a39b");var A=on(),R=c.filter((function(e){return null!==e.geoX&&null!==e.geoY}));return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(sn,{style:"style.json",center:x,zoom:g,maxZoom:17,pitch:[0],bearing:[0],fitBounds:null,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"},onStyleLoad:function(e){return D(e)},children:[R&&R.length>0?R.map((function(e){var t=[e.geoX,e.geoY];if(N&&e.routeSection&&e.routeSection.coordinates&&e.updated){var n=We()(N).diff(e.updated),r=Math.round(n/500),a=e.routeSection.coordinates;a.length>r&&r>0&&(t=a[r]),a.length<=r&&r>0&&(t=a[a.length-1])}var c=i[e.mobileId],s=c?o[c.organisationId]:null;return Object(m.jsx)(Ht.b,{coordinates:t,anchor:"bottom",children:Object(m.jsx)(an,{organisation:s,location:e,zoom:M?M.getZoom():0})},"mkr_"+e.id)})):null,Object(m.jsx)(Ht.c,{id:"src_stops",tileJsonSource:{type:"vector",tiles:ln}}),Object(m.jsx)(Ht.c,{id:"src_trips",tileJsonSource:{type:"vector",tiles:un}}),Object(m.jsx)(Ht.c,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:pn}}),Object(m.jsx)(Ht.a,{id:"lyr_trips_lines",type:"line",sourceId:"src_trips",sourceLayer:"trip",minZoom:13,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-offset":["interpolate",["linear"],["zoom"],13,.5,14,1,15,2,16,3,18,10,22,20],"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],13,.5,14,1,15,2,16,3,18,10,22,20],"line-dasharray":[2,.5]},onClick:function(e){e&&e.features&&e.features.length>0&&e.features[0].properties&&(b({type:"SetCurrentTrip",tripId:e.features[0].properties.id}),k({type:"SetTripDialog",tripDialogOpen:!0}))}}),Object(m.jsx)(Ht.a,{id:"lyr_stops_circles",type:"circle",sourceId:"src_stops",sourceLayer:"stop",minZoom:5,layout:{},paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,2,17,12],"circle-color":["get","organisation_colour"],"circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,17,4],"circle-stroke-color":"#FFFFFF","circle-opacity":.7},onClick:T}),Object(m.jsx)(Ht.a,{id:"lyr_stops_labels",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,17,22],"text-offset":[0,2]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:T}),Object(m.jsx)(Ht.a,{id:"lyr_stops_next_visiting",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","next_visiting"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,10,17,16],"text-offset":[0,-2.8]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:T}),y.authorityBoundary?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Ht.a,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,22,4]}}),Object(m.jsx)(Ht.a,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":B,"fill-opacity":.1}})]}):null,d&&d.length>1?Object(m.jsx)(Ht.b,{coordinates:[d[0],d[1]],children:Object(m.jsx)($t,{searchType:p})},"mk_me"):null,Object(m.jsx)(Ht.d,{position:"bottom-left"})]}),Object(m.jsx)(Z.a,{title:"Map settings",children:Object(m.jsx)(Jt.a,{size:"small",className:A.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return k({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})},children:Object(m.jsx)(Ut.a,{})})}),Object(m.jsx)(tn,{mapSettings:y,mapSettingsDialogOpen:S})]})},bn=n(909),jn=n(553),hn=n.n(jn);var mn=function(){var e=w(),t=Object(L.a)(e,2),n=t[0],r=n.notificationOpen,a=n.notificationMessage,o=t[1],i=function(){o({type:"SetNotification",notificationOpen:!1})};return Object(m.jsx)(bn.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:r,autoHideDuration:3e3,onClose:i,ContentProps:{"aria-describedby":"message-id"},message:Object(m.jsx)("span",{id:"message-id",children:a}),action:[Object(m.jsx)(R.a,{"aria-label":"close",onClick:i,color:"secondary",children:Object(m.jsx)(hn.a,{})},"close")]})},fn=n(166),gn=n(379),On=n.n(gn),xn=n(562),yn=n.n(xn),vn=n(561),Sn=n.n(vn),kn=n(560),wn=n.n(kn),Cn=n(558),_n=n.n(Cn),Nn=n(557),In=n.n(Nn),Ln=n(559),Pn=n.n(Ln),Fn=n(305),Mn=n.n(Fn),Dn=n(306),Tn=n.n(Dn),Bn=n(307),An=n.n(Bn),Rn=n(120),zn=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.routeIds=e.route_ids,this.routeNames=e.route_names,this.mobileIds=e.mobile_ids,this.mobileNames=e.mobile_names,this.organisationId=e.organisation_id,this.organisationName=e.organisation_name,this.name=e.name,this.community=e.community,this.address=e.address,this.postcode=e.postcode,this.arrivalTimes=e.arrival_times,this.departureTimes=e.departure_times,this.routeStart=We()(e.route_start),this.routeEnd=We()(e.route_end),this.routeDays=e.route_days,this.routeFrequencies=e.route_frequencies,this.routeSchedule=e.route_schedule.map((function(e){return We()(e)})),this.timetable=e.timetable,this.longitude=e.longitude,this.latitude=e.latitude,this}}]),e}();function En(e,t,n,r,a,o){return Wn.apply(this,arguments)}function Wn(){return(Wn=Object(N.a)(_.a.mark((function e(t,n,r,a,o,i){var c,s;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Rn.api+"/stops?page="+(t.page+1)+"&limit="+t.pageSize,t.orderBy&&t.orderBy.field&&(c=c+"&sort="+t.orderBy.field+"&direction="+t.orderDirection),r.length>0&&(c=c+"&mobile_ids="+r.join("|")),n.length>0&&(c=c+"&organisation_ids="+n.join("|")),a.length>0&&(c=c+"&route_ids="+a.join("|")),o&&o.length>1&&(c=c+"&longitude="+o[0]+"&latitude="+o[1]),i&&""!==i&&(c=c+"&distance="+i),e.next=9,_e.a.get(c);case 9:if(!((s=e.sent)&&s.data&&s.data.length>0)){e.next=14;break}return e.abrupt("return",{stops:s.data.map((function(e){return(new zn).fromJson(e)})),total:parseInt(s.headers["x-total-count"]),page:parseInt(s.headers["x-page"])});case 14:return e.abrupt("return",{stops:[],total:0,page:1});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zn(e){return Jn.apply(this,arguments)}function Jn(){return(Jn=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Rn.api+"/stops/"+t);case 2:if(!(n=e.sent)||!n.data){e.next=7;break}return e.abrupt("return",(new zn).fromJson(n.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Hn=n(120),Gn=Object(D.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:200},margin:{margin:e.spacing(1)},root:{flexGrow:1,maxWidth:"100%"},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"2px solid #c8e6c9"}}}));var Un=function(){var e=O(),t=Object(L.a)(e,1)[0],n=t.organisationLookup,r=t.mobileLookup,i=t.routeLookup,c=v(),l=Object(L.a)(c,2),u=l[0],p=u.searchType,d=u.searchPostcode,b=u.searchDistance,j=u.searchPosition,h=u.organisationFilter,f=u.mobileFilter,g=u.routeFilter,x=l[1],y=w(),S=Object(L.a)(y,2);Object(I.a)(S[0]);var k=S[1],C=o.a.createRef();Object(a.useEffect)((function(){C.current.onQueryChange()}),[j,b,h,f,g]);var F=Gn(),M=Object(zt.a)(),D=h.length>0?n[h[0]].name:"",T=f.length>0?r[f[0]].name:"",B=g.length>0?i[g[0]].name:"",z="All stops";""!==D&&(z="Stops in "+D),""!==T&&(z="Stops for "+D+" "+T),""!==B&&(z="Stops for "+D+" "+B),""!==d&&(z="Stops within "+Math.round(b/1609)+" mile(s) of "+d),"gps"===p&&(z="Stops within "+Math.round(b/1609)+" mile(s) of your location");var E={};Object.keys(n).forEach((function(e){E[e]=n[e].name}));var W={};Object.keys(r).forEach((function(e){W[e]=r[e].name}));var J={};return Object.keys(i).forEach((function(e){J[e]=i[e].name})),Object(m.jsxs)("div",{style:{maxWidth:"100%"},children:[Object(m.jsx)(St,{}),Object(m.jsx)(me.a,{disableSticky:!0,children:z}),Object(m.jsx)(On.a,{tableRef:C,components:{Container:function(e){return Object(m.jsx)(fn.a,Object(s.a)(Object(s.a)({},e),{},{elevation:0,className:F.table}))}},icons:{Filter:In.a,FirstPage:_n.a,LastPage:Pn.a,NextPage:wn.a,PreviousPage:Sn.a,SortArrow:yn.a},options:{padding:Object(Et.a)(M.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#e8f5e9",color:"#388e3c",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,render:function(e){return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Z.a,{title:"See more stop details",children:Object(m.jsx)(R.a,{size:"small",onClick:function(){return x({type:"SetCurrentStop",stopId:e.id}),void k({type:"SetStopDialog",stopDialogOpen:!0})},children:Object(m.jsx)(Nt.a,{})})}),Object(m.jsx)(A.a,{mdDown:!0,children:Object(m.jsx)(Z.a,{title:"Add event to your device calendar",children:Object(m.jsx)(R.a,{size:"small",color:"primary",onClick:function(){return t=e,window.open(Hn.api+"/stops/"+t.id+"/ics");var t},children:Object(m.jsx)(Mn.a,{})})})}),Object(m.jsx)(A.a,{mdDown:!0,children:Object(m.jsx)(Z.a,{title:"Download a PDF timetable for this stop",children:Object(m.jsx)(R.a,{size:"small",color:"primary",onClick:function(){return t=e,window.open(Hn.api+"/stops/"+t.id+"/pdf","_blank");var t},children:Object(m.jsx)(Tn.a,{})})})}),Object(m.jsx)(A.a,{mdDown:!0,children:Object(m.jsx)(Z.a,{title:"See this stop on the map",children:Object(m.jsx)(R.a,{size:"small",color:"primary",onClick:function(){return t=e.longitude,n=e.latitude,void k({type:"SetMapPosition",mapPosition:[t,n],mapZoom:15});var t,n},component:P.b,to:"/map",children:Object(m.jsx)(An.a,{})})})})]})},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Community",field:"community",filtering:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,render:function(e){return e.name},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Library service",field:"organisationName",filtering:!1,hidden:Object(Et.a)(M.breakpoints.down("sm")),cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Next due",field:"routeSchedule",filtering:!1,hidden:Object(Et.a)(M.breakpoints.down("xs")),render:function(e){return e.routeSchedule.length>0?e.routeSchedule[0].format("Do MMMM h:mma"):""},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}}],data:function(e){return new Promise((function(t,n){function r(){return(r=Object(N.a)(_.a.mark((function n(){var r;return _.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,En(e,h,f,g,j,b);case 2:r=n.sent,t({data:r.stops,page:r.page-1,totalCount:r.total});case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){r.apply(this,arguments)}()}))}})]})},qn=n(120),Xn=Object(D.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},dialogContentActions:{backgroundColor:"#e8f5e9",border:"1px solid #c8e6c9",borderRadius:3,padding:4},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)}}}));var Yn=function(){var e=v(),t=Object(L.a)(e,2),n=t[0].currentStopId,r=(t[1],w()),o=Object(L.a)(r,2),i=o[0].stopDialogOpen,c=o[1],s=Object(a.useState)({}),l=Object(L.a)(s,2),u=l[0],p=l[1];Object(a.useEffect)((function(){function e(){return(e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Zn(t);case 2:n=e.sent,p(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=n&&function(t){e.apply(this,arguments)}(n)}),[n]);var d=function(){c({type:"SetStopDialog",stopDialogOpen:!1})},b=Object(zt.a)(),j=Xn(),h=Object(Et.a)(b.breakpoints.down("sm"));return Object(m.jsxs)(Tt.a,{fullScreen:h,disableBackdropClick:!0,open:i,onClose:d,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:j.dialog},children:[u&&u.routeDays?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(Rt.a,{id:"dlg-title",children:u.name+". "+u.community}),Object(m.jsxs)(At.a,{children:[Object(m.jsx)("p",{children:u.routeSchedule&&u.routeSchedule.length>0?u.routeSchedule[0].format("dddd Do MMMM h:mma"):""}),Object(m.jsx)(me.a,{disableSticky:!0,children:"Actions"}),Object(m.jsxs)("div",{className:j.dialogContentActions,children:[Object(m.jsx)(B.a,{onClick:function(){return window.open(qn.api+"/stops/"+u.id+"/ics")},className:j.button,color:"primary",startIcon:Object(m.jsx)(Mn.a,{}),children:"Calendar"}),Object(m.jsx)(B.a,{onClick:function(){return window.open(qn.api+"/stops/"+u.id+"/pdf","_blank")},className:j.button,color:"primary",startIcon:Object(m.jsx)(Tn.a,{}),children:"Timetable"}),Object(m.jsx)(B.a,{onClick:function(){return window.open(u.timetable,"_blank")},color:"primary",startIcon:Object(m.jsx)(Lt.a,{}),children:"Website"}),Object(m.jsx)(B.a,{onClick:function(){c({type:"SetMapPosition",mapPosition:[u.longitude,u.latitude],mapZoom:14})},className:j.button,color:"primary",startIcon:Object(m.jsx)(An.a,{}),component:P.b,to:"/map",children:"Map"})]})]})]}):Object(m.jsx)(be.a,{className:j.progress,color:"primary",size:30}),Object(m.jsx)(Bt.a,{children:Object(m.jsx)(B.a,{onClick:function(){return d()},color:"secondary",endIcon:Object(m.jsx)(U.a,{}),children:"Close"})})]})},Vn=n(120),$n=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.originStopId=e.origin_stop_id,this.originStopName=e.origin_stop_name,this.destinationStopId=e.destination_stop_id,this.destinationStopName=e.destination_stop_name,this.distance=e.distance,this.duration=e.duration,this.routeLine=e.route_line,this}}]),e}();function Kn(e){return Qn.apply(this,arguments)}function Qn(){return(Qn=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(Vn.api+"/trips/"+t);case 2:if(!(n=e.sent)||!n.data){e.next=7;break}return e.abrupt("return",(new $n).fromJson(n.data));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var er=Object(D.a)((function(e){return{dialog:{border:"1px solid #E0E0E0"}}}));var tr=function(){var e=v(),t=Object(L.a)(e,2),n=t[0].currentTripId,r=(t[1],w()),o=Object(L.a)(r,2),i=o[0].tripDialogOpen,c=o[1],s=Object(a.useState)({}),l=Object(L.a)(s,2),u=l[0],p=l[1];Object(a.useEffect)((function(){function e(){return(e=Object(N.a)(_.a.mark((function e(t){var n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kn(t);case 2:n=e.sent,p(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=n&&function(t){e.apply(this,arguments)}(n)}),[n]);var d=function(){c({type:"SetTripDialog",tripDialogOpen:!1})},b=er(),j=Object(zt.a)(),h=Object(Et.a)(j.breakpoints.down("sm")),f=Math.round(u.duration/60)+" mins journey time.",g=Math.round(u.distance/1609,1)+" mile(s)";return Object(m.jsxs)(Tt.a,{fullScreen:h,disableBackdropClick:!0,open:i,onClose:d,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:b.dialog},children:[Object(m.jsx)(Rt.a,{children:"Trip details"}),Object(m.jsxs)(At.a,{children:[Object(m.jsx)(me.a,{disableSticky:!0,children:"From "+u.originStopName+" to "+u.destinationStopName}),Object(m.jsx)(pt.a,{variant:"body2",component:"p",children:f+" "+g})]}),Object(m.jsx)(Bt.a,{children:Object(m.jsx)(B.a,{onClick:d,color:"secondary",endIcon:Object(m.jsx)(U.a,{}),children:"Close"})})]})},nr=n.p+"static/media/accessibility.04c7e0c6.md",rr=n.p+"static/media/data.c1063344.md",ar=n.p+"static/media/privacy.d85474c9.md",or=n(120),ir=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.country=e.country,this.code=e.service_code,this.name=e.name,this.timetable=e.timetable,this.website=e.website,this.email=e.email,this.colour=e.colour,this.logo=e.logo,this.numberMobiles=e.number_mobiles,this.numberRoutes=e.number_routes,this.numberStops=e.number_stops,this}}]),e}();function cr(){return sr.apply(this,arguments)}function sr(){return(sr=Object(N.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(or.api+"/organisations");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new ir).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var lr=n(120),ur=function(){function e(t){Object(Re.a)(this,e),Object.assign(this,t)}return Object(ze.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.organisationId=e.organisation_id,this.mobileId=e.mobile_id,this.name=e.name,this.frequency=e.frequency,this.start=We()(e.start),this.end=We()(e.end),this.timetable=e.timetable,this.numberStops=e.number_stops,this}}]),e}();function pr(){return dr.apply(this,arguments)}function dr(){return(dr=Object(N.a)(_.a.mark((function e(){var t;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_e.a.get(lr.api+"/routes");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new ur).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var br=Object(D.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var jr=function(){var e=w(),t=Object(L.a)(e,1)[0],n=t.loadingOrganisations,r=t.loadingMobiles,o=t.loadingRoutes,i=t.loadingMobileLocations,c=t.loadingNearestMobiles,s=t.loadingPostcode,l=O(),u=Object(L.a)(l,2);Object(I.a)(u[0]);var p=u[1];Object(a.useEffect)((function(){function e(){return(e=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr();case 2:t=e.sent,n={},t.forEach((function(e){n[e.id]=e})),p({type:"AddOrganisations",organisations:t,organisationLookup:n});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ue();case 2:t=e.sent,n={},t.forEach((function(e){n[e.id]=e})),p({type:"AddMobiles",mobiles:t,mobileLookup:n});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return(n=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pr();case 2:t=e.sent,n={},t.forEach((function(e){n[e.id]=e})),p({type:"AddRoutes",routes:t,routeLookup:n});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function r(){return a.apply(this,arguments)}function a(){return(a=Object(N.a)(_.a.mark((function e(){var t,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xe();case 2:t=e.sent,n={},t.forEach((function(e){n[e.mobileId]=e})),p({type:"AddMobileLocations",mobileLocations:t,mobileLocationLookup:n});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}(),function(){n.apply(this,arguments)}(),r(),setInterval((function(){r(!1)}),15e3)}),[]);var d=br();return Object(m.jsx)(P.a,{children:Object(m.jsxs)("div",{className:d.root,children:[Object(m.jsx)(st,{loading:n||r||o||i||c||s,site:2}),Object(m.jsx)(M.a,{maxWidth:"lg",children:Object(m.jsxs)("main",{className:d.content,children:[Object(m.jsx)(F.a,{path:"/",exact:!0,render:function(){return Object(m.jsx)(Un,{})}}),Object(m.jsx)(F.a,{path:"/mobiles",render:function(){return Object(m.jsx)(Dt,{})}}),Object(m.jsx)(F.a,{path:"/map",render:function(){return Object(m.jsx)(dn,{})}}),Object(m.jsx)(F.a,{path:"/accessibility",exact:!0,render:function(){return Object(m.jsx)(xt,{page:nr})}}),Object(m.jsx)(F.a,{path:"/data",exact:!0,render:function(){return Object(m.jsx)(xt,{page:rr})}}),Object(m.jsx)(F.a,{path:"/privacy",exact:!0,render:function(){return Object(m.jsx)(xt,{page:ar})}}),Object(m.jsx)(F.a,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}})]})}),Object(m.jsx)(M.a,{maxWidth:"lg",children:Object(m.jsx)(bt,{})}),Object(m.jsx)(Yn,{}),Object(m.jsx)(Zt,{}),Object(m.jsx)(tr,{}),Object(m.jsx)(mn,{})]})})},hr={organisations:[],organisationLookup:{},mobiles:[],mobileLookup:{},mobileLocations:[],mobileLocationLookup:{},mobilesNearest:[],mobilesNearestLookup:{},routes:[],routeLookup:{},stops:[],trips:[]},mr=function(e,t){switch(t.type){case"AddOrganisations":return Object(s.a)(Object(s.a)({},e),{},{organisations:t.organisations,organisationLookup:t.organisationLookup});case"AddMobileLocations":return Object(s.a)(Object(s.a)({},e),{},{mobileLocations:t.mobileLocations,mobileLocationLookup:t.mobileLocationLookup});case"AddRoutes":return Object(s.a)(Object(s.a)({},e),{},{routes:t.routes,routeLookup:t.routeLookup});case"AddMobiles":return Object(s.a)(Object(s.a)({},e),{},{mobiles:t.mobiles,mobileLookup:t.mobileLookup});case"UpdateMobilesNearest":return Object(s.a)(Object(s.a)({},e),{},{mobilesNearest:t.mobilesNearest,mobilesNearestLookup:t.mobilesNearestLookup});default:return e}},fr={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[],searchPositionUpdateInterval:null,organisationFilter:[],mobileFilter:[],routeFilter:[],currentStopId:null,currentMobileLibraryId:null,currentTripId:null},gr=function(e,t){switch(t.type){case"SetCurrentStop":return Object(s.a)(Object(s.a)({},e),{},{currentStopId:t.stopId});case"SetCurrentMobileLibrary":return Object(s.a)(Object(s.a)({},e),{},{currentMobileLibraryId:t.mobileLibraryId});case"SetCurrentTrip":return Object(s.a)(Object(s.a)({},e),{},{currentTripId:t.tripId});case"SetSearchDistance":return Object(s.a)(Object(s.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(s.a)(Object(s.a)({},e),{},{searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode",organisationFilter:[],mobileFilter:[],routeFilter:[]});case"FilterByOrganisation":return Object(s.a)(Object(s.a)({},e),{},{organisationFilter:[t.organisationId],mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"FilterByMobile":return Object(s.a)(Object(s.a)({},e),{},{organisationFilter:[t.organisationId],mobileFilter:[t.mobileId],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"FilterByRoute":return Object(s.a)(Object(s.a)({},e),{},{routeFilter:[t.routeId],searchPostcode:"",searchPosition:[],searchType:""});case"ClearAll":return Object(s.a)(Object(s.a)({},e),{},{organisationFilter:[],mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"ClearMobileFilter":return Object(s.a)(Object(s.a)({},e),{},{mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"ClearRouteFilter":return Object(s.a)(Object(s.a)({},e),{},{routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});default:return e}},Or={stopDialogOpen:!1,mobileLibraryDialogOpen:!1,tripDialogOpen:!1,notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapSettings:{authorityBoundary:!1},mapSettingsDialogOpen:!1,loadingOrganisations:!1,loadingMobiles:!1,loadingRoutes:!1,loadingMobileLocations:!1,loadingNearestMobiles:!1,loadingPostcode:!1},xr=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(s.a)(Object(s.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(s.a)(Object(s.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(s.a)(Object(s.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(s.a)(Object(s.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetMobileLibraryDialog":return Object(s.a)(Object(s.a)({},e),{},{mobileLibraryDialogOpen:t.mobileLibraryDialogOpen});case"SetTripDialog":return Object(s.a)(Object(s.a)({},e),{},{tripDialogOpen:t.tripDialogOpen});case"SetMapSettingsDialog":return Object(s.a)(Object(s.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var n=e.mapSettings;return n[t.mapSetting]=!n[t.mapSetting],Object(s.a)(Object(s.a)({},e),{},{mapSettings:n});case"SetPostcodeSearch":return Object(s.a)(Object(s.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[13]});case"ToggleLoadingPostcode":return Object(s.a)(Object(s.a)({},e),{},{loadingPostcode:!e.loadingPostcode});case"SetMapPosition":return Object(s.a)(Object(s.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});default:return e}},yr=Object(j.a)({palette:{primary:{main:b.a[700]},secondary:{main:p.a[700]},outline:{main:p.a[50]}},overrides:{MuiButton:{text:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}},MuiTypography:{button:{textTransform:"none"}},MuiTableCell:{root:{borderBottom:"none"}}}});var vr=function(){return Object(m.jsx)(g,{initialState:hr,reducer:mr,children:Object(m.jsx)(y,{initialState:fr,reducer:gr,children:Object(m.jsx)(k,{initialState:Or,reducer:xr,children:Object(m.jsxs)(h.a,{theme:yr,children:[Object(m.jsx)(l.a,{}),Object(m.jsx)(jr,{})]})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(865);c.a.render(Object(m.jsx)(vr,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[866,1,2]]]);
//# sourceMappingURL=main.aa2eb7c8.chunk.js.map