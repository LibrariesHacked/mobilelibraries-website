{"version":3,"sources":["pages/accessibility.md","pages/data.md","pages/privacy.md","context/applicationState.js","context/searchState.js","context/viewState.js","helpers/geo.js","models/mobiles.js","PostcodeSearch.js","ServiceFilter.js","AppHeader.js","Footer.js","MarkdownPage.js","Filters.js","MobileCard.js","Mobiles.js","MeAvatar.js","MapSettings.js","helpers/utils.js","MobileAvatar.js","MobileMap.js","Notification.js","models/stops.js","Stops.js","StopDetails.js","models/trips.js","TripDetails.js","models/organisations.js","models/routes.js","MobilesApplication.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","ApplicationStateContext","createContext","ApplicationStateProvider","reducer","initialState","children","Provider","value","useReducer","useApplicationStateValue","useContext","SearchStateContext","SearchStateProvider","useSearchStateValue","ViewStateContext","ViewStateProvider","useViewStateValue","config","require","getPostcode","postcode","a","axios","get","postcodeApi","response","location","data","longitude","latitude","organisation","library_service_name","Mobile","obj","Object","assign","this","json","id","organisationId","organisation_id","name","timetable","numberRoutes","number_routes","numberStops","number_stops","MobileNearestStop","mobileId","mobile_id","stopId","stop_id","stopName","stop_name","stopDistance","stop_distance","MobileLocation","currentStopId","current_stop_id","currentStopDeparture","moment","current_stop_departure","currentStopName","current_stop_name","previousStopId","previous_stop_id","previousStopDeparture","previous_stop_departure","previousStopName","previous_stop_name","nextStopId","next_stop_id","nextStopArrival","next_stop_arrival","nextStopName","next_stop_name","updated","updateType","update_type","geoX","geox","geoY","geoy","routeSection","route_section","now","statuses","isSame","type","textFormat","message","arrival","fromNow","args","stopRemaining","text_format","getAllMobiles","api","length","mobiles","map","m","fromJson","getMobileLocations","locations","ml","getMobilesNearest","distance","useStyles","makeStyles","theme","grow","flexGrow","iconButton","padding","spacing","iconProgress","margin","inputInput","paddingTop","paddingRight","paddingBottom","paddingLeft","fontWeight","typography","fontWeightBold","search","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","marginRight","display","maxWidth","PostcodeSearch","props","settings","dispatchApplication","searchType","searchPostcode","searchDistance","dispatchSearch","loadingPostcode","dispatchView","useState","tempPostcode","setTempPostcode","anchor","setAnchor","prevProps","ref","useRef","useEffect","current","usePrevious","closeSettingsMenu","setSearchDistance","postcodeSearch","validatePostcode","pc","test","trim","geoHelper","postcodeData","searchPosition","mapPosition","mobilesModel","mobilesNearest","mobilesNearestLookup","forEach","mobile","notificationMessage","classes","className","InputBase","placeholder","input","onChange","e","target","toUpperCase","onKeyDown","keyCode","Tooltip","title","IconButton","aria-label","onClick","CircularProgress","size","color","currentTarget","openSettingsMenu","Menu","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","button","chip","leftIcon","alignContent","textAlign","marginBottom","subtitle","Filters","organisations","organisationLookup","mobileLookup","routeLookup","routes","organisationFilter","mobileFilter","routeFilter","organisationMenuAnchor","setOrganisationMenuAnchor","mobileMenuAnchor","setMobileMenuAnchor","routeMenuAnchor","setRouteMenuAnchor","closeOrganisationMenu","closeMobileMenu","closeRouteMenu","countries","Set","org","country","Button","element","Chip","variant","onDelete","label","Array","from","sort","b","localeCompare","idx","menuItems","key","orgList","filter","concat","mob","indexOf","route","routeId","appBar","zIndex","drawer","appBarTransparent","siteTitle","verticalAlign","primary","main","siteTitleIcon","topIcon","topTitle","AppHeader","site","currentServiceSystemName","appsOpen","setAppsOpen","tabValue","setTabValue","useLocation","currentServicePath","path","sites","url","icon","links","short","to","appBarClass","pathname","Toolbar","ServiceFilter","AppBar","elevation","Tabs","centered","v","scrollButtons","indicatorColor","textColor","s","Tab","Hidden","mdUp","link","component","Link","disableRipple","disableFocusRipple","startIcon","smDown","root","marginTop","width","grid","loveIcon","footerText","footerRight","tapTarget","lineHeight","fontSize","Footer","Divider","Grid","container","item","xs","sm","md","lg","xl","Typography","RouteLink","href","listItem","wordBreak","overflowX","WebkitOverflowScrolling","borderCollapse","borderSpacing","overflow","fontFamily","borderBottom","divider","body2","text","pxToRem","fontWeightMedium","whiteSpace","options","overrides","h1","gutterBottom","h2","h3","h4","paragraph","p","li","withStyles","MemoMarkdownPage","React","memo","page","pageText","setPageText","window","fetch","pageData","fetchPage","bullet","transform","card","minWidth","align","verticalDivider","height","progress","MobileCard","stopButton","stop","stopDialogOpen","statusMessage","status","getStatus","offRoadMessage","preRouteMessage","atStopMessage","betweenStopsMessage","postRouteMessage","bull","Card","CardContent","CardActions","goToWebsite","Mobiles","mobileLocationLookup","loadingMobileLocations","openTab","setOpenTab","filteredMobiles","activeMobiles","organisationName","mobileName","routeName","Math","round","mobilesView","changeTab","tab","Badge","badgeContent","showZero","replace","avatar","avatarOn","cursor","MeAvatar","Avatar","dialog","MapSettings","mapSettings","mapSettingsDialogOpen","closeDialog","useTheme","fullScreen","useMediaQuery","breakpoints","down","Dialog","disableBackdropClick","BackdropProps","invisible","PaperProps","DialogTitle","DialogContent","FormControlLabel","control","Switch","checked","authorityBoundary","mapSetting","DialogActions","hextoRGBA","hex","alpha","c","substring","split","join","Error","fab","boxShadow","MobileAvatar","mapZoom","Fab","style","utilsHelper","colour","bottom","right","Map","ReactMapboxGl","minZoom","maxZoom","customAttribution","stopTiles","tripTiles","libraryAuthorityTiles","MobileMap","mobileLocations","currentTime","setCurrentTime","setMap","setInterval","setTime","clickStop","features","properties","organisationColourMatch","push","code","l","center","zoom","pitch","bearing","fitBounds","containerStyle","top","left","onStyleLoad","locationPoint","coordinates","millisecondsPassed","diff","index","coords","getZoom","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","tripId","tripDialogOpen","Notification","notificationOpen","handleClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","action","Stop","routeIds","route_ids","routeNames","route_names","mobileIds","mobile_ids","mobileNames","mobile_names","organisation_name","community","address","arrivalTimes","arrival_times","departureTimes","departure_times","routeStart","route_start","routeEnd","route_end","routeDays","route_days","routeFrequencies","route_frequencies","routeSchedule","route_schedule","getQueryStops","query","organisationFilters","mobileFilters","routeFilters","pageSize","orderBy","field","orderDirection","stops","total","parseInt","headers","getStopById","formControl","table","Stops","tableRef","createRef","onQueryChange","orgText","keys","mobileText","routeText","components","Container","Paper","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","up","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","render","rowData","mdDown","cellStyle","hidden","format","Promise","resolve","reject","stopsModel","stopData","totalCount","getStops","list","background","paper","StopDetails","setStop","getStop","close","aria-labelledby","Trip","originStopId","origin_stop_id","originStopName","origin_stop_name","destinationStopId","destination_stop_id","destinationStopName","destination_stop_name","duration","routeLine","route_line","getTripById","TripDetails","currentTripId","trip","setTrip","tripsModel","getTrip","estimatedDuration","Organisation","website","email","logo","numberMobiles","number_mobiles","getAllOrganisations","o","Route","frequency","start","end","getAllRoutes","r","content","MobilesApplication","loadingOrganisations","loadingMobiles","loadingRoutes","loadingNearestMobiles","dispatchApplicationState","organisationsModel","routesModel","getOrganisations","getMobiles","getRoutes","loading","exact","Accessibility","Data","Privacy","substr","initialApplicationState","trips","applicationReducer","state","initialSearchState","searchPositionUpdateInterval","searchReducer","initialViewState","viewReducer","createMuiTheme","red","secondary","blueGrey","MuiButton","textTransform","MuiTab","MuiTypography","MuiTableCell","App","ThemeProvider","CssBaseline","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.75212c7c.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/accessibility.d9bc0fa4.md\";","module.exports = __webpack_public_path__ + \"static/media/data.e9cc0a7b.md\";","module.exports = __webpack_public_path__ + \"static/media/privacy.a013c74b.md\";","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ApplicationStateContext = createContext()\r\n\r\nexport const ApplicationStateProvider = ({ reducer, initialState, children }) => (\r\n  <ApplicationStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ApplicationStateContext.Provider>\r\n)\r\n\r\nexport const useApplicationStateValue = () => useContext(ApplicationStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const SearchStateContext = createContext()\r\n\r\nexport const SearchStateProvider = ({ reducer, initialState, children }) => (\r\n  <SearchStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </SearchStateContext.Provider>\r\n)\r\n\r\nexport const useSearchStateValue = () => useContext(SearchStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ViewStateContext = createContext()\r\n\r\nexport const ViewStateProvider = ({ reducer, initialState, children }) => (\r\n  <ViewStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ViewStateContext.Provider>\r\n)\r\n\r\nexport const useViewStateValue = () => useContext(ViewStateContext)\r\n","import axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getPosition (options = {}) {\r\n  return new Promise((resolve, reject) => {\r\n    navigator.geolocation.getCurrentPosition(resolve, reject, options)\r\n  })\r\n}\r\n\r\nexport async function getCurrentPosition () {\r\n  var options = {\r\n    enableHighAccuracy: true,\r\n    timeout: 10000,\r\n    maximumAge: 0\r\n  }\r\n\r\n  const position = await getPosition(options)\r\n  return [position.coords.longitude, position.coords.latitude]\r\n}\r\n\r\nexport async function getPostcode (postcode) {\r\n  const response = await axios.get(config.postcodeApi + postcode)\r\n  return {\r\n    location: [response.data.longitude, response.data.latitude],\r\n    organisation: response.data.library_service_name\r\n  }\r\n};\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Mobile {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileNearestStop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.stopId = json.stop_id\r\n    this.stopName = json.stop_name\r\n    this.stopDistance = json.stop_distance\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileLocation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.currentStopId = json.current_stop_id\r\n    this.currentStopDeparture = moment(json.current_stop_departure)\r\n    this.currentStopName = json.current_stop_name\r\n    this.previousStopId = json.previous_stop_id\r\n    this.previousStopDeparture = moment(json.previous_stop_departure)\r\n    this.previousStopName = json.previous_stop_name\r\n    this.nextStopId = json.next_stop_id\r\n    this.nextStopArrival = moment(json.next_stop_arrival)\r\n    this.nextStopName = json.next_stop_name\r\n    this.updated = moment(json.updated)\r\n    this.updateType = json.update_type\r\n    this.geoX = json.geox\r\n    this.geoY = json.geoy\r\n    this.routeSection = json.route_section\r\n    return this\r\n  }\r\n\r\n  getStatus () {\r\n    const now = moment()\r\n    const statuses = {\r\n      offRoad: 'Not out today',\r\n      preRoute: 'Arriving at ',\r\n      atStop: 'At ',\r\n      betweenStops: 'Arriving at ',\r\n      postRoute: 'Finished for the day'\r\n    }\r\n    // The mobile is not due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'offRoad',\r\n        textFormat: statuses.offRoad,\r\n        message: statuses.offRoad\r\n      }\r\n    }\r\n    // The mobile is due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'preRoute',\r\n        message: statuses.preRoute,\r\n        textFormat: statuses.preRoute + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is at a stop, and will be for a certain amount of time\r\n    if (this.currentStopId) {\r\n      const stopRemaining = this.currentStopDeparture.fromNow(true)\r\n      return {\r\n        type: 'atStop',\r\n        message: statuses.atStop,\r\n        textFormat: statuses.atStop + this.currentStopName + ' for ' + stopRemaining,\r\n        args: [\r\n          { stopName: this.currentStopName, stopId: this.currentStopId },\r\n          stopRemaining\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is between stops\r\n    if (!this.currentStopId && this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'betweenStops',\r\n        message: statuses.betweenStops,\r\n        textFormat: statuses.betweenStops + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile has finished for the day\r\n    if (this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'postRoute',\r\n        message: statuses.postRoute,\r\n        text_format: statuses.postRoute\r\n      }\r\n    }\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getAllMobiles () {\r\n  const response = await axios.get(config.api + '/mobiles')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const mobiles = response.data.map(m => (new Mobile()).fromJson(m))\r\n    return mobiles\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobileLocations () {\r\n  const response = await axios.get(config.api + '/mobiles/locations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const locations = response.data.map(ml => (new MobileLocation()).fromJson(ml))\r\n    return locations\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobilesNearest (location, distance) {\r\n  const response = await axios.get(config.api + '/mobiles/nearest?longitude=' + location[0] + '&latitude=' + location[1] + '&distance=' + distance)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(m => (new MobileNearestStop()).fromJson(m))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport ClearIcon from '@material-ui/icons/ClearTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as geoHelper from './helpers/geo'\r\nimport * as mobilesModel from './models/mobiles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  iconButton: {\r\n    padding: theme.spacing()\r\n  },\r\n  iconProgress: {\r\n    margin: theme.spacing()\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing(),\r\n    paddingRight: theme.spacing(),\r\n    paddingBottom: theme.spacing(),\r\n    paddingLeft: theme.spacing(2),\r\n    fontWeight: theme.typography.fontWeightBold\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    border: '1px solid #E0E0E0',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.8),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.9)\r\n    },\r\n    marginLeft: 0,\r\n    marginRight: theme.spacing(),\r\n    display: 'flex',\r\n    maxWidth: 240\r\n  }\r\n}))\r\n\r\nfunction usePrevious (value) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}\r\n\r\nfunction PostcodeSearch (props) {\r\n  const { settings } = props\r\n  const [{ }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ loadingPostcode }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [tempPostcode, setTempPostcode] = useState(searchPostcode)\r\n  const [anchor, setAnchor] = useState(null)\r\n\r\n  const prevProps = usePrevious({ searchPostcode })\r\n  useEffect(() => {\r\n    if (prevProps && searchPostcode !== prevProps.searchPostcode) setTempPostcode(searchPostcode)\r\n  }, [searchPostcode]) // eslint-disable-line\r\n\r\n  const openSettingsMenu = (e) => setAnchor(e.currentTarget)\r\n\r\n  const closeSettingsMenu = () => setAnchor(null)\r\n\r\n  const setSearchDistance = (searchDistance) => {\r\n    closeSettingsMenu()\r\n    dispatchSearch({ type: 'SetSearchDistance', searchDistance: searchDistance })\r\n    if (searchType === 'postcode') postcodeSearch()\r\n  }\r\n\r\n  const postcodeSearch = async () => {\r\n    dispatchView({ type: 'ToggleLoadingPostcode' })\r\n    const validatePostcode = (pc) => /^[A-Z]{1,2}\\d[A-Z\\d]? ?\\d[A-Z]{2}$/.test(pc)\r\n    if (tempPostcode !== '' && validatePostcode(tempPostcode.trim())) {\r\n      const postcodeData = await geoHelper.getPostcode(tempPostcode)\r\n      if (postcodeData.location && postcodeData.location.length === 2) {\r\n        dispatchSearch({ type: 'SetPostcodeSearch', searchPostcode: tempPostcode, searchPosition: postcodeData.location })\r\n        dispatchView({ type: 'SetPostcodeSearch', mapPosition: postcodeData.location })\r\n        const mobilesNearest = await mobilesModel.getMobilesNearest(postcodeData.location, searchDistance)\r\n        const mobilesNearestLookup = {}\r\n        mobilesNearest.forEach(mobile => { mobilesNearestLookup[mobile.mobileId] = mobile })\r\n        dispatchApplication({ type: 'UpdateMobilesNearest', mobilesNearest: mobilesNearest, mobilesNearestLookup: mobilesNearestLookup })\r\n      } else {\r\n        dispatchView({ type: 'ShowNotification', notificationMessage: 'Could not find that postcode' })\r\n      }\r\n    } else {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'You must enter a valid postcode' })\r\n    }\r\n    dispatchView({ type: 'ToggleLoadingPostcode' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.search}>\r\n      <InputBase\r\n        placeholder='Postcode'\r\n        classes={{\r\n          input: classes.inputInput\r\n        }}\r\n        value={tempPostcode}\r\n        onChange={(e) => setTempPostcode(e.target.value.toUpperCase())}\r\n        onKeyDown={(e) => { if (e.keyCode === 13) postcodeSearch() }}\r\n      />\r\n      <div className={classes.grow} />\r\n      {searchType === 'postcode'\r\n        ? (\r\n          <Tooltip title='Clear search'>\r\n            <IconButton\r\n              aria-label='Clear search'\r\n              className={classes.iconButton}\r\n              onClick={() => dispatchSearch({ type: 'ClearAll' })}\r\n            >\r\n              <ClearIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        )\r\n        : null}\r\n      <Tooltip title='Search by postcode'>\r\n        {!loadingPostcode\r\n          ? (\r\n            <IconButton\r\n              aria-label='Search'\r\n              color='primary'\r\n              className={classes.iconButton}\r\n              onClick={() => postcodeSearch()}\r\n            >\r\n              <SearchIcon />\r\n            </IconButton>\r\n          ) : <CircularProgress size={22} className={classes.iconProgress} />}\r\n      </Tooltip>\r\n      {settings\r\n        ? (\r\n          <Tooltip title='Change search settings'>\r\n            <IconButton\r\n              aria-label='Open search settings menu'\r\n              className={classes.iconButton}\r\n              color='secondary'\r\n              onClick={(e) => { openSettingsMenu(e) }}\r\n            >\r\n              <SettingsIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        ) : null}\r\n      <Menu\r\n        id='mnu-settings'\r\n        anchorEl={anchor}\r\n        keepMounted\r\n        open={Boolean(anchor)}\r\n        onClose={() => closeSettingsMenu()}\r\n      >\r\n        <ListSubheader disableSticky>Search distance</ListSubheader>\r\n        <MenuItem onClick={() => setSearchDistance(1609)}>1 mile</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(4827)}>3 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(8045)}>5 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(16090)}>10 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(32180)}>20 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(80450)}>50 miles</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PostcodeSearch\r\n","import React, { useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BusinessIcon from '@material-ui/icons/BusinessTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport DirectionsIcon from '@material-ui/icons/DirectionsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  chip: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const [{ organisations, organisationLookup, mobiles, mobileLookup, routeLookup, routes }] = useApplicationStateValue()\r\n  const [{ organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue()\r\n\r\n  const [organisationMenuAnchor, setOrganisationMenuAnchor] = useState(null)\r\n  const [mobileMenuAnchor, setMobileMenuAnchor] = useState(null)\r\n  const [routeMenuAnchor, setRouteMenuAnchor] = useState(null)\r\n\r\n  const openOrganisationMenu = (element) => setOrganisationMenuAnchor(element)\r\n\r\n  const closeOrganisationMenu = () => setOrganisationMenuAnchor(null)\r\n\r\n  const chooseOrganisation = (organisationId) => {\r\n    dispatchSearch({ type: 'FilterByOrganisation', organisationId: organisationId })\r\n    closeOrganisationMenu()\r\n  }\r\n\r\n  const clearOrganisationFilter = () => {\r\n    dispatchSearch({ type: 'ClearAll' })\r\n  }\r\n\r\n  const openMobileMenu = (element) => setMobileMenuAnchor(element)\r\n\r\n  const closeMobileMenu = () => setMobileMenuAnchor(null)\r\n\r\n  const chooseMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n    closeMobileMenu()\r\n  }\r\n\r\n  const clearMobileFilter = () => {\r\n    dispatchSearch({ type: 'ClearMobileFilter' })\r\n  }\r\n\r\n  const openRouteMenu = (element) => setRouteMenuAnchor(element)\r\n\r\n  const closeRouteMenu = () => setRouteMenuAnchor(null)\r\n\r\n  const chooseRoute = (routeId) => {\r\n    dispatchSearch({ type: 'FilterByRoute', routeId: routeId })\r\n    closeRouteMenu()\r\n  }\r\n\r\n  const clearRouteFilter = () => {\r\n    dispatchSearch({ type: 'ClearRouteFilter' })\r\n  }\r\n\r\n  const countries = new Set(organisations.map(org => org.country))\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.search}>\r\n        {organisationFilter.length === 0 ? (\r\n          <Tooltip title='Choose library service'>\r\n            <Button color='primary' className={classes.button} onClick={(e) => openOrganisationMenu(e.currentTarget)}>\r\n              <BusinessIcon className={classes.leftIcon} />Select service\r\n            </Button>\r\n          </Tooltip>\r\n        ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearOrganisationFilter} label={organisationLookup[organisationFilter[0]].name} />}\r\n        {organisationFilter.length > 0\r\n          ? (mobileFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose mobile library'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openMobileMenu(e.currentTarget)}>\r\n                  <DirectionBusIcon className={classes.leftIcon} />Select mobile\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearMobileFilter} label={mobileLookup[mobileFilter[0]].name} />\r\n          ) : null}\r\n        {mobileFilter.length > 0\r\n          ? (routeFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose route'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openRouteMenu(e.currentTarget)}>\r\n                  <DirectionsIcon className={classes.leftIcon} />Select route\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearRouteFilter} label={routeLookup[routeFilter[0]].name} />\r\n          )\r\n          : null}\r\n      </div>\r\n      <Menu\r\n        id='menu-library-service'\r\n        anchorEl={organisationMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(organisationMenuAnchor)}\r\n        onClose={() => closeOrganisationMenu()}\r\n      >\r\n        {\r\n          Array.from(countries)\r\n            .sort((a, b) => a.localeCompare(b))\r\n            .map((country, idx) => {\r\n              const menuItems = [<ListSubheader key={'lst_' + idx} disableSticky>{country}</ListSubheader>]\r\n              const orgList = organisations\r\n                .sort((a, b) => a.name.localeCompare(b.name))\r\n                .filter(org => org.country === country)\r\n                .map(org => {\r\n                  return <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n                })\r\n              return menuItems.concat(orgList)\r\n            })\r\n        }\r\n      </Menu>\r\n      <Menu\r\n        id='menu-mobile-library'\r\n        anchorEl={mobileMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(mobileMenuAnchor)}\r\n        onClose={() => closeMobileMenu()}\r\n      >\r\n        {mobiles\r\n          .filter(mob => {\r\n            let display = true\r\n            if (organisationFilter.length > 0 &&\r\n              organisationFilter.indexOf(mob.organisationId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(mob => {\r\n            return <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => chooseMobile(mob.organisationId, mob.id)}>{mob.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n      <Menu\r\n        id='menu-route'\r\n        anchorEl={routeMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(routeMenuAnchor)}\r\n        onClose={() => closeRouteMenu()}\r\n      >\r\n        {routes\r\n          .filter(route => {\r\n            let display = true\r\n            if (mobileFilter.length > 0 &&\r\n              mobileFilter.indexOf(route.mobileId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(route => {\r\n            return <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => chooseRoute(route.id)}>{route.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React, { useState } from 'react'\r\n\r\nimport { Link, useLocation } from 'react-router-dom'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Button from '@material-ui/core/Button'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport Container from '@material-ui/core/Container'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BookIcon from '@material-ui/icons/BookTwoTone'\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport GridOnIcon from '@material-ui/icons/GridOnTwoTone'\r\nimport HeadsetIcon from '@material-ui/icons/HeadsetTwoTone'\r\nimport ImportContactsIcon from '@material-ui/icons/ImportContactsTwoTone'\r\nimport MapIcon from '@material-ui/icons/MapTwoTone'\r\nimport MovieIcon from '@material-ui/icons/MovieTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport PetsIcon from '@material-ui/icons/PetsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'white',\r\n    position: 'relative'\r\n  },\r\n  appBarTransparent: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    position: 'relative'\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  siteTitle: {\r\n    margin: theme.spacing(1),\r\n    padding: theme.spacing(1),\r\n    display: 'inline-block',\r\n    verticalAlign: 'middle',\r\n    color: theme.palette.primary.main,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    border: '1px solid #e5e5e5',\r\n    borderRadius: 26\r\n  },\r\n  siteTitleIcon: {\r\n    verticalAlign: 'sub'\r\n  },\r\n  title: {\r\n    margin: theme.spacing(2),\r\n    display: 'inline-block',\r\n    verticalAlign: 'middle'\r\n  },\r\n  topIcon: {\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    border: '1px solid #e5e5e5',\r\n    '&:hover': {\r\n      backgroundColor: 'rgba(250, 250, 250, 0.8)'\r\n    }\r\n  },\r\n  topTitle: {\r\n    position: 'relative',\r\n    zIndex: theme.zIndex.drawer + 1\r\n  }\r\n}))\r\n\r\nfunction AppHeader (props) {\r\n  const { site } = props\r\n  const [{ currentServiceSystemName }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n\r\n  const [appsOpen, setAppsOpen] = useState(false)\r\n  const [tabValue, setTabValue] = useState(site)\r\n\r\n  const location = useLocation()\r\n  const classes = useStyles()\r\n\r\n  const currentServicePath = (path) => {\r\n    if (currentServiceSystemName) return path + '?service=' + currentServiceSystemName\r\n    return path\r\n  }\r\n\r\n  const sites = [\r\n    {\r\n      title: 'Library lab',\r\n      url: 'https://www.librarylab.uk',\r\n      icon: <PetsIcon />,\r\n      links: [\r\n        {\r\n          title: 'About library lab',\r\n          short: 'Lab',\r\n          icon: <PetsIcon />,\r\n          to: '/'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Libraries at home',\r\n      url: 'https://www.librariesathome.co.uk',\r\n      icon: <ImportContactsIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find service',\r\n          short: 'Find',\r\n          icon: <SearchIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Watch library TV',\r\n          short: 'Watch',\r\n          icon: <MovieIcon />,\r\n          to: '/watch'\r\n        },\r\n        {\r\n          title: 'Read blogs',\r\n          short: 'Read',\r\n          icon: <BookIcon />,\r\n          to: '/read'\r\n        },\r\n        {\r\n          title: 'Listen podcasts',\r\n          short: 'Listen',\r\n          icon: <HeadsetIcon />,\r\n          to: '/listen'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Mobile libraries',\r\n      url: 'https://www.mobilelibraries.org',\r\n      icon: <DirectionBusIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my stop',\r\n          short: 'Stops',\r\n          icon: <GridOnIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: 'Mobile vans',\r\n          short: 'Vans',\r\n          icon: <DirectionBusIcon />,\r\n          to: '/mobiles'\r\n        },\r\n        {\r\n          title: 'Map of stops',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: '/map'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Library map',\r\n      url: 'https://www.librarymap.co.uk',\r\n      icon: <MapIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my library',\r\n          short: 'Find',\r\n          icon: <GridOnIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Map of libraries',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: currentServicePath('/map')\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n\r\n  const appBarClass = (location.pathname === '/map' ? classes.appBarTransparent : classes.appBar)\r\n\r\n  return (\r\n    <>\r\n      <Container maxWidth='lg' className={classes.topTitle}>\r\n        <Toolbar>\r\n          <IconButton aria-label='Toggle site menu' className={classes.topIcon} color='primary' onClick={() => { setAppsOpen(!appsOpen); setTabValue(site) }}>\r\n            {appsOpen ? <CancelIcon /> : <PetsIcon />}\r\n          </IconButton>\r\n          <span className={classes.grow} />\r\n          {location.pathname === '/map' ? <ServiceFilter /> : null}\r\n          <Chip\r\n            label={sites[site].title}\r\n            color='secondary'\r\n          />\r\n        </Toolbar>\r\n      </Container>\r\n      {appsOpen ? (\r\n        <AppBar position='static' color='default' elevation={0} className={appBarClass}>\r\n          <Container maxWidth='lg'>\r\n            <Tabs\r\n              centered\r\n              value={tabValue}\r\n              onChange={(e, v) => { setTabValue(v) }}\r\n              variant='scrollable'\r\n              scrollButtons='on'\r\n              indicatorColor='primary'\r\n              textColor='secondary'\r\n            >\r\n              {sites.map((s, idx) => {\r\n                return (\r\n                  <Tab key={'tb_site_' + idx} label={s.title} icon={s.icon} />\r\n                )\r\n              })}\r\n            </Tabs>\r\n          </Container>\r\n        </AppBar>\r\n      ) : null}\r\n      <AppBar\r\n        position='static'\r\n        color='inherit'\r\n        elevation={0}\r\n        className={appBarClass}\r\n      >\r\n        <Container maxWidth='lg'>\r\n          <Toolbar>\r\n            <Hidden mdUp>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.short}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <Hidden smDown>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.title}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <span className={classes.grow} />\r\n            {location.pathname === '/map' ? <PostcodeSearch /> : null}\r\n          </Toolbar>\r\n        </Container>\r\n      </AppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default AppHeader\r\n","import React from 'react'\r\nimport RouteLink from 'react-router-dom/Link'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Link from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport FavoriteIcon from '@material-ui/icons/FavoriteTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingTop: theme.spacing(5),\r\n    marginTop: theme.spacing(3),\r\n    marginBottom: theme.spacing(5),\r\n    width: '100%'\r\n  },\r\n  grid: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  loveIcon: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  footerText: {\r\n    verticalAlign: 'middle',\r\n    display: 'inline-flex'\r\n  },\r\n  footerRight: {\r\n    textAlign: 'right'\r\n  },\r\n  tapTarget: {\r\n    lineHeight: 2.2,\r\n    fontSize: 16\r\n  }\r\n}))\r\n\r\nfunction Footer () {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider />\r\n      <Grid container spacing={3} className={classes.grid}>\r\n        <Grid item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='body1' className={classes.footerText}>A library lab project built by Libraries Hacked.</Typography><br />\r\n          <Typography variant='button'>\r\n            <Link component={RouteLink} to='/accessibility' title='How we make this site accessible' className={classes.tapTarget}>Accessibility</Link><br />\r\n            <Link component={RouteLink} to='/privacy' title='Your privacy on this site' className={classes.tapTarget}>Privacy</Link><br />\r\n            <Link component={RouteLink} to='/data' title='Data used on this site and licensing' className={classes.tapTarget}>Data</Link>\r\n          </Typography>\r\n        </Grid>\r\n        <Grid className={classes.footerRight} item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='button'>\r\n            <Link href='https://github.com/LibrariesHacked/mobilelibraries-website' target='_blank' title='Project on GitHub' className={classes.tapTarget}>Open Source on GitHub</Link><br />\r\n            <Link href='https://www.librarylab.uk/docs/mobile-libraries' target='_blank' title='About the library lab projects and documentation for this project' className={classes.tapTarget}>About this project</Link><br />\r\n            <FavoriteIcon color='error' className={classes.loveIcon} />\r\n          </Typography>\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Footer\r\n","import React, { useEffect, useState } from 'react'\r\nimport ReactMarkdown from 'markdown-to-jsx'\r\n\r\nimport { withStyles, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport Link from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  listItem: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  root: {\r\n    '& table': {\r\n      display: 'block',\r\n      wordBreak: 'normal',\r\n      width: '100%',\r\n      overflowX: 'auto',\r\n      WebkitOverflowScrolling: 'touch',\r\n      borderCollapse: 'collapse',\r\n      marginBottom: '16px',\r\n      borderSpacing: 0,\r\n      overflow: 'hidden',\r\n      '& .prop-name': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace'\r\n      },\r\n      '& .required': {\r\n        color: theme.palette.type === 'light' ? '#006500' : '#a5ffa5'\r\n      },\r\n      '& .prop-type': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        color: theme.palette.type === 'light' ? '#932981' : '#ffb6ec'\r\n      },\r\n      '& .prop-default': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        borderBottom: `1px dotted ${theme.palette.divider}`\r\n      }\r\n    },\r\n    '& td': {\r\n      ...theme.typography.body2,\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16,\r\n      color: theme.palette.text.primary\r\n    },\r\n    '& th': {\r\n      fontSize: 14,\r\n      lineHeight: theme.typography.pxToRem(24),\r\n      fontWeight: theme.typography.fontWeightMedium,\r\n      color: theme.palette.text.primary,\r\n      whiteSpace: 'pre',\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16\r\n    }\r\n  }\r\n}))\r\n\r\nconst options = {\r\n  overrides: {\r\n    h1: {\r\n      component: Typography,\r\n      props: {\r\n        gutterBottom: true,\r\n        variant: 'h4',\r\n        color: 'secondary'\r\n      }\r\n    },\r\n    h2: { component: Typography, props: { gutterBottom: true, variant: 'h5', color: 'textPrimary' } },\r\n    h3: { component: Typography, props: { gutterBottom: true, variant: 'h6', color: 'textPrimary' } },\r\n    h4: {\r\n      component: Typography,\r\n      props: { gutterBottom: true, variant: 'h6', paragraph: true, color: 'textPrimary' }\r\n    },\r\n    p: { component: Typography, props: { paragraph: true, color: 'textPrimary' } },\r\n    a: { component: Link },\r\n    li: {\r\n      component: withStyles(useStyles)(({ classes, ...props }) => (\r\n        <li className={classes.listItem}>\r\n          <Typography component='span' {...props} />\r\n        </li>\r\n      ))\r\n    }\r\n  }\r\n}\r\n\r\nexport function MarkdownPage (props) {\r\n  const { page } = props\r\n  const [pageText, setPageText] = useState('')\r\n  const classes = useStyles()\r\n\r\n  useEffect(() => {\r\n    async function fetchPage () {\r\n      const pageData = await window.fetch(page)\r\n      const pageText = await pageData.text()\r\n      setPageText(pageText)\r\n    }\r\n    fetchPage()\r\n  }, [page])\r\n\r\n  return <ReactMarkdown className={classes.root} options={options} {...props}>{pageText}</ReactMarkdown>\r\n}\r\n\r\nexport const MemoMarkdownPage = React.memo(MarkdownPage)\r\n","import React from 'react'\r\n\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const [{ searchDistance }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <Typography component='h2' variant='h6' className={classes.title}>Your mobile service</Typography>\r\n      <Typography component='p' variant='body1' className={classes.subtitle}>Search by postcode (within {searchDistance / 1609} mile/s) or select service</Typography>\r\n      <div className={classes.search}>\r\n        <PostcodeSearch settings />\r\n      </div>\r\n      <ServiceFilter />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React from 'react'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardActions from '@material-ui/core/CardActions'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\nimport WebIcon from '@material-ui/icons/WebTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  bullet: {\r\n    display: 'inline-block',\r\n    margin: '0 2px',\r\n    transform: 'scale(1.2)'\r\n  },\r\n  card: {\r\n    minWidth: 275\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  title: {\r\n    fontSize: 12,\r\n    fontWeight: 500,\r\n    align: 'right'\r\n  },\r\n  verticalDivider: {\r\n    width: 1,\r\n    height: 28,\r\n    margin: 8\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction MobileCard (props) {\r\n  const { mobile, organisation, location } = props\r\n  const [{ }, dispatchSearch] = useSearchStateValue() // eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() // eslint-disable-line\r\n\r\n  const viewStopsByMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n  }\r\n\r\n  const viewStop = (stopId) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stopId })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const stopButton = (stop) => {\r\n    return <Button color='secondary' onClick={() => viewStop(stop.stopId)}>{stop.stopName}</Button>\r\n  }\r\n\r\n  const offRoadMessage = (status) => {\r\n    return (\r\n      <Typography>{status.message}</Typography>\r\n    )\r\n  }\r\n\r\n  const preRouteMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const atStopMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {' for ' + status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const betweenStopsMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const postRouteMessage = (status) => <Typography>{status.message}</Typography>\r\n\r\n  const classes = useStyles()\r\n\r\n  let statusMessage = null\r\n  if (location) {\r\n    const status = location.getStatus()\r\n    if (status && status.type === 'offRoad') statusMessage = offRoadMessage(status)\r\n    if (status && status.type === 'preRoute') statusMessage = preRouteMessage(status)\r\n    if (status && status.type === 'atStop') statusMessage = atStopMessage(status)\r\n    if (status && status.type === 'betweenStops') statusMessage = betweenStopsMessage(status)\r\n    if (status && status.type === 'postRoute') statusMessage = postRouteMessage(status)\r\n  }\r\n\r\n  const bull = <span className={classes.bullet}></span>\r\n\r\n  return (\r\n    <Card className={classes.card} elevation={0}>\r\n      <CardContent>\r\n        <Typography className={classes.title} gutterBottom>\r\n          {mobile.numberRoutes + ' route' + (mobile.numberRoutes > 1 ? 's' : '')}\r\n          {bull}\r\n          {mobile.numberStops + ' stop' + (mobile.numberStops > 1 ? 's' : '')}\r\n        </Typography>\r\n        <Typography variant='h6' component='h2'>{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n        {statusMessage}\r\n      </CardContent>\r\n      <CardActions>\r\n        <Tooltip title='Mobile library stops'>\r\n          <Button component={Link} to='/stops' size='small' color='primary' className={classes.button} onClick={() => viewStopsByMobile(organisation.id, mobile.id)}>\r\n            <LocationOnIcon className={classes.leftIcon} />View stops\r\n          </Button>\r\n        </Tooltip>\r\n        <Divider className={classes.verticalDivider} />\r\n        {mobile.timetable ? (\r\n          <Tooltip title='Website timetable'>\r\n            <IconButton className={classes.button} onClick={() => this.goToWebsite()}>\r\n              <WebIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        ) : null}\r\n      </CardActions>\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default MobileCard\r\n","import React, { useState } from 'react'\r\n\r\nimport Badge from '@material-ui/core/Badge'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport Filters from './Filters'\r\nimport MobileCard from './MobileCard'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  padding: {\r\n    padding: theme.spacing(0, 2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction Mobiles () {\r\n  const [{ organisationLookup, mobiles, mobileLookup, mobileLocationLookup, mobilesNearestLookup, routes, routeLookup }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ organisationFilter, mobileFilter, routeFilter, searchType, searchDistance, searchPostcode }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ loadingMobileLocations }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [openTab, setOpenTab] = useState(0)\r\n\r\n  const changeTab = (value) => {\r\n    setOpenTab(value)\r\n  }\r\n\r\n  // Get all mobiles that are currently filtered\r\n  const filteredMobiles = mobiles.filter(mob => {\r\n    let display = true\r\n    if (searchType === 'gps' || searchType === 'postcode') {\r\n      display = mobilesNearestLookup[mob.id]\r\n    }\r\n    if (organisationFilter.length > 0 &&\r\n      organisationFilter.indexOf(mob.organisationId) === -1) {\r\n      display = false\r\n    }\r\n    if (mobileFilter.length > 0 &&\r\n      mobileFilter.indexOf(mob.id) === -1) {\r\n      display = false\r\n    }\r\n    return display\r\n  })\r\n\r\n  // Then get those that are currently active\r\n  const activeMobiles = filteredMobiles.filter(mob => {\r\n    if (mobileLocationLookup[mob.id]) {\r\n      const status = mobileLocationLookup[mob.id].getStatus()\r\n      return (status && status.type !== 'offRoad' && status.type !== 'postRoute')\r\n    }\r\n    return null\r\n  })\r\n\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n\r\n  let title = 'Mobile library vans'\r\n  if (organisationName !== '') title = 'Mobile library vans serving ' + organisationName\r\n  if (mobileName !== '') title = organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = organisationName + ' ' + routeName\r\n  if (searchPostcode !== '') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  if (searchType === 'gps') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const classes = useStyles()\r\n\r\n  const displayMobiles = (openTab === 0 ? activeMobiles : filteredMobiles)\r\n  const mobilesView = displayMobiles\r\n    .filter(mob => {\r\n      let display = true\r\n      if (organisationFilter.length > 0 &&\r\n        organisationFilter.indexOf(mob.organisationId) === -1) {\r\n        display = false\r\n      }\r\n      if (mobileFilter.length > 0 &&\r\n        mobileFilter.indexOf(mob.id) === -1) {\r\n        display = false\r\n      }\r\n      return display\r\n    })\r\n    .filter(mob => {\r\n      if (searchType === 'gps' || searchType === 'postcode') {\r\n        return mobilesNearestLookup[mob.id]\r\n      }\r\n      return true\r\n    })\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Filters />\r\n      <ListSubheader component='span' disableSticky>{title}</ListSubheader>\r\n      <Tabs\r\n        variant='standard'\r\n        scrollButtons='off'\r\n        value={openTab}\r\n        indicatorColor='secondary'\r\n        onChange={(e, value) => changeTab(value)}\r\n      >\r\n        <Tab\r\n          className={classes.tab}\r\n          label={\r\n            <Badge\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={activeMobiles.length}\r\n            >\r\n              On the road\r\n            </Badge>\r\n          }\r\n        />\r\n        <Tab\r\n          label={\r\n            <Badge\r\n              showZero\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={filteredMobiles.length}\r\n            >\r\n              All vans\r\n            </Badge>\r\n          }\r\n        />\r\n      </Tabs>\r\n      <br />\r\n      {\r\n        mobilesView.length > 0\r\n          ? (\r\n            <Grid container spacing={3}>\r\n              {\r\n                mobilesView.map((mobile, idx) => {\r\n                  return (\r\n                    <Grid\r\n                      key={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n                      item xs={12} sm={6} md={4} lg={3} xl={3}\r\n                    >\r\n                      <MobileCard\r\n                        mobile={mobile}\r\n                        location={mobileLocationLookup[mobile.id]}\r\n                        organisation={organisationLookup[mobile.organisationId]}\r\n                      />\r\n                    </Grid>\r\n                  )\r\n                })\r\n              }\r\n            </Grid>) : (\r\n            !loadingMobileLocations\r\n              ? <Typography component='p' variant='body1'>No mobile libraries currently on the road.</Typography>\r\n              : null\r\n          )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Mobiles\r\n","import React from 'react'\r\n\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport Face from '@material-ui/icons/FaceTwoTone'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    margin: 0\r\n  },\r\n  avatarOn: {\r\n    margin: 0,\r\n    cursor: 'pointer',\r\n    backgroundColor: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nfunction MeAvatar () {\r\n  const [{ searchType }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip title='Me'>\r\n      <Avatar\r\n        className={searchType === 'gps' ? classes.avatarOn : classes.avatar}\r\n      >\r\n        <Face />\r\n      </Avatar>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MeAvatar\r\n","import React from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport { useTheme, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction MapSettings () {\r\n  const [{ mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue()\r\n\r\n  const closeDialog = () => {\r\n    dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: false })\r\n  }\r\n\r\n  const handleAuthorityBoundaryChange = () => {\r\n    dispatchView({ type: 'ToggleMapSetting', mapSetting: 'authorityBoundary' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={mapSettingsDialogOpen}\r\n      onClose={closeDialog}\r\n      BackdropProps={{\r\n        invisible: true\r\n      }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Map settings</DialogTitle>\r\n      <DialogContent>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={mapSettings.authorityBoundary}\r\n              onChange={handleAuthorityBoundaryChange}\r\n              name='sw_authority_boundary'\r\n              color='primary'\r\n            />\r\n          }\r\n          label='Library service boundaries'\r\n        />\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={closeDialog} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default MapSettings\r\n","export function hextoRGBA (hex, alpha) {\r\n  var c\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('')\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]]\r\n    }\r\n    c = '0x' + c.join('')\r\n    return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ', ' + alpha + ')'\r\n  }\r\n  throw new Error('Bad Hex')\r\n}\r\n","import React from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as utilsHelper from './helpers/utils'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  fab: {\r\n    margin: theme.spacing(1),\r\n    boxShadow: 'none'\r\n  }\r\n}))\r\n\r\nfunction MobileAvatar (props) {\r\n  const [{ mapZoom }] = useViewStateValue()\r\n  const { location, organisation } = props\r\n\r\n  const status = location.getStatus()\r\n  const size = (mapZoom[0] < 8 ? 'small' : (mapZoom[0] < 12 ? 'medium' : 'large'))\r\n  const border = (mapZoom[0] < 8 ? 2 : (mapZoom[0] < 12 ? 3 : 4))\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip\r\n      title={(status ? status.textFormat : '')}\r\n    >\r\n      <Fab\r\n        size={size}\r\n        className={classes.fab}\r\n        color='primary'\r\n        style={{\r\n          backgroundColor: utilsHelper.hextoRGBA(organisation.colour, 0.8),\r\n          color: 'white',\r\n          border: (border + 'px solid #FFFFFF')\r\n        }}\r\n      >\r\n        <DirectionBusIcon />\r\n      </Fab>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MobileAvatar\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from 'react-mapbox-gl'\r\n\r\nimport LayersIcon from '@material-ui/icons/LayersTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport moment from 'moment'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport MeAvatar from './MeAvatar'\r\nimport MapSettings from './MapSettings'\r\nimport MobileAvatar from './MobileAvatar'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  settings: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4)\r\n  }\r\n}))\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst Map = ReactMapboxGl({\r\n  minZoom: 5,\r\n  maxZoom: 18,\r\n  customAttribution: 'Contains public sector information licensed under the Open Government Licence'\r\n})\r\n\r\nconst stopTiles = [config.stopTiles]\r\nconst tripTiles = [config.tripTiles]\r\nconst libraryAuthorityTiles = [config.libraryAuthorityTiles]\r\n\r\nfunction MobileMap () {\r\n  const [{ organisations, organisationLookup, mobileLookup, mobileLocations }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ mapZoom, mapPosition, mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [currentTime, setCurrentTime] = useState(null)\r\n  const [map, setMap] = useState(null)\r\n\r\n  useEffect(() => {\r\n    setInterval(setTime, 500)\r\n  }, [])\r\n\r\n  const clickStop = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentStop', stopId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const clickTrip = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentTrip', tripId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetTripDialog', tripDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const setTime = () => setCurrentTime(moment())\r\n\r\n  // Build the colour match\r\n  const organisationColourMatch = ['match', ['get', 'utla19cd']]\r\n  organisations.forEach(org => {\r\n    organisationColourMatch.push(org.code)\r\n    organisationColourMatch.push(org.colour)\r\n  })\r\n  organisationColourMatch.push('#a7a39b')\r\n\r\n  const classes = useStyles()\r\n\r\n  const locations = mobileLocations.filter(l => l.geoX !== null && l.geoY !== null)\r\n\r\n  return (\r\n    <>\r\n      <Map\r\n        style='style.json' // eslint-disable-line\r\n        center={mapPosition}\r\n        zoom={mapZoom}\r\n        maxZoom={17}\r\n        pitch={[0]}\r\n        bearing={[0]}\r\n        fitBounds={null}\r\n        containerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n        onStyleLoad={map => setMap(map)}\r\n      >\r\n        {// The mobile library locations\r\n          locations && locations.length > 0\r\n            ? locations.map(l => {\r\n              let locationPoint = [l.geoX, l.geoY]\r\n              if (currentTime && l.routeSection && l.routeSection.coordinates && l.updated) {\r\n                const millisecondsPassed = moment(currentTime).diff(l.updated)\r\n                const index = Math.round(millisecondsPassed / 500)\r\n                const coords = l.routeSection.coordinates\r\n                if (coords.length > index && index > 0) locationPoint = coords[index]\r\n                if (coords.length <= index && index > 0) locationPoint = coords[coords.length - 1]\r\n              }\r\n              const mobile = mobileLookup[l.mobileId]\r\n              const organisation = (mobile ? organisationLookup[mobile.organisationId] : null)\r\n              return (\r\n                <Marker\r\n                  key={'mkr_' + l.id}\r\n                  coordinates={locationPoint}\r\n                  anchor='bottom'\r\n                >\r\n                  <MobileAvatar\r\n                    organisation={organisation}\r\n                    location={l}\r\n                    zoom={map ? map.getZoom() : 0}\r\n                  />\r\n                </Marker>)\r\n            }) : null\r\n        }\r\n        <Source\r\n          id='src_stops'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: stopTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_trips'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: tripTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_library_authorities'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryAuthorityTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_trips_lines'\r\n          type='line'\r\n          sourceId='src_trips'\r\n          sourceLayer='trip'\r\n          minZoom={13}\r\n          layout={{\r\n            'line-join': 'round',\r\n            'line-cap': 'square'\r\n          }}\r\n          paint={{\r\n            'line-color': '#a7a39b',\r\n            'line-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-opacity': 1,\r\n            'line-width': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-dasharray': [\r\n              2,\r\n              0.5\r\n            ]\r\n          }}\r\n          onClick={clickTrip}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_circles'\r\n          type='circle'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={5}\r\n          layout={{}}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 2,\r\n              17, 12\r\n            ],\r\n            'circle-color': ['get', 'organisation_colour'],\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 1,\r\n              17, 4\r\n            ],\r\n            'circle-stroke-color': '#FFFFFF',\r\n            'circle-opacity': 0.7\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_labels'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 12,\r\n              17, 22\r\n            ],\r\n            'text-offset': [0, 2]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_next_visiting'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'next_visiting']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 10,\r\n              17, 16\r\n            ],\r\n            'text-offset': [0, -2.8]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        {mapSettings.authorityBoundary\r\n          ? (\r\n            <>\r\n              <Layer\r\n                id='lyr_library_authorities_lines'\r\n                type='line'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                layout={{\r\n                  'line-join': 'round',\r\n                  'line-cap': 'square'\r\n                }}\r\n                paint={{\r\n                  'line-color': '#a7a39b',\r\n                  'line-opacity': 1,\r\n                  'line-width': [\r\n                    'interpolate',\r\n                    [\r\n                      'linear'\r\n                    ],\r\n                    [\r\n                      'zoom'\r\n                    ],\r\n                    6, 1,\r\n                    22, 4\r\n                  ]\r\n                }}\r\n              />\r\n              <Layer\r\n                id='lyr_library_authorities_fill'\r\n                type='fill'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                paint={{\r\n                  'fill-color': organisationColourMatch,\r\n                  'fill-opacity': 0.1\r\n                }}\r\n              />\r\n            </>\r\n          ) : null}\r\n        {searchPosition && searchPosition.length > 1\r\n          ? (\r\n            <Marker\r\n              key='mk_me'\r\n              coordinates={[searchPosition[0], searchPosition[1]]}\r\n            >\r\n              <MeAvatar searchType={searchType} />\r\n            </Marker>\r\n          )\r\n          : null}\r\n        <ZoomControl position='bottom-left' />\r\n      </Map>\r\n      <Tooltip\r\n        title='Map settings'\r\n      >\r\n        <Fab\r\n          size='small'\r\n          className={classes.settings}\r\n          color='primary'\r\n          style={{\r\n            color: 'white',\r\n            border: '1px solid #FFFFFF'\r\n          }}\r\n          onClick={() => dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: true })}\r\n        >\r\n          <LayersIcon />\r\n        </Fab>\r\n      </Tooltip>\r\n      <MapSettings\r\n        mapSettings={mapSettings}\r\n        mapSettingsDialogOpen={mapSettingsDialogOpen}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MobileMap\r\n","import React from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Snackbar from '@material-ui/core/Snackbar'\r\n\r\nimport CloseIcon from '@material-ui/icons/CloseTwoTone'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nfunction Notification () {\r\n  const [{ notificationOpen, notificationMessage }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const handleClose = () => {\r\n    dispatchView({ type: 'SetNotification', notificationOpen: false })\r\n  }\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left'\r\n      }}\r\n      open={notificationOpen}\r\n      autoHideDuration={3000}\r\n      onClose={handleClose}\r\n      ContentProps={{\r\n        'aria-describedby': 'message-id'\r\n      }}\r\n      message={<span id='message-id'>{notificationMessage}</span>}\r\n      action={[\r\n        <IconButton\r\n          key='close'\r\n          aria-label='close'\r\n          onClick={handleClose}\r\n        >\r\n          <CloseIcon color='inherit' />\r\n        </IconButton>\r\n      ]}\r\n    />\r\n  )\r\n}\r\n\r\nexport default Notification\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Stop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.routeIds = json.route_ids\r\n    this.routeNames = json.route_names\r\n    this.mobileIds = json.mobile_ids\r\n    this.mobileNames = json.mobile_names\r\n    this.organisationId = json.organisation_id\r\n    this.organisationName = json.organisation_name\r\n    this.name = json.name\r\n    this.community = json.community\r\n    this.address = json.address\r\n    this.postcode = json.postcode\r\n    this.arrivalTimes = json.arrival_times\r\n    this.departureTimes = json.departure_times\r\n    this.routeStart = moment(json.route_start)\r\n    this.routeEnd = moment(json.route_end)\r\n    this.routeDays = json.route_days\r\n    this.routeFrequencies = json.route_frequencies\r\n    this.routeSchedule = json.route_schedule.map(s => moment(s))\r\n    this.timetable = json.timetable\r\n    this.longitude = json.longitude\r\n    this.latitude = json.latitude\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getQueryStops (query, organisationFilters, mobileFilters, routeFilters, searchPosition, distance) {\r\n  let url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (mobileFilters.length > 0) url = url + '&mobile_ids=' + mobileFilters.join('|')\r\n  if (organisationFilters.length > 0) url = url + '&organisation_ids=' + organisationFilters.join('|')\r\n  if (routeFilters.length > 0) url = url + '&route_ids=' + routeFilters.join('|')\r\n\r\n  if (searchPosition && searchPosition.length > 1) url = url + '&longitude=' + searchPosition[0] + '&latitude=' + searchPosition[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  const response = await axios.get(url)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return {\r\n      stops: response.data.map(s => (new Stop()).fromJson(s)),\r\n      total: parseInt(response.headers['x-total-count']),\r\n      page: parseInt(response.headers['x-page'])\r\n    }\r\n  } else {\r\n    return { stops: [], total: 0, page: 1 }\r\n  }\r\n}\r\n\r\nexport async function getAllStops () {\r\n  const response = await axios.get(config.api + '/stops')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(s => (new Stop()).fromJson(s))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getStopById (id) {\r\n  const response = await axios.get(config.api + '/stops/' + id)\r\n  if (response && response.data) {\r\n    return (new Stop()).fromJson(response.data)\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport MaterialTable from 'material-table'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpwardTwoTone'\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeftTwoTone'\r\nimport ChevronRight from '@material-ui/icons/ChevronRightTwoTone'\r\nimport FirstPage from '@material-ui/icons/FirstPageTwoTone'\r\nimport FilterList from '@material-ui/icons/FilterListTwoTone'\r\nimport LastPage from '@material-ui/icons/LastPageTwoTone'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone'\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport Filters from './Filters'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 200\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  root: {\r\n    flexGrow: 1,\r\n    maxWidth: '100%'\r\n  },\r\n  table: {\r\n    backgroundColor: 'rgba(0, 0, 0, 0)',\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction Stops () {\r\n  const [{ organisations, organisationLookup, mobiles, mobileLookup, routeLookup }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance, searchPosition, organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const tableRef = React.createRef()\r\n\r\n  const getStopCalendar = (stop) => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = (stop) => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  useEffect(() => {\r\n    tableRef.current.onQueryChange()\r\n  }, [searchPosition, searchDistance, organisationFilter, mobileFilter, routeFilter]) // eslint-disable-line\r\n\r\n  const displayStopInfo = (stop) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stop.id })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const displayMapStop = (longitude, latitude) => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [longitude, latitude], mapZoom: 15 })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  // Calculate title\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n  let title = 'All stops'\r\n  // Filter stops\r\n  if (organisationName !== '') title = 'Stops in ' + organisationName\r\n  if (mobileName !== '') title = 'Stops for ' + organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = 'Stops for ' + organisationName + ' ' + routeName\r\n  // Postcode search stops\r\n  if (searchPostcode !== '') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  // GPS search stops\r\n  if (searchType === 'gps') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const orgText = {}\r\n  Object.keys(organisationLookup).forEach(key => {\r\n    orgText[key] = organisationLookup[key].name\r\n  })\r\n  const mobileText = {}\r\n  Object.keys(mobileLookup).forEach(key => {\r\n    mobileText[key] = mobileLookup[key].name\r\n  })\r\n  const routeText = {}\r\n  Object.keys(routeLookup).forEach(key => {\r\n    routeText[key] = routeLookup[key].name\r\n  })\r\n\r\n  return (\r\n    <div style={{ maxWidth: '100%' }}>\r\n      <Filters />\r\n      <ListSubheader disableSticky>{title}</ListSubheader>\r\n      <MaterialTable\r\n        tableRef={tableRef}\r\n        components={{\r\n          Container: props => <Paper {...props} elevation={0} className={classes.table} />\r\n        }}\r\n        icons={{\r\n          Filter: FilterList,\r\n          FirstPage: FirstPage,\r\n          LastPage: LastPage,\r\n          NextPage: ChevronRight,\r\n          PreviousPage: ChevronLeft,\r\n          SortArrow: ArrowUpward\r\n        }}\r\n        options={{\r\n          padding: useMediaQuery(theme.breakpoints.up('sm')) ? 'default' : 'dense',\r\n          search: false,\r\n          loadingType: 'overlay',\r\n          actionsColumnIndex: 0,\r\n          filtering: false,\r\n          toolbar: false,\r\n          headerStyle: {\r\n            backgroundColor: '#fafafa',\r\n            color: '#737373',\r\n            border: '0px'\r\n          }\r\n        }}\r\n        columns={[\r\n          {\r\n            title: '',\r\n            field: 'name',\r\n            filtering: false,\r\n            render: rowData => {\r\n              return (\r\n                <>\r\n                  <Tooltip title='See more stop details'>\r\n                    <IconButton onClick={() => displayStopInfo(rowData)}>\r\n                      <MoreVertIcon />\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Add event to your device calendar'>\r\n                      <IconButton onClick={() => getStopCalendar(rowData)}>\r\n                        <EventIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Download a PDF timetable for this stop'>\r\n                      <IconButton onClick={() => getStopPdf(rowData)}>\r\n                        <PrintIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='See this stop on the map'>\r\n                      <IconButton onClick={() => displayMapStop(rowData.longitude, rowData.latitude)} component={Link} to='/map'>\r\n                        <LocationOnIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                </>\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Name',\r\n            field: 'name',\r\n            filtering: false,\r\n            hidden: false,\r\n            render: rowData => {\r\n              return (\r\n                rowData.name\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Community',\r\n            field: 'community',\r\n            filtering: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Library service',\r\n            field: 'organisationName',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('sm')),\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Next due',\r\n            field: 'routeSchedule',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('xs')),\r\n            render: (rowData) => {\r\n              return (\r\n                rowData.routeSchedule.length > 0 ? rowData.routeSchedule[0].format('Do MMMM h:mma') : ''\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          }\r\n        ]}\r\n        data={query =>\r\n          new Promise((resolve, reject) => {\r\n            async function getStops () {\r\n              const stopData = await stopsModel.getQueryStops(query, organisationFilter, mobileFilter, routeFilter, searchPosition, searchDistance)\r\n              resolve({\r\n                data: stopData.stops,\r\n                page: (stopData.page - 1),\r\n                totalCount: stopData.total\r\n              })\r\n            }\r\n            getStops()\r\n          })}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Stops\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction StopDetails () {\r\n  const [{ currentStopId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ stopDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [stop, setStop] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getStop (stopId) {\r\n      const stopData = await stopsModel.getStopById(stopId)\r\n      setStop(stopData)\r\n    }\r\n    if (currentStopId != null) getStop(currentStopId)\r\n  }, [currentStopId])\r\n\r\n  const getStopCalendar = () => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = () => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  const goToWebsite = () => window.open(stop.timetable, '_blank')\r\n\r\n  const viewMapStop = () => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [stop.longitude, stop.latitude], mapZoom: 14 })\r\n  }\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={stopDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {stop && stop.routeDays\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>{stop.name + '. ' + stop.community}</DialogTitle>\r\n            <DialogContent>\r\n              <ListSubheader>{(stop.routeSchedule && stop.routeSchedule.length > 0 ? stop.routeSchedule[0].format('dddd Do MMMM h:mma') : '')}</ListSubheader>\r\n              <br />\r\n              <Divider />\r\n              <br />\r\n              <Button onClick={getStopCalendar} className={classes.button} color='primary' startIcon={<EventIcon />}>Calendar</Button>\r\n              <Button onClick={getStopPdf} className={classes.button} color='primary' startIcon={<PrintIcon />}>Timetable</Button>\r\n              <Button onClick={viewMapStop} className={classes.button} color='primary' startIcon={<LocationOnIcon />} component={Link} to='/map'>Map</Button>\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => goToWebsite()} color='primary'>Website</Button>\r\n        <Button onClick={() => close()} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default StopDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Trip {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.originStopId = json.origin_stop_id\r\n    this.originStopName = json.origin_stop_name\r\n    this.destinationStopId = json.destination_stop_id\r\n    this.destinationStopName = json.destination_stop_name\r\n    this.distance = json.distance\r\n    this.duration = json.duration\r\n    this.routeLine = json.route_line\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllTrips () {\r\n  const response = await axios.get(config.api + '/trips')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(t => (new Trip()).fromJson(t))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getTripById (id) {\r\n  const response = await axios.get(config.api + '/trips/' + id)\r\n  if (response && response.data) {\r\n    return (new Trip()).fromJson(response.data)\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as tripsModel from './models/trips'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction TripDetails () {\r\n  const [{ currentTripId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ tripDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [trip, setTrip] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getTrip (tripId) {\r\n      const trip = await tripsModel.getTripById(tripId)\r\n      setTrip(trip)\r\n    }\r\n    if (currentTripId != null) getTrip(currentTripId)\r\n  }, [currentTripId])\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetTripDialog', tripDialogOpen: false })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n  const estimatedDuration = Math.round(trip.duration / 60) + ' mins journey time.'\r\n  const distance = Math.round(trip.distance / 1609, 1) + ' mile(s)'\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={tripDialogOpen}\r\n      onClose={close}\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Trip details</DialogTitle>\r\n      <DialogContent>\r\n        <ListSubheader disableSticky>{'From ' + trip.originStopName + ' to ' + trip.destinationStopName}</ListSubheader>\r\n        <Typography variant='body2' component='p'>{estimatedDuration + ' ' + distance}</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default TripDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Organisation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.country = json.country\r\n    this.code = json.code\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.website = json.website\r\n    this.email = json.email\r\n    this.colour = json.colour\r\n    this.logo = json.logo\r\n    this.numberMobiles = json.number_mobiles\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllOrganisations () {\r\n  const response = await axios.get(config.api + '/organisations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(o => (new Organisation()).fromJson(o))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Route {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.mobileId = json.mobile_id\r\n    this.name = json.name\r\n    this.frequency = json.frequency\r\n    this.start = moment(json.start)\r\n    this.end = moment(json.end)\r\n    this.timetable = json.timetable\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllRoutes () {\r\n  const response = await axios.get(config.api + '/routes')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(r => (new Route()).fromJson(r))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { BrowserRouter, Route } from 'react-router-dom'\r\n\r\nimport Container from '@material-ui/core/Container'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport AppHeader from './AppHeader'\r\nimport Footer from './Footer'\r\nimport { MemoMarkdownPage } from './MarkdownPage'\r\nimport Mobiles from './Mobiles'\r\nimport MobileMap from './MobileMap'\r\nimport Notification from './Notification'\r\nimport Stops from './Stops'\r\nimport StopDetails from './StopDetails'\r\nimport TripDetails from './TripDetails'\r\n\r\nimport Accessibility from './pages/accessibility.md'\r\nimport Data from './pages/data.md'\r\nimport Privacy from './pages/privacy.md'\r\n\r\nimport * as mobilesModel from './models/mobiles'\r\nimport * as organisationsModel from './models/organisations'\r\nimport * as routesModel from './models/routes'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction MobilesApplication () {\r\n  const [{ loadingOrganisations, loadingMobiles, loadingRoutes, loadingMobileLocations, loadingNearestMobiles, loadingPostcode }] = useViewStateValue()\r\n  const [{ }, dispatchApplicationState] = useApplicationStateValue() //eslint-disable-line\r\n\r\n  useEffect(() => {\r\n    async function getOrganisations () {\r\n      const organisations = await organisationsModel.getAllOrganisations()\r\n      const organisationLookup = {}\r\n      organisations.forEach(organisation => { organisationLookup[organisation.id] = organisation })\r\n      dispatchApplicationState({ type: 'AddOrganisations', organisations: organisations, organisationLookup: organisationLookup })\r\n    }\r\n    async function getMobiles () {\r\n      const mobiles = await mobilesModel.getAllMobiles()\r\n      const mobileLookup = {}\r\n      mobiles.forEach(mobile => { mobileLookup[mobile.id] = mobile })\r\n      dispatchApplicationState({ type: 'AddMobiles', mobiles: mobiles, mobileLookup: mobileLookup })\r\n    }\r\n    async function getRoutes () {\r\n      const routes = await routesModel.getAllRoutes()\r\n      const routeLookup = {}\r\n      routes.forEach(route => { routeLookup[route.id] = route })\r\n      dispatchApplicationState({ type: 'AddRoutes', routes: routes, routeLookup: routeLookup })\r\n    }\r\n    async function getMobileLocations () {\r\n      const locations = await mobilesModel.getMobileLocations()\r\n      const mobileLocationLookup = {}\r\n      locations.forEach(location => { mobileLocationLookup[location.mobileId] = location })\r\n      dispatchApplicationState({ type: 'AddMobileLocations', mobileLocations: locations, mobileLocationLookup: mobileLocationLookup })\r\n    }\r\n    getOrganisations()\r\n    getMobiles()\r\n    getRoutes()\r\n    getMobileLocations()\r\n\r\n    setInterval(() => {\r\n      getMobileLocations(false)\r\n    }, 15000)\r\n  }, []) //eslint-disable-line\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <div className={classes.root}>\r\n        <AppHeader\r\n          loading={loadingOrganisations || loadingMobiles || loadingRoutes || loadingMobileLocations || loadingNearestMobiles || loadingPostcode}\r\n          site={2}\r\n        />\r\n        <Container maxWidth='lg'>\r\n          <main className={classes.content}>\r\n            <Route path='/' exact render={() => <Stops />} />\r\n            <Route path='/mobiles' render={() => <Mobiles />} />\r\n            <Route path='/map' render={() => <MobileMap />} />\r\n            <Route path='/accessibility' exact render={() => <MemoMarkdownPage page={Accessibility} />} />\r\n            <Route path='/data' exact render={() => <MemoMarkdownPage page={Data} />} />\r\n            <Route path='/privacy' exact render={() => <MemoMarkdownPage page={Privacy} />} />\r\n            <Route path={['/http:', '/https:']} component={props => { window.location.replace(props.location.pathname.substr(1)); return null }} />\r\n          </main>\r\n        </Container>\r\n        <Container maxWidth='lg'>\r\n          <Footer />\r\n        </Container>\r\n        <StopDetails />\r\n        <TripDetails />\r\n        <Notification />\r\n      </div>\r\n    </BrowserRouter>\r\n  )\r\n}\r\n\r\nexport default MobilesApplication\r\n","import React from 'react'\r\n\r\nimport CssBaseline from '@material-ui/core/CssBaseline'\r\n\r\nimport blueGrey from '@material-ui/core/colors/blueGrey'\r\nimport red from '@material-ui/core/colors/red'\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\r\n\r\nimport { ApplicationStateProvider } from './context/applicationState'\r\nimport { SearchStateProvider } from './context/searchState'\r\nimport { ViewStateProvider } from './context/viewState'\r\n\r\nimport MobilesApplication from './MobilesApplication'\r\n\r\nconst initialApplicationState = {\r\n  organisations: [],\r\n  organisationLookup: {},\r\n  mobiles: [],\r\n  mobileLookup: {},\r\n  mobileLocations: [],\r\n  mobileLocationLookup: {},\r\n  mobilesNearest: [],\r\n  mobilesNearestLookup: {},\r\n  routes: [],\r\n  routeLookup: {},\r\n  stops: [],\r\n  trips: []\r\n}\r\n\r\nconst applicationReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'AddOrganisations':\r\n      return {\r\n        ...state,\r\n        organisations: action.organisations,\r\n        organisationLookup: action.organisationLookup\r\n      }\r\n    case 'AddMobileLocations':\r\n      return {\r\n        ...state,\r\n        mobileLocations: action.mobileLocations,\r\n        mobileLocationLookup: action.mobileLocationLookup\r\n      }\r\n    case 'AddRoutes':\r\n      return {\r\n        ...state,\r\n        routes: action.routes,\r\n        routeLookup: action.routeLookup\r\n      }\r\n    case 'AddMobiles':\r\n      return {\r\n        ...state,\r\n        mobiles: action.mobiles,\r\n        mobileLookup: action.mobileLookup\r\n      }\r\n    case 'UpdateMobilesNearest':\r\n      return {\r\n        ...state,\r\n        mobilesNearest: action.mobilesNearest,\r\n        mobilesNearestLookup: action.mobilesNearestLookup\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialSearchState = {\r\n  searchPostcode: '',\r\n  searchType: '',\r\n  searchDistance: 1609,\r\n  searchPosition: [],\r\n  searchPositionUpdateInterval: null,\r\n  organisationFilter: [],\r\n  mobileFilter: [],\r\n  routeFilter: [],\r\n  currentStopId: null,\r\n  currentTripId: null\r\n}\r\n\r\nconst searchReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetCurrentStop':\r\n      return {\r\n        ...state,\r\n        currentStopId: action.stopId\r\n      }\r\n    case 'SetCurrentTrip':\r\n      return {\r\n        ...state,\r\n        currentTripId: action.tripId\r\n      }\r\n    case 'SetSearchDistance':\r\n      return {\r\n        ...state,\r\n        searchDistance: action.searchDistance\r\n      }\r\n    case 'SetPostcodeSearch':\r\n      return {\r\n        ...state,\r\n        searchPostcode: action.searchPostcode,\r\n        searchPosition: action.searchPosition,\r\n        searchType: 'postcode',\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: []\r\n      }\r\n    case 'FilterByOrganisation':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByMobile':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [action.mobileId],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByRoute':\r\n      return {\r\n        ...state,\r\n        routeFilter: [action.routeId],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearAll':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearMobileFilter':\r\n      return {\r\n        ...state,\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearRouteFilter':\r\n      return {\r\n        ...state,\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialViewState = {\r\n  stopDialogOpen: false,\r\n  tripDialogOpen: false,\r\n  notificationOpen: false,\r\n  notificationMessage: '',\r\n  mapZoom: [7],\r\n  mapPosition: [-1.155414, 52.691432],\r\n  mapSettings: {\r\n    authorityBoundary: false\r\n  },\r\n  mapSettingsDialogOpen: false,\r\n  loadingOrganisations: false,\r\n  loadingMobiles: false,\r\n  loadingRoutes: false,\r\n  loadingMobileLocations: false,\r\n  loadingNearestMobiles: false,\r\n  loadingPostcode: false\r\n}\r\n\r\nconst viewReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetNotificationMessage':\r\n      return { ...state, notificationMessage: action.notificationMessage }\r\n    case 'SetNotification':\r\n      return { ...state, notificationOpen: action.notificationOpen }\r\n    case 'ShowNotification':\r\n      return { ...state, notificationOpen: true, notificationMessage: action.notificationMessage }\r\n    case 'SetStopDialog':\r\n      return { ...state, stopDialogOpen: action.stopDialogOpen }\r\n    case 'SetTripDialog':\r\n      return { ...state, tripDialogOpen: action.tripDialogOpen }\r\n    case 'SetMapSettingsDialog':\r\n      return { ...state, mapSettingsDialogOpen: action.mapSettingsDialogOpen }\r\n    case 'ToggleMapSetting': {\r\n      const settings = state.mapSettings\r\n      settings[action.mapSetting] = !settings[action.mapSetting]\r\n      return { ...state, mapSettings: settings }\r\n    }\r\n    case 'SetPostcodeSearch':\r\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [13] }\r\n    case 'ToggleLoadingPostcode':\r\n      return { ...state, loadingPostcode: !state.loadingPostcode }\r\n    case 'SetMapPosition':\r\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [action.mapZoom] }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: red[900]\r\n    },\r\n    secondary: {\r\n      main: blueGrey[700]\r\n    }\r\n  },\r\n  overrides: {\r\n    MuiButton: {\r\n      text: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTab: {\r\n      root: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTypography: {\r\n      button: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTableCell: {\r\n      root: {\r\n        borderBottom: 'none'\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nfunction App () {\r\n  return (\r\n    <ApplicationStateProvider initialState={initialApplicationState} reducer={applicationReducer}>\r\n      <SearchStateProvider initialState={initialSearchState} reducer={searchReducer}>\r\n        <ViewStateProvider initialState={initialViewState} reducer={viewReducer}>\r\n          <ThemeProvider theme={theme}>\r\n            <CssBaseline />\r\n            <MobilesApplication />\r\n          </ThemeProvider>\r\n        </ViewStateProvider>\r\n      </SearchStateProvider>\r\n    </ApplicationStateProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n)\r\n\r\nexport function register (config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config)\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          )\r\n        })\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction registerValidSW (swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing\r\n        if (installingWorker == null) {\r\n          return\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              )\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration)\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.')\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error)\r\n    })\r\n}\r\n\r\nfunction checkValidServiceWorker (swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  window.fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type')\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload()\r\n          })\r\n        })\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      )\r\n    })\r\n}\r\n\r\nexport function unregister () {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister()\r\n    })\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11'\r\nimport 'react-app-polyfill/stable'\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './App'\r\n\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}