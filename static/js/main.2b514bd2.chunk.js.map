{"version":3,"sources":["PostcodeSearch.js","AppHeader.js","Filters.js","helpers/mobiles.js","MobileCard.js","Mobiles.js","MeAvatar.js","MapSettings.js","helpers/utils.js","MobileAvatar.js","MobileMap.js","helpers/stops.js","Stops.js","StopDetails.js","TripDetails.js","helpers/geo.js","helpers/organisations.js","helpers/routes.js","helpers/trips.js","App.js","serviceWorker.js","index.js"],"names":["PostcodeSearch","state","postcode","props","anchor","openSettingsMenu","e","setState","currentTarget","closeSettingsMenu","setSearchDistance","distance","setDistance","prevProps","this","classes","search_type","postcodeSearch","clearSearch","toggleGPS","className","search","InputBase","placeholder","root","inputRoot","input","inputInput","value","onChange","target","grow","Tooltip","title","IconButton","color","iconButton","onClick","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","React","Component","withStyles","theme","flexGrow","padding","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","marginRight","display","maxWidth","AppHeader","loading","searchType","location","Typography","variant","component","AppBar","pathname","elevation","appBarTransparent","appBar","Toolbar","Hidden","smDown","Button","Link","to","size","leftIcon","mdUp","CircularProgress","progress","compose","withRouter","zIndex","drawer","hide","margin","withTheme","Filters","organisation_menu_anchor","mobile_menu_anchor","route_menu_anchor","openOrganisationMenu","element","closeOrganisationMenu","chooseOrganisation","organisation_id","setOrganisationFilter","openMobileMenu","closeMobileMenu","chooseMobile","mobile_id","setMobileFilter","openRouteMenu","closeRouteMenu","chooseRoute","route_id","setRouteFilter","organisations","organisation_lookup","organisation_filter","clearOrganisationFilter","mobiles","mobile_lookup","mobile_filter","clearMobileFilter","routes","route_lookup","route_filter","clearRouteFilter","postcode_district","bull","bullet","countries","Set","map","org","country","Grid","grid","container","item","xs","sm","md","lg","xl","Alert","severity","AlertTitle","Card","card","CardContent","gutterBottom","Math","round","length","CardActions","button","Chip","onDelete","label","name","Array","from","sort","a","b","localeCompare","menu_items","org_list","filter","key","concat","mob","indexOf","route","transform","minWidth","marginBottom","fontSize","fontWeight","config","require","getAllMobiles","callback","axios","get","api","then","response","data","catch","err","getMobileLocations","getMobilesNearest","getMobileStatus","statuses","current_stop_id","previous_stop_id","next_stop_id","moment","next_stop_arrival","isSame","type","text_format","message","arrival","fromNow","next_stop_name","args","stop_name","stop_id","stop_remaining","current_stop_departure","current_stop_name","previous_stop_departure","MobileCard","stopButton","stop","viewStop","offRoadMessage","status","preRouteMessage","stop_button","Fragment","atStopMessage","betweenStopsMessage","postRouteMessage","goToWebsite","window","mobile","timetable","organisation","mobilesHelper","number_routes","number_stops","viewStopsByMobile","Divider","verticalDivider","align","width","height","Mobiles","open_tab","changeTab","viewStopsByOrganisation","mobile_location_lookup","mobiles_nearest_lookup","filtered_mobiles","active_mobiles","display_mobiles","organisation_name","mobile_name","route_name","displayStopLink","Tabs","scrollButtons","indicatorColor","textColor","Tab","tab","Badge","badgeContent","showZero","idx","replace","LinearProgress","chip","MeAvatar","Avatar","avatarOn","avatar","cursor","primary","main","MapSettings","handleAuthorityBoundaryChange","toggleMapSetting","close","map_settings","fullScreen","isWidthDown","Dialog","disableBackdropClick","BackdropProps","invisible","PaperProps","dialog","DialogTitle","DialogContent","FormControlLabel","control","Switch","checked","authority_boundary","DialogActions","withWidth","hextoRGBA","hex","alpha","c","test","substring","split","join","Error","MobileAvatar","zoom","Fab","fab","style","utilsHelper","colour","boxShadow","Map","ReactMapboxGl","minZoom","maxZoom","customAttribution","stop_tiles","trip_tiles","library_authority_tiles","MobileMap","time_update_interval","current_time","settings_dial_open","settings_dialog_open","componentDidMount","setInterval","setCurrentTime","clickStop","features","properties","clickTrip","viewTrip","pitch","bearing","fit_bounds","mobile_locations","organisation_colour_match","forEach","push","code","center","fitBounds","containerStyle","top","bottom","right","left","onStyleLoad","l","location_point","geox","geoy","route_section","coordinates","updated","milliseconds_passed","diff","index","coords","getZoom","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","current_position","SpeedDial","ariaLabel","FabProps","settingsDial","icon","onOpen","direction","SpeedDialAction","tooltipTitle","getStopById","Stops","tableRef","createRef","getStopCalendar","getStopPdf","viewMapStop","longitude","latitude","current","onQueryChange","displayStopInfo","row","orgText","Object","keys","mobileText","routeText","components","Container","Paper","table","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","options","isWidthUp","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","field","render","rowData","mdDown","cellStyle","borderBottom","hidden","route_schedule","format","query","Promise","resolve","reject","organisation_filters","mobile_filters","route_filters","url","page","pageSize","orderBy","orderDirection","stops","total","parseInt","headers","stopsHelper","stopData","totalCount","formControl","StopDetails","aria-labelledby","route_days","community","startIcon","list","background","paper","TripDetails","trip","estimated_duration","duration","origin_stop_name","destination_stop_name","getCurrentPosition","navigator","geolocation","pos","enableHighAccuracy","timeout","maximumAge","getPostcode","result","admin_district","getAllOrganisations","getAllRoutes","getTripById","createMuiTheme","lightBlue","secondary","blueGrey","overrides","MuiButton","text","textTransform","MuiTab","MuiTableCell","App","stop_dialog_open","current_stop","trip_dialog_open","current_trip","mobiles_nearest","mobile_location_timer","position_update_interval","loading_gps","loading_mobiles","loading_organisations","loading_postcode","loading_routes","snackbar_open","snackbar_message","getOrganisations","organisationsHelper","getMobiles","getRoutes","routesHelper","locations","openStopDialog","closeStopDialog","openTripDialog","tripsHelper","closeTripDialog","viewStopsByRoute","logPosition","geoHelper","clearInterval","new_state","postcode_data","setting","current_setting","closeSnackbar","event","reason","CssBaseline","content","path","exact","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","action","aria-label","hostname","match","ReactDOM","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"g/BAoDMA,G,4MACLC,MAAQ,CACPC,SAAU,EAAKC,MAAMD,SACrBE,OAAQ,M,EAOTC,iBAAmB,SAACC,GAAD,OAAO,EAAKC,SAAS,CAAEH,OAAQE,EAAEE,iB,EACpDC,kBAAoB,kBAAM,EAAKF,SAAS,CAAEH,OAAQ,Q,EAElDM,kBAAoB,SAACC,GACpB,EAAKF,oBACL,EAAKN,MAAMS,YAAYD,I,iEATLE,GACdC,KAAKX,MAAMD,WAAaW,EAAUX,UAAUY,KAAKP,SAAS,CAAEL,SAAUY,KAAKX,MAAMD,a,+BAW5E,IAAD,SACiEY,KAAKX,MAAtEY,EADA,EACAA,QAASC,EADT,EACSA,YAAaC,EADtB,EACsBA,eAAgBC,EADtC,EACsCA,YAAaC,EADnD,EACmDA,UAC3D,OACC,yBAAKC,UAAWL,EAAQM,QACvB,kBAACC,EAAA,EAAD,CACCC,YAAY,WACZR,QAAS,CACRS,KAAMT,EAAQU,UACdC,MAAOX,EAAQY,YAEhBC,MAAOd,KAAKb,MAAMC,SAClB2B,SAAU,SAACvB,GAAD,OAAO,EAAKC,SAAS,CAAEL,SAAUI,EAAEwB,OAAOF,WAErD,yBAAKR,UAAWL,EAAQgB,OACP,aAAhBf,EACA,kBAACgB,EAAA,EAAD,CAASC,MAAO,gBACf,kBAACC,EAAA,EAAD,CACCC,MAAM,YACNf,UAAWL,EAAQqB,WACnBC,QAAS,kBAAMnB,MACf,kBAAC,IAAD,QAGA,KACH,kBAACc,EAAA,EAAD,CAASC,MAAO,sBACf,kBAACC,EAAA,EAAD,CACCC,MAAM,UACNf,UAAWL,EAAQqB,WACnBC,QAAS,kBAAMpB,EAAe,EAAKhB,MAAMC,YACzC,kBAAC,IAAD,QAGF,kBAAC8B,EAAA,EAAD,CAASC,MAAO,qBACf,kBAACC,EAAA,EAAD,CACCd,UAAWL,EAAQqB,WACnBD,MAAuB,QAAhBnB,EAAwB,UAAY,YAC3CqB,QAAS,WAAQlB,MAEA,QAAhBH,EAAwB,kBAAC,IAAD,MAAqB,kBAAC,IAAD,QAGhD,kBAACgB,EAAA,EAAD,CAASC,MAAO,0BACf,kBAACC,EAAA,EAAD,CACCd,UAAWL,EAAQqB,WACnBD,MAAM,YACNE,QAAS,SAAC/B,GAAQ,EAAKD,iBAAiBC,KAExC,kBAAC,KAAD,QAGF,kBAACgC,EAAA,EAAD,CACCC,GAAG,eACHC,SAAU1B,KAAKb,MAAMG,OACrBqC,aAAW,EACXC,KAAMC,QAAQ7B,KAAKb,MAAMG,QACzBwC,QAAS,kBAAM,EAAKnC,sBAEpB,kBAACoC,EAAA,EAAD,CAAeC,eAAe,GAA9B,mBACA,kBAACC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,QAAhD,UACA,kBAACqC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,QAAhD,WACA,kBAACqC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,QAAhD,WACA,kBAACqC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,SAAhD,YACA,kBAACqC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,SAAhD,YACA,kBAACqC,EAAA,EAAD,CAAUV,QAAS,kBAAM,EAAK3B,kBAAkB,SAAhD,kB,GAjFwBsC,IAAMC,WA4FpBC,gBA3HA,SAAAC,GAAK,MAAK,CACxBpB,KAAM,CACLqB,SAAU,GAEXhB,WAAY,CACXiB,QAAS,IAEV5B,UAAW,CACVU,MAAO,WAERR,WAAY,CACX2B,WAAYH,EAAMI,UAClBC,aAAcL,EAAMI,UACpBE,cAAeN,EAAMI,UACrBG,YAAaP,EAAMI,QAAQ,IAE5BlC,OAAQ,CACPsC,SAAU,WACVC,OAAQ,oBACRC,aAAcV,EAAMW,MAAMD,aAC1BE,gBAAiBC,eAAKb,EAAMc,QAAQC,OAAOC,MAAO,IAClD,UAAW,CACVJ,gBAAiBC,eAAKb,EAAMc,QAAQC,OAAOC,MAAO,KAEnDC,WAAY,EACZC,YAAalB,EAAMI,UACnBe,QAAS,OACTC,SAAU,QAgGGrB,CAAmBlD,IC1F5BwE,G,uKACO,IAAD,EACoH1D,KAAKX,MAAzHsE,EADA,EACAA,QAAS1D,EADT,EACSA,QAAS2D,EADlB,EACkBA,WAAYxE,EAD9B,EAC8BA,SAAUS,EADxC,EACwCA,SAAUQ,EADlD,EACkDA,UAAWF,EAD7D,EAC6DA,eAAgBC,EAD7E,EAC6EA,YAAaN,EAD1F,EAC0FA,YAAa+D,EADvG,EACuGA,SAC/G,OACE,oCACE,kBAAC,IAAD,CAAWJ,SAAS,MAClB,kBAACK,EAAA,EAAD,CAAYzC,MAAM,gBAAgB0C,QAAQ,KAAKC,UAAU,KAAK1D,UAAWL,EAAQkB,OAAjF,qBAEF,kBAAC8C,EAAA,EAAD,CACEpB,SAAiC,SAAtBgB,EAASK,SAAsB,QAAU,SACpD7C,MAAM,UACN8C,UAAW,EACX7D,UAAkC,SAAtBuD,EAASK,SAAsBjE,EAAQmE,kBAAoBnE,EAAQoE,QAE/E,kBAAC,IAAD,CAAWZ,SAAS,MAClB,kBAACa,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAAQC,QAAM,GACZ,oCACE,kBAACC,EAAA,EAAD,CACET,UAAWU,IAAMC,GAAG,IAAItD,MAA8B,MAAtBwC,EAASK,SAAmB,UAAY,YAAcU,KAAK,QAC3FrD,QAAS,cAET,kBAAC,IAAD,CAAkBjB,UAAWL,EAAQ4E,WAJvC,eAMA,kBAACJ,EAAA,EAAD,CACET,UAAWU,IAAMC,GAAG,SAAStD,MAA8B,WAAtBwC,EAASK,SAAwB,UAAY,YAAcU,KAAK,QACrGrD,QAAS,cAET,kBAAC,IAAD,CAAgBjB,UAAWL,EAAQ4E,WAJrC,kBAMA,kBAACJ,EAAA,EAAD,CACET,UAAWU,IAAMC,GAAG,OAAOtD,MAA8B,SAAtBwC,EAASK,SAAsB,UAAY,YAAcU,KAAK,QACjGrD,QAAS,cAET,kBAAC,IAAD,CAASjB,UAAWL,EAAQ4E,WAJ9B,SAQJ,kBAACN,EAAA,EAAD,CAAQO,MAAI,GACV,oCACE,kBAAC1D,EAAA,EAAD,CAAY4C,UAAWU,IAAMC,GAAG,IAAIpD,QAAS,cAC3C,kBAAC,IAAD,OAEF,kBAACH,EAAA,EAAD,CAAY4C,UAAWU,IAAMC,GAAG,SAASpD,QAAS,cAChD,kBAAC,IAAD,OAEF,kBAACH,EAAA,EAAD,CAAY4C,UAAWU,IAAMC,GAAG,OAAOpD,QAAS,cAC9C,kBAAC,IAAD,SAIiB,SAAtBsC,EAASK,SACN,kBAAC,GAAD,CACA9E,SAAUA,EACVS,SAAUA,EACV+D,WAAYA,EACZvD,UAAWA,EACXP,YAAaA,EACbK,eAAgBA,EAChBC,YAAaA,IACV,KACNuD,EAAU,kBAACoB,EAAA,EAAD,CAAkBzE,UAAWL,EAAQ+E,SAAU3D,MAAM,YAAYuD,KAAM,KAAS,a,GA7DjFzC,aA0ET8C,OAAQC,IAAY9C,aAnGpB,SAAAC,GAAK,MAAK,CACvBgC,OAAQ,CACNc,OAAQ9C,EAAM8C,OAAOC,OAAS,GAEhChB,kBAAmB,CACjBe,OAAQ9C,EAAM8C,OAAOC,OAAS,EAC9BnC,gBAAiB,4BAEnBhC,KAAM,CACJqB,SAAU,GAEZ+C,KAAM,CACJ7B,QAAS,QAEXqB,SAAU,CACRtB,YAAalB,EAAMI,QAAQ,IAE7BuC,SAAU,CACRM,OAAQjD,EAAMI,QAAQ,IAExBtB,MAAO,CACLmE,OAAQjD,EAAMI,QAAQ,OA8E4B,CAAE8C,WAAW,IAApDN,CAA6DvB,I,wJC3EtE8B,G,4MAELrG,MAAQ,CACPsG,yBAA0B,KAC1BC,mBAAoB,KACpBC,kBAAmB,M,EAGpBC,qBAAuB,SAACC,GACvB,EAAKpG,SAAS,CAAEgG,yBAA0BI,K,EAG3CC,sBAAwB,WACvB,EAAKrG,SAAS,CAAEgG,yBAA0B,Q,EAG3CM,mBAAqB,SAACC,GACrB,EAAK3G,MAAMe,cACX,EAAKf,MAAM4G,sBAAsBD,GACjC,EAAKF,yB,EAGNI,eAAiB,SAACL,GACjB,EAAKpG,SAAS,CAAEiG,mBAAoBG,K,EAGrCM,gBAAkB,WACjB,EAAK1G,SAAS,CAAEiG,mBAAoB,Q,EAGrCU,aAAe,SAACC,GACf,EAAKhH,MAAMiH,gBAAgBD,GAC3B,EAAKF,mB,EAGNI,cAAgB,SAACV,GAChB,EAAKpG,SAAS,CAAEkG,kBAAmBE,K,EAGpCW,eAAiB,WAChB,EAAK/G,SAAS,CAAEkG,kBAAmB,Q,EAGpCc,YAAc,SAACC,GACd,EAAKrH,MAAMsH,eAAeD,GAC1B,EAAKF,kB,uDAGI,IAAD,SAMJxG,KAAKX,MAJRY,EAFO,EAEPA,QAAS2G,EAFF,EAEEA,cAAeC,EAFjB,EAEiBA,oBAAqBC,EAFtC,EAEsCA,oBAC7CC,EAHO,EAGPA,wBAAyBC,EAHlB,EAGkBA,QAASC,EAH3B,EAG2BA,cAAeC,EAH1C,EAG0CA,cAAeC,EAHzD,EAGyDA,kBAChEC,EAJO,EAIPA,OAAQC,EAJD,EAICA,aAAcC,EAJf,EAIeA,aAAcC,EAJ7B,EAI6BA,iBACpCrH,EALO,EAKPA,YAAad,EALN,EAKMA,SAAUoI,EALhB,EAKgBA,kBAAmB3H,EALnC,EAKmCA,SAAUQ,EAL7C,EAK6CA,UAAWF,EALxD,EAKwDA,eAAgBC,EALxE,EAKwEA,YAAaN,EALrF,EAKqFA,YAEvF2H,EAAO,0BAAMnH,UAAWL,EAAQyH,QAAzB,UACPC,EAAY,IAAIC,IAAIhB,EAAciB,KAAI,SAAAC,GAAG,OAAIA,EAAIC,YAEvD,OACC,kBAACC,GAAA,EAAD,CAAM1H,UAAWL,EAAQgI,KAAMC,WAAS,EAACzF,QAAS,GACjD,kBAACuF,GAAA,EAAD,CAAMG,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAC5C,kBAACC,GAAA,EAAD,CAAOC,SAAS,WACf,kBAACC,GAAA,EAAD,yBADD,yEAKA,kBAACX,GAAA,EAAD,CAAMG,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAC3C,kBAACI,GAAA,EAAD,CAAMtI,UAAWL,EAAQ4I,KAAM1E,UAAW,GACzC,kBAAC2E,GAAA,EAAD,KACC,kBAAChF,EAAA,EAAD,CAAYxD,UAAWL,EAAQkB,MAAOE,MAAM,gBAAgB0H,cAAY,GACtE,kBAAoBC,KAAKC,MAAMpJ,EAAW,MAAQ,QAClD4H,EACA,iBAAmC,QAAhBvH,EAAwB,KAAO,QAEpD,kBAAC4D,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAU,KAAK+E,cAAY,GAApD,sBACA,kBAAC,GAAD,CACC3J,SAAUA,EACVS,SAAUA,EACVK,YAAaA,EACbG,UAAWA,EACXP,YAAaA,EACbK,eAAgBA,EAChBC,YAAaA,IAES,KAAtBoH,EACA,kBAAC1D,EAAA,EAAD,CAAYC,QAAQ,UAAUP,QAAQ,SAAS,oBAAsBgE,EAAoB,KACvF,QAIN,kBAACQ,GAAA,EAAD,CAAMG,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GAC3C,kBAACI,GAAA,EAAD,CAAMtI,UAAWL,EAAQ4I,KAAM1E,UAAW,GACzC,kBAAC2E,GAAA,EAAD,KACC,kBAAChF,EAAA,EAAD,CAAYxD,UAAWL,EAAQkB,MAAOE,MAAM,gBAAgB0H,cAAY,GACtEnC,EAAcsC,OAAS,oBACvBzB,EACAT,EAAQkC,OAAS,oBACjBzB,EACAL,EAAO8B,OAAS,WAElB,kBAACpF,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAU,MAAnC,sBAED,kBAACmF,GAAA,EAAD,KACiC,IAA/BrC,EAAoBoC,OAAe,kBAAChI,EAAA,EAAD,CAASC,MAAM,0BAClD,kBAACsD,EAAA,EAAD,CAAQG,KAAK,QAAQvD,MAAM,UAAUf,UAAWL,EAAQmJ,OAAQ7H,QAAS,SAAC/B,GAAD,OAAO,EAAKoG,qBAAqBpG,EAAEE,iBAC3G,kBAAC,KAAD,CAAcY,UAAWL,EAAQ4E,WADlC,YAIA,kBAACwE,GAAA,EAAD,CAAMzE,KAAK,QAAQvD,MAAM,YAAYiI,SAAUvC,EAAyBwC,MAAO1C,EAAoBC,EAAoB,IAAI0C,OAE3H1C,EAAoBoC,OAAS,EACH,IAAzBhC,EAAcgC,OACd,kBAAChI,EAAA,EAAD,CAASC,MAAM,yBACd,kBAACsD,EAAA,EAAD,CAAQG,KAAK,QAAQvD,MAAM,UAAUf,UAAWL,EAAQmJ,OAAQ7H,QAAS,SAAC/B,GAAD,OAAO,EAAK0G,eAAe1G,EAAEE,iBACrG,kBAAC,IAAD,CAAkBY,UAAWL,EAAQ4E,WADtC,WAID,kBAACwE,GAAA,EAAD,CAAMzE,KAAK,QAAQvD,MAAM,YAAYiI,SAAU,SAAC9J,GAAD,OAAO2H,KAAqBoC,MAAOtC,EAAcC,EAAc,IAAIsC,OAEjH,KACFtC,EAAcgC,OAAS,EACE,IAAxB5B,EAAa4B,OACb,kBAAChI,EAAA,EAAD,CAASC,MAAM,gBACd,kBAACsD,EAAA,EAAD,CAAQG,KAAK,QAAQvD,MAAM,UAAUf,UAAWL,EAAQmJ,OAAQ7H,QAAS,SAAC/B,GAAD,OAAO,EAAK+G,cAAc/G,EAAEE,iBACpG,kBAAC,KAAD,CAAgBY,UAAWL,EAAQ4E,WADpC,UAID,kBAACwE,GAAA,EAAD,CAAMzE,KAAK,QAAQvD,MAAM,YAAYiI,SAAU,SAAC9J,GAAD,OAAO+H,KAAoBgC,MAAOlC,EAAaC,EAAa,IAAIkC,OAE9G,QAIN,kBAAChI,EAAA,EAAD,CACCC,GAAG,uBACHC,SAAU1B,KAAKb,MAAMsG,yBACrB9D,aAAW,EACXC,KAAMC,QAAQ7B,KAAKb,MAAMsG,0BACzB3D,QAAS,kBAAM,EAAKgE,0BAInB2D,MAAMC,KAAK/B,GACTgC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEE,cAAcD,MAC/BhC,KAAI,SAAAE,GACJ,IAAIgC,EAAa,CAAC,kBAAChI,EAAA,EAAD,CAAeC,eAAe,GAAO+F,IACjDiC,EAAWpD,EACf+C,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEJ,KAAKM,cAAcD,EAAEL,SACtCS,QAAO,SAAAnC,GAAG,OAAIA,EAAIC,UAAYA,KAC9BF,KAAI,SAAAC,GACJ,OAAO,kBAAC7F,EAAA,EAAD,CAAUiI,IAAK,eAAiBpC,EAAIrG,GAAIF,QAAS,kBAAM,EAAKwE,mBAAmB+B,EAAIrG,MAAMqG,EAAI0B,SAEtG,OAAOO,EAAWI,OAAOH,OAI7B,kBAACxI,EAAA,EAAD,CACCC,GAAG,sBACHC,SAAU1B,KAAKb,MAAMuG,mBACrB/D,aAAW,EACXC,KAAMC,QAAQ7B,KAAKb,MAAMuG,oBACzB5D,QAAS,kBAAM,EAAKqE,oBAEnBa,EACCiD,QAAO,SAAAG,GACP,IAAI5G,GAAU,EAKd,OAJIsD,EAAoBoC,OAAS,IACsB,IAAtDpC,EAAoBuD,QAAQD,EAAIpE,mBAChCxC,GAAU,GAEJA,KAEPmG,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEJ,KAAKM,cAAcD,EAAEL,SACtC3B,KAAI,SAAAuC,GACJ,OAAO,kBAACnI,EAAA,EAAD,CAAUiI,IAAK,eAAiBE,EAAI3I,GAAIF,QAAS,kBAAM,EAAK6E,aAAagE,EAAI3I,MAAM2I,EAAIZ,UAGjG,kBAAChI,EAAA,EAAD,CACCC,GAAG,aACHC,SAAU1B,KAAKb,MAAMwG,kBACrBhE,aAAW,EACXC,KAAMC,QAAQ7B,KAAKb,MAAMwG,mBACzB7D,QAAS,kBAAM,EAAK0E,mBAEnBY,EACC6C,QAAO,SAAAK,GACP,IAAI9G,GAAU,EAKd,OAJI0D,EAAcgC,OAAS,IACkB,IAA5ChC,EAAcmD,QAAQC,EAAMjE,aAC5B7C,GAAU,GAEJA,KAEPmG,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEJ,KAAKM,cAAcD,EAAEL,SACtC3B,KAAI,SAAAyC,GACJ,OAAO,kBAACrI,EAAA,EAAD,CAAUiI,IAAK,iBAAmBI,EAAM7I,GAAIF,QAAS,kBAAM,EAAKkF,YAAY6D,EAAM7I,MAAM6I,EAAMd,e,GAnMtFrH,aA+MPC,gBArOA,SAACC,GAAD,MAAY,CAC1BqF,OAAQ,CACPlE,QAAS,eACT8B,OAAQ,QACRiF,UAAW,cAEZ1B,KAAM,CACLhG,SAAU,WACV2H,SAAU,KAEXvC,KAAM,CACLwC,aAAc,IAEf5F,SAAU,CACTtB,YAAalB,EAAMI,QAAQ,IAE5BtB,MAAO,CACNuJ,SAAU,GACVC,WAAY,QAmNoB,CAAEpF,WAAW,GAAhCnD,CAAwCoD,I,uEC9PjDoF,GAASC,EAAQ,KAEhB,SAASC,GAAeC,GAC7BC,KAAMC,IAAIL,GAAOM,IAAM,YACpBC,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OAGpB,SAASS,GAAoBT,GAClCC,KAAMC,IAAIL,GAAOM,IAAM,sBACpBC,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OAGpB,SAASU,GAAmB5H,EAAUhE,EAAUkL,GACrDC,KAAMC,IAAIL,GAAOM,IAAM,8BAAgCrH,EAAS,GAAK,aAAeA,EAAS,GAAK,aAAehE,GAC9GsL,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OAGpB,SAASW,GAAiB7H,GAC/B,IAAM8H,EACM,CACRpC,MAAO,iBAFLoC,EAIO,CACTpC,MAAO,gBALLoC,EAOK,CACPpC,MAAO,OARLoC,EAUW,CACbpC,MAAO,gBAXLoC,EAaQ,CACVpC,MAAO,wBAKX,GAAI1F,IAAaA,EAAS+H,kBACnB/H,EAASgI,kBAAoBhI,EAASiI,eACtCC,KAAOlI,EAASmI,mBAAmBC,OAAOF,OAAU,OACzD,MAAO,CACLG,KAAM,WACNC,YAAaR,EAAkBpC,MAC/B6C,QAAST,EAAkBpC,OAK/B,GAAI1F,IAAaA,EAAS+H,kBACnB/H,EAASgI,kBAAoBhI,EAASiI,cACvCC,KAAOlI,EAASmI,mBAAmBC,OAAOF,OAAU,OAAQ,CAChE,IAAMM,EAAUN,KAAOlI,EAASmI,mBAAmBM,UACnD,MAAO,CACLJ,KAAM,YACNE,QAAST,EAAmBpC,MAC5B4C,YAAaR,EAAmBpC,MAAQ1F,EAAS0I,eAAiB,IAAMF,EACxEG,KAAM,CACJ,CAAEC,UAAW5I,EAAS0I,eAAgBG,QAAS7I,EAASiI,cACxDO,IAMN,GAAIxI,GAAYA,EAAS+H,gBAAiB,CACxC,IAAMe,EAAiBZ,KAAOlI,EAAS+I,wBAAwBN,SAAQ,GACvE,MAAO,CACLJ,KAAM,UACNE,QAAST,EAAiBpC,MAC1B4C,YAAaR,EAAiBpC,MAAQ1F,EAASgJ,kBAAoB,QAAUF,EAC7EH,KAAM,CACJ,CAAEC,UAAW5I,EAASgJ,kBAAmBH,QAAS7I,EAAS+H,iBAC3De,IAMN,GAAI9I,IAAaA,EAAS+H,iBACpB/H,EAASgI,kBAAoBhI,EAASiI,cACtCC,KAAOlI,EAASiJ,yBAAyBb,OAAOF,OAAU,QAC1DA,KAAOlI,EAASmI,mBAAmBC,OAAOF,OAAU,OAAQ,CAChE,IAAMM,EAAUN,KAAOlI,EAASmI,mBAAmBM,UACnD,MAAO,CACLJ,KAAM,gBACNE,QAAST,EAAuBpC,MAChC4C,YAAaR,EAAuBpC,MAAQ1F,EAAS0I,eAAiB,IAAMF,EAC5EG,KAAM,CACJ,CAAEC,UAAW5I,EAAS0I,eAAgBG,QAAS7I,EAASiI,cACxDO,IAMN,OAAIxI,GACEA,EAASgI,kBAAoBhI,EAASiI,cACtCC,KAAOlI,EAASiJ,yBAAyBb,OAAOF,OAAU,SACzDA,KAAOlI,EAASmI,mBAAmBC,OAAOF,OAAU,OAClD,CACLG,KAAM,aACNE,QAAST,EAAoBpC,MAC7B4C,YAAaR,EAAoBpC,OAI9B,KC1GT,IA2BMwD,G,4MAELC,WAAa,SAACC,GACb,OAAO,kBAACxI,EAAA,EAAD,CAAQpD,MAAM,YAAYE,QAAS,kBAAM,EAAKlC,MAAM6N,SAAS,CAAEzL,GAAIwL,EAAKP,YAAaO,EAAKR,Y,EAGlGU,eAAiB,SAACC,GACjB,OACC,kBAACtJ,EAAA,EAAD,KAAasJ,EAAOhB,U,EAItBiB,gBAAkB,SAACD,GAClB,IAAME,EAAc,EAAKN,WAAWI,EAAOZ,KAAK,IAChD,OACC,kBAAC,IAAMe,SAAP,KACC,kBAACzJ,EAAA,EAAD,KACEsJ,EAAOhB,QACPkB,EACAF,EAAOZ,KAAK,M,EAMjBgB,cAAgB,SAACJ,GAChB,IAAME,EAAc,EAAKN,WAAWI,EAAOZ,KAAK,IAChD,OACC,kBAAC,IAAMe,SAAP,KACC,kBAACzJ,EAAA,EAAD,KACEsJ,EAAOhB,QACPkB,EACA,QAAUF,EAAOZ,KAAK,M,EAM3BiB,oBAAsB,SAACL,GACtB,IAAME,EAAc,EAAKN,WAAWI,EAAOZ,KAAK,IAChD,OACC,kBAAC,IAAMe,SAAP,KACC,kBAACzJ,EAAA,EAAD,KACEsJ,EAAOhB,QACPkB,EACAF,EAAOZ,KAAK,M,EAMjBkB,iBAAmB,SAACN,GACnB,OACC,kBAACtJ,EAAA,EAAD,KAAasJ,EAAOhB,U,EAItBuB,YAAc,kBAAMC,OAAOhM,KAAK,EAAKvC,MAAMwO,OAAOC,UAAW,W,uDAEnD,IAAD,SAC4C9N,KAAKX,MAAjDY,EADA,EACAA,QAAS4N,EADT,EACSA,OAAQE,EADjB,EACiBA,aACrBX,EAASY,GAFL,EAC+BnK,UAEnCuJ,GAA0B,aAAhBA,EAAOlB,OAAqBkB,EAASpN,KAAKmN,eAAeC,IACnEA,GAA0B,cAAhBA,EAAOlB,OAAsBkB,EAASpN,KAAKqN,gBAAgBD,IACrEA,GAA0B,YAAhBA,EAAOlB,OAAoBkB,EAASpN,KAAKwN,cAAcJ,IACjEA,GAA0B,kBAAhBA,EAAOlB,OAA0BkB,EAASpN,KAAKyN,oBAAoBL,IAC7EA,GAA0B,eAAhBA,EAAOlB,OAAuBkB,EAASpN,KAAK0N,iBAAiBN,IACtEA,IAAQA,EAAS,kBAACrI,EAAA,EAAD,CAAkBzE,UAAWL,EAAQ+E,SAAU3D,MAAM,YAAYuD,KAAM,MAC7F,IAAM6C,EAAO,0BAAMnH,UAAWL,EAAQyH,QAAzB,UACb,OACC,kBAACkB,GAAA,EAAD,CAAMtI,UAAWL,EAAQ4I,KAAM1E,UAAW,GACzC,kBAAC2E,GAAA,EAAD,KACC,kBAAChF,EAAA,EAAD,CAAYxD,UAAWL,EAAQkB,MAAOE,MAAM,gBAAgB0H,cAAY,GACtE8E,EAAOI,cAAgB,UAAYJ,EAAOI,cAAgB,EAAI,IAAM,IACpExG,EACAoG,EAAOK,aAAe,SAAWL,EAAOK,aAAe,EAAI,IAAM,KAEnE,kBAACpK,EAAA,EAAD,CAAYC,QAAQ,KAAKC,UAAU,OAAO+J,EAAeA,EAAavE,KAAO,IAAM,IAAMqE,EAAOrE,MAC/F4D,GAEF,kBAACjE,GAAA,EAAD,KACC,kBAACjI,EAAA,EAAD,CAASC,MAAM,wBACd,kBAACsD,EAAA,EAAD,CAAQT,UAAWU,IAAMC,GAAG,SAASC,KAAK,QAAQvD,MAAM,UAAUf,UAAWL,EAAQmJ,OAAQ7H,QAAS,kBAAM,EAAKlC,MAAM8O,kBAAkBJ,EAAatM,GAAIoM,EAAOpM,MAChK,kBAAC,IAAD,CAAgBnB,UAAWL,EAAQ4E,WADpC,UAID,kBAACuJ,GAAA,EAAD,CAAS9N,UAAWL,EAAQoO,kBAC3BR,EAAOC,UAAY,kBAAC5M,EAAA,EAAD,CAASC,MAAM,qBAClC,kBAACC,EAAA,EAAD,CAAYd,UAAWL,EAAQmJ,OAAQ7H,QAAS,kBAAM,EAAKoM,gBAC1D,kBAAC,KAAD,QAEW,W,GA3FOxL,aAsGVC,gBAjIA,SAAAC,GAAK,MAAK,CACxBqF,OAAQ,CACPlE,QAAS,eACT8B,OAAQ,QACRiF,UAAW,cAEZ1B,KAAM,CACL2B,SAAU,KAEX3F,SAAU,CACTtB,YAAalB,EAAMI,QAAQ,IAE5BtB,MAAO,CACNuJ,SAAU,GACVC,WAAY,IACZ2D,MAAO,SAERD,gBAAiB,CAChBE,MAAO,EACPC,OAAQ,GACRlJ,OAAQ,GAETN,SAAU,CACTM,OAAQjD,EAAMI,QAAQ,OA0GU,CAAE8C,WAAW,GAAhCnD,CAAwC2K,IC3HjD0B,G,4MACLtP,MAAQ,CACPuP,SAAU,G,EAGXC,UAAY,SAAC7N,GACZ,EAAKrB,SAAS,CAAEiP,SAAU5N,K,uDAGjB,IAAD,SAIqGd,KAAKX,MAH1GY,EADA,EACAA,QAAS2G,EADT,EACSA,cAAeC,EADxB,EACwBA,oBAAqBC,EAD7C,EAC6CA,oBAAqBb,EADlE,EACkEA,sBAAuBc,EADzF,EACyFA,wBAAyB6H,EADlH,EACkHA,wBACzH5H,EAFO,EAEPA,QAASC,EAFF,EAEEA,cAAe4H,EAFjB,EAEiBA,uBAAwBC,EAFzC,EAEyCA,uBAAwB5H,EAFjE,EAEiEA,cAAeZ,EAFhF,EAEgFA,gBAAiBa,EAFjG,EAEiGA,kBACxGC,EAHO,EAGPA,OAAQC,EAHD,EAGCA,aAAcC,EAHf,EAGeA,aAAcX,EAH7B,EAG6BA,eAAgBY,EAH7C,EAG6CA,iBACpDrH,EAJO,EAIPA,YAAad,EAJN,EAIMA,SAAUoI,EAJhB,EAIgBA,kBAAmB3H,EAJnC,EAImCA,SAAUQ,EAJ7C,EAI6CA,UAAWF,EAJxD,EAIwDA,eAAgBC,EAJxE,EAIwEA,YAAaN,EAJrF,EAIqFA,YAGvFiP,EAAmB/H,EAAQiD,QAAO,SAAAG,GACvC,IAAI5G,GAAU,EAYd,MAXoB,QAAhBtD,GAAyC,aAAhBA,IAC5BsD,EAAUsL,EAAuB1E,EAAI3I,KAElCqF,EAAoBoC,OAAS,IACsB,IAAtDpC,EAAoBuD,QAAQD,EAAIpE,mBAChCxC,GAAU,GAEP0D,EAAcgC,OAAS,IACS,IAAnChC,EAAcmD,QAAQD,EAAI3I,MAC1B+B,GAAU,GAEJA,KAGFwL,EAAiBD,EAAiB9E,QAAO,SAAAG,GAC9C,IAAMgD,EAASY,GAA8Ba,EAAuBzE,EAAI3I,KACxE,OAAQ2L,GAA0B,aAAhBA,EAAOlB,MAAuC,eAAhBkB,EAAOlB,QAIlD+C,EAA2C,IAAxBjP,KAAKb,MAAMuP,SAAiBM,EAAiBD,EAGhEG,EAAqBpI,EAAoBoC,OAAS,EAAIrC,EAAoBC,EAAoB,IAAI0C,KAAO,GACzG2F,EAAejI,EAAcgC,OAAS,EAAIjC,EAAcC,EAAc,IAAIsC,KAAO,GACjF4F,EAAc9H,EAAa4B,OAAS,EAAI7B,EAAaC,EAAa,IAAIkC,KAAO,GAC/ErI,EAAQ,cAUZ,MAR0B,KAAtB+N,IAA0B/N,EAAQ,cAAgB+N,GAClC,KAAhBC,IAAoBhO,EAAQ+N,EAAoB,IAAMC,GACvC,KAAfC,IAAmBjO,EAAQ+N,EAAoB,IAAME,GAExC,KAAbhQ,IAAiB+B,EAAQ,6BAA+B6H,KAAKC,MAAMpJ,EAAW,MAAQ,eAAiBT,GAEvF,QAAhBc,IAAuBiB,EAAQ,6BAA+B6H,KAAKC,MAAMpJ,EAAW,MAAQ,6BAG/F,yBAAKS,UAAWL,EAAQS,MACvB,kBAAC,GAAD,CACC2O,iBAAiB,EACjBzI,cAAeA,EACfC,oBAAqBA,EACrBC,oBAAqBA,EACrBb,sBAAuBA,EACvBc,wBAAyBA,EACzB6H,wBAAyBA,EACzB5H,QAASA,EACTC,cAAeA,EACfC,cAAeA,EACfZ,gBAAiBA,EACjBa,kBAAmBA,EACnBC,OAAQA,EACRC,aAAcA,EACdC,aAAcA,EACdX,eAAgBA,EAChBY,iBAAkBA,EAClBnI,SAAUA,EACVoI,kBAAmBA,EACnB3H,SAAUA,EACVK,YAAaA,EACbJ,YAAaA,EACbO,UAAWA,EACXF,eAAgBA,EAChBC,YAAaA,IAEd,kBAAC2B,EAAA,EAAD,CAAeC,eAAe,GAAOb,GACrC,kBAACmO,GAAA,EAAD,CACCvL,QAAQ,WACRwL,cAAc,MACdzO,MAAOd,KAAKb,MAAMuP,SAClBc,eAAe,YACfC,UAAU,YACV1O,SAAU,SAACvB,EAAGsB,GAAJ,OAAc,EAAK6N,UAAU7N,KAEvC,kBAAC4O,GAAA,EAAD,CACCpP,UAAWL,EAAQ0P,IACnBpG,MACC,kBAACqG,GAAA,EAAD,CACCtP,UAAWL,EAAQsC,QACnBlB,MAAO,YACPwO,aAAcb,EAAe9F,QAH9B,eAQF,kBAACwG,GAAA,EAAD,CACCnG,MACC,kBAACqG,GAAA,EAAD,CACCE,UAAQ,EACRxP,UAAWL,EAAQsC,QACnBlB,MAAM,YACNwO,aAAcd,EAAiB7F,QAJhC,eAUH,6BACClC,EACA,kBAACgB,GAAA,EAAD,CAAME,WAAS,EAACzF,QAAS,GACvBwM,EACChF,QAAO,SAAAG,GACP,IAAI5G,GAAU,EASd,OARIsD,EAAoBoC,OAAS,IACsB,IAAtDpC,EAAoBuD,QAAQD,EAAIpE,mBAChCxC,GAAU,GAEP0D,EAAcgC,OAAS,IACS,IAAnChC,EAAcmD,QAAQD,EAAI3I,MAC1B+B,GAAU,GAEJA,KAEPyG,QAAO,SAAAG,GACP,MAAoB,QAAhBlK,GAAyC,aAAhBA,GACrB4O,EAAuB1E,EAAI3I,OAInCoG,KAAI,SAACgG,EAAQkC,GACb,OACC,kBAAC/H,GAAA,EAAD,CACCkC,IAAK,OAAS2D,EAAOrE,KAAKwG,QAAQ,IAAK,IAAM,IAAMD,EACnD5H,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,GACtC,kBAAC,GAAD,CACCqF,OAAQA,EACRhK,SAAUgL,EAAuBhB,EAAOpM,IACxCsM,aAAclH,EAAoBgH,EAAO7H,iBACzCkH,SAAU,EAAK7N,MAAM6N,SACrBiB,kBAAmB,EAAK9O,MAAM8O,yBAMpC,6BACC,6BACA,kBAAC8B,GAAA,EAAD,CAAgB5O,MAAM,oB,GA3JNc,aAsKPC,gBAlLA,SAACC,GAAD,MAAY,CAC1B6N,KAAM,CACL5K,OAAQjD,EAAMI,QAAQ,IAEvBF,QAAS,CACRA,QAASF,EAAMI,QAAQ,EAAG,IAE3B/B,KAAM,CACL4B,SAAU,MA0KGF,CAAmBqM,I,wCChL5B0B,G,4MACFhR,MAAQ,G,uDAGE,IACEc,EAAYD,KAAKX,MAAjBY,QAER,OACI,kBAACiB,EAAA,EAAD,CAASC,MAAO,MACZ,kBAACiP,GAAA,EAAD,CACI9P,UAAsC,QAA3BN,KAAKX,MAAMa,YAAwBD,EAAQoQ,SAAWpQ,EAAQqQ,QACzE,kBAAC,KAAD,Y,GAXGpO,IAAMC,WAsBdC,gBAjCA,SAAAC,GAAK,MAAK,CACrBiO,OAAQ,CACJhL,OAAQ,GAEZ+K,SAAU,CACN/K,OAAQ,EACRiL,OAAQ,UACRtN,gBAAiBZ,EAAMc,QAAQqN,QAAQC,SA0Bb,CAAElL,WAAW,GAAhCnD,CAAwC+N,I,sECxBjDO,G,4MACFvR,MAAQ,G,EAERwR,8BAAgC,WAC5B,EAAKtR,MAAMuR,iBAAiB,uB,EAGhCC,MAAQ,kBAAM,EAAKxR,MAAMwR,S,uDAEf,IAAD,SACoC7Q,KAAKX,MAAtCY,EADH,EACGA,QAASsO,EADZ,EACYA,MAAOuC,EADnB,EACmBA,aAClBC,EAAaC,aAAY,KAAMzC,GACrC,OACI,kBAAC0C,GAAA,EAAD,CACIF,WAAYA,EACZG,sBAAsB,EACtBtP,KAAM5B,KAAKX,MAAMuC,KACjBE,QAAS9B,KAAK6Q,MACdM,cAAe,CACXC,WAAW,GAEfC,WACI,CACIlN,UAAW,EACX7D,UAAWL,EAAQqR,SAI3B,kBAACC,GAAA,EAAD,qBACA,kBAACC,GAAA,EAAD,KACI,kBAACC,GAAA,EAAD,CACIC,QACI,kBAACC,GAAA,EAAD,CACIC,QAASd,EAAae,mBACtB9Q,SAAUf,KAAK2Q,8BACfnH,KAAK,wBACLnI,MAAM,YAGdkI,MAAM,0BAGd,kBAACuI,GAAA,EAAD,KACI,kBAACrN,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKsP,SAASxP,MAAM,aAA3C,e,GA3CMa,IAAMC,WAsDjB8C,OAAQ8M,eAAa3P,aA5DrB,SAAAC,GAAK,MAAK,CACrBiP,OAAQ,CACJxO,OAAQ,wBA0DuC,CAAEyC,WAAW,IAArDN,CAA8DyL,I,UC3EtE,SAASsB,GAAWC,EAAKC,GAC9B,IAAIC,EACJ,GAAI,2BAA2BC,KAAKH,GAMlC,OAJiB,KADjBE,EAAIF,EAAII,UAAU,GAAGC,MAAM,KACrBpJ,SACJiJ,EAAI,CAACA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,GAAIA,EAAE,KAGhC,QAAU,EADjBA,EAAI,KAAOA,EAAEI,KAAK,MACM,GAAM,IAAMJ,GAAK,EAAK,IAAS,IAAJA,GAASI,KAAK,KAAO,KAAOL,EAAQ,IAEzF,MAAM,IAAIM,MAAM,WCQlB,IAOMC,G,uKACO,IAAD,EAC0CzS,KAAKX,MAA/CY,EADA,EACAA,QAAS4D,EADT,EACSA,SAAUkK,EADnB,EACmBA,aAAc2E,EADjC,EACiCA,KACnCtF,EAASY,GAA8BnK,GACvCe,EAAQ8N,EAAO,EAAI,QAAWA,EAAO,GAAK,SAAW,QACrD5P,EAAU4P,EAAO,EAAI,EAAKA,EAAO,GAAK,EAAI,EAChD,OACE,kBAACxR,EAAA,EAAD,CACEC,MAAQiM,EAASA,EAAOjB,YAAc,IAEtC,kBAACwG,GAAA,EAAD,CACE/N,KAAMA,EACNtE,UAAWL,EAAQ2S,IACnBvR,MAAM,UACNwR,MAAO,CACL5P,gBAAiB6P,GAAsB/E,EAAagF,OAAQ,IAC5DjQ,OAASA,EAAS,qBAGpB,kBAAC,IAAD,Y,GAnBiBX,aA8BZC,gBArCA,SAAAC,GAAK,MAAK,CACvBuQ,IAAK,CACHtN,OAAQjD,EAAMI,QAAQ,GACtBuQ,UAAW,WAkCmB,CAAEzN,WAAW,GAAhCnD,CAAwCqQ,I,yCCtBjD7H,GAASC,EAAQ,KAEjBoI,GAAMC,aAAc,CACxBC,QAAS,EACTC,QAAS,GACTC,kBAAmB,kFAGfC,GAAa,CAAC1I,GAAO0I,YACrBC,GAAa,CAAC3I,GAAO2I,YACrBC,GAA0B,CAAC5I,GAAO4I,yBAElCC,G,4MAEJtU,MAAQ,CACNuU,qBAAsB,KACtBC,aAAc,KACd9L,IAAK,KACL+L,oBAAoB,EACpBC,sBAAsB,G,EAGxBC,kBAAoB,WAElB,IAAIJ,EAAuBK,YAAY,EAAKC,eAAgB,KAC5D,EAAKvU,SAAS,CAAEiU,qBAAsBA,K,EAGxCO,UAAY,SAACpM,GACPA,GAAOA,EAAIqM,UAAYrM,EAAIqM,SAAShL,OAAS,GAAKrB,EAAIqM,SAAS,GAAGC,YACpE,EAAK9U,MAAM6N,SAAS,CAAEzL,GAAIoG,EAAIqM,SAAS,GAAGC,WAAW1S,M,EAIzD2S,UAAY,SAACvM,GACPA,GAAOA,EAAIqM,UAAYrM,EAAIqM,SAAShL,OAAS,GAAKrB,EAAIqM,SAAS,GAAGC,YACpE,EAAK9U,MAAMgV,SAASxM,EAAIqM,SAAS,GAAGC,a,EAIxCH,eAAiB,kBAAM,EAAKvU,SAAS,CAAEkU,aAAc5H,U,uDAE3C,IAAD,SAC8J/L,KAAKX,MAAlKY,EADD,EACCA,QAAS4C,EADV,EACUA,SAAU6P,EADpB,EACoBA,KAAM4B,EAD1B,EAC0BA,MAAOC,EADjC,EACiCA,QAASC,EAD1C,EAC0CA,WAAY1D,EADtD,EACsDA,aAAc2D,EADpE,EACoEA,iBAAkBxN,EADtF,EACsFA,cAAeL,EADrG,EACqGA,cAAeC,EADpH,EACoHA,oBAAqB+J,EADzI,EACyIA,iBAG5I8D,EAA4B,CAAC,QAAS,CAAC,MAAO,aAOlD,OANA9N,EAAc+N,SAAQ,SAAA7M,GACpB4M,EAA0BE,KAAK9M,EAAI+M,MACnCH,EAA0BE,KAAK9M,EAAIiL,WAErC2B,EAA0BE,KAAK,WAG7B,kBAAC,IAAMrH,SAAP,KACE,kBAAC0F,GAAD,CACEJ,MAAM,aACNiC,OAAQjS,EACR6P,KAAMA,EACNU,QAAS,GACTkB,MAAOA,EACPC,QAASA,EACTQ,UAAWP,EACXQ,eAAgB,CAAEC,IAAK,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,KAAM,EAAG5G,OAAQ,QAASD,MAAO,QAAS1L,SAAU,YACnGwS,YAAa,SAAAxN,GAAG,OAAI,EAAKpI,SAAS,CAAEoI,IAAKA,MAGvC4M,GAAoBA,EAAiBvL,OAAS,EAC5CuL,EAAiB5M,KAAI,SAAAyN,GACnB,IAAIC,EAAiB,CAACD,EAAEE,KAAMF,EAAEG,MAChC,GAAI,EAAKtW,MAAMwU,cAAgB2B,EAAEI,eAAiBJ,EAAEI,cAAcC,aAAeL,EAAEM,QAAS,CAC1F,IAAMC,EAAsB9J,KAAO,EAAK5M,MAAMwU,cAAcmC,KAAKR,EAAEM,SAC7DG,EAAQ/M,KAAKC,MAAM4M,EAAsB,KACzCG,EAASV,EAAEI,cAAcC,YAC3BK,EAAO9M,OAAS6M,GAASA,EAAQ,IAAGR,EAAiBS,EAAOD,IAC5DC,EAAO9M,QAAU6M,GAASA,EAAQ,IAAGR,EAAiBS,EAAOA,EAAO9M,OAAS,IAEnF,IAAM2E,EAAS5G,EAAcqO,EAAEjP,WACzB0H,EAAgBF,EAAShH,EAAoBgH,EAAO7H,iBAAmB,KAC7E,OAAO,kBAAC,KAAD,CACLkE,IAAK,OAASoL,EAAE7T,GAChBkU,YAAaJ,EACbjW,OAAO,UACP,kBAAC,GAAD,CACEyO,aAAcA,EACdlK,SAAUyR,EACV5C,KAAM,EAAKvT,MAAM0I,IAAM,EAAK1I,MAAM0I,IAAIoO,UAAY,QAGnD,KAET,kBAAC,KAAD,CACExU,GAAG,YACHyU,eAAgB,CACdhK,KAAM,SACNiK,MAAO7C,MAEX,kBAAC,KAAD,CACE7R,GAAG,YACHyU,eAAgB,CACdhK,KAAM,SACNiK,MAAO5C,MAEX,kBAAC,KAAD,CACE9R,GAAG,0BACHyU,eAAgB,CACdhK,KAAM,SACNiK,MAAO3C,MAEX,kBAAC,KAAD,CACE/R,GAAG,kBACHyK,KAAK,OACLkK,SAAS,YACTC,YAAY,OACZlD,QAAS,GACTmD,OAAQ,CACN,YAAa,QACb,WAAY,UAEdC,MAAO,CACL,aAAc,UACd,cAAe,CACb,cACA,CACE,UAEF,CACE,QAEF,GAAI,GACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,GACJ,GAAI,IAEN,eAAgB,EAChB,aAAc,CACZ,cACA,CACE,UAEF,CACE,QAEF,GAAI,GACJ,GAAI,EACJ,GAAI,EACJ,GAAI,EACJ,GAAI,GACJ,GAAI,IAEN,iBAAkB,CAChB,EACA,KAGJhV,QAASvB,KAAKoU,YAEhB,kBAAC,KAAD,CACE3S,GAAG,oBACHyK,KAAK,SACLkK,SAAS,YACTC,YAAY,OACZlD,QAAS,EACTmD,OAAQ,GACRC,MAAO,CACL,gBAAiB,CACf,cACA,CAAC,UACD,CAAC,QACD,EAAG,EACH,GAAI,IAEN,eAAgB,CAAC,MAAO,uBACxB,sBAAuB,CACrB,cACA,CAAC,UACD,CAAC,QACD,EAAG,EACH,GAAI,GAEN,sBAAuB,UACvB,iBAAkB,IAEpBhV,QAASvB,KAAKiU,YAEhB,kBAAC,KAAD,CACExS,GAAG,mBACHyK,KAAK,SACLkK,SAAS,YACTC,YAAY,OACZlD,QAAS,GACTmD,OAAQ,CACN,yBAAyB,EACzB,aAAc,CAAC,YAAa,CAAC,MAAO,SACpC,YAAa,CACX,wBAEF,mBAAoB,EACpB,YAAa,CACX,cACA,CACE,UAEF,CACE,QAEF,GAAI,GACJ,GAAI,IAEN,cAAe,CAAC,EAAG,IAErBC,MAAO,CACL,kBAAmB,mBACnB,kBAAmB,EACnB,iBAAkB,EAClB,aAAc,WAEhBhV,QAASvB,KAAKiU,YAEhB,kBAAC,KAAD,CACExS,GAAG,0BACHyK,KAAK,SACLkK,SAAS,YACTC,YAAY,OACZlD,QAAS,GACTmD,OAAQ,CACN,yBAAyB,EACzB,aAAc,CAAC,YAAa,CAAC,MAAO,kBACpC,YAAa,CACX,wBAEF,mBAAoB,EACpB,YAAa,CACX,cACA,CACE,UAEF,CACE,QAEF,GAAI,GACJ,GAAI,IAEN,cAAe,CAAC,GAAI,MAEtBC,MAAO,CACL,kBAAmB,mBACnB,kBAAmB,EACnB,iBAAkB,EAClB,aAAc,WAEhBhV,QAASvB,KAAKiU,YAEfnD,EAAae,mBACZ,kBAAC,IAAMtE,SAAP,KACE,kBAAC,KAAD,CACE9L,GAAG,gCACHyK,KAAK,OACLkK,SAAS,0BACTC,YAAY,+BACZlD,QAAS,EACTmD,OAAQ,CACN,YAAa,QACb,WAAY,UAEdC,MAAO,CACL,aAAc,UACd,eAAgB,EAChB,aAAc,CACZ,cACA,CACE,UAEF,CACE,QAEF,EAAG,EACH,GAAI,MAIV,kBAAC,KAAD,CACE9U,GAAG,+BACHyK,KAAK,OACLkK,SAAS,0BACTC,YAAY,+BACZlD,QAAS,EACToD,MAAO,CACL,aAAc7B,EACd,eAAgB,OAIpB,KACH1U,KAAKX,MAAMmX,kBAAoBxW,KAAKX,MAAMmX,iBAAiBtN,OAAS,EACnE,kBAAC,KAAD,CACEgB,IAAK,QACLyL,YAAa,CAAC3V,KAAKX,MAAMmX,iBAAiB,GAAIxW,KAAKX,MAAMmX,iBAAiB,KAC1E,kBAAC,GAAD,CAAUtW,YAAaF,KAAKX,MAAMa,eAElC,KACJ,kBAAC,KAAD,CAAa2C,SAAS,iBAExB,kBAAC4T,GAAA,EAAD,CACEC,UAAU,WACVC,SAAU,CACR/R,KAAM,SAERtE,UAAWL,EAAQ2W,aACnBC,KAAM,kBAAC,KAAD,MACN/U,QAAS,kBAAM,EAAKrC,SAAS,CAAEmU,oBAAoB,KACnDkD,OAAQ,kBAAM,EAAKrX,SAAS,CAAEmU,oBAAoB,KAClDhS,KAAM5B,KAAKb,MAAMyU,mBACjBmD,UAAW,QAEX,kBAACC,GAAA,EAAD,CACE9M,IAAK,WACL2M,KAAM,kBAAC,KAAD,MACNI,aAAc,gBACd1V,QAAS,kBAAM,EAAK9B,SAAS,CAAEoU,sBAAsB,EAAMD,oBAAoB,QAGnF,kBAAC,GAAD,CACE9C,aAAcA,EACdlP,KAAM5B,KAAKb,MAAM0U,qBACjBjD,iBAAkBA,EAClBC,MAAO,kBAAM,EAAKpR,SAAS,CAAEoU,sBAAsB,EAAOD,oBAAoB,Y,GA5ThEzR,aAuUTC,gBA3VA,SAAAC,GAAK,MAAK,CACvBuU,aAAc,CACZ/T,SAAU,WACVqS,OAAQ7S,EAAMI,QAAQ,GACtB0S,MAAO9S,EAAMI,QAAQ,OAuVS,CAAE8C,WAAW,GAAhCnD,CAAwCqR,I,4NCjXjD7I,GAASC,EAAQ,KAwChB,SAASqM,GAAazV,EAAIsJ,GAC/BC,KAAMC,IAAIL,GAAOM,IAAM,UAAYzJ,GAChC0J,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,kBAAMP,EAAS,OCV1B,IAAMH,GAASC,EAAQ,KAoBjBsM,G,4MAELC,SAAWlV,IAAMmV,Y,EAEjBC,gBAAkB,SAACrK,GAAD,OAAUW,OAAOhM,KAAKgJ,GAAOM,IAAM,UAAY+B,EAAKxL,GAAK,S,EAC3E8V,WAAa,SAACtK,GAAD,OAAUW,OAAOhM,KAAKgJ,GAAOM,IAAM,UAAY+B,EAAKxL,GAAK,OAAQ,W,EAC9E+V,YAAc,SAACvK,GAAD,OAAU,EAAK5N,MAAMmY,YAAYvK,EAAKwK,UAAWxK,EAAKyK,W,EACpE/J,YAAc,SAACV,GAAD,OAAUW,OAAOhM,KAAKqL,EAAKa,UAAW,W,EAMpD7H,sBAAwB,SAACD,GACxB,EAAK3G,MAAM4G,sBAAsBD,GACjC,EAAKoR,SAASO,QAAQC,iB,EAGvB7Q,wBAA0B,WACzB,EAAK1H,MAAM0H,0BACX,EAAKqQ,SAASO,QAAQC,iB,EAGvBtR,gBAAkB,SAACD,GAClB,EAAKhH,MAAMiH,gBAAgBD,GAC3B,EAAK+Q,SAASO,QAAQC,iB,EAGvBzQ,kBAAoB,WACnB,EAAK9H,MAAM8H,oBACX,EAAKiQ,SAASO,QAAQC,iB,EAGvBjR,eAAiB,SAACD,GACjB,EAAKrH,MAAMsH,eAAeD,GAC1B,EAAK0Q,SAASO,QAAQC,iB,EAGvBrQ,iBAAmB,WAClB,EAAKlI,MAAMkI,mBACX,EAAK6P,SAASO,QAAQC,iB,EAGvBC,gBAAkB,SAACC,GAAD,OAAS,EAAKzY,MAAM6N,SAAS4K,I,iEAlC5B/X,GACdC,KAAKX,MAAMmX,mBAAqBzW,EAAUyW,kBAAoBxW,KAAKX,MAAMQ,WAAaE,EAAUF,UAAUG,KAAKoX,SAASO,QAAQC,kB,+BAmC3H,IAAD,SAK2F5X,KAAKX,MAHvGY,EAFO,EAEPA,QAAS2G,EAFF,EAEEA,cAAeC,EAFjB,EAEiBA,oBAAqBC,EAFtC,EAEsCA,oBAAqB8H,EAF3D,EAE2DA,wBAClE5H,EAHO,EAGPA,QAASC,EAHF,EAGEA,cAAeC,EAHjB,EAGiBA,cACxBE,EAJO,EAIPA,OAAQC,EAJD,EAICA,aAAcC,EAJf,EAIeA,aAAckP,EAJ7B,EAI6BA,iBAAkB3W,EAJ/C,EAI+CA,SAAU0O,EAJzD,EAIyDA,MAChErO,EALO,EAKPA,YAAad,EALN,EAKMA,SAAUoI,EALhB,EAKgBA,kBAAmBnH,EALnC,EAKmCA,UAAWF,EAL9C,EAK8CA,eAAgBC,EAL9D,EAK8DA,YAAaN,EAL3E,EAK2EA,YAG7EoP,EAAqBpI,EAAoBoC,OAAS,EAAIrC,EAAoBC,EAAoB,IAAI0C,KAAO,GACzG2F,EAAejI,EAAcgC,OAAS,EAAIjC,EAAcC,EAAc,IAAIsC,KAAO,GACjF4F,EAAc9H,EAAa4B,OAAS,EAAI7B,EAAaC,EAAa,IAAIkC,KAAO,GAC/ErI,EAAQ,YAEc,KAAtB+N,IAA0B/N,EAAQ,YAAc+N,GAChC,KAAhBC,IAAoBhO,EAAQ,aAAe+N,EAAoB,IAAMC,GACtD,KAAfC,IAAmBjO,EAAQ,aAAe+N,EAAoB,IAAME,GAEvD,KAAbhQ,IAAiB+B,EAAQ,gBAAkB6H,KAAKC,MAAMpJ,EAAW,MAAQ,eAAiBT,GAE1E,QAAhBc,IAAuBiB,EAAQ,gBAAkB6H,KAAKC,MAAMpJ,EAAW,MAAQ,6BAEnF,IAAIkY,EAAU,GACdC,OAAOC,KAAKpR,GAAqB8N,SAAQ,SAAAzK,GACxC6N,EAAQ7N,GAAOrD,EAAoBqD,GAAKV,QAEzC,IAAI0O,EAAa,GACjBF,OAAOC,KAAKhR,GAAe0N,SAAQ,SAAAzK,GAClCgO,EAAWhO,GAAOjD,EAAciD,GAAKV,QAEtC,IAAI2O,EAAY,GAIhB,OAHAH,OAAOC,KAAK5Q,GAAcsN,SAAQ,SAAAzK,GACjCiO,EAAUjO,GAAO7C,EAAa6C,GAAKV,QAGnC,yBAAKqJ,MAAO,CAAEpP,SAAU,SACvB,kBAAC,GAAD,CACC4L,iBAAiB,EACjBzI,cAAeA,EACfC,oBAAqBA,EACrBC,oBAAqBA,EACrBb,sBAAuBjG,KAAKiG,sBAC5Bc,wBAAyB/G,KAAK+G,wBAC9B6H,wBAAyBA,EACzB5H,QAASA,EACTC,cAAeA,EACfC,cAAeA,EACfZ,gBAAiBtG,KAAKsG,gBACtBa,kBAAmBnH,KAAKmH,kBACxBC,OAAQA,EACRC,aAAcA,EACdC,aAAcA,EACdX,eAAgB3G,KAAK2G,eACrBY,iBAAkBvH,KAAKuH,iBACvBnI,SAAUA,EACVoI,kBAAmBA,EACnB3H,SAAUA,EACVK,YAAaA,EACbJ,YAAaA,EACbO,UAAWA,EACXF,eAAgBA,EAChBC,YAAaA,IAEd,kBAAC2B,EAAA,EAAD,CAAeC,eAAe,GAAOb,GACrC,kBAAC,KAAD,CACCiW,SAAUpX,KAAKoX,SACfgB,WAAY,CACXC,UAAW,SAAAhZ,GAAK,OAAI,kBAACiZ,GAAA,EAAD,iBAAWjZ,EAAX,CAAkB8E,UAAW,EAAG7D,UAAWL,EAAQsY,WAExEC,MAAO,CACNC,OAAQC,KACRC,UAAWA,KACXC,SAAUA,KACVC,SAAUC,KACVC,aAAcC,KACdC,UAAWC,MAEZC,QAAS,CACR5W,QAAS6W,aAAU,KAAM7K,GAAS,UAAY,QAC9ChO,QAAQ,EACR8Y,YAAa,UACbC,mBAAoB,EACpBC,WAAW,EACXC,SAAS,EACTC,YAAa,CACZxW,gBAAiB,UACjB5B,MAAO,UACPyB,OAAQ,QAGV4W,QAAS,CACR,CACCvY,MAAO,GACPwY,MAAO,OACPJ,WAAW,EACXK,OAAQ,SAAAC,GACP,OACC,kBAAC,IAAMtM,SAAP,KACC,kBAACrM,EAAA,EAAD,CAASC,MAAM,yBACd,kBAACC,EAAA,EAAD,CAAYG,QAAS,kBAAM,EAAKsW,gBAAgBgC,KAC/C,kBAAC,KAAD,QAGF,kBAACtV,EAAA,EAAD,CAAQuV,QAAM,GACb,kBAAC5Y,EAAA,EAAD,CAASC,MAAM,qCACd,kBAACC,EAAA,EAAD,CAAYG,QAAS,kBAAM,EAAK+V,gBAAgBuC,KAC/C,kBAAC,KAAD,SAIH,kBAACtV,EAAA,EAAD,CAAQuV,QAAM,GACb,kBAAC5Y,EAAA,EAAD,CAASC,MAAM,0CACd,kBAACC,EAAA,EAAD,CAAYG,QAAS,kBAAM,EAAKgW,WAAWsC,KAC1C,kBAAC,KAAD,SAIH,kBAACtV,EAAA,EAAD,CAAQuV,QAAM,GACb,kBAAC5Y,EAAA,EAAD,CAASC,MAAM,4BACd,kBAACC,EAAA,EAAD,CAAYG,QAAS,kBAAM,EAAKiW,YAAYqC,IAAU7V,UAAWU,IAAMC,GAAG,QACzE,kBAAC,IAAD,SAIH,kBAACJ,EAAA,EAAD,CAAQuV,QAAM,GACb,kBAAC5Y,EAAA,EAAD,CAASC,MAAM,mCACd,kBAACC,EAAA,EAAD,CAAYG,QAAS,kBAAM,EAAKoM,YAAYkM,KAC3C,kBAAC,KAAD,WAONE,UAAW,CACVC,aAAc,oBACd/W,gBAAiB,YAGnB,CACC9B,MAAO,OACPwY,MAAO,OACPJ,WAAW,EACXU,QAAQ,EACRL,OAAQ,SAAAC,GACP,OACCA,EAAQrQ,MAGVuQ,UAAW,CACVC,aAAc,oBACd/W,gBAAiB,YAGnB,CACC9B,MAAO,YACPwY,MAAO,YACPJ,WAAW,EACXQ,UAAW,CACVC,aAAc,oBACd/W,gBAAiB,YAGnB,CACC9B,MAAO,YACPwY,MAAO,oBACPJ,WAAW,EACXU,OAAQjJ,aAAY,KAAMzC,GAC1BwL,UAAW,CACVC,aAAc,oBACd/W,gBAAiB,YAGnB,CACC9B,MAAO,WACPwY,MAAO,iBACPJ,WAAW,EACXU,OAAQjJ,aAAY,KAAMzC,GAC1BqL,OAAQ,SAACC,GACR,OACCA,EAAQK,eAAehR,OAAS,EAAI6C,KAAO8N,EAAQK,eAAe,IAAIC,OAAO,iBAAmB,IAGlGJ,UAAW,CACVC,aAAc,oBACd/W,gBAAiB,aAIpBoI,KAAM,SAAA+O,GAAK,OACV,IAAIC,SAAQ,SAACC,EAASC,IDnSrB,SAAwBH,EAAOI,EAAsBC,EAAgBC,EAAelE,EAAkB3W,EAAUkL,GACrH,IAAI4P,EAAM/P,GAAOM,IAAM,gBAAkBkP,EAAMQ,KAAO,GAAK,UAAYR,EAAMS,SACzET,EAAMU,SAAWV,EAAMU,QAAQnB,QAAOgB,EAAMA,EAAM,SAAWP,EAAMU,QAAQnB,MAAQ,cAAgBS,EAAMW,gBAEzGN,EAAevR,OAAS,IAAGyR,EAAMA,EAAM,eAAiBF,EAAelI,KAAK,MAC5EiI,EAAqBtR,OAAS,IAAGyR,EAAMA,EAAM,qBAAuBH,EAAqBjI,KAAK,MAC9FmI,EAAcxR,OAAS,IAAGyR,EAAMA,EAAM,cAAgBD,EAAcnI,KAAK,MAEzEiE,GAAoBA,EAAiBtN,OAAS,IAAGyR,EAAMA,EAAM,cAAgBnE,EAAiB,GAAK,aAAeA,EAAiB,IACnI3W,GAAyB,KAAbA,IAAiB8a,EAAMA,EAAM,aAAe9a,GAE5DmL,KAAMC,IAAI0P,GACPxP,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAAS,CACPiQ,MAAO5P,EAASC,KAChB4P,MAAOC,SAAS9P,EAAS+P,QAAQ,kBACjCP,KAAMM,SAAS9P,EAAS+P,QAAQ,aAGlCpQ,EAAS,CAAEiQ,MAAO,GAAIC,MAAO,EAAGL,KAAM,OAGzCtP,OAAM,kBAAMP,EAAS,CAAEiQ,MAAO,GAAIC,MAAO,EAAGL,KAAM,OC6QhDQ,CAA0BhB,EAAOtT,EAAqBI,EAAeI,EAAckP,EAAkB3W,GAAU,SAAAwb,GAC9Gf,EAAQ,CACPjP,KAAMgQ,EAASL,MACfJ,KAAOS,EAAST,KAAO,EACvBU,WAAYD,EAASJ,sB,GA/OV9Y,aA8PL8C,OAAQ8M,eAAa3P,aAhRrB,SAACC,GAAD,MAAY,CAC1BkZ,YAAa,CACZjW,OAAQjD,EAAMI,QAAQ,GACtB+H,SAAU,KAEXlF,OAAQ,CACPA,OAAQjD,EAAMI,QAAQ,IAEvB/B,KAAM,CACL4B,SAAU,EACVmB,SAAU,QAEX8U,MAAO,CACNtV,gBAAiB,mBACjBH,OAAQ,wBAkQ6C,CAAEyC,WAAW,IAArDN,CAA8DkS,IClSvEvM,GAASC,EAAQ,KAsBjB2Q,G,4MACFrc,MAAQ,G,EAERmY,gBAAkB,kBAAM1J,OAAOhM,KAAKgJ,GAAOM,IAAM,UAAY,EAAK7L,MAAM4N,KAAKxL,GAAK,S,EAClF8V,WAAa,kBAAM3J,OAAOhM,KAAKgJ,GAAOM,IAAM,UAAY,EAAK7L,MAAM4N,KAAKxL,GAAK,OAAQ,W,EACrF+V,YAAc,kBAAM,EAAKnY,MAAMmY,YAAY,EAAKnY,MAAM4N,KAAKwK,UAAW,EAAKpY,MAAM4N,KAAKyK,W,EACtF/J,YAAc,kBAAMC,OAAOhM,KAAK,EAAKvC,MAAM4N,KAAKa,UAAW,W,EAE3D+C,MAAQ,WAAQ,EAAKxR,MAAMwR,S,uDAEjB,IAAD,SAC4B7Q,KAAKX,MAA9BY,EADH,EACGA,QAASsO,EADZ,EACYA,MAAOtB,EADnB,EACmBA,KAClB8D,EAAaC,aAAY,KAAMzC,GACrC,OACI,kBAAC0C,GAAA,EAAD,CACIF,WAAYA,EACZG,sBAAsB,EACtBtP,KAAM5B,KAAKX,MAAMuC,KACjBE,QAAS9B,KAAK6Q,MACd4K,kBAAgB,YAChBtK,cACI,CACIC,WAAW,GAGnBC,WACI,CACIlN,UAAW,EACX7D,UAAWL,EAAQqR,SAI1BrE,GAAQA,EAAKyO,WACV,kBAAC,IAAMnO,SAAP,KACI,kBAACgE,GAAA,EAAD,CAAa9P,GAAG,aAAawL,EAAKzD,KAAO,KAAOyD,EAAK0O,WACrD,kBAACnK,GAAA,EAAD,KACI,kBAACzP,EAAA,EAAD,KAAiBkL,EAAKiN,gBAAkBjN,EAAKiN,eAAehR,OAAS,EAAI6C,KAAOkB,EAAKiN,eAAe,IAAIC,OAAO,sBAAwB,IAEvI,6BACA,kBAAC/L,GAAA,EAAD,MACA,6BACA,kBAAC3J,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAK+V,mBAAmBhX,UAAWL,EAAQmJ,OAAQ/H,MAAM,UAAUua,UAAW,kBAAC,KAAD,OAArG,YACA,kBAACnX,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKgW,cAAcjX,UAAWL,EAAQmJ,OAAQ/H,MAAM,UAAUua,UAAW,kBAAC,KAAD,OAAhG,aACA,kBAACnX,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKiW,eAAelX,UAAWL,EAAQmJ,OAAQ/H,MAAM,UAAUua,UAAW,kBAAC,IAAD,MAAoB5X,UAAWU,IAAMC,GAAG,QAAzI,SAGR,kBAACI,EAAA,EAAD,CAAkBzE,UAAWL,EAAQ+E,SAAU3D,MAAM,YAAYuD,KAAM,KAC3E,kBAACkN,GAAA,EAAD,KACI,kBAACrN,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKoM,eAAetM,MAAM,WAAjD,WACA,kBAACoD,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKsP,SAASxP,MAAM,aAA3C,e,GAjDMa,IAAMC,WA4DjB8C,OAAQ8M,eAAa3P,aAhFrB,SAAAC,GAAK,MAAK,CACrB+G,OAAQ,CACJ9D,OAAQjD,EAAMI,QAAQ,IAE1B6O,OAAQ,CACJxO,OAAQ,qBAEZ+B,SAAU,CACNtB,YAAalB,EAAMI,QAAQ,IAE/BoZ,KAAM,CACFtN,MAAO,OACP9K,SAAU,IACVR,gBAAiBZ,EAAMc,QAAQ2Y,WAAWC,OAE9C/W,SAAU,CACNM,OAAQjD,EAAMI,QAAQ,OAgEyB,CAAE8C,WAAW,IAArDN,CAA8DuW,ICvFvEQ,G,4MACF7c,MAAQ,G,EAER0R,MAAQ,WAAQ,EAAKxR,MAAMwR,S,uDAEjB,IAAD,SAC4B7Q,KAAKX,MAA9BY,EADH,EACGA,QAASsO,EADZ,EACYA,MAAO0N,EADnB,EACmBA,KAClBlL,EAAaC,aAAY,KAAMzC,GAC/B2N,EAAqBlT,KAAKC,MAAMgT,EAAKE,SAAW,IAAM,sBACtDtc,EAAWmJ,KAAKC,MAAMgT,EAAKpc,SAAW,KAAM,GAAK,WACvD,OACI,kBAACoR,GAAA,EAAD,CACIF,WAAYA,EACZG,sBAAsB,EACtBtP,KAAM5B,KAAKX,MAAMuC,KACjBE,QAAS9B,KAAK6Q,MACdM,cACI,CACIC,WAAW,GAGnBC,WACI,CACIlN,UAAW,EACX7D,UAAWL,EAAQqR,SAI3B,kBAACC,GAAA,EAAD,KAAc,gBACd,kBAACC,GAAA,EAAD,KACA,kBAACzP,EAAA,EAAD,CAAeC,eAAa,GAAE,QAAUia,EAAKG,iBAAmB,OAASH,EAAKI,uBAC9E,kBAACvY,EAAA,EAAD,CAAYC,QAAQ,QAAQC,UAAU,KAAKkY,EAAqB,IAAMrc,IAEtE,kBAACiS,GAAA,EAAD,KACI,kBAACrN,EAAA,EAAD,CAAQlD,QAAS,kBAAM,EAAKsP,SAASxP,MAAM,aAA3C,e,GAlCMa,IAAMC,WA6CjB8C,OAAQ8M,eAAa3P,aAnDrB,SAAAC,GAAK,MAAK,CACrBiP,OAAQ,CACJxO,OAAQ,wBAiDuC,CAAEyC,WAAW,IAArDN,CAA8D+W,IC9DtE,SAASM,GAAoBvR,GAMlCwR,UAAUC,YAAYF,oBAAmB,SAACG,GACxC1R,EAAS,CAAC0R,EAAIzG,OAAOyB,UAAWgF,EAAIzG,OAAO0B,cAC1C,SAAAnM,GACDR,EAAS,MARG,CACZ2R,oBAAoB,EACpBC,QAAS,IACTC,WAAY,IAUT,SAASC,GAAazd,EAAU2L,GACrCC,KAAMC,IAAI,sCAAwC7L,GAC/C+L,MAAK,SAAAC,GACAA,GAAYA,EAASC,MAAQD,EAASC,KAAKyR,OAC7C/R,EAAS,CACPlH,SAAU,CAACuH,EAASC,KAAKyR,OAAOrF,UAAWrM,EAASC,KAAKyR,OAAOpF,UAChEqF,eAAgB3R,EAASC,KAAKyR,OAAOC,iBAGvChS,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OC3B3B,IAAMH,GAASC,EAAQ,KAEhB,SAASmS,GAAqBjS,GACnCC,KAAMC,IAAIL,GAAOM,IAAM,kBACpBC,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OCX3B,IAAMH,GAASC,EAAQ,KAEhB,SAASoS,GAAclS,GAC5BC,KAAMC,IAAIL,GAAOM,IAAM,WACpBC,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,SAAAC,GAAG,OAAIR,EAAS,OCX3B,IAAMH,GAASC,EAAQ,KAchB,SAASqS,GAAazb,EAAIsJ,GAC/BC,KAAMC,IAAIL,GAAOM,IAAM,UAAYzJ,GAChC0J,MAAK,SAAAC,GACAA,GAAYA,EAASC,KACvBN,EAASK,EAASC,MAElBN,EAAS,OAGZO,OAAM,kBAAMP,EAAS,OCW1B,IAAM1I,GAAQ8a,YAAe,CAC3Bha,QAAS,CACPqN,QAAS4M,IACTC,UAAWC,KAEbC,UAAW,CACTC,UAAW,CACTC,KAAM,CACJC,cAAe,SAGnBC,OAAQ,CACNjd,KAAM,CACJgd,cAAe,SAGnBE,aAAc,CACZld,KAAM,CACJsZ,aAAc,YAgBhB6D,G,4MACJ1e,MAAQ,CAEN2e,kBAAkB,EAClBC,aAAc,GAEdC,kBAAkB,EAClBC,aAAc,GAEdrX,cAAe,GACfC,oBAAqB,GACrBC,oBAAqB,GAErBE,QAAS,GACTC,cAAe,GACfC,cAAe,GACfuN,iBAAkB,GAClB5F,uBAAwB,GACxBqP,gBAAiB,GACjBpP,uBAAwB,GACxBqP,sBAAuB,KAEvB/W,OAAQ,GACRC,aAAc,GACdC,aAAc,GAEdkN,WAAY,KACZ3R,SAAU,EAAE,IAAQ,SACpB6P,KAAM,CAAC,GACP4B,MAAO,CAAC,GACRC,QAAS,CAAC,GAEVrU,YAAa,GACbL,SAAU,KACVT,SAAU,GACVoI,kBAAmB,GAEnBgP,iBAAkB,GAClB4H,yBAA0B,GAC1BtN,aAAc,CACZe,oBAAoB,GAGtBwM,aAAa,EACbC,iBAAiB,EACjBC,uBAAuB,EACvBC,kBAAkB,EAClBC,gBAAgB,EAEhBC,eAAe,EACfC,iBAAkB,I,EAGpBC,iBAAmB,WACjB,EAAKnf,SAAS,CAAE8e,uBAAuB,IACvCM,IAAwC,SAAAjY,GACtC,IAAIC,EAAsB,GAC1BD,EAAc+N,SAAQ,SAAA5G,GAAY,OAAIlH,EAAoBkH,EAAatM,IAAMsM,KAC7E,EAAKtO,SAAS,CAAEmH,cAAeA,EAAeC,oBAAqBA,EAAqB0X,uBAAuB,Q,EAInHO,WAAa,WACX,EAAKrf,SAAS,CAAE6e,iBAAiB,IACjCtQ,IAA4B,SAAAhH,GAC1B,IAAIC,EAAgB,GACpBD,EAAQ2N,SAAQ,SAAA9G,GAAM,OAAI5G,EAAc4G,EAAOpM,IAAMoM,KACrD,EAAKpO,SAAS,CAAEuH,QAASA,EAASC,cAAeA,EAAeqX,iBAAiB,Q,EAIrFS,UAAY,WACV,EAAKtf,SAAS,CAAEgf,gBAAgB,IAChCO,IAA0B,SAAA5X,GACxB,IAAIC,EAAe,GACnBD,EAAOuN,SAAQ,SAAArK,GAAK,OAAIjD,EAAaiD,EAAM7I,IAAM6I,KACjD,EAAK7K,SAAS,CAAE2H,OAAQA,EAAQC,aAAcA,EAAcoX,gBAAgB,Q,EAIhFjT,mBAAqB,WACnBwC,IAAiC,SAAAiR,GAC/B,IAAIpQ,EAAyB,GAC7BoQ,EAAUtK,SAAQ,SAAA9Q,GAAQ,OAAIgL,EAAuBhL,EAASwC,WAAaxC,KAC3E,EAAKpE,SAAS,CAAEgV,iBAAkBwK,EAAWpQ,uBAAwBA,Q,EAIzEpD,kBAAoB,WAClBuC,GAAgC,EAAK7O,MAAMqX,iBAAkB,EAAKrX,MAAMU,UAAU,SAAAmH,GAChF,IAAI8H,EAAyB,GAC7B9H,EAAQ2N,SAAQ,SAAA9G,GAAM,OAAIiB,EAAuBjB,EAAOxH,WAAawH,KACrE,EAAKpO,SAAS,CAAEye,gBAAiBlX,EAAS8H,uBAAwBA,Q,EAItEgF,kBAAoB,WAClB,EAAK8K,mBACL,EAAKE,aACL,EAAKC,YACL,EAAKvT,qBAEL,IAAM2S,EAAwBpK,aAAY,WACxC,EAAKvI,uBACJ,MACH,EAAK/L,SAAS,CAAE0e,sBAAuBA,K,EAGzCjR,SAAW,SAACD,GAEV,EAAKiS,eAAejS,GAGfA,EAAKzD,MACR4R,GAAwBnO,EAAKxL,IAAI,SAAAwL,GAC/B,EAAKxN,SAAS,CAAEse,aAAc9Q,Q,EAIpCiS,eAAiB,SAACjS,GAAD,OAAU,EAAKxN,SAAS,CAAEse,aAAc9Q,EAAM6Q,kBAAkB,K,EACjFqB,gBAAkB,kBAAM,EAAK1f,SAAS,CAAEqe,kBAAkB,K,EAE1DzJ,SAAW,SAAC4H,GAEV,EAAKmD,eAAenD,GACpBoD,GAAwBpD,EAAKxa,IAAI,SAAAwa,GAC/B,EAAKxc,SAAS,CAAEwe,aAAchC,Q,EAGlCmD,eAAiB,SAACnD,GAAD,OAAU,EAAKxc,SAAS,CAAEwe,aAAchC,EAAM+B,kBAAkB,K,EACjFsB,gBAAkB,kBAAM,EAAK7f,SAAS,CAAEue,kBAAkB,K,EAE1DpP,wBAA0B,SAAC5I,GAAD,OAAqB,EAAKvG,SAAS,CAAEmb,KAAM,QAAS9T,oBAAqB,CAACd,GAAkBkB,cAAe,GAAII,aAAc,M,EACvJ6G,kBAAoB,SAACnI,EAAiBK,GAAlB,OAAgC,EAAK5G,SAAS,CAAEmb,KAAM,QAAS9T,oBAAqB,CAACd,GAAkBkB,cAAe,CAACb,GAAYiB,aAAc,M,EACrKiY,iBAAmB,SAACvZ,EAAiBK,EAAWK,GAA7B,OAA0C,EAAKjH,SAAS,CAAEmb,KAAM,QAAS9T,oBAAqB,CAACd,GAAkBkB,cAAe,CAACb,GAAYiB,aAAc,CAACZ,M,EAC/KS,kBAAoB,kBAAM,EAAK1H,SAAS,CAAEyH,cAAe,GAAII,aAAc,M,EAC3EC,iBAAmB,kBAAM,EAAK9H,SAAS,CAAE6H,aAAc,M,EACvDP,wBAA0B,kBAAM,EAAKtH,SAAS,CAAEqH,oBAAqB,GAAII,cAAe,GAAII,aAAc,M,EAE1GkQ,YAAc,SAACC,EAAWC,GAAZ,OAAyB,EAAKjY,SAAS,CAAEmb,KAAM,MAAO/X,SAAU,CAAC4U,EAAWC,GAAWhF,KAAM,CAAC,IAAKoL,kBAAkB,K,EAEnI0B,YAAc,WACZ,EAAK/f,SAAS,CAAE4e,aAAa,IAC7BoB,IAA6B,SAAA5c,GACH,IAApBA,EAASqG,QACX,EAAKuC,oBACL,EAAKhM,SAAS,CAAE+W,iBAAkB3T,EAAUA,SAAUA,EAAU6P,KAAM,CAAC,IAAK2L,aAAa,MAEzFqB,cAAc,EAAKvgB,MAAMif,0BACzB,EAAK3e,SAAS,CAAES,YAAa,GAAId,SAAU,GAAIoX,iBAAkB,GAAI4H,yBAA0B,KAAMM,eAAe,EAAMC,iBAAkB,0C,EAKlJ7e,YAAc,SAACD,GAAD,OAAc,EAAKJ,SAAS,CAAEI,SAAUA,K,EAEtDO,YAAc,WACZ,EAAKX,SAAS,CAAEL,SAAU,GAAIoI,kBAAmB,GAAIgP,iBAAkB,GAAItW,YAAa,GAAI4G,oBAAqB,GAAII,cAAe,GAAII,aAAc,M,EAIxJnH,eAAiB,SAACf,GAEhB,GAAiB,KAAbA,EAAJ,CAKA,IAAIugB,EAAY,CAAEzf,YAAa,WAAYse,kBAAkB,EAAMpf,SAAUA,EAAU0H,oBAAqB,GAAII,cAAe,GAAII,aAAc,IAGlH,QAA3B,EAAKnI,MAAMe,cACbwf,cAAc,EAAKvgB,MAAMif,0BACzBuB,EAAUvB,yBAA2B,MAIvCqB,GAAsBrgB,GAAU,SAAAwgB,GAC1BA,EAAc/b,UAA8C,IAAlC+b,EAAc/b,SAASqF,QACnDyW,EAAUzf,YAAc,WACxByf,EAAUnJ,iBAAmBoJ,EAAc/b,SAC3C8b,EAAU9c,SAAW+c,EAAc/b,SACnC8b,EAAUjN,KAAO,CAAC,IAClBiN,EAAUnB,kBAAmB,EAC7BmB,EAAUnY,kBAAoBoY,EAAc7C,eAC5C,EAAKtd,SAASkgB,GACd,EAAKlU,qBAEL,EAAKhM,SAAS,CAAEif,eAAe,EAAMC,iBAAkB,0BAA2BnX,kBAAmB,aAxBvG,EAAK/H,SAAS,CAAEif,eAAe,EAAMC,iBAAkB,4BAA6BnX,kBAAmB,M,EA8B3GnH,UAAY,WAEV,GAA+B,QAA3B,EAAKlB,MAAMe,YACbwf,cAAc,EAAKvgB,MAAMif,0BACzB,EAAK3e,SAAS,CAAES,YAAa,GAAId,SAAU,GAAIoX,iBAAkB,GAAI4H,yBAA0B,WAC1F,CACL,IAAIA,EAA2BrK,YAAY,EAAKyL,YAAa,KAC7D,EAAK/f,SAAS,CAAE2e,yBAA0BA,EAA0Ble,YAAa,MAAOd,SAAU,GAAI0H,oBAAqB,GAAII,cAAe,GAAII,aAAc,KAChK,EAAKkY,aAAY,K,EAIrB5O,iBAAmB,SAACiP,GAClB,IAAI/O,EAAe,EAAK3R,MAAM2R,aACxBgP,EAAkB,EAAK3gB,MAAM2R,aAAa+O,GAChD/O,EAAa+O,IAAYC,EACzB,EAAKrgB,SAAS,CAAEqR,aAAcA,K,EAGhCiP,cAAgB,SAACC,EAAOC,GACP,cAAXA,GACJ,EAAKxgB,SAAS,CAAEif,eAAe,K,uDAGvB,IAAD,OACCze,EAAYD,KAAKX,MAAjBY,QACR,OACE,kBAAC,IAAD,CAAkBoC,MAAOA,IACvB,kBAAC,IAAD,KACE,yBAAK/B,UAAWL,EAAQS,MACtB,kBAACwf,EAAA,EAAD,MACA,kBAAC,GAAD,CACEvc,QAAS3D,KAAKb,MAAMmf,iBAAmBte,KAAKb,MAAMof,uBAAyBve,KAAKb,MAAMsf,eACtFrf,SAAUY,KAAKb,MAAMC,SACrBS,SAAUG,KAAKb,MAAMU,SACrBK,YAAaF,KAAKb,MAAMe,YACxBJ,YAAaE,KAAKF,YAClBO,UAAWL,KAAKK,UAChBF,eAAgBH,KAAKG,eACrBC,YAAaJ,KAAKI,cAEpB,kBAAC,IAAD,CAAWqD,SAAS,MAClB,0BAAMnD,UAAWL,EAAQkgB,SACvB,kBAAC,IAAD,CACEC,KAAK,IACLC,OAAK,EACLzG,OAAQ,WACN,OAAQ,kBAAC,GAAD,CACN5S,QAAS,EAAK7H,MAAM6H,QACpBC,cAAe,EAAK9H,MAAM8H,cAC1B4H,uBAAwB,EAAK1P,MAAM0P,uBACnCC,uBAAwB,EAAK3P,MAAM2P,uBACnCjI,oBAAqB,EAAK1H,MAAM0H,oBAChCqG,SAAU,EAAKA,SACfiB,kBAAmB,EAAKA,kBACxBS,wBAAyB,EAAKA,wBAC9BhI,cAAe,EAAKzH,MAAMyH,cAC1BE,oBAAqB,EAAK3H,MAAM2H,oBAChCb,sBAAuB,SAACD,GAAsB,EAAKvG,SAAS,CAAEqH,oBAAqB,CAACd,MACpFe,wBAAyB,EAAKA,wBAC9BG,cAAe,EAAK/H,MAAM+H,cAC1BZ,gBAAiB,SAACD,GAAgB,EAAK5G,SAAS,CAAEyH,cAAe,CAACb,MAClEc,kBAAmB,EAAKA,kBACxBC,OAAQ,EAAKjI,MAAMiI,OACnBC,aAAc,EAAKlI,MAAMkI,aACzBC,aAAc,EAAKnI,MAAMmI,aACzBX,eAAgB,SAACD,GAAe,EAAKjH,SAAS,CAAE6H,aAAc,CAACZ,MAC/Da,iBAAkB,EAAKA,iBACvBnI,SAAU,EAAKD,MAAMC,SACrBoI,kBAAmB,EAAKrI,MAAMqI,kBAC9B3H,SAAU,EAAKV,MAAMU,SACrBK,YAAa,EAAKf,MAAMe,YACxBJ,YAAa,EAAKA,YAClBO,UAAW,EAAKA,UAChBF,eAAgB,EAAKA,eACrBC,YAAa,EAAKA,iBAIxB,kBAAC,IAAD,CACEggB,KAAK,SACLxG,OAAQ,WACN,OACE,kBAAC,GAAD,CACEhT,cAAe,EAAKzH,MAAMyH,cAC1BC,oBAAqB,EAAK1H,MAAM0H,oBAChCC,oBAAqB,EAAK3H,MAAM2H,oBAChCb,sBAAuB,SAACD,GAAsB,EAAKvG,SAAS,CAAEqH,oBAAqB,CAACd,MACpFe,wBAAyB,EAAKA,wBAC9BC,QAAS,EAAK7H,MAAM6H,QACpBC,cAAe,EAAK9H,MAAM8H,cAC1BC,cAAe,EAAK/H,MAAM+H,cAC1BZ,gBAAiB,SAACD,GAAgB,EAAK5G,SAAS,CAAEyH,cAAe,CAACb,MAClEc,kBAAmB,EAAKA,kBACxBC,OAAQ,EAAKjI,MAAMiI,OACnBC,aAAc,EAAKlI,MAAMkI,aACzBC,aAAc,EAAKnI,MAAMmI,aACzBX,eAAgB,SAACD,GAAe,EAAKjH,SAAS,CAAE6H,aAAc,CAACZ,MAC/Da,iBAAkB,EAAKA,iBACvB2F,SAAU,EAAKA,SACfsK,YAAa,EAAKA,YAClBhB,iBAAkB,EAAKrX,MAAMqX,iBAC7BpX,SAAU,EAAKD,MAAMC,SACrBoI,kBAAmB,EAAKrI,MAAMqI,kBAC9B3H,SAAU,EAAKV,MAAMU,SACrBK,YAAa,EAAKf,MAAMe,YACxBJ,YAAa,EAAKA,YAClBO,UAAW,EAAKA,UAChBF,eAAgB,EAAKA,eACrBC,YAAa,EAAKA,iBAI1B,kBAAC,IAAD,CACEggB,KAAK,OACLxG,OAAQ,WACN,OACE,kBAAC,GAAD,CACErF,QAAS,EAAKpV,MAAMoV,QACpBC,WAAY,EAAKrV,MAAMqV,WACvBF,MAAO,EAAKnV,MAAMmV,MAClBzR,SAAU,EAAK1D,MAAM0D,SACrB2T,iBAAkB,EAAKrX,MAAMqX,iBAC7B9D,KAAM,EAAKvT,MAAMuT,KACjBxS,YAAa,EAAKf,MAAMe,YACxB+G,cAAe,EAAK9H,MAAM8H,cAC1BwN,iBAAkB,EAAKtV,MAAMsV,iBAAiBxK,QAAO,SAAAqL,GAAC,OAAe,OAAXA,EAAEE,QAC5D5O,cAAe,EAAKzH,MAAMyH,cAC1BC,oBAAqB,EAAK1H,MAAM0H,oBAChCiK,aAAc,EAAK3R,MAAM2R,aACzBF,iBAAkB,EAAKA,iBACvB1D,SAAU,EAAKA,SACfmH,SAAU,EAAKA,gBAM3B,kBAAC,GAAD,CACEpH,KAAMjN,KAAKb,MAAM4e,aACjBnc,KAAM5B,KAAKb,MAAM2e,iBACjBjN,MAAO,kBAAM,EAAKsO,mBAClB3H,YAAaxX,KAAKwX,cAEpB,kBAAC,GAAD,CACEyE,KAAMjc,KAAKb,MAAM8e,aACjBrc,KAAM5B,KAAKb,MAAM6e,iBACjBnN,MAAO,kBAAM,EAAKyO,qBAEpB,kBAACgB,EAAA,EAAD,CACEC,aAAc,CACZC,SAAU,SACVC,WAAY,QAEd7e,KAAM5B,KAAKb,MAAMuf,cACjBgC,iBAAkB,IAClB5e,QAAS9B,KAAK+f,cACdY,aAAc,CACZ,mBAAoB,cAEtBvU,QAAS,0BAAM3K,GAAG,cAAczB,KAAKb,MAAMwf,kBAC3CiC,OAAQ,CACN,kBAACxf,EAAA,EAAD,CACE8I,IAAI,QACJ2W,aAAW,QACXxf,MAAM,UACNf,UAAWL,EAAQ4Q,MACnBtP,QAASvB,KAAK+f,eAEd,kBAAC,IAAD,iB,GA3WA5d,aA0XHC,gBApYA,SAAAC,GAAK,MAAK,CACvB3B,KAAM,CACJ4B,SAAU,GAEZ6d,QAAS,CACP7d,SAAU,EACVC,QAASF,EAAMI,QAAQ,OA8XZL,CAAmByb,ICrbdhc,QACW,cAA7B+L,OAAO/J,SAASid,UAEe,UAA7BlT,OAAO/J,SAASid,UAEhBlT,OAAO/J,SAASid,SAASC,MACvB,2DCNNC,IAASpH,OAAO,kBAAC,GAAD,MAASqH,SAASC,eAAe,SDqH3C,kBAAmB3E,WACrBA,UAAU4E,cAAcC,MAAMjW,MAAK,SAAAkW,GACjCA,EAAaC,kB","file":"static/js/main.2b514bd2.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Material icons\r\nimport ClearIcon from '@material-ui/icons/ClearTwoTone';\r\nimport LocationSearchingIcon from '@material-ui/icons/LocationSearchingTwoTone';\r\nimport MyLocationIcon from '@material-ui/icons/MyLocationTwoTone';\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone';\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone';\r\n\r\nconst styles = theme => ({\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10\r\n\t},\r\n\tinputRoot: {\r\n\t\tcolor: 'inherit'\r\n\t},\r\n\tinputInput: {\r\n\t\tpaddingTop: theme.spacing(),\r\n\t\tpaddingRight: theme.spacing(),\r\n\t\tpaddingBottom: theme.spacing(),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tsearch: {\r\n\t\tposition: 'relative',\r\n\t\tborder: '1px solid #E0E0E0',\r\n\t\tborderRadius: theme.shape.borderRadius,\r\n\t\tbackgroundColor: fade(theme.palette.common.white, 0.8),\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: fade(theme.palette.common.white, 0.9)\r\n\t\t},\r\n\t\tmarginLeft: 0,\r\n\t\tmarginRight: theme.spacing(),\r\n\t\tdisplay: 'flex',\r\n\t\tmaxWidth: 300\r\n\t}\r\n});\r\n\r\nclass PostcodeSearch extends React.Component {\r\n\tstate = {\r\n\t\tpostcode: this.props.postcode,\r\n\t\tanchor: null\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.postcode !== prevProps.postcode) this.setState({ postcode: this.props.postcode });\r\n\t}\r\n\r\n\topenSettingsMenu = (e) => this.setState({ anchor: e.currentTarget })\r\n\tcloseSettingsMenu = () => this.setState({ anchor: null })\r\n\r\n\tsetSearchDistance = (distance) => {\r\n\t\tthis.closeSettingsMenu();\r\n\t\tthis.props.setDistance(distance);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, search_type, postcodeSearch, clearSearch, toggleGPS } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.search}>\r\n\t\t\t\t<InputBase\r\n\t\t\t\t\tplaceholder=\"Postcode\"\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.inputRoot,\r\n\t\t\t\t\t\tinput: classes.inputInput\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={this.state.postcode}\r\n\t\t\t\t\tonChange={(e) => this.setState({ postcode: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t{search_type === 'postcode' ?\r\n\t\t\t\t\t<Tooltip title={'Clear search'}>\r\n\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\t\tonClick={() => clearSearch()}>\r\n\t\t\t\t\t\t\t<ClearIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<Tooltip title={'Search by postcode'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tonClick={() => postcodeSearch(this.state.postcode)}>\r\n\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Track my location'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor={search_type === 'gps' ? 'primary' : 'secondary'}\r\n\t\t\t\t\t\tonClick={() => { toggleGPS() }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{search_type === 'gps' ? <MyLocationIcon /> : <LocationSearchingIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Change search settings'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\tonClick={(e) => { this.openSettingsMenu(e) }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SettingsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"mnu-settings\"\r\n\t\t\t\t\tanchorEl={this.state.anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.anchor)}\r\n\t\t\t\t\tonClose={() => this.closeSettingsMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ListSubheader disableSticky={true}>Search distance</ListSubheader>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(1609)}>1 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(4827)}>3 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(8045)}>5 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(16090)}>10 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(32180)}>20 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(80450)}>50 miles</MenuItem>\r\n\t\t\t\t</Menu>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPostcodeSearch.propTypes = {\r\n\tclasses: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(PostcodeSearch);","// React\r\nimport React, { Component } from 'react'\r\n\r\n// Other core stuff\r\nimport compose from 'recompose/compose'\r\nimport PropTypes from 'prop-types'\r\nimport { Link, withRouter } from 'react-router-dom'\r\n\r\n// Material UI\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Button from '@material-ui/core/Button'\r\nimport Container from '@material-ui/core/Container'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\n// Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\nimport MapIcon from '@material-ui/icons/MapTwoTone'\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles'\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch'\r\n\r\nconst styles = theme => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1\r\n  },\r\n  appBarTransparent: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)'\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  hide: {\r\n    display: 'none'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  title: {\r\n    margin: theme.spacing(2)\r\n  }\r\n})\r\n\r\nclass AppHeader extends Component {\r\n  render () {\r\n    const { loading, classes, searchType, postcode, distance, toggleGPS, postcodeSearch, clearSearch, setDistance, location } = this.props\r\n    return (\r\n      <>\r\n        <Container maxWidth='lg'>\r\n          <Typography color='textSecondary' variant='h6' component='h1' className={classes.title}>Mobile libraries</Typography>\r\n        </Container>\r\n        <AppBar\r\n          position={(location.pathname === '/map' ? 'fixed' : 'static')}\r\n          color='inherit'\r\n          elevation={0}\r\n          className={(location.pathname === '/map' ? classes.appBarTransparent : classes.appBar)}\r\n        >\r\n          <Container maxWidth='lg'>\r\n            <Toolbar>\r\n              <Hidden smDown>\r\n                <>\r\n                  <Button\r\n                    component={Link} to='/' color={(location.pathname === '/' ? 'primary' : 'secondary')} size='large'\r\n                    onClick={() => { }}\r\n                  >\r\n                    <DirectionBusIcon className={classes.leftIcon} />Mobile vans\r\n                  </Button>\r\n                  <Button\r\n                    component={Link} to='/stops' color={(location.pathname === '/stops' ? 'primary' : 'secondary')} size='large'\r\n                    onClick={() => { }}\r\n                  >\r\n                    <LocationOnIcon className={classes.leftIcon} />Stop locations\r\n                  </Button>\r\n                  <Button\r\n                    component={Link} to='/map' color={(location.pathname === '/map' ? 'primary' : 'secondary')} size='large'\r\n                    onClick={() => { }}\r\n                  >\r\n                    <MapIcon className={classes.leftIcon} />Map\r\n                  </Button>\r\n                </>\r\n              </Hidden>\r\n              <Hidden mdUp>\r\n                <>\r\n                  <IconButton component={Link} to='/' onClick={() => { }}>\r\n                    <DirectionBusIcon />\r\n                  </IconButton>\r\n                  <IconButton component={Link} to='/stops' onClick={() => { }}>\r\n                    <LocationOnIcon />\r\n                  </IconButton>\r\n                  <IconButton component={Link} to='/map' onClick={() => { }}>\r\n                    <MapIcon />\r\n                  </IconButton>\r\n                </>\r\n              </Hidden>\r\n              {location.pathname === '/map'\r\n                ? <PostcodeSearch\r\n                  postcode={postcode}\r\n                  distance={distance}\r\n                  searchType={searchType}\r\n                  toggleGPS={toggleGPS}\r\n                  setDistance={setDistance}\r\n                  postcodeSearch={postcodeSearch}\r\n                  clearSearch={clearSearch}\n                /> : null}\r\n              {loading ? <CircularProgress className={classes.progress} color='secondary' size={30} /> : null}\r\n            </Toolbar>\r\n          </Container>\r\n        </AppBar>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nAppHeader.propTypes = {\r\n  classes: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withRouter, withStyles(styles, { withTheme: true }))(AppHeader)\r\n","// React\r\nimport React, { Component } from 'react';\r\n\r\n// Other core stuff\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport { Alert, AlertTitle } from '@material-ui/lab';\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport BusinessIcon from '@material-ui/icons/BusinessTwoTone';\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone';\r\nimport DirectionsIcon from '@material-ui/icons/DirectionsTwoTone';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = (theme) => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(1.2)'\r\n\t},\r\n\tcard: {\r\n\t\tposition: 'relative',\r\n\t\tminWidth: 275\r\n\t},\r\n\tgrid: {\r\n\t\tmarginBottom: 10\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t}\r\n});\r\n\r\nclass Filters extends Component {\r\n\r\n\tstate = {\r\n\t\torganisation_menu_anchor: null,\r\n\t\tmobile_menu_anchor: null,\r\n\t\troute_menu_anchor: null\r\n\t};\r\n\r\n\topenOrganisationMenu = (element) => {\r\n\t\tthis.setState({ organisation_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseOrganisationMenu = () => {\r\n\t\tthis.setState({ organisation_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseOrganisation = (organisation_id) => {\r\n\t\tthis.props.clearSearch();\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.closeOrganisationMenu();\r\n\t}\r\n\r\n\topenMobileMenu = (element) => {\r\n\t\tthis.setState({ mobile_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseMobileMenu = () => {\r\n\t\tthis.setState({ mobile_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseMobile = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.closeMobileMenu();\r\n\t}\r\n\r\n\topenRouteMenu = (element) => {\r\n\t\tthis.setState({ route_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseRouteMenu = () => {\r\n\t\tthis.setState({ route_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseRoute = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.closeRouteMenu();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter,\r\n\t\t\tclearOrganisationFilter, mobiles, mobile_lookup, mobile_filter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, postcode_district, distance, toggleGPS, postcodeSearch, clearSearch, setDistance\r\n\t\t} = this.props;\r\n\t\tconst bull = <span className={classes.bullet}></span>;\r\n\t\tconst countries = new Set(organisations.map(org => org.country));\r\n\r\n\t\treturn (\r\n\t\t\t<Grid className={classes.grid} container spacing={3}>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t<Alert severity=\"warning\">\r\n\t\t\t\t\t<AlertTitle>Work in progress</AlertTitle>\r\n\t\t\t\t\tWhile this site is being developed you may see unexpected behaviour.\r\n\t\t\t\t</Alert>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{'Search radius: ' + Math.round(distance / 1609) + ' mile'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{'GPS tracking ' + (search_type === 'gps' ? 'on' : 'off')}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\" gutterBottom>Search by location</Typography>\r\n\t\t\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{postcode_district !== '' ?\r\n\t\t\t\t\t\t\t\t<Typography variant=\"caption\" display=\"block\">{'Searching around ' + postcode_district + '.'}</Typography>\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{organisations.length + ' library services'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{mobiles.length + ' mobile libraries'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{routes.length + ' routes'}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">Search by service</Typography>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t\t{organisation_filter.length === 0 ? <Tooltip title=\"Choose library service\">\r\n\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openOrganisationMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t<BusinessIcon className={classes.leftIcon} />Service\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={clearOrganisationFilter} label={organisation_lookup[organisation_filter[0]].name} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{organisation_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(mobile_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose mobile library\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openMobileMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionBusIcon className={classes.leftIcon} />Mobile\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearMobileFilter()} label={mobile_lookup[mobile_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t\t{mobile_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(route_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose route\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openRouteMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionsIcon className={classes.leftIcon} />Route\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearRouteFilter()} label={route_lookup[route_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardActions>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-library-service\"\r\n\t\t\t\t\tanchorEl={this.state.organisation_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.organisation_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeOrganisationMenu()}\r\n\t\t\t\t>\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tArray.from(countries)\r\n\t\t\t\t\t\t\t.sort((a, b) => a.localeCompare(b))\r\n\t\t\t\t\t\t\t.map(country => {\r\n\t\t\t\t\t\t\t\tlet menu_items = [<ListSubheader disableSticky={true}>{country}</ListSubheader>];\r\n\t\t\t\t\t\t\t\tconst org_list = organisations\r\n\t\t\t\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t\t\t\t.filter(org => org.country === country)\r\n\t\t\t\t\t\t\t\t\t.map(org => {\r\n\t\t\t\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => this.chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\treturn menu_items.concat(org_list);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-mobile-library\"\r\n\t\t\t\t\tanchorEl={this.state.mobile_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.mobile_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeMobileMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(mob => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => this.chooseMobile(mob.id)}>{mob.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-route\"\r\n\t\t\t\t\tanchorEl={this.state.route_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.route_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeRouteMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{routes\r\n\t\t\t\t\t\t.filter(route => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(route.mobile_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => this.chooseRoute(route.id)}>{route.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nFilters.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Filters);","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\n// Moment for time calculations\r\nimport moment from 'moment'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getAllMobiles (callback) {\r\n  axios.get(config.api + '/mobiles')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n}\r\n\r\nexport function getMobileLocations (callback) {\r\n  axios.get(config.api + '/mobiles/locations')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n}\r\n\r\nexport function getMobilesNearest (location, distance, callback) {\r\n  axios.get(config.api + '/mobiles/nearest?longitude=' + location[0] + '&latitude=' + location[1] + '&distance=' + distance)\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n}\r\n\r\nexport function getMobileStatus (location) {\n  const statuses = {\r\n    off_road: {\r\n      label: 'Not out today'\r\n    },\r\n    pre_route: {\r\n      label: 'Arriving at '\r\n    },\r\n    at_stop: {\r\n      label: 'At '\r\n    },\r\n    between_stops: {\r\n      label: 'Arriving at '\r\n    },\r\n    post_route: {\r\n      label: 'Finished for the day'\r\n    }\r\n  }\r\n\r\n  // The mobile is not due out today\r\n  if (location && !location.current_stop_id &&\r\n        !location.previous_stop_id && location.next_stop_id &&\r\n        !moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n    return {\r\n      type: 'off_road',\r\n      text_format: statuses.off_road.label,\r\n      message: statuses.off_road.label\r\n    }\r\n  }\r\n\r\n  // The mobile is due out today\r\n  if (location && !location.current_stop_id &&\r\n        !location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n    const arrival = moment(location.next_stop_arrival).fromNow()\r\n    return {\r\n      type: 'pre_route',\r\n      message: statuses.pre_route.label,\r\n      text_format: statuses.pre_route.label + location.next_stop_name + ' ' + arrival,\r\n      args: [\r\n        { stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n        arrival\r\n      ]\r\n    }\r\n  }\r\n\r\n  // The mobile is at a stop, and will be for a certain amount of time\r\n  if (location && location.current_stop_id) {\r\n    const stop_remaining = moment(location.current_stop_departure).fromNow(true)\r\n    return {\r\n      type: 'at_stop',\r\n      message: statuses.at_stop.label,\r\n      text_format: statuses.at_stop.label + location.current_stop_name + ' for ' + stop_remaining,\r\n      args: [\r\n        { stop_name: location.current_stop_name, stop_id: location.current_stop_id },\r\n        stop_remaining\r\n      ]\r\n    }\r\n  }\r\n\r\n  // The mobile is between stops\r\n  if (location && !location.current_stop_id &&\r\n        location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n        moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n    const arrival = moment(location.next_stop_arrival).fromNow()\r\n    return {\r\n      type: 'between_stops',\r\n      message: statuses.between_stops.label,\r\n      text_format: statuses.between_stops.label + location.next_stop_name + ' ' + arrival,\r\n      args: [\r\n        { stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n        arrival\r\n      ]\r\n    }\n  }\r\n\r\n  // The mobile has finished for the day\r\n  if (location &&\r\n        location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n        !moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n    return {\r\n      type: 'post_route',\r\n      message: statuses.post_route.label,\r\n      text_format: statuses.post_route.label\r\n    }\n  }\r\n\r\n  return null\r\n}\n","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// MUI Icons\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone';\r\nimport WebIcon from '@material-ui/icons/WebTwoTone';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(1.2)'\r\n\t},\r\n\tcard: {\r\n\t\tminWidth: 275\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500,\r\n\t\talign: 'right'\r\n\t},\r\n\tverticalDivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(2)\r\n\t}\r\n});\r\n\r\nclass MobileCard extends Component {\r\n\r\n\tstopButton = (stop) => {\r\n\t\treturn <Button color=\"secondary\" onClick={() => this.props.viewStop({ id: stop.stop_id })}>{stop.stop_name}</Button>\r\n\t}\r\n\r\n\toffRoadMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\tpreRouteMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tatStopMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{' for ' + status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tbetweenStopsMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tpostRouteMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\tgoToWebsite = () => window.open(this.props.mobile.timetable, '_blank');\r\n\r\n\trender() {\r\n\t\tconst { classes, mobile, organisation, location } = this.props;\r\n\t\tlet status = mobilesHelper.getMobileStatus(location);\r\n\t\tif (status && status.type === 'off_road') status = this.offRoadMessage(status);\r\n\t\tif (status && status.type === 'pre_route') status = this.preRouteMessage(status);\r\n\t\tif (status && status.type === 'at_stop') status = this.atStopMessage(status);\r\n\t\tif (status && status.type === 'between_stops') status = this.betweenStopsMessage(status);\r\n\t\tif (status && status.type === 'post_route') status = this.postRouteMessage(status);\r\n\t\tif (!status) status = <CircularProgress className={classes.progress} color=\"secondary\" size={30} />\r\n\t\tconst bull = <span className={classes.bullet}></span>;\r\n\t\treturn (\r\n\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t{mobile.number_routes + ' route' + (mobile.number_routes > 1 ? 's' : '')}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_stops + ' stop' + (mobile.number_stops > 1 ? 's' : '')}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n\t\t\t\t\t{status}\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<Tooltip title=\"Mobile library stops\">\r\n\t\t\t\t\t\t<Button component={Link} to=\"/stops\" size=\"small\" color=\"primary\" className={classes.button} onClick={() => this.props.viewStopsByMobile(organisation.id, mobile.id)}>\r\n\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t\t{mobile.timetable ? <Tooltip title=\"Website timetable\">\r\n\t\t\t\t\t\t<IconButton className={classes.button} onClick={() => this.goToWebsite()}>\r\n\t\t\t\t\t\t\t<WebIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip> : null}\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileCard.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileCard);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Badge from '@material-ui/core/Badge';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\nimport MobileCard from './MobileCard';\r\n\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = (theme) => ({\r\n\tchip: {\r\n\t\tmargin: theme.spacing(1),\r\n\t},\r\n\tpadding: {\r\n\t\tpadding: theme.spacing(0, 2)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t}\r\n});\r\n\r\nclass Mobiles extends Component {\r\n\tstate = {\r\n\t\topen_tab: 0\r\n\t};\r\n\r\n\tchangeTab = (value) => {\r\n\t\tthis.setState({ open_tab: value });\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, organisations, organisation_lookup, organisation_filter, setOrganisationFilter, clearOrganisationFilter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_location_lookup, mobiles_nearest_lookup, mobile_filter, setMobileFilter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, setRouteFilter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, postcode_district, distance, toggleGPS, postcodeSearch, clearSearch, setDistance } = this.props;\r\n\r\n\t\t// Get all mobiles that are currently filtered\r\n\t\tconst filtered_mobiles = mobiles.filter(mob => {\r\n\t\t\tlet display = true;\r\n\t\t\tif (search_type === 'gps' || search_type === 'postcode') {\r\n\t\t\t\tdisplay = mobiles_nearest_lookup[mob.id];\r\n\t\t\t}\r\n\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\tdisplay = false;\r\n\t\t\t}\r\n\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\tdisplay = false;\r\n\t\t\t}\r\n\t\t\treturn display;\r\n\t\t});\r\n\t\t// Then get those that are currently active\r\n\t\tconst active_mobiles = filtered_mobiles.filter(mob => {\r\n\t\t\tconst status = mobilesHelper.getMobileStatus(mobile_location_lookup[mob.id]);\r\n\t\t\treturn (status && status.type !== 'off_road' && status.type !== 'post_route');\r\n\t\t});\r\n\r\n\t\t// Apply filters\r\n\t\tconst display_mobiles = (this.state.open_tab === 0 ? active_mobiles : filtered_mobiles);\r\n\r\n\t\t// Calculate title\r\n\t\tconst organisation_name = (organisation_filter.length > 0 ? organisation_lookup[organisation_filter[0]].name : '');\r\n\t\tconst mobile_name = (mobile_filter.length > 0 ? mobile_lookup[mobile_filter[0]].name : '');\r\n\t\tconst route_name = (route_filter.length > 0 ? route_lookup[route_filter[0]].name : '');\r\n\t\tlet title = 'Mobile vans';\r\n\t\t// Filter stops\r\n\t\tif (organisation_name !== '') title = 'Mobiles in ' + organisation_name;\r\n\t\tif (mobile_name !== '') title = organisation_name + ' ' + mobile_name;\r\n\t\tif (route_name !== '') title = organisation_name + ' ' + route_name;\r\n\t\t// Postcode search stops\r\n\t\tif (postcode !== '') title = 'Mobiles with stops within ' + Math.round(distance / 1609) + ' mile(s) of ' + postcode;\r\n\t\t// GPS search stops\r\n\t\tif (search_type === 'gps') title = 'Mobiles with stops within ' + Math.round(distance / 1609) + ' mile(s) of your location';\r\n\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={true}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tpostcode_district={postcode_district}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>{title}</ListSubheader>\r\n\t\t\t\t<Tabs\r\n\t\t\t\t\tvariant=\"standard\"\r\n\t\t\t\t\tscrollButtons=\"off\"\r\n\t\t\t\t\tvalue={this.state.open_tab}\r\n\t\t\t\t\tindicatorColor=\"secondary\"\r\n\t\t\t\t\ttextColor=\"secondary\"\r\n\t\t\t\t\tonChange={(e, value) => this.changeTab(value)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tclassName={classes.tab}\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\tclassName={classes.padding}\r\n\t\t\t\t\t\t\t\tcolor={\"secondary\"}\r\n\t\t\t\t\t\t\t\tbadgeContent={active_mobiles.length}>\r\n\t\t\t\t\t\t\t\tOut today\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\tshowZero\r\n\t\t\t\t\t\t\t\tclassName={classes.padding}\r\n\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\tbadgeContent={filtered_mobiles.length}>\r\n\t\t\t\t\t\t\t\tAll vans\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Tabs>\r\n\t\t\t\t<br />\r\n\t\t\t\t{mobiles ?\r\n\t\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t\t{display_mobiles\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tif (search_type === 'gps' || search_type === 'postcode') {\r\n\t\t\t\t\t\t\t\t\treturn mobiles_nearest_lookup[mob.id];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((mobile, idx) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\t\t\t\tkey={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n\t\t\t\t\t\t\t\t\t\titem xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t\t\t\t\t\t<MobileCard\r\n\t\t\t\t\t\t\t\t\t\t\tmobile={mobile}\r\n\t\t\t\t\t\t\t\t\t\t\tlocation={mobile_location_lookup[mobile.id]}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation={organisation_lookup[mobile.organisation_id]}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStop={this.props.viewStop}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.props.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t</Grid> :\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<LinearProgress color=\"secondary\" />\r\n\t\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobiles.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(Mobiles);","// React and additional\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Icons\r\nimport Face from '@material-ui/icons/FaceTwoTone';\r\n\r\nconst styles = theme => ({\r\n    avatar: {\r\n        margin: 0\r\n    },\r\n    avatarOn: {\r\n        margin: 0,\r\n        cursor: 'pointer',\r\n        backgroundColor: theme.palette.primary.main\r\n    }\r\n});\r\n\r\nclass MeAvatar extends React.Component {\r\n    state = {\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        return (\r\n            <Tooltip title={'Me'}>\r\n                <Avatar\r\n                    className={this.props.search_type === 'gps' ? classes.avatarOn : classes.avatar}>\r\n                    <Face />\r\n                </Avatar>\r\n            </Tooltip>\r\n        );\r\n    }\r\n}\r\n\r\nMeAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(MeAvatar);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Switch from '@material-ui/core/Switch';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n    dialog: {\r\n        border: '1px solid #E0E0E0'\r\n    }\r\n});\r\n\r\nclass MapSettings extends React.Component {\r\n    state = {}\r\n\r\n    handleAuthorityBoundaryChange = () => {\r\n        this.props.toggleMapSetting('authority_boundary');\r\n    }\r\n\r\n    close = () => this.props.close()\r\n\r\n    render() {\r\n        const { classes, width, map_settings } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                BackdropProps={{\r\n                    invisible: true\r\n                }}\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                <DialogTitle>Map settings</DialogTitle>\r\n                <DialogContent>\r\n                    <FormControlLabel\r\n                        control={\r\n                            <Switch\r\n                                checked={map_settings.authority_boundary}\r\n                                onChange={this.handleAuthorityBoundaryChange}\r\n                                name=\"sw_authority_boundary\"\r\n                                color=\"primary\"\r\n                            />\r\n                        }\r\n                        label=\"Authority boundaries\"\r\n                    />\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nMapSettings.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(MapSettings);","export function hextoRGBA (hex, alpha) {\r\n  var c\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('')\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]]\r\n    }\r\n    c = '0x' + c.join('')\r\n    return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ', ' + alpha + ')'\r\n  }\r\n  throw new Error('Bad Hex')\r\n}\r\n","// React\r\nimport React, { Component } from 'react'\r\nimport PropTypes from 'prop-types'\r\n\r\n// Material UI\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\n// MUI Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles'\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles'\r\nimport * as utilsHelper from './helpers/utils'\r\n\r\nconst styles = theme => ({\r\n  fab: {\r\n    margin: theme.spacing(1),\r\n    boxShadow: 'none'\r\n  }\r\n})\r\n\r\nclass MobileAvatar extends Component {\n  render () {\r\n    const { classes, location, organisation, zoom } = this.props\r\n    const status = mobilesHelper.getMobileStatus(location)\r\n    const size = (zoom < 8 ? 'small' : (zoom < 12 ? 'medium' : 'large'))\r\n    const border = (zoom < 8 ? 2 : (zoom < 12 ? 3 : 4))\r\n    return (\r\n      <Tooltip\r\n        title={(status ? status.text_format : '')}\n      >\r\n        <Fab\r\n          size={size}\r\n          className={classes.fab}\r\n          color='primary'\r\n          style={{\r\n            backgroundColor: utilsHelper.hextoRGBA(organisation.colour, 0.8),\r\n            border: (border + 'px solid #FFFFFF')\r\n          }}\n        >\r\n          <DirectionBusIcon />\r\n        </Fab>\r\n      </Tooltip>\r\n    )\r\n  }\r\n}\r\n\r\nMobileAvatar.propTypes = {\r\n  classes: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileAvatar)\n","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Mapbox GL\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from \"react-mapbox-gl\";\r\n\r\n// Our components\r\nimport MeAvatar from './MeAvatar';\r\nimport MapSettings from './MapSettings';\r\nimport MobileAvatar from './MobileAvatar';\r\n\r\n// Mui Icons\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// lab\r\nimport SpeedDial from '@material-ui/lab/SpeedDial';\r\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction';\r\n\r\nimport moment from 'moment';\r\n\r\nconst styles = theme => ({\r\n  settingsDial: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4),\r\n  }\r\n});\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst Map = ReactMapboxGl({\r\n  minZoom: 5,\r\n  maxZoom: 18,\r\n  customAttribution: 'Contains public sector information licensed under the Open Government Licence'\r\n});\r\n\r\nconst stop_tiles = [config.stop_tiles];\r\nconst trip_tiles = [config.trip_tiles];\r\nconst library_authority_tiles = [config.library_authority_tiles];\r\n\r\nclass MobileMap extends Component {\r\n\r\n  state = {\r\n    time_update_interval: null,\r\n    current_time: null,\r\n    map: null,\r\n    settings_dial_open: false,\r\n    settings_dialog_open: false\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    // Set up interval to provide a date every 500 milliseconds\r\n    let time_update_interval = setInterval(this.setCurrentTime, 500);\r\n    this.setState({ time_update_interval: time_update_interval });\r\n  }\r\n\r\n  clickStop = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      this.props.viewStop({ id: map.features[0].properties.id });\r\n    }\r\n  }\r\n\r\n  clickTrip = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      this.props.viewTrip(map.features[0].properties);\r\n    }\r\n  }\r\n\r\n  setCurrentTime = () => this.setState({ current_time: moment() });\r\n\r\n  render() {\r\n    const { classes, position, zoom, pitch, bearing, fit_bounds, map_settings, mobile_locations, mobile_lookup, organisations, organisation_lookup, toggleMapSetting } = this.props;\r\n\r\n    // Build the colour match\r\n    let organisation_colour_match = ['match', ['get', 'utla19cd']]\r\n    organisations.forEach(org => {\r\n      organisation_colour_match.push(org.code);\r\n      organisation_colour_match.push(org.colour);\r\n    });\r\n    organisation_colour_match.push('#a7a39b');\r\n\r\n    return (\r\n      <React.Fragment>\r\n        <Map\r\n          style='style.json'  // eslint-disable-line react/style-prop-object\r\n          center={position}\r\n          zoom={zoom}\r\n          maxZoom={17}\r\n          pitch={pitch}\r\n          bearing={bearing}\r\n          fitBounds={fit_bounds}\r\n          containerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n          onStyleLoad={map => this.setState({ map: map })}\r\n        >\r\n          { // The mobile library locations\r\n            mobile_locations && mobile_locations.length > 0 ?\r\n              mobile_locations.map(l => {\r\n                let location_point = [l.geox, l.geoy];\r\n                if (this.state.current_time && l.route_section && l.route_section.coordinates && l.updated) {\r\n                  const milliseconds_passed = moment(this.state.current_time).diff(l.updated);\r\n                  const index = Math.round(milliseconds_passed / 500);\r\n                  const coords = l.route_section.coordinates;\r\n                  if (coords.length > index && index > 0) location_point = coords[index];\r\n                  if (coords.length <= index && index > 0) location_point = coords[coords.length - 1];\r\n                }\r\n                const mobile = mobile_lookup[l.mobile_id];\r\n                const organisation = (mobile ? organisation_lookup[mobile.organisation_id] : null);\r\n                return <Marker\r\n                  key={'mkr_' + l.id}\r\n                  coordinates={location_point}\r\n                  anchor=\"bottom\">\r\n                  <MobileAvatar\r\n                    organisation={organisation}\r\n                    location={l}\r\n                    zoom={this.state.map ? this.state.map.getZoom() : 0}\r\n                  />\r\n                </Marker>\r\n              }) : null\r\n          }\r\n          <Source\r\n            id='src_stops'\r\n            tileJsonSource={{\r\n              type: 'vector',\r\n              tiles: stop_tiles\r\n            }} />\r\n          <Source\r\n            id='src_trips'\r\n            tileJsonSource={{\r\n              type: 'vector',\r\n              tiles: trip_tiles\r\n            }} />\r\n          <Source\r\n            id='src_library_authorities'\r\n            tileJsonSource={{\r\n              type: 'vector',\r\n              tiles: library_authority_tiles\r\n            }} />\r\n          <Layer\r\n            id='lyr_trips_lines'\r\n            type='line'\r\n            sourceId='src_trips'\r\n            sourceLayer='trip'\r\n            minZoom={13}\r\n            layout={{\r\n              \"line-join\": \"round\",\r\n              \"line-cap\": \"square\"\r\n            }}\r\n            paint={{\r\n              \"line-color\": \"#a7a39b\",\r\n              \"line-offset\": [\r\n                \"interpolate\",\r\n                [\r\n                  \"linear\"\r\n                ],\r\n                [\r\n                  \"zoom\"\r\n                ],\r\n                13, 0.5,\r\n                14, 1,\r\n                15, 2,\r\n                16, 3,\r\n                18, 10,\r\n                22, 20\r\n              ],\r\n              \"line-opacity\": 1,\r\n              \"line-width\": [\r\n                \"interpolate\",\r\n                [\r\n                  \"linear\"\r\n                ],\r\n                [\r\n                  \"zoom\"\r\n                ],\r\n                13, 0.5,\r\n                14, 1,\r\n                15, 2,\r\n                16, 3,\r\n                18, 10,\r\n                22, 20\r\n              ],\r\n              \"line-dasharray\": [\r\n                2,\r\n                0.5\r\n              ]\r\n            }}\r\n            onClick={this.clickTrip}\r\n          />\r\n          <Layer\r\n            id='lyr_stops_circles'\r\n            type='circle'\r\n            sourceId='src_stops'\r\n            sourceLayer='stop'\r\n            minZoom={5}\r\n            layout={{}}\r\n            paint={{\r\n              'circle-radius': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['zoom'],\r\n                5, 2,\r\n                17, 12\r\n              ],\r\n              'circle-color': ['get', 'organisation_colour'],\r\n              'circle-stroke-width': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['zoom'],\r\n                5, 1,\r\n                17, 4\r\n              ],\r\n              'circle-stroke-color': '#FFFFFF',\r\n              'circle-opacity': 0.7\r\n            }}\r\n            onClick={this.clickStop}\r\n          />\r\n          <Layer\r\n            id='lyr_stops_labels'\r\n            type='symbol'\r\n            sourceId='src_stops'\r\n            sourceLayer='stop'\r\n            minZoom={13}\r\n            layout={{\r\n              'text-ignore-placement': false,\r\n              'text-field': ['to-string', ['get', 'name']],\r\n              \"text-font\": [\r\n                \"Source Sans Pro Bold\"\r\n              ],\r\n              \"text-line-height\": 1,\r\n              \"text-size\": [\r\n                \"interpolate\",\r\n                [\r\n                  \"linear\"\r\n                ],\r\n                [\r\n                  \"zoom\"\r\n                ],\r\n                13, 12,\r\n                17, 22\r\n              ],\r\n              \"text-offset\": [0, 2],\r\n            }}\r\n            paint={{\r\n              \"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n              \"text-halo-width\": 1,\r\n              \"text-halo-blur\": 1,\r\n              \"text-color\": \"#6a6f73\"\r\n            }}\r\n            onClick={this.clickStop}\r\n          />\r\n          <Layer\r\n            id='lyr_stops_next_visiting'\r\n            type='symbol'\r\n            sourceId='src_stops'\r\n            sourceLayer='stop'\r\n            minZoom={13}\r\n            layout={{\r\n              'text-ignore-placement': false,\r\n              'text-field': ['to-string', ['get', 'next_visiting']],\r\n              \"text-font\": [\r\n                \"Source Sans Pro Bold\"\r\n              ],\r\n              \"text-line-height\": 1,\r\n              \"text-size\": [\r\n                \"interpolate\",\r\n                [\r\n                  \"linear\"\r\n                ],\r\n                [\r\n                  \"zoom\"\r\n                ],\r\n                13, 10,\r\n                17, 16\r\n              ],\r\n              \"text-offset\": [0, -2.8],\r\n            }}\r\n            paint={{\r\n              \"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n              \"text-halo-width\": 1,\r\n              \"text-halo-blur\": 1,\r\n              \"text-color\": \"#6a6f73\"\r\n            }}\r\n            onClick={this.clickStop}\r\n          />\r\n          {map_settings.authority_boundary ?\r\n            <React.Fragment>\r\n              <Layer\r\n                id='lyr_library_authorities_lines'\r\n                type='line'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                layout={{\r\n                  \"line-join\": \"round\",\r\n                  \"line-cap\": \"square\"\r\n                }}\r\n                paint={{\r\n                  \"line-color\": \"#a7a39b\",\r\n                  \"line-opacity\": 1,\r\n                  \"line-width\": [\r\n                    \"interpolate\",\r\n                    [\r\n                      \"linear\"\r\n                    ],\r\n                    [\r\n                      \"zoom\"\r\n                    ],\r\n                    6, 1,\r\n                    22, 4\r\n                  ]\r\n                }}\r\n              />\r\n              <Layer\r\n                id='lyr_library_authorities_fill'\r\n                type='fill'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                paint={{\r\n                  'fill-color': organisation_colour_match,\r\n                  'fill-opacity': 0.1\r\n                }}\r\n              />\r\n            </React.Fragment>\r\n            : null}\r\n          {this.props.current_position && this.props.current_position.length > 1 ?\r\n            <Marker\r\n              key={'mk_me'}\r\n              coordinates={[this.props.current_position[0], this.props.current_position[1]]}>\r\n              <MeAvatar search_type={this.props.search_type} />\r\n            </Marker>\r\n            : null}\r\n          <ZoomControl position=\"bottom-left\" />\r\n        </Map>\r\n        <SpeedDial\r\n          ariaLabel=\"Settings\"\r\n          FabProps={{\r\n            size: \"small\"\r\n          }}\r\n          className={classes.settingsDial}\r\n          icon={<SettingsIcon />}\r\n          onClose={() => this.setState({ settings_dial_open: false })}\r\n          onOpen={() => this.setState({ settings_dial_open: true })}\r\n          open={this.state.settings_dial_open}\r\n          direction={'left'}\r\n        >\r\n          <SpeedDialAction\r\n            key={'act_more'}\r\n            icon={<MoreVertIcon />}\r\n            tooltipTitle={'More settings'}\r\n            onClick={() => this.setState({ settings_dialog_open: true, settings_dial_open: false })}\r\n          />\r\n        </SpeedDial>\r\n        <MapSettings\r\n          map_settings={map_settings}\r\n          open={this.state.settings_dialog_open}\r\n          toggleMapSetting={toggleMapSetting}\r\n          close={() => this.setState({ settings_dialog_open: false, settings_dial_open: false })}\r\n        />\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nMobileMap.propTypes = {\r\n  current_position: PropTypes.array\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileMap);","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getQueryStops (query, organisation_filters, mobile_filters, route_filters, current_position, distance, callback) {\r\n  let url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (mobile_filters.length > 0) url = url + '&mobile_ids=' + mobile_filters.join('|')\r\n  if (organisation_filters.length > 0) url = url + '&organisation_ids=' + organisation_filters.join('|')\r\n  if (route_filters.length > 0) url = url + '&route_ids=' + route_filters.join('|')\r\n\r\n  if (current_position && current_position.length > 1) url = url + '&longitude=' + current_position[0] + '&latitude=' + current_position[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  axios.get(url)\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback({\r\n          stops: response.data,\r\n          total: parseInt(response.headers['x-total-count']),\r\n          page: parseInt(response.headers['x-page'])\r\n        })\r\n      } else {\r\n        callback({ stops: [], total: 0, page: 1 })\r\n      }\r\n    })\r\n    .catch(() => callback({ stops: [], total: 0, page: 1 }))\r\n}\r\n\r\nexport function getAllStops (callback) {\r\n  axios.get(config.api + '/stops')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback({})\r\n      }\r\n    })\r\n    .catch(err => callback({}))\r\n}\r\n\r\nexport function getStopById (id, callback) {\r\n  axios.get(config.api + '/stops/' + id)\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback({})\r\n      }\r\n    })\r\n    .catch(() => callback({}))\r\n}\r\n","// React\r\nimport compose from 'recompose/compose';\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport withWidth, { isWidthUp, isWidthDown } from '@material-ui/core/withWidth';\r\n\r\n// Material Table\r\nimport MaterialTable from 'material-table';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpwardTwoTone';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeftTwoTone';\r\nimport ChevronRight from '@material-ui/icons/ChevronRightTwoTone';\r\nimport FirstPage from '@material-ui/icons/FirstPageTwoTone';\r\nimport FilterList from '@material-ui/icons/FilterListTwoTone';\r\nimport LastPage from '@material-ui/icons/LastPageTwoTone';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone';\r\nimport OpenInBrowserIcon from '@material-ui/icons/OpenInBrowserTwoTone';\r\nimport EventIcon from '@material-ui/icons/EventTwoTone';\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\n// Our Helpers\r\nimport * as stopsHelper from './helpers/stops';\r\nimport { Tooltip } from '@material-ui/core';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = (theme) => ({\r\n\tformControl: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tminWidth: 200\r\n\t},\r\n\tmargin: {\r\n\t\tmargin: theme.spacing(1)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t\tmaxWidth: '100%'\r\n\t},\r\n\ttable: {\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0)',\r\n\t\tborder: '1px solid #E0E0E0'\r\n\t}\r\n});\r\n\r\nclass Stops extends Component {\r\n\r\n\ttableRef = React.createRef();\r\n\r\n\tgetStopCalendar = (stop) => window.open(config.api + '/stops/' + stop.id + '/ics');\r\n\tgetStopPdf = (stop) => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank');\r\n\tviewMapStop = (stop) => this.props.viewMapStop(stop.longitude, stop.latitude);\r\n\tgoToWebsite = (stop) => window.open(stop.timetable, '_blank');\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.current_position !== prevProps.current_position || this.props.distance !== prevProps.distance) this.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetOrganisationFilter = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearOrganisationFilter = () => {\r\n\t\tthis.props.clearOrganisationFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetMobileFilter = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearMobileFilter = () => {\r\n\t\tthis.props.clearMobileFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetRouteFilter = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearRouteFilter = () => {\r\n\t\tthis.props.clearRouteFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tdisplayStopInfo = (row) => this.props.viewStop(row);\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_filter,\r\n\t\t\troutes, route_lookup, route_filter, current_position, distance, width,\r\n\t\t\tsearch_type, postcode, postcode_district, toggleGPS, postcodeSearch, clearSearch, setDistance } = this.props;\r\n\r\n\t\t// Calculate title\r\n\t\tconst organisation_name = (organisation_filter.length > 0 ? organisation_lookup[organisation_filter[0]].name : '');\r\n\t\tconst mobile_name = (mobile_filter.length > 0 ? mobile_lookup[mobile_filter[0]].name : '');\r\n\t\tconst route_name = (route_filter.length > 0 ? route_lookup[route_filter[0]].name : '');\r\n\t\tlet title = 'All stops';\r\n\t\t// Filter stops\r\n\t\tif (organisation_name !== '') title = 'Stops in ' + organisation_name;\r\n\t\tif (mobile_name !== '') title = 'Stops for ' + organisation_name + ' ' + mobile_name;\r\n\t\tif (route_name !== '') title = 'Stops for ' + organisation_name + ' ' + route_name;\r\n\t\t// Postcode search stops\r\n\t\tif (postcode !== '') title = 'Stops within ' + Math.round(distance / 1609) + ' mile(s) of ' + postcode;\r\n\t\t// GPS search stops\r\n\t\tif (search_type === 'gps') title = 'Stops within ' + Math.round(distance / 1609) + ' mile(s) of your location';\r\n\r\n\t\tlet orgText = {}\r\n\t\tObject.keys(organisation_lookup).forEach(key => {\r\n\t\t\torgText[key] = organisation_lookup[key].name;\r\n\t\t});\r\n\t\tlet mobileText = {}\r\n\t\tObject.keys(mobile_lookup).forEach(key => {\r\n\t\t\tmobileText[key] = mobile_lookup[key].name;\r\n\t\t});\r\n\t\tlet routeText = {}\r\n\t\tObject.keys(route_lookup).forEach(key => {\r\n\t\t\trouteText[key] = route_lookup[key].name;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ maxWidth: '100%' }}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={false}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={this.setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={this.setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={this.setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tpostcode_district={postcode_district}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>{title}</ListSubheader>\r\n\t\t\t\t<MaterialTable\r\n\t\t\t\t\ttableRef={this.tableRef}\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tContainer: props => <Paper {...props} elevation={0} className={classes.table} />\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ticons={{\r\n\t\t\t\t\t\tFilter: FilterList,\r\n\t\t\t\t\t\tFirstPage: FirstPage,\r\n\t\t\t\t\t\tLastPage: LastPage,\r\n\t\t\t\t\t\tNextPage: ChevronRight,\r\n\t\t\t\t\t\tPreviousPage: ChevronLeft,\r\n\t\t\t\t\t\tSortArrow: ArrowUpward\r\n\t\t\t\t\t}}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tpadding: isWidthUp('sm', width) ? 'default' : 'dense',\r\n\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\tloadingType: 'overlay',\r\n\t\t\t\t\t\tactionsColumnIndex: 0,\r\n\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\ttoolbar: false,\r\n\t\t\t\t\t\theaderStyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\r\n\t\t\t\t\t\t\tcolor: '#737373',\r\n\t\t\t\t\t\t\tborder: '0px'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '',\r\n\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"See more stop details\">\r\n\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.displayStopInfo(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<MoreVertIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Add event to your device calendar\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.getStopCalendar(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<EventIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Download a PDF timetable for this stop\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.getStopPdf(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<PrintIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"See this stop on the map\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.viewMapStop(rowData)} component={Link} to=\"/map\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<LocationOnIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Go to the website for this stop\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.goToWebsite(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<OpenInBrowserIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Name',\r\n\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: false,\r\n\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\trowData.name\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Community',\r\n\t\t\t\t\t\t\tfield: 'community',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Authority',\r\n\t\t\t\t\t\t\tfield: 'organisation_name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: isWidthDown('md', width),\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Next due',\r\n\t\t\t\t\t\t\tfield: 'route_schedule',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: isWidthDown('xs', width),\r\n\t\t\t\t\t\t\trender: (rowData) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\trowData.route_schedule.length > 0 ? moment(rowData.route_schedule[0]).format('Do MMMM h:mma') : ''\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tdata={query =>\r\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tstopsHelper.getQueryStops(query, organisation_filter, mobile_filter, route_filter, current_position, distance, stopData => {\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tdata: stopData.stops,\r\n\t\t\t\t\t\t\t\t\tpage: (stopData.page - 1),\r\n\t\t\t\t\t\t\t\t\ttotalCount: stopData.total,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nStops.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(Stops);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { Link } from \"react-router-dom\";\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport EventIcon from '@material-ui/icons/EventTwoTone';\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = theme => ({\r\n    button: {\r\n        margin: theme.spacing(1)\r\n    },\r\n    dialog: {\r\n        border: '1px solid #E0E0E0'\r\n    },\r\n    leftIcon: {\r\n        marginRight: theme.spacing(1)\r\n    },\r\n    list: {\r\n        width: '100%',\r\n        maxWidth: 360,\r\n        backgroundColor: theme.palette.background.paper\r\n    },\r\n    progress: {\r\n        margin: theme.spacing(2)\r\n    }\r\n});\r\n\r\nclass StopDetails extends React.Component {\r\n    state = {}\r\n\r\n    getStopCalendar = () => window.open(config.api + '/stops/' + this.props.stop.id + '/ics');\r\n    getStopPdf = () => window.open(config.api + '/stops/' + this.props.stop.id + '/pdf', '_blank');\r\n    viewMapStop = () => this.props.viewMapStop(this.props.stop.longitude, this.props.stop.latitude);\r\n    goToWebsite = () => window.open(this.props.stop.timetable, '_blank');\r\n\r\n    close = () => { this.props.close() }\r\n\r\n    render() {\r\n        const { classes, width, stop } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                aria-labelledby=\"dlg-title\"\r\n                BackdropProps={\r\n                    {\r\n                        invisible: true\r\n                    }\r\n                }\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                {stop && stop.route_days ?\r\n                    <React.Fragment>\r\n                        <DialogTitle id=\"dlg-title\">{stop.name + '. ' + stop.community}</DialogTitle>\r\n                        <DialogContent>\r\n                            <ListSubheader>{(stop.route_schedule && stop.route_schedule.length > 0 ? moment(stop.route_schedule[0]).format('dddd Do MMMM h:mma') : '')}</ListSubheader>\r\n                           \r\n                            <br />\r\n                            <Divider />\r\n                            <br />\r\n                            <Button onClick={() => this.getStopCalendar()} className={classes.button} color=\"primary\" startIcon={<EventIcon />}>Calendar</Button>\r\n                            <Button onClick={() => this.getStopPdf()} className={classes.button} color=\"primary\" startIcon={<PrintIcon />}>Timetable</Button>\r\n                            <Button onClick={() => this.viewMapStop()} className={classes.button} color=\"primary\" startIcon={<LocationOnIcon />} component={Link} to=\"/map\">Map</Button>\r\n                        </DialogContent>\r\n                    </React.Fragment> :\r\n                    <CircularProgress className={classes.progress} color=\"secondary\" size={30} />}\r\n                <DialogActions>\r\n                    <Button onClick={() => this.goToWebsite()} color=\"primary\">Website</Button>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nStopDetails.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(StopDetails);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n    dialog: {\r\n        border: '1px solid #E0E0E0'\r\n    }\r\n});\r\n\r\nclass TripDetails extends React.Component {\r\n    state = {}\r\n\r\n    close = () => { this.props.close() }\r\n\r\n    render() {\r\n        const { classes, width, trip } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        const estimated_duration = Math.round(trip.duration / 60) + ' mins journey time.';\r\n        const distance = Math.round(trip.distance / 1609, 1) + ' mile(s)';\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                BackdropProps={\r\n                    {\r\n                        invisible: true\r\n                    }\r\n                }\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                <DialogTitle>{'Trip details'}</DialogTitle>\r\n                <DialogContent>\r\n                <ListSubheader disableSticky>{'From ' + trip.origin_stop_name + ' to ' + trip.destination_stop_name}</ListSubheader>\r\n                <Typography variant=\"body2\" component=\"p\">{estimated_duration + ' ' + distance}</Typography>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nTripDetails.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(TripDetails);","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\n// getCurrentLocation:\r\nexport function getCurrentPosition (callback) {\r\n  var options = {\r\n    enableHighAccuracy: true,\r\n    timeout: 10000,\r\n    maximumAge: 0\r\n  }\r\n  navigator.geolocation.getCurrentPosition((pos) => {\r\n    callback([pos.coords.longitude, pos.coords.latitude])\r\n  }, err => {\r\n    callback([])\r\n  }, options)\r\n};\r\n\r\n// Get postcode data\r\nexport function getPostcode (postcode, callback) {\r\n  axios.get('https://api.postcodes.io/postcodes/' + postcode)\r\n    .then(response => {\r\n      if (response && response.data && response.data.result) {\r\n        callback({\r\n          location: [response.data.result.longitude, response.data.result.latitude],\r\n          admin_district: response.data.result.admin_district\r\n        })\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n};\n","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getAllOrganisations (callback) {\r\n  axios.get(config.api + '/organisations')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n}\n","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getAllRoutes (callback) {\r\n  axios.get(config.api + '/routes')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(err => callback([]))\r\n}\n","// Axios for making requests\r\nimport axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getAllTrips (callback) {\r\n  axios.get(config.api + '/trips')\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback([])\r\n      }\r\n    })\r\n    .catch(() => callback([]))\r\n}\r\n\r\nexport function getTripById (id, callback) {\r\n  axios.get(config.api + '/trips/' + id)\r\n    .then(response => {\r\n      if (response && response.data) {\r\n        callback(response.data)\r\n      } else {\r\n        callback({})\r\n      }\r\n    })\r\n    .catch(() => callback({}))\r\n}\r\n","// React\r\nimport React, { Component } from 'react';\r\n\r\n// Other core stuff\r\nimport PropTypes from 'prop-types';\r\nimport { BrowserRouter, Route } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport Container from '@material-ui/core/Container';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\n\r\n// Icons\r\nimport CloseIcon from '@material-ui/icons/CloseTwoTone';\r\n\r\n// MUI Style\r\nimport lightBlue from '@material-ui/core/colors/lightBlue';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport { MuiThemeProvider, createMuiTheme, withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport AppHeader from './AppHeader';\r\nimport Mobiles from './Mobiles';\r\nimport MobileMap from './MobileMap';\r\nimport Stops from './Stops';\r\nimport StopDetails from './StopDetails';\r\nimport TripDetails from './TripDetails';\r\n\r\n// Our helpers\r\nimport * as geoHelper from './helpers/geo';\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as organisationsHelper from './helpers/organisations';\r\nimport * as routesHelper from './helpers/routes';\r\nimport * as stopsHelper from './helpers/stops';\r\nimport * as tripsHelper from './helpers/trips';\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: lightBlue,\r\n    secondary: blueGrey\r\n  },\r\n  overrides: {\r\n    MuiButton: {\r\n      text: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTab: {\r\n      root: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTableCell: {\r\n      root: {\r\n        borderBottom: 'none'\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3)\r\n  }\r\n});\r\n\r\nclass App extends Component {\r\n  state = {\r\n    // Stop dialog\r\n    stop_dialog_open: false,\r\n    current_stop: {},\r\n    // Trip dialog\r\n    trip_dialog_open: false,\r\n    current_trip: {},\r\n    // Organisation data\r\n    organisations: [],\r\n    organisation_lookup: {},\r\n    organisation_filter: [],\r\n    // Mobile data\r\n    mobiles: [],\r\n    mobile_lookup: {},\r\n    mobile_filter: [],\r\n    mobile_locations: [],\r\n    mobile_location_lookup: {},\r\n    mobiles_nearest: [],\r\n    mobiles_nearest_lookup: {},\r\n    mobile_location_timer: null,\r\n    // Route data\r\n    routes: [],\r\n    route_lookup: {},\r\n    route_filter: [],\r\n    // Map view settings\r\n    fit_bounds: null,\r\n    position: [-2.1000, 53.6138],\r\n    zoom: [7],\r\n    pitch: [0],\r\n    bearing: [0],\r\n    // Search\r\n    search_type: '', // search types can be gps, postcode, service\r\n    distance: 1609,\r\n    postcode: '',\r\n    postcode_district: '',\r\n    // GPS\r\n    current_position: [],\r\n    position_update_interval: '',\r\n    map_settings: {\r\n      authority_boundary: false\r\n    },\r\n    // Loading indicators\r\n    loading_gps: true,\r\n    loading_mobiles: false,\r\n    loading_organisations: false,\r\n    loading_postcode: true,\r\n    loading_routes: false,\r\n    // Snackbar\r\n    snackbar_open: false,\r\n    snackbar_message: ''\r\n  };\r\n\r\n  getOrganisations = () => {\r\n    this.setState({ loading_organisations: true });\r\n    organisationsHelper.getAllOrganisations(organisations => {\r\n      let organisation_lookup = {};\r\n      organisations.forEach(organisation => organisation_lookup[organisation.id] = organisation);\r\n      this.setState({ organisations: organisations, organisation_lookup: organisation_lookup, loading_organisations: false })\r\n    });\r\n  }\r\n\r\n  getMobiles = () => {\r\n    this.setState({ loading_mobiles: true });\r\n    mobilesHelper.getAllMobiles(mobiles => {\r\n      let mobile_lookup = {};\r\n      mobiles.forEach(mobile => mobile_lookup[mobile.id] = mobile);\r\n      this.setState({ mobiles: mobiles, mobile_lookup: mobile_lookup, loading_mobiles: false });\r\n    });\r\n  }\r\n\r\n  getRoutes = () => {\r\n    this.setState({ loading_routes: true });\r\n    routesHelper.getAllRoutes(routes => {\r\n      let route_lookup = {};\r\n      routes.forEach(route => route_lookup[route.id] = route);\r\n      this.setState({ routes: routes, route_lookup: route_lookup, loading_routes: false });\r\n    });\r\n  }\r\n\r\n  getMobileLocations = () => {\r\n    mobilesHelper.getMobileLocations(locations => {\r\n      let mobile_location_lookup = {};\r\n      locations.forEach(location => mobile_location_lookup[location.mobile_id] = location);\r\n      this.setState({ mobile_locations: locations, mobile_location_lookup: mobile_location_lookup });\r\n    });\r\n  }\r\n\r\n  getMobilesNearest = () => {\r\n    mobilesHelper.getMobilesNearest(this.state.current_position, this.state.distance, mobiles => {\r\n      let mobiles_nearest_lookup = {};\r\n      mobiles.forEach(mobile => mobiles_nearest_lookup[mobile.mobile_id] = mobile);\r\n      this.setState({ mobiles_nearest: mobiles, mobiles_nearest_lookup: mobiles_nearest_lookup });\r\n    });\r\n  }\r\n\r\n  componentDidMount = () => {\r\n    this.getOrganisations();\r\n    this.getMobiles();\r\n    this.getRoutes();\r\n    this.getMobileLocations();\r\n    // Set up a timer for the mobile locations\r\n    const mobile_location_timer = setInterval(() => {\r\n      this.getMobileLocations();\r\n    }, 15000);\r\n    this.setState({ mobile_location_timer: mobile_location_timer });\r\n  }\r\n\r\n  viewStop = (stop) => {\r\n    // First open the dialog\r\n    this.openStopDialog(stop);\r\n    // We may or may not have a complete stop object.\r\n    // If calling from the stop table we do - if not we don't, all we have is ID\r\n    if (!stop.name) {\r\n      stopsHelper.getStopById(stop.id, stop => {\r\n        this.setState({ current_stop: stop })\r\n      });\r\n    }\r\n  }\r\n  openStopDialog = (stop) => this.setState({ current_stop: stop, stop_dialog_open: true });\r\n  closeStopDialog = () => this.setState({ stop_dialog_open: false });\r\n\r\n  viewTrip = (trip) => {\r\n    // First open the dialog\r\n    this.openTripDialog(trip);\r\n    tripsHelper.getTripById(trip.id, trip => {\r\n      this.setState({ current_trip: trip })\r\n    });\r\n  }\r\n  openTripDialog = (trip) => this.setState({ current_trip: trip, trip_dialog_open: true });\r\n  closeTripDialog = () => this.setState({ trip_dialog_open: false });\r\n\r\n  viewStopsByOrganisation = (organisation_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [], route_filter: [] });\r\n  viewStopsByMobile = (organisation_id, mobile_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [] });\r\n  viewStopsByRoute = (organisation_id, mobile_id, route_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [route_id] });\r\n  clearMobileFilter = () => this.setState({ mobile_filter: [], route_filter: [] });\r\n  clearRouteFilter = () => this.setState({ route_filter: [] });\r\n  clearOrganisationFilter = () => this.setState({ organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\r\n  viewMapStop = (longitude, latitude) => this.setState({ page: 'map', position: [longitude, latitude], zoom: [15], stop_dialog_open: false });\r\n\r\n  logPosition = (fit = false) => {\r\n    this.setState({ loading_gps: true });\r\n    geoHelper.getCurrentPosition(position => {\r\n      if (position.length === 2) {\r\n        this.getMobilesNearest();\r\n        this.setState({ current_position: position, position: position, zoom: [12], loading_gps: false });\r\n      } else {\r\n        clearInterval(this.state.position_update_interval);\r\n        this.setState({ search_type: '', postcode: '', current_position: [], position_update_interval: null, snackbar_open: true, snackbar_message: 'Could not fetch current location' });\r\n      }\r\n    });\r\n  }\r\n\r\n  setDistance = (distance) => this.setState({ distance: distance });\r\n\r\n  clearSearch = () => {\r\n    this.setState({ postcode: '', postcode_district: '', current_position: [], search_type: '', organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n  }\r\n\r\n  // postcodeSearch\r\n  postcodeSearch = (postcode) => {\r\n\r\n    if (postcode === '') {\r\n      this.setState({ snackbar_open: true, snackbar_message: 'You must enter a postcode', postcode_district: '' });\r\n      return;\r\n    }\r\n\r\n    let new_state = { search_type: 'postcode', loading_postcode: true, postcode: postcode, organisation_filter: [], mobile_filter: [], route_filter: [] };\r\n\r\n    // If we're already tracking GPS then turn this off\r\n    if (this.state.search_type === 'gps') {\r\n      clearInterval(this.state.position_update_interval);\r\n      new_state.position_update_interval = null;\r\n    }\r\n\r\n    // Get the postcode\r\n    geoHelper.getPostcode(postcode, postcode_data => {\r\n      if (postcode_data.location && postcode_data.location.length === 2) {\r\n        new_state.search_type = 'postcode';\r\n        new_state.current_position = postcode_data.location;\r\n        new_state.position = postcode_data.location;\r\n        new_state.zoom = [11];\r\n        new_state.loading_postcode = false;\r\n        new_state.postcode_district = postcode_data.admin_district;\r\n        this.setState(new_state);\r\n        this.getMobilesNearest();\r\n      } else {\r\n        this.setState({ snackbar_open: true, snackbar_message: 'Could not find postcode', postcode_district: '' });\r\n      }\r\n    });\r\n  }\r\n\r\n  // toggleGPS\r\n  toggleGPS = () => {\r\n    // If we're already tracking GPS then turn this off\r\n    if (this.state.search_type === 'gps') {\r\n      clearInterval(this.state.position_update_interval);\r\n      this.setState({ search_type: '', postcode: '', current_position: [], position_update_interval: null });\r\n    } else {\r\n      let position_update_interval = setInterval(this.logPosition, 10000);\r\n      this.setState({ position_update_interval: position_update_interval, search_type: 'gps', postcode: '', organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n      this.logPosition(true);\r\n    }\r\n  }\r\n\r\n  toggleMapSetting = (setting) => {\r\n    let map_settings = this.state.map_settings;\r\n    const current_setting = this.state.map_settings[setting];\r\n    map_settings[setting] = !current_setting;\r\n    this.setState({ map_settings: map_settings });\r\n  }\r\n\r\n  closeSnackbar = (event, reason) => {\r\n    if (reason === 'clickaway') return;\r\n    this.setState({ snackbar_open: false });\r\n  };\r\n\r\n  render() {\r\n    const { classes } = this.props;\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        <BrowserRouter>\r\n          <div className={classes.root}>\r\n            <CssBaseline />\r\n            <AppHeader\r\n              loading={this.state.loading_mobiles || this.state.loading_organisations || this.state.loading_routes}\r\n              postcode={this.state.postcode}\r\n              distance={this.state.distance}\r\n              search_type={this.state.search_type}\r\n              setDistance={this.setDistance}\r\n              toggleGPS={this.toggleGPS}\r\n              postcodeSearch={this.postcodeSearch}\r\n              clearSearch={this.clearSearch}\r\n            />\r\n            <Container maxWidth=\"lg\">\r\n              <main className={classes.content}>\r\n                <Route\r\n                  path='/'\r\n                  exact\r\n                  render={() => {\r\n                    return (<Mobiles\r\n                      mobiles={this.state.mobiles}\r\n                      mobile_lookup={this.state.mobile_lookup}\r\n                      mobile_location_lookup={this.state.mobile_location_lookup}\r\n                      mobiles_nearest_lookup={this.state.mobiles_nearest_lookup}\r\n                      organisation_lookup={this.state.organisation_lookup}\r\n                      viewStop={this.viewStop}\r\n                      viewStopsByMobile={this.viewStopsByMobile}\r\n                      viewStopsByOrganisation={this.viewStopsByOrganisation}\r\n                      organisations={this.state.organisations}\r\n                      organisation_filter={this.state.organisation_filter}\r\n                      setOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n                      clearOrganisationFilter={this.clearOrganisationFilter}\r\n                      mobile_filter={this.state.mobile_filter}\r\n                      setMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n                      clearMobileFilter={this.clearMobileFilter}\r\n                      routes={this.state.routes}\r\n                      route_lookup={this.state.route_lookup}\r\n                      route_filter={this.state.route_filter}\r\n                      setRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n                      clearRouteFilter={this.clearRouteFilter}\r\n                      postcode={this.state.postcode}\r\n                      postcode_district={this.state.postcode_district}\r\n                      distance={this.state.distance}\r\n                      search_type={this.state.search_type}\r\n                      setDistance={this.setDistance}\r\n                      toggleGPS={this.toggleGPS}\r\n                      postcodeSearch={this.postcodeSearch}\r\n                      clearSearch={this.clearSearch}\r\n                    />)\r\n                  }}\r\n                />\r\n                <Route\r\n                  path='/stops'\r\n                  render={() => {\r\n                    return (\r\n                      <Stops\r\n                        organisations={this.state.organisations}\r\n                        organisation_lookup={this.state.organisation_lookup}\r\n                        organisation_filter={this.state.organisation_filter}\r\n                        setOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n                        clearOrganisationFilter={this.clearOrganisationFilter}\r\n                        mobiles={this.state.mobiles}\r\n                        mobile_lookup={this.state.mobile_lookup}\r\n                        mobile_filter={this.state.mobile_filter}\r\n                        setMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n                        clearMobileFilter={this.clearMobileFilter}\r\n                        routes={this.state.routes}\r\n                        route_lookup={this.state.route_lookup}\r\n                        route_filter={this.state.route_filter}\r\n                        setRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n                        clearRouteFilter={this.clearRouteFilter}\r\n                        viewStop={this.viewStop}\r\n                        viewMapStop={this.viewMapStop}\r\n                        current_position={this.state.current_position}\r\n                        postcode={this.state.postcode}\r\n                        postcode_district={this.state.postcode_district}\r\n                        distance={this.state.distance}\r\n                        search_type={this.state.search_type}\r\n                        setDistance={this.setDistance}\r\n                        toggleGPS={this.toggleGPS}\r\n                        postcodeSearch={this.postcodeSearch}\r\n                        clearSearch={this.clearSearch}\r\n                      />)\r\n                  }}\r\n                />\r\n                <Route\r\n                  path='/map'\r\n                  render={() => {\r\n                    return (\r\n                      <MobileMap\r\n                        bearing={this.state.bearing}\r\n                        fit_bounds={this.state.fit_bounds}\r\n                        pitch={this.state.pitch}\r\n                        position={this.state.position}\r\n                        current_position={this.state.current_position}\r\n                        zoom={this.state.zoom}\r\n                        search_type={this.state.search_type}\r\n                        mobile_lookup={this.state.mobile_lookup}\r\n                        mobile_locations={this.state.mobile_locations.filter(l => l.geox !== null)}\r\n                        organisations={this.state.organisations}\r\n                        organisation_lookup={this.state.organisation_lookup}\r\n                        map_settings={this.state.map_settings}\r\n                        toggleMapSetting={this.toggleMapSetting}\r\n                        viewStop={this.viewStop}\r\n                        viewTrip={this.viewTrip}\r\n                      />)\r\n                  }}\r\n                />\r\n              </main>\r\n            </Container>\r\n            <StopDetails\r\n              stop={this.state.current_stop}\r\n              open={this.state.stop_dialog_open}\r\n              close={() => this.closeStopDialog()}\r\n              viewMapStop={this.viewMapStop}\r\n            />\r\n            <TripDetails\r\n              trip={this.state.current_trip}\r\n              open={this.state.trip_dialog_open}\r\n              close={() => this.closeTripDialog()}\r\n            />\r\n            <Snackbar\r\n              anchorOrigin={{\r\n                vertical: 'bottom',\r\n                horizontal: 'left'\r\n              }}\r\n              open={this.state.snackbar_open}\r\n              autoHideDuration={4000}\r\n              onClose={this.closeSnackbar}\r\n              ContentProps={{\r\n                'aria-describedby': 'message-id',\r\n              }}\r\n              message={<span id=\"message-id\">{this.state.snackbar_message}</span>}\r\n              action={[\r\n                <IconButton\r\n                  key=\"close\"\r\n                  aria-label=\"close\"\r\n                  color=\"inherit\"\r\n                  className={classes.close}\r\n                  onClick={this.closeSnackbar}\r\n                >\r\n                  <CloseIcon />\r\n                </IconButton>\r\n              ]}\r\n            />\r\n          </div>\r\n        </BrowserRouter>\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nApp.propTypes = {\r\n  classes: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(App);","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n)\r\n\r\nexport function register (config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config)\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          )\r\n        })\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction registerValidSW (swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing\r\n        if (installingWorker == null) {\r\n          return\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              )\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration)\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.')\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error)\r\n    })\r\n}\r\n\r\nfunction checkValidServiceWorker (swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type')\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload()\r\n          })\r\n        })\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      )\r\n    })\r\n}\r\n\r\nexport function unregister () {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister()\r\n    })\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11'\r\nimport 'react-app-polyfill/stable'\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\n// Our app entry point\r\nimport App from './App'\r\n\r\n// Service worker for PWA behaviour\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}