{"version":3,"sources":["PostcodeSearch.js","AppHeader.js","Filters.js","MobileCard.js","Mobiles.js","MeAvatar.js","MobileAvatar.js","MobileMap.js","helpers/stops.js","Stops.js","helpers/mobiles.js","helpers/organisations.js","helpers/routes.js","App.js","helpers/geo.js","serviceWorker.js","index.js"],"names":["PostcodeSearch","state","postcode","distance","_this2","this","_this$props","props","classes","gps_available","search_type","postcodeSearch","toggleGPS","react_default","a","createElement","className","search","InputBase","placeholder","root","inputRoot","input","inputInput","value","onChange","e","setState","target","Select","name","id","MenuItem","Tooltip","title","IconButton","iconButton","onClick","Search_default","Divider","divider","color","MyLocation_default","LocationSearching_default","React","Component","withStyles","theme","width","height","margin","padding","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","&:hover","marginLeft","marginRight","display","AppHeader","_this","drawer_open","AppBar","elevation","clsx","appBar","Object","defineProperty","appBarShift","Toolbar","Typography","variant","noWrap","grow","src_PostcodeSearch","Button","page","setPage","Dashboard_default","leftIcon","LocationOn_default","Map_default","zIndex","drawer","flexGrow","hide","withTheme","Filters","organisation_menu_anchor","mobile_menu_anchor","route_menu_anchor","openOrganisationMenu","element","closeOrganisationMenu","chooseOrganisation","organisation_id","setOrganisationFilter","openMobileMenu","closeMobileMenu","chooseMobile","mobile_id","setMobileFilter","openRouteMenu","closeRouteMenu","chooseRoute","route_id","setRouteFilter","organisations","organisation_lookup","organisation_filter","clearOrganisationFilter","mobiles","mobile_lookup","mobile_filter","clearMobileFilter","routes","route_lookup","route_filter","clearRouteFilter","bull","bullet","Grid","grid","container","item","xs","sm","md","lg","xl","Card","card","CardContent","gutterBottom","length","CardActions","size","button","currentTarget","Business_default","Chip","onDelete","label","DirectionsBus_default","Directions_default","Menu","anchorEl","keepMounted","open","Boolean","onClose","sort","b","localeCompare","map","org","key","filter","mob","indexOf","route","transform","minWidth","marginBottom","fontSize","fontWeight","MobileCard","mobile","organisation","location","number_routes","number_stops","component","viewStopsByMobile","verticalDivider","PictureAsPdf_default","current_stop_id","previous_stop_id","geox","next_stop_id","current_stop_name","Mobiles","viewStopsByOrganisation","mobile_location_lookup","src_Filters","displayStopLink","ListSubheader","disableSticky","idx","replace","src_MobileCard","MeAvatar","Avatar","avatarOn","avatar","Face_default","cursor","primary","main","MobileAvatar","Fab","fab","boxShadow","Map","ReactMapboxGl","minZoom","maxZoom","scrollZoom","interactive","dragRotate","attributionControl","stop_tiles","MobileMap","zoom","pitch","bearing","fit_bounds","mobile_locations","MobileMap_Map","style","center","fitBounds","containerStyle","top","bottom","right","left","l","lib_esm","coordinates","geoy","anchor","src_MobileAvatar","tileJsonSource","type","tiles","sourceId","sourceLayer","layout","paint","circle-radius","circle-color","circle-stroke-width","circle-stroke-color","circle-opacity","text-ignore-placement","text-field","text-font","text-line-height","text-size","text-offset","text-halo-color","text-halo-width","text-halo-blur","text-color","current_position","src_MeAvatar","config","require","Stops","tableRef","createRef","current","onQueryChange","getStopCalendar","event","rowData","getStopPdf","orgText","keys","forEach","mobileText","routeText","maxWidth","dist_default","components","Container","Paper","assign","table","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","options","loadingType","actionsColumnIndex","filtering","columns","field","render","moment","arrival","format","departure","actions","icon","Event_default","iconProps","tooltip","data","query","Promise","resolve","reject","organisation_filters","mobile_filters","route_filters","callback","url","api","pageSize","orderBy","orderDirection","join","axios","get","then","response","stops","total","parseInt","headers","catch","err","stopsHelper","stopData","totalCount","formControl","createMuiTheme","deepOrange","secondary","blueGrey","overrides","MuiButton","text","textTransform","App","location_timer","gps_loading","postcode_loading","position_update_interval","getOrganisations","getMobiles","getRoutes","getMobileLocations","locations","componentDidMount","setInterval","viewStopsByRoute","logPosition","arguments","undefined","loading","navigator","geolocation","getCurrentPosition","pos","coords","longitude","latitude","enableHighAccuracy","timeout","maximumAge","new_state","clearInterval","result","geoHelper","MuiThemeProvider","CssBaseline","src_AppHeader","content","toolbar","src_Mobiles","src_Stops","src_MobileMap","objectSpread","alignItems","justifyContent","mixins","window","hostname","match","ReactDOM","src_App","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5d4049ee.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Select from '@material-ui/core/Select';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Material icons\r\nimport LocationSearching from '@material-ui/icons/LocationSearching';\r\nimport MyLocation from '@material-ui/icons/MyLocation';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\n\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10\r\n\t},\r\n\tinputRoot: {\r\n\t\tcolor: 'inherit'\r\n\t},\r\n\tinputInput: {\r\n\t\tpaddingTop: theme.spacing(),\r\n\t\tpaddingRight: theme.spacing(),\r\n\t\tpaddingBottom: theme.spacing(),\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\twidth: 100\r\n\t},\r\n\tsearch: {\r\n\t\tposition: 'relative',\r\n\t\tborder: '1px solid #e5e5e5',\r\n\t\tborderRadius: theme.shape.borderRadius,\r\n\t\tbackgroundColor: fade(theme.palette.common.white, 0.8),\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: fade(theme.palette.common.white, 0.9),\r\n\t\t},\r\n\t\tmarginLeft: 0,\r\n\t\tmarginRight: theme.spacing(),\r\n\t\tdisplay: 'flex'\r\n\t}\r\n});\r\n\r\nclass PostcodeSearch extends React.Component {\r\n\tstate = {\r\n\t\tpostcode: '',\r\n\t\tdistance: 1609\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, gps_available, search_type, postcodeSearch, toggleGPS } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.search}>\r\n\t\t\t\t<InputBase\r\n\t\t\t\t\tplaceholder=\"Postcode\"\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.inputRoot,\r\n\t\t\t\t\t\tinput: classes.inputInput,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={this.state.postcode}\r\n\t\t\t\t\tonChange={(e) => this.setState({ postcode: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<Select\r\n\t\t\t\t\tvalue={this.state.distance}\r\n\t\t\t\t\tonChange={(e) => { this.setState({ distance: e.target.value }) }}\r\n\t\t\t\t\tinput={<InputBase name=\"sel-miles\" id=\"sel-miles\" />}\r\n\t\t\t\t>\r\n\t\t\t\t\t<MenuItem value={1609}>1 mi</MenuItem>\r\n\t\t\t\t\t<MenuItem value={3219}>2 mi</MenuItem>\r\n\t\t\t\t\t<MenuItem value={4828}>3 mi</MenuItem>\r\n\t\t\t\t\t<MenuItem value={8047}>5 mi</MenuItem>\r\n\t\t\t\t</Select>\r\n\t\t\t\t<Tooltip title={'Search by postcode'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tonClick={() => postcodeSearch(this.state.postcode, this.state.distance)}>\r\n\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Divider className={classes.divider} />\r\n\t\t\t\t{gps_available ?\r\n\t\t\t\t\t<Tooltip title={'Track my location'}>\r\n\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\t\tonClick={() => { this.setState({ postcode: '' }); toggleGPS() }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{gps_available && search_type === 'gps' ? <MyLocation /> : <LocationSearching />}\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip> : null}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPostcodeSearch.propTypes = {\r\n\tclasses: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(PostcodeSearch);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport clsx from 'clsx';\r\n\r\n// Material UI\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material Icons\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport MapIcon from '@material-ui/icons/Map';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = theme => ({\r\n\tappBar: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tbackgroundColor: 'rgba(255, 255, 255, 0.5)'\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\thide: {\r\n\t\tdisplay: 'none'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t}\r\n});\r\n\r\nclass AppHeader extends Component {\r\n\r\n\trender() {\r\n\t\tconst { classes, drawer_open, search_type, gps_available, toggleGPS, postcodeSearch } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<AppBar\r\n\t\t\t\tposition=\"fixed\"\r\n\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\televation={0}\r\n\t\t\t\tclassName={clsx(classes.appBar, {\r\n\t\t\t\t\t[classes.appBarShift]: drawer_open\r\n\t\t\t\t})}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t<Typography variant=\"h6\" noWrap>Mobile Libraries</Typography>\r\n\t\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\tgps_available={gps_available}\r\n\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button color=\"primary\" variant={this.props.page === 'mobiles' ? 'text' : 'text'}\r\n\t\t\t\t\t\tonClick={() => this.props.setPage('mobiles')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<DashboardIcon className={classes.leftIcon} />Mobile dashboard\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button color=\"primary\" variant={this.props.page === 'stops' ? 'text' : 'text'}\r\n\t\t\t\t\t\tonClick={() => this.props.setPage('stops')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Find a stop\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t\t<Button color=\"primary\" variant={this.props.page === 'map' ? 'text' : 'text'}\r\n\t\t\t\t\t\tonClick={() => this.props.setPage('map')}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<MapIcon className={classes.leftIcon} />Map\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nAppHeader.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(AppHeader);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport BusinessIcon from '@material-ui/icons/Business';\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\nimport DirectionsIcon from '@material-ui/icons/Directions';\r\n\r\n// Our components\r\n\r\n\r\nconst styles = (theme) => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tposition: 'relative',\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t},\r\n\tgrid: {\r\n\t\tmarginBottom: 10\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t}\r\n});\r\n\r\nclass Filters extends Component {\r\n\r\n\tstate = {\r\n\t\torganisation_menu_anchor: null,\r\n\t\tmobile_menu_anchor: null,\r\n\t\troute_menu_anchor: null\r\n\t};\r\n\r\n\topenOrganisationMenu = (element) => {\r\n\t\tthis.setState({ organisation_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseOrganisationMenu = () => {\r\n\t\tthis.setState({ organisation_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseOrganisation = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.closeOrganisationMenu();\r\n\t}\r\n\r\n\topenMobileMenu = (element) => {\r\n\t\tthis.setState({ mobile_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseMobileMenu = () => {\r\n\t\tthis.setState({ mobile_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseMobile = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.closeMobileMenu();\r\n\t}\r\n\r\n\topenRouteMenu = (element) => {\r\n\t\tthis.setState({ route_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseRouteMenu = () => {\r\n\t\tthis.setState({ route_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseRoute = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.closeRouteMenu();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter,\r\n\t\t\tclearOrganisationFilter, mobiles, mobile_lookup, mobile_filter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, clearRouteFilter\r\n\t\t} = this.props;\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\r\n\t\treturn (\r\n\t\t\t<Grid className={classes.grid} container spacing={3}>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{organisations.length + ' library services'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{mobiles.length + ' mobile libraries'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{routes.length + ' routes'}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t\t{organisation_filter.length === 0 ? <Tooltip title=\"Choose library service\">\r\n\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openOrganisationMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t<BusinessIcon className={classes.leftIcon} />Service\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={clearOrganisationFilter} label={organisation_lookup[organisation_filter[0]].name} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{organisation_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(mobile_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose mobile library\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openMobileMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionBusIcon className={classes.leftIcon} />Mobile\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearMobileFilter()} label={mobile_lookup[mobile_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t\t{mobile_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(route_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose route\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openRouteMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionsIcon className={classes.leftIcon} />Route\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearRouteFilter()} label={route_lookup[route_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardActions>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-library-service\"\r\n\t\t\t\t\tanchorEl={this.state.organisation_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.organisation_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeOrganisationMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{organisations\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(org => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => this.chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-mobile-library\"\r\n\t\t\t\t\tanchorEl={this.state.mobile_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.mobile_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeMobileMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(mob => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => this.chooseMobile(mob.id)}>{mob.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-route\"\r\n\t\t\t\t\tanchorEl={this.state.route_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.route_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeRouteMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{routes\r\n\t\t\t\t\t\t.filter(route => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(route.mobile_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => this.chooseRoute(route.id)}>{route.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nFilters.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Filters);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// MUI Icons\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport PictureAsPdfIcon from '@material-ui/icons/PictureAsPdf';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t},\r\n\tverticalDivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t}\r\n});\r\n\r\nclass MobileCard extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, mobile, organisation, location } = this.props;\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\t\treturn (\r\n\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t{organisation ? organisation.name : ''}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_routes + ' route' + (mobile.number_routes > 1 ? 's' : '')}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_stops + ' stop' + (mobile.number_stops > 1 ? 's' : '')}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">{mobile.name}</Typography>\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<Divider variant=\"middle\" />\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<Tooltip title=\"Mobile library stops\">\r\n\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={() => this.props.viewStopsByMobile(mobile.id)}>\r\n\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t\t<Tooltip title=\"Download PDF timetable for mobile\">\r\n\t\t\t\t\t\t<IconButton>\r\n\t\t\t\t\t\t\t<PictureAsPdfIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlocation && !location.current_stop_id && !location.previous_stop_id & !location.geox ?\r\n\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" label=\"Off Road\" />\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlocation && !location.current_stop_id && location.previous_stop_id && location.next_stop_id && location.geox ?\r\n\t\t\t\t\t\t\t<Chip size=\"small\" color=\"primary\" label=\"Travelling\" />\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlocation && location.current_stop_id ?\r\n\t\t\t\t\t\t\t<Chip size=\"small\" color=\"primary\" label={location.current_stop_name} />\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileCard.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileCard);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Grid from '@material-ui/core/Grid';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\nimport MobileCard from './MobileCard';\r\n\r\nconst styles = () => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t}\r\n});\r\n\r\nclass Mobiles extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, organisations, organisation_lookup, organisation_filter, setOrganisationFilter, clearOrganisationFilter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_location_lookup, mobile_filter, setMobileFilter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, setRouteFilter, clearRouteFilter } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={true}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={clearRouteFilter}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>Library dashboard</ListSubheader>\r\n\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.map((mobile, idx) => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\t\t\tkey={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n\t\t\t\t\t\t\t\t\titem xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t\t\t\t\t<MobileCard\r\n\t\t\t\t\t\t\t\t\t\tmobile={mobile}\r\n\t\t\t\t\t\t\t\t\t\tlocation={mobile_location_lookup[mobile.id]}\r\n\t\t\t\t\t\t\t\t\t\torganisation={organisation_lookup[mobile.organisation_id]}\r\n\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.props.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Grid>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobiles.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(Mobiles);","// React and additional\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Icons\r\nimport Face from '@material-ui/icons/Face';\r\n\r\nconst styles = theme => ({\r\n    avatar: {\r\n        margin: 0\r\n    },\r\n    avatarOn: {\r\n        margin: 0,\r\n        cursor: 'pointer',\r\n        backgroundColor: theme.palette.primary.main\r\n    }\r\n});\r\n\r\nclass MeAvatar extends React.Component {\r\n    state = {\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        return (\r\n            <Tooltip title={'Me'}>\r\n                <Avatar\r\n                    className={this.props.search_type === 'gps' ? classes.avatarOn : classes.avatar}>\r\n                    <Face />\r\n                </Avatar>\r\n            </Tooltip>\r\n        );\r\n    }\r\n}\r\n\r\nMeAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(MeAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Fab from '@material-ui/core/Fab';\r\n\r\n// MUI Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n\tfab: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tboxShadow: 'none'\r\n\t}\r\n});\r\n\r\nclass MobileAvatar extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<Fab size=\"small\" color=\"primary\" className={classes.fab}>\r\n\t\t\t\t<DirectionBusIcon />\r\n\t\t\t</Fab>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileAvatar.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Mapbox GL\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from \"react-mapbox-gl\";\r\n\r\n// Our components\r\nimport MeAvatar from './MeAvatar';\r\nimport MobileAvatar from './MobileAvatar';\r\n\r\nconst Map = ReactMapboxGl({\r\n\tminZoom: 5,\r\n\tmaxZoom: 18,\r\n\tscrollZoom: true,\r\n\tinteractive: true,\r\n\tdragRotate: true,\r\n\tattributionControl: true\r\n});\r\n\r\nconst stop_tiles = ['https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt'];\r\n\r\nclass MobileMap extends Component {\r\n\r\n\trender() {\r\n\t\tconst { position, zoom, pitch, bearing, fit_bounds, mobile_locations, mobile_lookup } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Map\r\n\t\t\t\tstyle='style.json'  // eslint-disable-line react/style-prop-object\r\n\t\t\t\tcenter={position}\r\n\t\t\t\tzoom={zoom}\r\n\t\t\t\tmaxZoom={17}\r\n\t\t\t\tpitch={pitch}\r\n\t\t\t\tbearing={bearing}\r\n\t\t\t\tfitBounds={fit_bounds}\r\n\t\t\t\tcontainerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n\t\t\t>\r\n\t\t\t\t{ // The mobile library locations\r\n\t\t\t\t\tmobile_locations && mobile_locations.length > 0 ?\r\n\t\t\t\t\t\tmobile_locations.map(l => {\r\n\t\t\t\t\t\t\treturn <Marker\r\n\t\t\t\t\t\t\t\tkey={'mkr_' + l.id}\r\n\t\t\t\t\t\t\t\tcoordinates={[l.geox, l.geoy]}\r\n\t\t\t\t\t\t\t\tanchor=\"bottom\">\r\n\t\t\t\t\t\t\t\t<MobileAvatar\r\n\t\t\t\t\t\t\t\t\tmobile={mobile_lookup[l.mobile_id]}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t}) : null\r\n\t\t\t\t}\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_stops'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: stop_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_circles'\r\n\t\t\t\t\ttype='circle'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tlayout={{}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t'circle-radius': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 2,\r\n\t\t\t\t\t\t\t17, 10\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-color': '#607d8b',\r\n\t\t\t\t\t\t'circle-stroke-width': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 1,\r\n\t\t\t\t\t\t\t14, 2\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-stroke-color': '#FFFFFF',\r\n\t\t\t\t\t\t'circle-opacity': 0.8\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_labels'\r\n\t\t\t\t\ttype='symbol'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t'text-ignore-placement': false,\r\n\t\t\t\t\t\t'text-field': ['to-string', ['get', 'name']],\r\n\t\t\t\t\t\t\"text-font\": [\r\n\t\t\t\t\t\t\t\"Source Sans Pro Bold\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-line-height\": 1,\r\n\t\t\t\t\t\t\"text-size\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 10,\r\n\t\t\t\t\t\t\t17, 22\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-offset\": [0, 1.7],\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n\t\t\t\t\t\t\"text-halo-width\": 1,\r\n\t\t\t\t\t\t\"text-halo-blur\": 1,\r\n\t\t\t\t\t\t\"text-color\": \"#6a6f73\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.props.current_position && this.props.current_position.length > 0 ?\r\n\t\t\t\t\t<Marker\r\n\t\t\t\t\t\tkey={'mk_me'}\r\n\t\t\t\t\t\tcoordinates={[this.props.current_position[0], this.props.current_position[1]]}>\r\n\t\t\t\t\t\t<MeAvatar search_type={this.props.search_type} />\r\n\t\t\t\t\t</Marker>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<ZoomControl position=\"bottom-right\" />\r\n\t\t\t</Map>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileMap.propTypes = {\r\n}\r\n\r\nexport default MobileMap;","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getQueryStops(query, organisation_filters, mobile_filters, route_filters, callback) {\r\n\r\n\tlet url = config.api + '/api/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize;\r\n\tif (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection;\r\n\r\n\tif (mobile_filters.length > 0) url = url + '&mobile_ids=' + mobile_filters.join('|');\r\n\tif (organisation_filters.length > 0) url = url + '&organisation_ids=' + organisation_filters.join('|');\r\n\tif (route_filters.length > 0) url = url + '&route_ids=' + route_filters.join('|');\r\n\r\n\taxios.get(url)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tstops: response.data,\r\n\t\t\t\t\ttotal: parseInt(response.headers['x-total-count']),\r\n\t\t\t\t\tpage: parseInt(response.headers['x-page'])\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({ stops: [], total: 0, page: 1 });\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({ stops: [], total: 0, page: 1 }));\r\n}\r\n\r\nexport function getAllStops(callback) {\r\n\taxios.get(config.api + '/api/stops')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\n// Material Table\r\nimport MaterialTable from 'material-table';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport Event from '@material-ui/icons/Event';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport PictureAsPdfIcon from '@material-ui/icons/PictureAsPdf';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\n// Our Helpers\r\nimport * as stopsHelper from './helpers/stops';\r\n\r\nconst styles = (theme) => ({\r\n\tformControl: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tminWidth: 200\r\n\t},\r\n\tmargin: {\r\n\t\tmargin: theme.spacing(1)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t\tmaxWidth: '100%'\r\n\t},\r\n\ttable: {\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t}\r\n});\r\n\r\nclass Stops extends Component {\r\n\r\n\tstate = {\r\n\t\ttitle: 'All stops'\r\n\t};\r\n\r\n\ttableRef = React.createRef();\r\n\r\n\tsetOrganisationFilter = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearOrganisationFilter = () => {\r\n\t\tthis.props.clearOrganisationFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetMobileFilter = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearMobileFilter = () => {\r\n\t\tthis.props.clearMobileFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetRouteFilter = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearRouteFilter = () => {\r\n\t\tthis.props.clearRouteFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tgetStopCalendar = (event, rowData) => {\r\n\r\n\t}\r\n\r\n\tgetStopPdf = (event, rowData) => {\r\n\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_filter,\r\n\t\t\troutes, route_lookup, route_filter } = this.props;\r\n\t\tlet orgText = {}\r\n\t\tObject.keys(organisation_lookup).forEach(key => {\r\n\t\t\torgText[key] = organisation_lookup[key].name;\r\n\t\t});\r\n\t\tlet mobileText = {}\r\n\t\tObject.keys(mobile_lookup).forEach(key => {\r\n\t\t\tmobileText[key] = mobile_lookup[key].name;\r\n\t\t});\r\n\t\tlet routeText = {}\r\n\t\tObject.keys(route_lookup).forEach(key => {\r\n\t\t\trouteText[key] = route_lookup[key].name;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ maxWidth: '100%' }}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={false}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={this.setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={this.setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={this.setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t/>\r\n\t\t\t\t<MaterialTable\r\n\t\t\t\t\ttableRef={this.tableRef}\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tContainer: props => <Paper {...props} elevation={0} className={classes.table} />\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ticons={{\r\n\t\t\t\t\t\tFilter: FilterList,\r\n\t\t\t\t\t\tFirstPage: FirstPage,\r\n\t\t\t\t\t\tLastPage: LastPage,\r\n\t\t\t\t\t\tNextPage: ChevronRight,\r\n\t\t\t\t\t\tPreviousPage: ChevronLeft\r\n\t\t\t\t\t}}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\tloadingType: 'linear',\r\n\t\t\t\t\t\tactionsColumnIndex: 4,\r\n\t\t\t\t\t\tfiltering: false\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t{ title: 'Name', field: 'name', filtering: false },\r\n\t\t\t\t\t\t{ title: 'Community', field: 'community', filtering: false },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Time',\r\n\t\t\t\t\t\t\tfield: 'arrival',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\trender: (rowData) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\tmoment(rowData.arrival, 'HH:mm:ssZ').format('HH:mma') + '-' +\r\n\t\t\t\t\t\t\t\t\tmoment(rowData.departure, 'HH:mm:ssZ').format('HH:mma')\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tactions={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ticon: () => <Event color='action' fontSize='small' />,\r\n\t\t\t\t\t\t\ticonProps: {\r\n\t\t\t\t\t\t\t\tcolor: 'primary'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttooltip: 'Download stop calendar',\r\n\t\t\t\t\t\t\tonClick: this.getStopCalendar\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ticon: () => <PictureAsPdfIcon color='action' fontSize='small' />,\r\n\t\t\t\t\t\t\ticonProps: {\r\n\t\t\t\t\t\t\t\tcolor: 'primary'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttooltip: 'Download stop as PDF',\r\n\t\t\t\t\t\t\tonClick: this.getStopPdf\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tdata={query =>\r\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tstopsHelper.getQueryStops(query, this.props.organisation_filter, this.props.mobile_filter, this.props.route_filter, stopData => {\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tdata: stopData.stops,\r\n\t\t\t\t\t\t\t\t\tpage: (stopData.page - 1),\r\n\t\t\t\t\t\t\t\t\ttotalCount: stopData.total,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttitle={this.state.title}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nStops.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Stops);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllMobiles(callback) {\r\n\taxios.get(config.api + '/api/mobiles')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileLocations(callback) {\r\n\taxios.get(config.api + '/api/mobiles/locations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllOrganisations(callback) {\r\n\taxios.get(config.api + '/api/organisations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllRoutes(callback) {\r\n\taxios.get(config.api + '/api/routes')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\n// MUI Style\r\nimport deepOrange from '@material-ui/core/colors/deepOrange';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport { MuiThemeProvider, createMuiTheme, withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport AppHeader from './AppHeader';\r\nimport Mobiles from './Mobiles';\r\nimport MobileMap from './MobileMap';\r\nimport Stops from './Stops';\r\n\r\n// Our helpers\r\nimport * as geoHelper from './helpers/geo';\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as organisationsHelper from './helpers/organisations';\r\nimport * as routesHelper from './helpers/routes';\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: deepOrange,\r\n\t\tsecondary: blueGrey\r\n\t},\r\n\toverrides: {\r\n\t\tMuiButton: {\r\n\t\t\ttext: {\r\n\t\t\t\ttextTransform: 'inherit'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\tpadding: '0 8px',\r\n\t\t...theme.mixins.toolbar\r\n\t},\r\n\tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: theme.spacing(3)\r\n\t}\r\n});\r\n\r\nclass App extends Component {\r\n\tstate = {\r\n\t\tpage: 'mobiles',\r\n\t\torganisations: [],\r\n\t\torganisation_lookup: {},\r\n\t\torganisation_filter: [],\r\n\t\tmobiles: [],\r\n\t\tmobile_lookup: {},\r\n\t\tmobile_filter: [],\r\n\t\tmobile_locations: [],\r\n\t\tmobile_location_lookup: {},\r\n\t\tlocation_timer: null,\r\n\t\troutes: [],\r\n\t\troute_lookup: {},\r\n\t\troute_filter: [],\r\n\t\tfit_bounds: null,\r\n\t\tposition: [-2.1000, 53.6138],\r\n\t\tzoom: [7],\r\n\t\tpitch: [0],\r\n\t\tbearing: [0],\r\n\t\tgps_loading: true,\r\n\t\tpostcode: '',\r\n\t\tpostcode_loading: true,\r\n\t\tcurrent_position: [],\r\n\t\tgps_available: false,\r\n\t\tposition_update_interval: '',\r\n\t\tsearch_type: ''\r\n\t};\r\n\r\n\tgetOrganisations = () => {\r\n\t\torganisationsHelper.getAllOrganisations(organisations => {\r\n\t\t\tlet organisation_lookup = {};\r\n\t\t\torganisations.forEach(organisation => organisation_lookup[organisation.id] = organisation);\r\n\t\t\tthis.setState({ organisations: organisations, organisation_lookup: organisation_lookup })\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobiles = () => {\r\n\t\tmobilesHelper.getAllMobiles(mobiles => {\r\n\t\t\tlet mobile_lookup = {};\r\n\t\t\tmobiles.forEach(mobile => mobile_lookup[mobile.id] = mobile);\r\n\t\t\tthis.setState({ mobiles: mobiles, mobile_lookup: mobile_lookup });\r\n\t\t});\r\n\t}\r\n\r\n\tgetRoutes = () => {\r\n\t\troutesHelper.getAllRoutes(routes => {\r\n\t\t\tlet route_lookup = {};\r\n\t\t\troutes.forEach(route => route_lookup[route.id] = route);\r\n\t\t\tthis.setState({ routes: routes, route_lookup: route_lookup })\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobileLocations = () => {\r\n\t\tmobilesHelper.getMobileLocations(locations => {\r\n\t\t\tlet mobile_location_lookup = {};\r\n\t\t\tlocations.forEach(location => mobile_location_lookup[location.mobile_id] = location);\r\n\t\t\tthis.setState({ mobile_locations: locations, mobile_location_lookup: mobile_location_lookup });\r\n\t\t});\r\n\t}\r\n\r\n\t// componentDidMount: sets up data and any logging\r\n\tcomponentDidMount = () => {\r\n\t\tthis.getOrganisations();\r\n\t\tthis.getMobiles();\r\n\t\tthis.getRoutes();\r\n\t\t// Set up a timer for the mobile locations\r\n\t\tthis.getMobileLocations();\r\n\t\tconst location_timer = setInterval(() => {\r\n\t\t\tthis.getMobileLocations();\r\n\t\t}, 15000);\r\n\t\tthis.setState({ location_timer: location_timer });\r\n\t}\r\n\r\n\tsetPage = (page) => this.setState({ page: page })\r\n\r\n\tviewStopsByOrganisation = (organisation_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [], route_filter: [] });\r\n\tviewStopsByMobile = (mobile_id) => this.setState({ page: 'stops', organisation_filter: [], mobile_filter: [mobile_id], route_filter: [] });\r\n\tviewStopsByRoute = (route_id) => this.setState({ page: 'stops', organisation_filter: [], mobile_filter: [], route_filter: [route_id] });\r\n\r\n\tclearOrganisationFilter = () => this.setState({ organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\tclearMobileFilter = () => this.setState({ mobile_filter: [], route_filter: [] });\r\n\tclearRouteFilter = () => this.setState({ route_filter: [] });\r\n\r\n\t// logPosition: Retrieve position from gps\r\n\tlogPosition = (fit = false) => {\r\n\t\tthis.setState({ loading: true, gps_loading: true });\r\n\t\tgeoHelper.getCurrentPosition(position => {\r\n\t\t\tthis.setState({ current_position: position, gps_loading: false, gps_available: (position.length > 0) });\r\n\t\t});\r\n\t}\r\n\r\n\t// postcodeSearch\r\n\tpostcodeSearch = (postcode, distance) => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tlet new_state = { search_type: 'postcode', loading: true, postcode_loading: true, postcode: postcode, distance: distance };\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tnew_state.position_update_interval = null;\r\n\t\t}\r\n\r\n\t\t// Get the postcode\r\n\t\tgeoHelper.getPostcode(postcode, location => {\r\n\t\t\tif (location.length === 2) {\r\n\t\t\t\tnew_state.current_position = location;\r\n\t\t\t\tnew_state.position = location;\r\n\t\t\t\tnew_state.zoom = [11];\r\n\t\t\t\tthis.setState(new_state);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// toggleGPS\r\n\ttoggleGPS = () => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tthis.setState({ search_type: '', postcode: '', position_update_interval: null });\r\n\t\t} else {\r\n\t\t\tlet position_update_interval = setInterval(this.logPosition, 10000);\r\n\t\t\tthis.setState({ position_update_interval: position_update_interval, search_type: 'gps', postcode: '' });\r\n\t\t\tthis.logPosition(true);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t<div className={classes.root}>\r\n\t\t\t\t\t<CssBaseline />\r\n\t\t\t\t\t<AppHeader\r\n\t\t\t\t\t\tpage={this.state.page}\r\n\t\t\t\t\t\tsetPage={this.setPage}\r\n\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\tgps_available={this.state.gps_available}\r\n\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<main className={classes.content}>\r\n\t\t\t\t\t\t<div className={classes.toolbar} />\r\n\t\t\t\t\t\t{this.state.page === 'mobiles' ?\r\n\t\t\t\t\t\t\t<Mobiles\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_location_lookup={this.state.mobile_location_lookup}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\tviewStopsByMobile={this.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\tviewStopsByOrganisation={this.viewStopsByOrganisation}\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'stops' ?\r\n\t\t\t\t\t\t\t<Stops\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'map' ?\r\n\t\t\t\t\t\t\t<MobileMap\r\n\t\t\t\t\t\t\t\tbearing={this.state.bearing}\r\n\t\t\t\t\t\t\t\tfit_bounds={this.state.fit_bounds}\r\n\t\t\t\t\t\t\t\tpitch={this.state.pitch}\r\n\t\t\t\t\t\t\t\tposition={this.state.position}\r\n\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_locations={this.state.mobile_locations.filter(l => l.geox !== null)}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t</main>\r\n\t\t\t\t</div>\r\n\t\t\t</MuiThemeProvider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nApp.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(App);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// getCurrentLocation: \r\nexport function getCurrentPosition(callback) {\r\n\tvar options = {\r\n\t\tenableHighAccuracy: true,\r\n\t\ttimeout: 10000,\r\n\t\tmaximumAge: 0\r\n\t};\r\n\tnavigator.geolocation.getCurrentPosition((pos) => {\r\n\t\tcallback([pos.coords.longitude, pos.coords.latitude]);\r\n\t}, err => {\r\n\t\tcallback([]);\r\n\t}, options);\r\n};\r\n\r\n// Get postcode data\r\nexport function getPostcode(postcode, callback) {\r\n\taxios.get('https://api.postcodes.io/postcodes/' + postcode)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data && response.data.result) {\r\n\t\t\t\tcallback([response.data.result.longitude, response.data.result.latitude]);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n};","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n// Our app entry point\nimport App from './App';\n\n// Service worker for PWA behaviour\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}