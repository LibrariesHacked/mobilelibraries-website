{"version":3,"sources":["PostcodeSearch.js","AppHeader.js","Filters.js","helpers/mobiles.js","MobileCard.js","Mobiles.js","MeAvatar.js","helpers/utils.js","MobileAvatar.js","MobileMap.js","helpers/stops.js","Stops.js","StopDetails.js","TripDetails.js","helpers/geo.js","helpers/organisations.js","helpers/routes.js","helpers/trips.js","App.js","serviceWorker.js","index.js"],"names":["PostcodeSearch","state","postcode","props","anchor","openSettingsMenu","e","setState","currentTarget","closeSettingsMenu","setSearchDistance","distance","setDistance","prevProps","this","classes","search_type","postcodeSearch","clearSearch","toggleGPS","className","search","InputBase","placeholder","root","inputRoot","input","inputInput","value","onChange","target","grow","Tooltip","title","IconButton","color","iconButton","onClick","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","React","Component","withStyles","theme","flexGrow","padding","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","marginRight","display","maxWidth","AppHeader","loading","location","AppBar","elevation","pathname","appBarTransparent","appBar","Toolbar","Hidden","xsDown","Typography","variant","noWrap","CircularProgress","progress","size","smDown","Fragment","Button","component","Link","to","leftIcon","mdUp","compose","withRouter","zIndex","drawer","borderBottom","hide","margin","withTheme","Filters","organisation_menu_anchor","mobile_menu_anchor","route_menu_anchor","openOrganisationMenu","element","closeOrganisationMenu","chooseOrganisation","organisation_id","setOrganisationFilter","openMobileMenu","closeMobileMenu","chooseMobile","mobile_id","setMobileFilter","openRouteMenu","closeRouteMenu","chooseRoute","route_id","setRouteFilter","organisations","organisation_lookup","organisation_filter","clearOrganisationFilter","mobiles","mobile_lookup","mobile_filter","clearMobileFilter","routes","route_lookup","route_filter","clearRouteFilter","postcode_district","bull","bullet","countries","Set","map","org","country","Grid","grid","container","item","xs","sm","md","lg","xl","Alert","severity","AlertTitle","Card","card","CardContent","gutterBottom","Math","round","length","CardActions","button","Chip","onDelete","label","name","Array","from","sort","a","b","localeCompare","menu_items","org_list","filter","key","concat","mob","indexOf","route","transform","minWidth","marginBottom","fontSize","fontWeight","config","require","getAllMobiles","callback","axios","get","api","then","response","data","catch","err","getMobileLocations","getMobilesNearest","getMobileStatus","statuses","current_stop_id","previous_stop_id","next_stop_id","moment","next_stop_arrival","isSame","type","text_format","message","arrival","fromNow","next_stop_name","args","stop_name","stop_id","stop_remaining","current_stop_departure","current_stop_name","previous_stop_departure","MobileCard","stopButton","stop","viewStop","offRoadMessage","status","preRouteMessage","stop_button","atStopMessage","betweenStopsMessage","postRouteMessage","goToWebsite","window","mobile","timetable","organisation","mobilesHelper","number_routes","number_stops","viewStopsByMobile","Divider","verticalDivider","align","width","height","Mobiles","on_road","open_tab","changeTab","viewStopsByOrganisation","mobile_location_lookup","mobiles_nearest_lookup","filtered_mobiles","active_mobiles","display_mobiles","organisation_name","mobile_name","route_name","displayStopLink","Tabs","scrollButtons","indicatorColor","textColor","Tab","Badge","showZero","badgeContent","tab","disabled","idx","replace","LinearProgress","chip","MeAvatar","Avatar","avatarOn","avatar","cursor","primary","main","hextoRGBA","hex","alpha","c","test","substring","split","join","Error","MobileAvatar","zoom","Fab","fab","style","utilsHelper","colour","boxShadow","Map","ReactMapboxGl","minZoom","maxZoom","scrollZoom","interactive","dragRotate","attributionControl","stop_tiles","trip_tiles","MobileMap","time_update_interval","current_time","componentDidMount","setInterval","setCurrentTime","clickStop","features","properties","clickTrip","viewTrip","pitch","bearing","fit_bounds","mobile_locations","center","fitBounds","containerStyle","top","bottom","right","left","onStyleLoad","l","location_point","geox","geoy","route_section","coordinates","updated","milliseconds_passed","diff","index","coords","getZoom","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","current_position","getStopById","Stops","tableRef","createRef","getStopCalendar","getStopPdf","viewMapStop","longitude","latitude","current","onQueryChange","displayStopInfo","row","orgText","Object","keys","forEach","mobileText","routeText","components","Container","Paper","table","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","options","isWidthUp","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","field","render","rowData","mdDown","cellStyle","hidden","isWidthDown","route_schedule","format","query","Promise","resolve","reject","organisation_filters","mobile_filters","route_filters","url","page","pageSize","orderBy","orderDirection","stops","total","parseInt","headers","stopsHelper","stopData","totalCount","withWidth","formControl","StopDetails","close","fullScreen","Dialog","disableBackdropClick","aria-labelledby","BackdropProps","invisible","PaperProps","dialog","route_days","DialogTitle","community","DialogContent","startIcon","DialogActions","list","background","paper","TripDetails","trip","estimated_duration","duration","origin_stop_name","destination_stop_name","getCurrentPosition","navigator","geolocation","pos","enableHighAccuracy","timeout","maximumAge","getPostcode","result","admin_district","getAllOrganisations","getAllRoutes","getTripById","createMuiTheme","deepOrange","secondary","brown","overrides","MuiButton","text","textTransform","MuiTab","MuiTableCell","App","stop_dialog_open","current_stop","trip_dialog_open","current_trip","mobiles_nearest","mobile_location_timer","position_update_interval","loading_gps","loading_mobiles","loading_organisations","loading_postcode","loading_routes","snackbar_open","snackbar_message","getOrganisations","organisationsHelper","getMobiles","getRoutes","routesHelper","locations","openStopDialog","closeStopDialog","openTripDialog","tripsHelper","closeTripDialog","viewStopsByRoute","logPosition","geoHelper","clearInterval","new_state","postcode_data","closeSnackbar","event","reason","CssBaseline","content","path","exact","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","action","aria-label","alignItems","justifyContent","mixins","hostname","match","ReactDOM","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7d06beaf.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Material icons\r\nimport ClearIcon from '@material-ui/icons/Clear';\r\nimport LocationSearchingIcon from '@material-ui/icons/LocationSearching';\r\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\n\r\nconst styles = theme => ({\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10\r\n\t},\r\n\tinputRoot: {\r\n\t\tcolor: 'inherit'\r\n\t},\r\n\tinputInput: {\r\n\t\tpaddingTop: theme.spacing(),\r\n\t\tpaddingRight: theme.spacing(),\r\n\t\tpaddingBottom: theme.spacing(),\r\n\t\tpaddingLeft: theme.spacing(2)\r\n\t},\r\n\tsearch: {\r\n\t\tposition: 'relative',\r\n\t\tborder: '1px solid #e5e5e5',\r\n\t\tborderRadius: theme.shape.borderRadius,\r\n\t\tbackgroundColor: fade(theme.palette.common.white, 0.8),\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: fade(theme.palette.common.white, 0.9)\r\n\t\t},\r\n\t\tmarginLeft: 0,\r\n\t\tmarginRight: theme.spacing(),\r\n\t\tdisplay: 'flex',\r\n\t\tmaxWidth: 300\r\n\t}\r\n});\r\n\r\nclass PostcodeSearch extends React.Component {\r\n\tstate = {\r\n\t\tpostcode: this.props.postcode,\r\n\t\tanchor: null\r\n\t}\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.postcode !== prevProps.postcode) this.setState({ postcode: this.props.postcode });\r\n\t}\r\n\r\n\topenSettingsMenu = (e) => this.setState({ anchor: e.currentTarget })\r\n\tcloseSettingsMenu = () => this.setState({ anchor: null })\r\n\r\n\tsetSearchDistance = (distance) => {\r\n\t\tthis.closeSettingsMenu();\r\n\t\tthis.props.setDistance(distance);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, search_type, postcodeSearch, clearSearch, toggleGPS } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.search}>\r\n\t\t\t\t<InputBase\r\n\t\t\t\t\tplaceholder=\"Postcode\"\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.inputRoot,\r\n\t\t\t\t\t\tinput: classes.inputInput\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={this.state.postcode}\r\n\t\t\t\t\tonChange={(e) => this.setState({ postcode: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t{search_type === 'postcode' ?\r\n\t\t\t\t\t<Tooltip title={'Clear search'}>\r\n\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\t\tonClick={() => clearSearch()}>\r\n\t\t\t\t\t\t\t<ClearIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<Tooltip title={'Search by postcode'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tcolor=\"primary\"\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tonClick={() => postcodeSearch(this.state.postcode)}>\r\n\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Track my location'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor={search_type === 'gps' ? 'primary' : 'secondary'}\r\n\t\t\t\t\t\tonClick={() => { toggleGPS() }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{search_type === 'gps' ? <MyLocationIcon /> : <LocationSearchingIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Change search settings'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\tonClick={(e) => { this.openSettingsMenu(e) }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SettingsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"mnu-settings\"\r\n\t\t\t\t\tanchorEl={this.state.anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.anchor)}\r\n\t\t\t\t\tonClose={() => this.closeSettingsMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ListSubheader disableSticky={true}>Search distance</ListSubheader>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(1609)}>1 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(4827)}>3 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(8045)}>5 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(16090)}>10 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(32180)}>20 miles</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(80450)}>50 miles</MenuItem>\r\n\t\t\t\t</Menu>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPostcodeSearch.propTypes = {\r\n\tclasses: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(PostcodeSearch);","// React\r\nimport React, { Component } from 'react';\r\n\r\n// Other core stuff\r\nimport compose from 'recompose/compose';\r\nimport PropTypes from 'prop-types';\r\nimport { Link, withRouter } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material Icons\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport MapIcon from '@material-ui/icons/Map';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = theme => ({\r\n\tappBar: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tborderBottom: '1px solid #F5F5F5'\r\n\t},\r\n\tappBarTransparent: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tbackgroundColor: 'rgba(250, 250, 250, 0.5)',\r\n\t\tborderBottom: '1px solid #F5F5F5'\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\thide: {\r\n\t\tdisplay: 'none'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(1)\r\n\t}\r\n});\r\n\r\nclass AppHeader extends Component {\r\n\r\n\trender() {\r\n\t\tconst { loading, classes, search_type, postcode, distance, toggleGPS, postcodeSearch, clearSearch, setDistance, location } = this.props;\r\n\t\treturn (\r\n\t\t\t<AppBar\r\n\t\t\t\tposition=\"fixed\"\r\n\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\televation={0}\r\n\t\t\t\tclassName={(location.pathname === '/map' ? classes.appBarTransparent : classes.appBar)}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{location.pathname !== '/map' ?\r\n\t\t\t\t\t\t<Hidden xsDown>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" color=\"primary\" noWrap>Mobile libraries</Typography>\r\n\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t\t{loading ? <CircularProgress className={classes.progress} color=\"secondary\" size={30} /> : null}\r\n\t\t\t\t\t{location.pathname === '/map' ?\r\n\t\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t<Hidden smDown>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<Button component={Link} to=\"/\" color=\"secondary\"\r\n\t\t\t\t\t\t\t\tonClick={() => { }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<DashboardIcon className={classes.leftIcon} />Mobiles\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button component={Link} to=\"/stops\" color=\"secondary\"\r\n\t\t\t\t\t\t\t\tonClick={() => { }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button component={Link} to=\"/map\" color=\"secondary\"\r\n\t\t\t\t\t\t\t\tonClick={() => { }}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MapIcon className={classes.leftIcon} />Map\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t<Hidden mdUp>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<IconButton component={Link} to=\"/\" onClick={() => { }}>\r\n\t\t\t\t\t\t\t\t<DashboardIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton component={Link} to=\"/stops\" onClick={() => { }}>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton component={Link} to=\"/map\" onClick={() => { }}>\r\n\t\t\t\t\t\t\t\t<MapIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nAppHeader.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withRouter, withStyles(styles, { withTheme: true }))(AppHeader);","// React\r\nimport React, { Component } from 'react';\r\n\r\n// Other core stuff\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport { Alert, AlertTitle } from '@material-ui/lab';\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport BusinessIcon from '@material-ui/icons/Business';\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\nimport DirectionsIcon from '@material-ui/icons/Directions';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = (theme) => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tposition: 'relative',\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid #F5F5F5'\r\n\t},\r\n\tgrid: {\r\n\t\tmarginBottom: 10\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t}\r\n});\r\n\r\nclass Filters extends Component {\r\n\r\n\tstate = {\r\n\t\torganisation_menu_anchor: null,\r\n\t\tmobile_menu_anchor: null,\r\n\t\troute_menu_anchor: null\r\n\t};\r\n\r\n\topenOrganisationMenu = (element) => {\r\n\t\tthis.setState({ organisation_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseOrganisationMenu = () => {\r\n\t\tthis.setState({ organisation_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseOrganisation = (organisation_id) => {\r\n\t\tthis.props.clearSearch();\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.closeOrganisationMenu();\r\n\t}\r\n\r\n\topenMobileMenu = (element) => {\r\n\t\tthis.setState({ mobile_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseMobileMenu = () => {\r\n\t\tthis.setState({ mobile_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseMobile = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.closeMobileMenu();\r\n\t}\r\n\r\n\topenRouteMenu = (element) => {\r\n\t\tthis.setState({ route_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseRouteMenu = () => {\r\n\t\tthis.setState({ route_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseRoute = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.closeRouteMenu();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter,\r\n\t\t\tclearOrganisationFilter, mobiles, mobile_lookup, mobile_filter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, postcode_district, distance, toggleGPS, postcodeSearch, clearSearch, setDistance\r\n\t\t} = this.props;\r\n\t\tconst bull = <span className={classes.bullet}></span>;\r\n\t\tconst countries = new Set(organisations.map(org => org.country));\r\n\r\n\t\treturn (\r\n\t\t\t<Grid className={classes.grid} container spacing={3}>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t<Alert severity=\"warning\">\r\n\t\t\t\t\t<AlertTitle>In development</AlertTitle>\r\n\t\t\t\t\tWhile this site is being developed you may see unexpected behaviour.\r\n\t\t\t\t</Alert>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{Math.round(distance / 1609) + ' mile radius'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{'GPS tracking ' + (search_type === 'gps' ? 'on' : 'off')}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\" gutterBottom>Search by location</Typography>\r\n\t\t\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{postcode_district !== '' ?\r\n\t\t\t\t\t\t\t\t<Typography variant=\"caption\" display=\"block\">{'Searching around ' + postcode_district + '.'}</Typography>\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={4} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{organisations.length + ' library services'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{mobiles.length + ' mobile libraries'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{routes.length + ' routes'}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">Search by service</Typography>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t\t{organisation_filter.length === 0 ? <Tooltip title=\"Choose library service\">\r\n\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openOrganisationMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t<BusinessIcon className={classes.leftIcon} />Service\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={clearOrganisationFilter} label={organisation_lookup[organisation_filter[0]].name} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{organisation_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(mobile_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose mobile library\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openMobileMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionBusIcon className={classes.leftIcon} />Mobile\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearMobileFilter()} label={mobile_lookup[mobile_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t\t{mobile_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(route_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose route\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openRouteMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionsIcon className={classes.leftIcon} />Route\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearRouteFilter()} label={route_lookup[route_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardActions>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-library-service\"\r\n\t\t\t\t\tanchorEl={this.state.organisation_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.organisation_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeOrganisationMenu()}\r\n\t\t\t\t>\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tArray.from(countries)\r\n\t\t\t\t\t\t\t.sort((a, b) => a.localeCompare(b))\r\n\t\t\t\t\t\t\t.map(country => {\r\n\t\t\t\t\t\t\t\tlet menu_items = [<ListSubheader disableSticky={true}>{country}</ListSubheader>];\r\n\t\t\t\t\t\t\t\tconst org_list = organisations\r\n\t\t\t\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t\t\t\t.filter(org => org.country === country)\r\n\t\t\t\t\t\t\t\t\t.map(org => {\r\n\t\t\t\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => this.chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\treturn menu_items.concat(org_list);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-mobile-library\"\r\n\t\t\t\t\tanchorEl={this.state.mobile_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.mobile_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeMobileMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(mob => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => this.chooseMobile(mob.id)}>{mob.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-route\"\r\n\t\t\t\t\tanchorEl={this.state.route_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.route_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeRouteMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{routes\r\n\t\t\t\t\t\t.filter(route => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(route.mobile_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => this.chooseRoute(route.id)}>{route.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nFilters.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Filters);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// Moment for time calculations\r\nimport moment from 'moment';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllMobiles(callback) {\r\n    axios.get(config.api + '/mobiles')\r\n        .then(response => {\r\n            if (response && response.data) {\r\n                callback(response.data);\r\n            } else {\r\n                callback([]);\r\n            }\r\n        })\r\n        .catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileLocations(callback) {\r\n    axios.get(config.api + '/mobiles/locations')\r\n        .then(response => {\r\n            if (response && response.data) {\r\n                callback(response.data);\r\n            } else {\r\n                callback([]);\r\n            }\r\n        })\r\n        .catch(err => callback([]));\r\n}\r\n\r\nexport function getMobilesNearest(location, distance, callback) {\r\n    axios.get(config.api + '/mobiles/nearest?longitude=' + location[0] + '&latitude=' + location[1] + '&distance=' + distance)\r\n        .then(response => {\r\n            if (response && response.data) {\r\n                callback(response.data);\r\n            } else {\r\n                callback([]);\r\n            }\r\n        })\r\n        .catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileStatus(location) {\r\n\r\n    let statuses = {\r\n        off_road: {\r\n            label: \"Not out today\"\r\n        },\r\n        pre_route: {\r\n            label: \"Arriving at \",\r\n        },\r\n        at_stop: {\r\n            label: \"At \"\r\n        },\r\n        between_stops: {\r\n            label: \"Arriving at \"\r\n        },\r\n        post_route: {\r\n            label: \"Finished for the day\"\r\n        }\r\n    }\r\n\r\n    // The mobile is not due out today\r\n    if (location && !location.current_stop_id &&\r\n        !location.previous_stop_id && location.next_stop_id &&\r\n        !moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n        return {\r\n            type: 'off_road',\r\n            text_format: statuses.off_road.label,\r\n            message: statuses.off_road.label\r\n        };\r\n    }\r\n\r\n    // The mobile is due out today\r\n    if (location && !location.current_stop_id &&\r\n        !location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n        const arrival = moment(location.next_stop_arrival).fromNow();\r\n        return {\r\n            type: 'pre_route',\r\n            message: statuses.pre_route.label,\r\n            text_format: statuses.pre_route.label + location.next_stop_name + ' ' + arrival,\r\n            args: [\r\n                { stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n                arrival\r\n            ]\r\n        };\r\n    }\r\n\r\n    // The mobile is at a stop, and will be for a certain amount of time\r\n    if (location && location.current_stop_id) {\r\n        const stop_remaining = moment(location.current_stop_departure).fromNow(true);\r\n        return {\r\n            type: 'at_stop',\r\n            message: statuses.at_stop.label,\r\n            text_format: statuses.at_stop.label + location.current_stop_name + ' for ' + stop_remaining,\r\n            args: [\r\n                { stop_name: location.current_stop_name, stop_id: location.current_stop_id },\r\n                stop_remaining\r\n            ]\r\n        };\r\n    }\r\n\r\n    // The mobile is between stops\r\n    if (location && !location.current_stop_id &&\r\n        location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n        moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n        const arrival = moment(location.next_stop_arrival).fromNow();\r\n        return {\r\n            type: 'between_stops',\r\n            message: statuses.between_stops.label,\r\n            text_format: statuses.between_stops.label + location.next_stop_name + ' ' + arrival,\r\n            args: [\r\n                { stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n                arrival\r\n            ]\r\n        };\r\n\r\n    }\r\n\r\n    // The mobile has finished for the day\r\n    if (location &&\r\n        location.previous_stop_id && location.next_stop_id &&\r\n        moment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n        !moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n        return {\r\n            type: 'post_route',\r\n            message: statuses.post_route.label,\r\n            text_format: statuses.post_route.label\r\n        };\r\n\r\n    }\r\n\r\n    return null;\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// MUI Icons\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport WebIcon from '@material-ui/icons/Web';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid #F5F5F5'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500,\r\n\t\talign: 'right'\r\n\t},\r\n\tverticalDivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(2),\r\n\t}\r\n});\r\n\r\nclass MobileCard extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\tstopButton = (stop) => {\r\n\t\treturn <Button color=\"secondary\" onClick={() => this.props.viewStop({ id: stop.stop_id })}>{stop.stop_name}</Button>\r\n\t}\r\n\r\n\toffRoadMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\tpreRouteMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tatStopMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{' for ' + status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tbetweenStopsMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tpostRouteMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\tgoToWebsite = () => window.open(this.props.mobile.timetable, '_blank');\r\n\r\n\trender() {\r\n\t\tconst { classes, mobile, organisation, location } = this.props;\r\n\t\tlet status = mobilesHelper.getMobileStatus(location);\r\n\t\tif (status && status.type === 'off_road') status = this.offRoadMessage(status);\r\n\t\tif (status && status.type === 'pre_route') status = this.preRouteMessage(status);\r\n\t\tif (status && status.type === 'at_stop') status = this.atStopMessage(status);\r\n\t\tif (status && status.type === 'between_stops') status = this.betweenStopsMessage(status);\r\n\t\tif (status && status.type === 'post_route') status = this.postRouteMessage(status);\r\n\t\tif (!status) status = <CircularProgress className={classes.progress} color=\"secondary\" size={30} />\r\n\t\tconst bull = <span className={classes.bullet}></span>;\r\n\t\treturn (\r\n\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t{mobile.number_routes + ' route' + (mobile.number_routes > 1 ? 's' : '')}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_stops + ' stop' + (mobile.number_stops > 1 ? 's' : '')}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n\t\t\t\t\t{status}\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<Tooltip title=\"Mobile library stops\">\r\n\t\t\t\t\t\t<Button component={Link} to=\"/stops\" size=\"small\" color=\"primary\" className={classes.button} onClick={() => this.props.viewStopsByMobile(organisation.id, mobile.id)}>\r\n\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t\t{mobile.timetable ? <Tooltip title=\"Website timetable\">\r\n\t\t\t\t\t\t<IconButton className={classes.button} onClick={() => this.goToWebsite()}>\r\n\t\t\t\t\t\t\t<WebIcon />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t</Tooltip> : null}\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileCard.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileCard);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Badge from '@material-ui/core/Badge';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Tabs from '@material-ui/core/Tabs';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\nimport MobileCard from './MobileCard';\r\n\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = (theme) => ({\r\n\tchip: {\r\n\t\tmargin: theme.spacing(1),\r\n\t},\r\n\tpadding: {\r\n\t\tpadding: theme.spacing(0, 2)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t}\r\n});\r\n\r\nclass Mobiles extends Component {\r\n\tstate = {\r\n\t\ton_road: false,\r\n\t\topen_tab: 0\r\n\t};\r\n\r\n\tchangeTab = (value) => {\r\n\t\tthis.setState({ open_tab: value });\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, organisations, organisation_lookup, organisation_filter, setOrganisationFilter, clearOrganisationFilter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_location_lookup, mobiles_nearest_lookup, mobile_filter, setMobileFilter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, setRouteFilter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, postcode_district, distance, toggleGPS, postcodeSearch, clearSearch, setDistance } = this.props;\r\n\r\n\t\t// Get all mobiles that are currently filtered\r\n\t\tconst filtered_mobiles = mobiles.filter(mob => {\r\n\t\t\tlet display = true;\r\n\t\t\tif (search_type === 'gps' || search_type === 'postcode') {\r\n\t\t\t\tdisplay = mobiles_nearest_lookup[mob.id];\r\n\t\t\t}\r\n\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\tdisplay = false;\r\n\t\t\t}\r\n\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\tdisplay = false;\r\n\t\t\t}\r\n\t\t\treturn display;\r\n\t\t});\r\n\t\t// Then get those that are currently active\r\n\t\tconst active_mobiles = filtered_mobiles.filter(mob => {\r\n\t\t\tconst status = mobilesHelper.getMobileStatus(mobile_location_lookup[mob.id]);\r\n\t\t\treturn (status && status.type !== 'off_road' && status.type !== 'post_route');\r\n\t\t});\r\n\r\n\t\t// Apply filters\r\n\t\tconst display_mobiles = (this.state.open_tab === 1 ? active_mobiles : filtered_mobiles);\r\n\r\n\t\t// Calculate title\r\n\t\tconst organisation_name = (organisation_filter.length > 0 ? organisation_lookup[organisation_filter[0]].name : '');\r\n\t\tconst mobile_name = (mobile_filter.length > 0 ? mobile_lookup[mobile_filter[0]].name : '');\r\n\t\tconst route_name = (route_filter.length > 0 ? route_lookup[route_filter[0]].name : '');\r\n\t\tlet title = 'Dashboard';\r\n\t\t// Filter stops\r\n\t\tif (organisation_name !== '') title = 'Mobiles in ' + organisation_name;\r\n\t\tif (mobile_name !== '') title = organisation_name + ' ' + mobile_name;\r\n\t\tif (route_name !== '') title = organisation_name + ' ' + route_name;\r\n\t\t// Postcode search stops\r\n\t\tif (postcode !== '') title = 'Mobiles with stops within ' + Math.round(distance / 1609) + ' mile(s) of ' + postcode;\r\n\t\t// GPS search stops\r\n\t\tif (search_type === 'gps') title = 'Mobiles with stops within ' + Math.round(distance / 1609) + ' mile(s) of your location';\r\n\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={true}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tpostcode_district={postcode_district}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>{title}</ListSubheader>\r\n\t\t\t\t<Tabs\r\n\t\t\t\t\tvariant=\"standard\"\r\n\t\t\t\t\tscrollButtons=\"off\"\r\n\t\t\t\t\tvalue={this.state.open_tab}\r\n\t\t\t\t\tindicatorColor=\"secondary\"\r\n\t\t\t\t\ttextColor=\"secondary\"\r\n\t\t\t\t\tonChange={(e, value) => this.changeTab(value)}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\tshowZero\r\n\t\t\t\t\t\t\t\tclassName={classes.padding}\r\n\t\t\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\t\t\tbadgeContent={filtered_mobiles.length}>\r\n\t\t\t\t\t\t\t\tMobiles\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tclassName={classes.tab}\r\n\t\t\t\t\t\tdisabled={active_mobiles.length === 0}\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<Badge\r\n\t\t\t\t\t\t\t\tclassName={classes.padding}\r\n\t\t\t\t\t\t\t\tcolor={\"secondary\"}\r\n\t\t\t\t\t\t\t\tbadgeContent={active_mobiles.length}>\r\n\t\t\t\t\t\t\t\tActive\r\n\t\t\t\t\t\t\t</Badge>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Tabs>\r\n\t\t\t\t<br />\r\n\t\t\t\t{mobiles ?\r\n\t\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t\t{display_mobiles\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tif (search_type === 'gps' || search_type === 'postcode') {\r\n\t\t\t\t\t\t\t\t\treturn mobiles_nearest_lookup[mob.id];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((mobile, idx) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\t\t\t\tkey={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n\t\t\t\t\t\t\t\t\t\titem xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t\t\t\t\t\t<MobileCard\r\n\t\t\t\t\t\t\t\t\t\t\tmobile={mobile}\r\n\t\t\t\t\t\t\t\t\t\t\tlocation={mobile_location_lookup[mobile.id]}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation={organisation_lookup[mobile.organisation_id]}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStop={this.props.viewStop}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.props.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t</Grid> :\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<LinearProgress color=\"secondary\" />\r\n\t\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobiles.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(Mobiles);","// React and additional\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Icons\r\nimport Face from '@material-ui/icons/Face';\r\n\r\nconst styles = theme => ({\r\n    avatar: {\r\n        margin: 0\r\n    },\r\n    avatarOn: {\r\n        margin: 0,\r\n        cursor: 'pointer',\r\n        backgroundColor: theme.palette.primary.main\r\n    }\r\n});\r\n\r\nclass MeAvatar extends React.Component {\r\n    state = {\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        return (\r\n            <Tooltip title={'Me'}>\r\n                <Avatar\r\n                    className={this.props.search_type === 'gps' ? classes.avatarOn : classes.avatar}>\r\n                    <Face />\r\n                </Avatar>\r\n            </Tooltip>\r\n        );\r\n    }\r\n}\r\n\r\nMeAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(MeAvatar);","export function hextoRGBA(hex, alpha) {\r\n\tvar c;\r\n\tif (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n\t\tc = hex.substring(1).split('');\r\n\t\tif (c.length === 3) {\r\n\t\t\tc = [c[0], c[0], c[1], c[1], c[2], c[2]];\r\n\t\t}\r\n\t\tc = '0x' + c.join('');\r\n\t\treturn 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ', ' + alpha + ')';\r\n\t}\r\n\tthrow new Error('Bad Hex');\r\n}\r\n","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// MUI Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as utilsHelper from './helpers/utils';\r\n\r\nconst styles = theme => ({\r\n    fab: {\r\n        margin: theme.spacing(1),\r\n        boxShadow: 'none'\r\n    }\r\n});\r\n\r\nclass MobileAvatar extends Component {\r\n\r\n    render() {\r\n        const { classes, location, organisation, zoom } = this.props;\r\n        const status = mobilesHelper.getMobileStatus(location);\r\n        const size = (zoom < 8 ? \"small\" : (zoom < 12 ? \"medium\" : \"large\"));\r\n        const border = (zoom < 8 ? 2 : (zoom < 12 ? 3 : 4));\r\n        return (\r\n            <Tooltip\r\n                title={(status ? status.text_format : '')}>\r\n                <Fab \r\n                    size={size}\r\n                    className={classes.fab}\r\n                    color=\"primary\"\r\n                    style={{\r\n                        backgroundColor: utilsHelper.hextoRGBA(organisation.colour, 0.8),\r\n                        border: (border + 'px solid #FFFFFF')\r\n                    }}\r\n                >\r\n                    <DirectionBusIcon />\r\n                </Fab>\r\n            </Tooltip >\r\n        );\r\n    }\r\n}\r\n\r\nMobileAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Mapbox GL\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from \"react-mapbox-gl\";\r\n\r\n// Our components\r\nimport MeAvatar from './MeAvatar';\r\nimport MobileAvatar from './MobileAvatar';\r\n\r\nimport moment from 'moment';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst Map = ReactMapboxGl({\r\n\tminZoom: 5,\r\n\tmaxZoom: 18,\r\n\tscrollZoom: true,\r\n\tinteractive: true,\r\n\tdragRotate: true,\r\n\tattributionControl: true\r\n});\r\n\r\nconst stop_tiles = [config.stop_tiles];\r\nconst trip_tiles = [config.trip_tiles];\r\n\r\nclass MobileMap extends Component {\r\n\r\n\tstate = {\r\n\t\ttime_update_interval: null,\r\n\t\tcurrent_time: null,\r\n\t\tmap: null\r\n\t}\r\n\r\n\tcomponentDidMount = () => {\r\n\t\t// Set up interval to provide a date every 500 milliseconds\r\n\t\tlet time_update_interval = setInterval(this.setCurrentTime, 500);\r\n\t\tthis.setState({ time_update_interval: time_update_interval });\r\n\t}\r\n\r\n\tclickStop = (map) => {\r\n\t\tif (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n\t\t\tthis.props.viewStop({ id: map.features[0].properties.id });\r\n\t\t}\r\n\t}\r\n\r\n\tclickTrip = (map) => {\r\n\t\tif (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n\t\t\tthis.props.viewTrip(map.features[0].properties);\r\n\t\t}\r\n\t}\r\n\r\n\tsetCurrentTime = () => this.setState({ current_time: moment() });\r\n\r\n\trender() {\r\n\t\tconst { position, zoom, pitch, bearing, fit_bounds, mobile_locations, mobile_lookup, organisation_lookup } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Map\r\n\t\t\t\tstyle='style.json'  // eslint-disable-line react/style-prop-object\r\n\t\t\t\tcenter={position}\r\n\t\t\t\tzoom={zoom}\r\n\t\t\t\tmaxZoom={17}\r\n\t\t\t\tpitch={pitch}\r\n\t\t\t\tbearing={bearing}\r\n\t\t\t\tfitBounds={fit_bounds}\r\n\t\t\t\tcontainerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n\t\t\t\tonStyleLoad={map => this.setState({ map: map })}\r\n\t\t\t>\r\n\t\t\t\t{ // The mobile library locations\r\n\t\t\t\t\tmobile_locations && mobile_locations.length > 0 ?\r\n\t\t\t\t\t\tmobile_locations.map(l => {\r\n\t\t\t\t\t\t\tlet location_point = [l.geox, l.geoy];\r\n\t\t\t\t\t\t\tif (this.state.current_time && l.route_section && l.route_section.coordinates && l.updated) {\r\n\t\t\t\t\t\t\t\tconst milliseconds_passed = moment(this.state.current_time).diff(l.updated);\r\n\t\t\t\t\t\t\t\tconst index = Math.round(milliseconds_passed / 500);\r\n\t\t\t\t\t\t\t\tconst coords = l.route_section.coordinates;\r\n\t\t\t\t\t\t\t\tif (coords.length > index && index > 0) location_point = coords[index];\r\n\t\t\t\t\t\t\t\tif (coords.length <= index && index > 0) location_point = coords[coords.length - 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst mobile = mobile_lookup[l.mobile_id];\r\n\t\t\t\t\t\t\tconst organisation = (mobile ? organisation_lookup[mobile.organisation_id] : null);\r\n\t\t\t\t\t\t\treturn <Marker\r\n\t\t\t\t\t\t\t\tkey={'mkr_' + l.id}\r\n\t\t\t\t\t\t\t\tcoordinates={location_point}\r\n\t\t\t\t\t\t\t\tanchor=\"bottom\">\r\n\t\t\t\t\t\t\t\t<MobileAvatar\r\n\t\t\t\t\t\t\t\t\torganisation={organisation}\r\n\t\t\t\t\t\t\t\t\tlocation={l}\r\n\t\t\t\t\t\t\t\t\tzoom={this.state.map ? this.state.map.getZoom() : 0}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t}) : null\r\n\t\t\t\t}\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_stops'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: stop_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_trips'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: trip_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_trips_lines'\r\n\t\t\t\t\ttype='line'\r\n\t\t\t\t\tsourceId='src_trips'\r\n\t\t\t\t\tsourceLayer='trip'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t\"line-join\": \"round\",\r\n\t\t\t\t\t\t\"line-cap\": \"square\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"line-color\": \"#a7a39b\",\r\n\t\t\t\t\t\t\"line-offset\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 0.5,\r\n\t\t\t\t\t\t\t14, 1,\r\n\t\t\t\t\t\t\t15, 2,\r\n\t\t\t\t\t\t\t16, 3,\r\n\t\t\t\t\t\t\t18, 10,\r\n\t\t\t\t\t\t\t22, 20\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"line-opacity\": 1,\r\n\t\t\t\t\t\t\"line-width\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 0.5,\r\n\t\t\t\t\t\t\t14, 1,\r\n\t\t\t\t\t\t\t15, 2,\r\n\t\t\t\t\t\t\t16, 3,\r\n\t\t\t\t\t\t\t18, 10,\r\n\t\t\t\t\t\t\t22, 20\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"line-dasharray\": [\r\n\t\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t\t0.5\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickTrip}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_circles'\r\n\t\t\t\t\ttype='circle'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={5}\r\n\t\t\t\t\tlayout={{}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t'circle-radius': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 2,\r\n\t\t\t\t\t\t\t17, 12\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-color': ['get', 'organisation_colour'],\r\n\t\t\t\t\t\t'circle-stroke-width': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 1,\r\n\t\t\t\t\t\t\t17, 4\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-stroke-color': '#FFFFFF',\r\n\t\t\t\t\t\t'circle-opacity': 0.7\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickStop}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_labels'\r\n\t\t\t\t\ttype='symbol'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t'text-ignore-placement': false,\r\n\t\t\t\t\t\t'text-field': ['to-string', ['get', 'name']],\r\n\t\t\t\t\t\t\"text-font\": [\r\n\t\t\t\t\t\t\t\"Source Sans Pro Bold\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-line-height\": 1,\r\n\t\t\t\t\t\t\"text-size\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 12,\r\n\t\t\t\t\t\t\t17, 22\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-offset\": [0, 2],\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n\t\t\t\t\t\t\"text-halo-width\": 1,\r\n\t\t\t\t\t\t\"text-halo-blur\": 1,\r\n\t\t\t\t\t\t\"text-color\": \"#6a6f73\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickStop}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_next_visiting'\r\n\t\t\t\t\ttype='symbol'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t'text-ignore-placement': false,\r\n\t\t\t\t\t\t'text-field': ['to-string', ['get', 'next_visiting']],\r\n\t\t\t\t\t\t\"text-font\": [\r\n\t\t\t\t\t\t\t\"Source Sans Pro Bold\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-line-height\": 1,\r\n\t\t\t\t\t\t\"text-size\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 10,\r\n\t\t\t\t\t\t\t17, 16\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-offset\": [0, -2.8],\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n\t\t\t\t\t\t\"text-halo-width\": 1,\r\n\t\t\t\t\t\t\"text-halo-blur\": 1,\r\n\t\t\t\t\t\t\"text-color\": \"#6a6f73\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickStop}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.props.current_position && this.props.current_position.length > 1 ?\r\n\t\t\t\t\t<Marker\r\n\t\t\t\t\t\tkey={'mk_me'}\r\n\t\t\t\t\t\tcoordinates={[this.props.current_position[0], this.props.current_position[1]]}>\r\n\t\t\t\t\t\t<MeAvatar search_type={this.props.search_type} />\r\n\t\t\t\t\t</Marker>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<ZoomControl position=\"bottom-right\" />\r\n\t\t\t</Map>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileMap.propTypes = {\r\n\tcurrent_position: PropTypes.array\r\n}\r\n\r\nexport default MobileMap;","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getQueryStops(query, organisation_filters, mobile_filters, route_filters, current_position, distance, callback) {\r\n\r\n\tlet url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize;\r\n\tif (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection;\r\n\r\n\tif (mobile_filters.length > 0) url = url + '&mobile_ids=' + mobile_filters.join('|');\r\n\tif (organisation_filters.length > 0) url = url + '&organisation_ids=' + organisation_filters.join('|');\r\n\tif (route_filters.length > 0) url = url + '&route_ids=' + route_filters.join('|');\r\n\r\n\tif (current_position && current_position.length > 1) url = url + '&longitude=' + current_position[0] + '&latitude=' + current_position[1];\r\n\tif (distance && distance !== '') url = url + '&distance=' + distance;\r\n\r\n\taxios.get(url)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tstops: response.data,\r\n\t\t\t\t\ttotal: parseInt(response.headers['x-total-count']),\r\n\t\t\t\t\tpage: parseInt(response.headers['x-page'])\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({ stops: [], total: 0, page: 1 });\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({ stops: [], total: 0, page: 1 }));\r\n}\r\n\r\nexport function getAllStops(callback) {\r\n\taxios.get(config.api + '/stops')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}\r\n\r\nexport function getStopById(id, callback) {\r\n\taxios.get(config.api + '/stops/' + id)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}","// React\r\nimport compose from 'recompose/compose';\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Link } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport withWidth, { isWidthUp, isWidthDown } from '@material-ui/core/withWidth';\r\n\r\n// Material Table\r\nimport MaterialTable from 'material-table';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpward';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\r\nimport OpenInBrowserIcon from '@material-ui/icons/OpenInBrowser';\r\n\r\nimport EventIcon from '@material-ui/icons/Event';\r\nimport PrintIcon from '@material-ui/icons/Print';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\n// Our Helpers\r\nimport * as stopsHelper from './helpers/stops';\r\nimport { Tooltip } from '@material-ui/core';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = (theme) => ({\r\n\tformControl: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tminWidth: 200\r\n\t},\r\n\tmargin: {\r\n\t\tmargin: theme.spacing(1)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t\tmaxWidth: '100%'\r\n\t},\r\n\ttable: {\r\n\t\tbackgroundColor: 'rgba(0, 0, 0, 0)',\r\n\t\tborder: '1px solid #f5f5f5'\r\n\t}\r\n});\r\n\r\nclass Stops extends Component {\r\n\r\n\ttableRef = React.createRef();\r\n\r\n\tgetStopCalendar = (stop) => window.open(config.api + '/stops/' + stop.id + '/ics');\r\n\tgetStopPdf = (stop) => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank');\r\n\tviewMapStop = (stop) => this.props.viewMapStop(stop.longitude, stop.latitude);\r\n\tgoToWebsite = (stop) => window.open(stop.timetable, '_blank');\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.current_position !== prevProps.current_position || this.props.distance !== prevProps.distance) this.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetOrganisationFilter = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearOrganisationFilter = () => {\r\n\t\tthis.props.clearOrganisationFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetMobileFilter = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearMobileFilter = () => {\r\n\t\tthis.props.clearMobileFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetRouteFilter = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearRouteFilter = () => {\r\n\t\tthis.props.clearRouteFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tdisplayStopInfo = (row) => this.props.viewStop(row);\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_filter,\r\n\t\t\troutes, route_lookup, route_filter, current_position, distance, width,\r\n\t\t\tsearch_type, postcode, postcode_district, toggleGPS, postcodeSearch, clearSearch, setDistance } = this.props;\r\n\r\n\t\t// Calculate title\r\n\t\tconst organisation_name = (organisation_filter.length > 0 ? organisation_lookup[organisation_filter[0]].name : '');\r\n\t\tconst mobile_name = (mobile_filter.length > 0 ? mobile_lookup[mobile_filter[0]].name : '');\r\n\t\tconst route_name = (route_filter.length > 0 ? route_lookup[route_filter[0]].name : '');\r\n\t\tlet title = 'All stops';\r\n\t\t// Filter stops\r\n\t\tif (organisation_name !== '') title = 'Stops in ' + organisation_name;\r\n\t\tif (mobile_name !== '') title = 'Stops for ' + organisation_name + ' ' + mobile_name;\r\n\t\tif (route_name !== '') title = 'Stops for ' + organisation_name + ' ' + route_name;\r\n\t\t// Postcode search stops\r\n\t\tif (postcode !== '') title = 'Stops within ' + Math.round(distance / 1609) + ' mile(s) of ' + postcode;\r\n\t\t// GPS search stops\r\n\t\tif (search_type === 'gps') title = 'Stops within ' + Math.round(distance / 1609) + ' mile(s) of your location';\r\n\r\n\t\tlet orgText = {}\r\n\t\tObject.keys(organisation_lookup).forEach(key => {\r\n\t\t\torgText[key] = organisation_lookup[key].name;\r\n\t\t});\r\n\t\tlet mobileText = {}\r\n\t\tObject.keys(mobile_lookup).forEach(key => {\r\n\t\t\tmobileText[key] = mobile_lookup[key].name;\r\n\t\t});\r\n\t\tlet routeText = {}\r\n\t\tObject.keys(route_lookup).forEach(key => {\r\n\t\t\trouteText[key] = route_lookup[key].name;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ maxWidth: '100%' }}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={false}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={this.setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={this.setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={this.setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tpostcode_district={postcode_district}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\tclearSearch={clearSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>{title}</ListSubheader>\r\n\t\t\t\t<MaterialTable\r\n\t\t\t\t\ttableRef={this.tableRef}\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tContainer: props => <Paper {...props} elevation={0} className={classes.table} />\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ticons={{\r\n\t\t\t\t\t\tFilter: FilterList,\r\n\t\t\t\t\t\tFirstPage: FirstPage,\r\n\t\t\t\t\t\tLastPage: LastPage,\r\n\t\t\t\t\t\tNextPage: ChevronRight,\r\n\t\t\t\t\t\tPreviousPage: ChevronLeft,\r\n\t\t\t\t\t\tSortArrow: ArrowUpward\r\n\t\t\t\t\t}}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tpadding: isWidthUp('sm', width) ? 'default' : 'dense',\r\n\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\tloadingType: 'overlay',\r\n\t\t\t\t\t\tactionsColumnIndex: 0,\r\n\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\ttoolbar: false,\r\n\t\t\t\t\t\theaderStyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: '#fafafa',\r\n\t\t\t\t\t\t\tcolor: '#737373',\r\n\t\t\t\t\t\t\tborder: '0px'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: '',\r\n\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"See more stop details\">\r\n\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.displayStopInfo(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<MoreVertIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Add event to your device calendar\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.getStopCalendar(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<EventIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Download a PDF timetable for this stop\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.getStopPdf(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<PrintIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"See this stop on the map\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.viewMapStop(rowData)} component={Link} to=\"/map\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<LocationOnIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t\t<Hidden mdDown>\r\n\t\t\t\t\t\t\t\t\t\t\t<Tooltip title=\"Go to the website for this stop\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<IconButton onClick={() => this.goToWebsite(rowData)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<OpenInBrowserIcon />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Name',\r\n\t\t\t\t\t\t\tfield: 'name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: false,\r\n\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\trowData.name\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Community',\r\n\t\t\t\t\t\t\tfield: 'community',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Authority',\r\n\t\t\t\t\t\t\tfield: 'organisation_name',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: isWidthDown('md', width),\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Next due',\r\n\t\t\t\t\t\t\tfield: 'route_schedule',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\thidden: isWidthDown('xs', width),\r\n\t\t\t\t\t\t\trender: (rowData) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\trowData.route_schedule.length > 0 ? moment(rowData.route_schedule[0]).format('Do MMMM h:mma') : ''\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcellStyle: {\r\n\t\t\t\t\t\t\t\tborderBottom: '1px solid #f5f5f5',\r\n\t\t\t\t\t\t\t\tbackgroundColor: '#ffffff'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tdata={query =>\r\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tstopsHelper.getQueryStops(query, organisation_filter, mobile_filter, route_filter, current_position, distance, stopData => {\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tdata: stopData.stops,\r\n\t\t\t\t\t\t\t\t\tpage: (stopData.page - 1),\r\n\t\t\t\t\t\t\t\t\ttotalCount: stopData.total,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nStops.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(Stops);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport { Link } from \"react-router-dom\";\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport EventIcon from '@material-ui/icons/Event';\r\nimport PrintIcon from '@material-ui/icons/Print';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = theme => ({\r\n    button: {\r\n        margin: theme.spacing(1)\r\n    },\r\n    dialog: {\r\n        border: '1px solid #e5e5e5'\r\n    },\r\n    leftIcon: {\r\n        marginRight: theme.spacing(1)\r\n    },\r\n    list: {\r\n        width: '100%',\r\n        maxWidth: 360,\r\n        backgroundColor: theme.palette.background.paper\r\n    },\r\n    progress: {\r\n        margin: theme.spacing(2)\r\n    }\r\n});\r\n\r\nclass StopDetails extends React.Component {\r\n    state = {}\r\n\r\n    getStopCalendar = () => window.open(config.api + '/stops/' + this.props.stop.id + '/ics');\r\n    getStopPdf = () => window.open(config.api + '/stops/' + this.props.stop.id + '/pdf', '_blank');\r\n    viewMapStop = () => this.props.viewMapStop(this.props.stop.longitude, this.props.stop.latitude);\r\n    goToWebsite = () => window.open(this.props.stop.timetable, '_blank');\r\n\r\n    close = () => { this.props.close() }\r\n\r\n    render() {\r\n        const { classes, width, stop } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                aria-labelledby=\"dlg-title\"\r\n                BackdropProps={\r\n                    {\r\n                        invisible: true\r\n                    }\r\n                }\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                {stop && stop.route_days ?\r\n                    <React.Fragment>\r\n                        <DialogTitle id=\"dlg-title\">{stop.name + '. ' + stop.community}</DialogTitle>\r\n                        <DialogContent>\r\n                            <ListSubheader>{(stop.route_schedule && stop.route_schedule.length > 0 ? moment(stop.route_schedule[0]).format('dddd Do MMMM h:mma') : '')}</ListSubheader>\r\n                           \r\n                            <br />\r\n                            <Divider />\r\n                            <br />\r\n                            <Button onClick={() => this.getStopCalendar()} className={classes.button} color=\"primary\" startIcon={<EventIcon />}>Calendar</Button>\r\n                            <Button onClick={() => this.getStopPdf()} className={classes.button} color=\"primary\" startIcon={<PrintIcon />}>Timetable</Button>\r\n                            <Button onClick={() => this.viewMapStop()} className={classes.button} color=\"primary\" startIcon={<LocationOnIcon />} component={Link} to=\"/map\">Map</Button>\r\n                        </DialogContent>\r\n                    </React.Fragment> :\r\n                    <CircularProgress className={classes.progress} color=\"secondary\" size={30} />}\r\n                <DialogActions>\r\n                    <Button onClick={() => this.goToWebsite()} color=\"primary\">Website</Button>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nStopDetails.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(StopDetails);","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\nconst styles = theme => ({\r\n    dialog: {\r\n        border: '1px solid #e5e5e5'\r\n    }\r\n});\r\n\r\nclass TripDetails extends React.Component {\r\n    state = {}\r\n\r\n    close = () => { this.props.close() }\r\n\r\n    render() {\r\n        const { classes, width, trip } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        const estimated_duration = Math.round(trip.duration / 60) + ' mins journey time.';\r\n        const distance = Math.round(trip.distance / 1609, 1) + ' mile(s)';\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                BackdropProps={\r\n                    {\r\n                        invisible: true\r\n                    }\r\n                }\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                <DialogTitle>{'Trip details'}</DialogTitle>\r\n                <DialogContent>\r\n                <ListSubheader disableSticky>{'From ' + trip.origin_stop_name + ' to ' + trip.destination_stop_name}</ListSubheader>\r\n                <Typography variant=\"body2\" component=\"p\">{estimated_duration + ' ' + distance}</Typography>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nTripDetails.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(TripDetails);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// getCurrentLocation: \r\nexport function getCurrentPosition(callback) {\r\n\tvar options = {\r\n\t\tenableHighAccuracy: true,\r\n\t\ttimeout: 10000,\r\n\t\tmaximumAge: 0\r\n\t};\r\n\tnavigator.geolocation.getCurrentPosition((pos) => {\r\n\t\tcallback([pos.coords.longitude, pos.coords.latitude]);\r\n\t}, err => {\r\n\t\tcallback([]);\r\n\t}, options);\r\n};\r\n\r\n// Get postcode data\r\nexport function getPostcode(postcode, callback) {\r\n\taxios.get('https://api.postcodes.io/postcodes/' + postcode)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data && response.data.result) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tlocation: [response.data.result.longitude, response.data.result.latitude],\r\n\t\t\t\t\tadmin_district: response.data.result.admin_district\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n};","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllOrganisations(callback) {\r\n\taxios.get(config.api + '/organisations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllRoutes(callback) {\r\n\taxios.get(config.api + '/routes')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllTrips(callback) {\r\n\taxios.get(config.api + '/trips')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getTripById(id, callback) {\r\n\taxios.get(config.api + '/trips/' + id)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}","// React\r\nimport React, { Component } from 'react';\r\n\r\n// Other core stuff\r\nimport PropTypes from 'prop-types';\r\nimport { BrowserRouter, Route } from \"react-router-dom\";\r\n\r\n// Material UI\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\n\r\n// MUI Style\r\nimport deepOrange from '@material-ui/core/colors/deepOrange';\r\nimport brown from '@material-ui/core/colors/brown';\r\nimport { MuiThemeProvider, createMuiTheme, withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport AppHeader from './AppHeader';\r\nimport Mobiles from './Mobiles';\r\nimport MobileMap from './MobileMap';\r\nimport Stops from './Stops';\r\nimport StopDetails from './StopDetails';\r\nimport TripDetails from './TripDetails';\r\n\r\n// Our helpers\r\nimport * as geoHelper from './helpers/geo';\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as organisationsHelper from './helpers/organisations';\r\nimport * as routesHelper from './helpers/routes';\r\nimport * as stopsHelper from './helpers/stops';\r\nimport * as tripsHelper from './helpers/trips';\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: deepOrange,\r\n\t\tsecondary: brown\r\n\t},\r\n\toverrides: {\r\n\t\tMuiButton: {\r\n\t\t\ttext: {\r\n\t\t\t\ttextTransform: 'none'\r\n\t\t\t}\r\n\t\t},\r\n\t\tMuiTab: {\r\n\t\t\troot: {\r\n\t\t\t\ttextTransform: 'none'\r\n\t\t\t}\r\n\t\t},\r\n\t\tMuiTableCell: {\r\n\t\t\troot: {\r\n\t\t\t\tborderBottom: 'none'\r\n\t\t\t}\r\n\t\t},\r\n\t}\r\n});\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\tpadding: '0 8px',\r\n\t\t...theme.mixins.toolbar\r\n\t},\r\n\tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: theme.spacing(3)\r\n\t}\r\n});\r\n\r\nclass App extends Component {\r\n\tstate = {\r\n\t\t// Stop dialog\r\n\t\tstop_dialog_open: false,\r\n\t\tcurrent_stop: {},\r\n\t\t// Trip dialog\r\n\t\ttrip_dialog_open: false,\r\n\t\tcurrent_trip: {},\r\n\t\t// Organisation data\r\n\t\torganisations: [],\r\n\t\torganisation_lookup: {},\r\n\t\torganisation_filter: [],\r\n\t\t// Mobile data\r\n\t\tmobiles: [],\r\n\t\tmobile_lookup: {},\r\n\t\tmobile_filter: [],\r\n\t\tmobile_locations: [],\r\n\t\tmobile_location_lookup: {},\r\n\t\tmobiles_nearest: [],\r\n\t\tmobiles_nearest_lookup: {},\r\n\t\tmobile_location_timer: null,\r\n\t\t// Route data\r\n\t\troutes: [],\r\n\t\troute_lookup: {},\r\n\t\troute_filter: [],\r\n\t\t// Map view settings\r\n\t\tfit_bounds: null,\r\n\t\tposition: [-2.1000, 53.6138],\r\n\t\tzoom: [7],\r\n\t\tpitch: [0],\r\n\t\tbearing: [0],\r\n\t\t// Search\r\n\t\tsearch_type: '', // search types can be gps, postcode, service\r\n\t\tdistance: 1609,\r\n\t\tpostcode: '',\r\n\t\tpostcode_district: '',\r\n\t\t// GPS\r\n\t\tcurrent_position: [],\r\n\t\tposition_update_interval: '',\r\n\t\t// Loading indicators\r\n\t\tloading_gps: true,\r\n\t\tloading_mobiles: false,\r\n\t\tloading_organisations: false,\r\n\t\tloading_postcode: true,\r\n\t\tloading_routes: false,\r\n\t\t// Snackbar\r\n\t\tsnackbar_open: false,\r\n\t\tsnackbar_message: ''\r\n\t};\r\n\r\n\tgetOrganisations = () => {\r\n\t\tthis.setState({ loading_organisations: true });\r\n\t\torganisationsHelper.getAllOrganisations(organisations => {\r\n\t\t\tlet organisation_lookup = {};\r\n\t\t\torganisations.forEach(organisation => organisation_lookup[organisation.id] = organisation);\r\n\t\t\tthis.setState({ organisations: organisations, organisation_lookup: organisation_lookup, loading_organisations: false })\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobiles = () => {\r\n\t\tthis.setState({ loading_mobiles: true });\r\n\t\tmobilesHelper.getAllMobiles(mobiles => {\r\n\t\t\tlet mobile_lookup = {};\r\n\t\t\tmobiles.forEach(mobile => mobile_lookup[mobile.id] = mobile);\r\n\t\t\tthis.setState({ mobiles: mobiles, mobile_lookup: mobile_lookup, loading_mobiles: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetRoutes = () => {\r\n\t\tthis.setState({ loading_routes: true });\r\n\t\troutesHelper.getAllRoutes(routes => {\r\n\t\t\tlet route_lookup = {};\r\n\t\t\troutes.forEach(route => route_lookup[route.id] = route);\r\n\t\t\tthis.setState({ routes: routes, route_lookup: route_lookup, loading_routes: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobileLocations = () => {\r\n\t\tmobilesHelper.getMobileLocations(locations => {\r\n\t\t\tlet mobile_location_lookup = {};\r\n\t\t\tlocations.forEach(location => mobile_location_lookup[location.mobile_id] = location);\r\n\t\t\tthis.setState({ mobile_locations: locations, mobile_location_lookup: mobile_location_lookup });\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobilesNearest = () => {\r\n\t\tmobilesHelper.getMobilesNearest(this.state.current_position, this.state.distance, mobiles => {\r\n\t\t\tlet mobiles_nearest_lookup = {};\r\n\t\t\tmobiles.forEach(mobile => mobiles_nearest_lookup[mobile.mobile_id] = mobile);\r\n\t\t\tthis.setState({ mobiles_nearest: mobiles, mobiles_nearest_lookup: mobiles_nearest_lookup });\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentDidMount = () => {\r\n\t\tthis.getOrganisations();\r\n\t\tthis.getMobiles();\r\n\t\tthis.getRoutes();\r\n\t\tthis.getMobileLocations();\r\n\t\t// Set up a timer for the mobile locations\r\n\t\tconst mobile_location_timer = setInterval(() => {\r\n\t\t\tthis.getMobileLocations();\r\n\t\t}, 15000);\r\n\t\tthis.setState({ mobile_location_timer: mobile_location_timer });\r\n\t}\r\n\r\n\tviewStop = (stop) => {\r\n\t\t// First open the dialog\r\n\t\tthis.openStopDialog(stop);\r\n\t\t// We may or may not have a complete stop object.\r\n\t\t// If calling from the stop table we do - if not we don't, all we have is ID\r\n\t\tif (!stop.name) {\r\n\t\t\tstopsHelper.getStopById(stop.id, stop => {\r\n\t\t\t\tthis.setState({ current_stop: stop })\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\topenStopDialog = (stop) => this.setState({ current_stop: stop, stop_dialog_open: true });\r\n\tcloseStopDialog = () => this.setState({ stop_dialog_open: false });\r\n\r\n\tviewTrip = (trip) => {\r\n\t\t// First open the dialog\r\n\t\tthis.openTripDialog(trip);\r\n\t\ttripsHelper.getTripById(trip.id, trip => {\r\n\t\t\tthis.setState({ current_trip: trip })\r\n\t\t});\r\n\t}\r\n\topenTripDialog = (trip) => this.setState({ current_trip: trip, trip_dialog_open: true });\r\n\tcloseTripDialog = () => this.setState({ trip_dialog_open: false });\r\n\r\n\tviewStopsByOrganisation = (organisation_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [], route_filter: [] });\r\n\tviewStopsByMobile = (organisation_id, mobile_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [] });\r\n\tviewStopsByRoute = (organisation_id, mobile_id, route_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [route_id] });\r\n\tclearMobileFilter = () => this.setState({ mobile_filter: [], route_filter: [] });\r\n\tclearRouteFilter = () => this.setState({ route_filter: [] });\r\n\tclearOrganisationFilter = () => this.setState({ organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\r\n\tviewMapStop = (longitude, latitude) => this.setState({ page: 'map', position: [longitude, latitude], zoom: [15], stop_dialog_open: false });\r\n\r\n\tlogPosition = (fit = false) => {\r\n\t\tthis.setState({ loading_gps: true });\r\n\t\tgeoHelper.getCurrentPosition(position => {\r\n\t\t\tif (position.length === 2) {\r\n\t\t\t\tthis.getMobilesNearest();\r\n\t\t\t\tthis.setState({ current_position: position, position: position, zoom: [12], loading_gps: false });\r\n\t\t\t} else {\r\n\t\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\t\tthis.setState({ search_type: '', postcode: '', current_position: [], position_update_interval: null, snackbar_open: true, snackbar_message: 'Could not fetch current location' });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tsetDistance = (distance) => this.setState({ distance: distance });\r\n\r\n\tclearSearch = () => {\r\n\t\tthis.setState({ postcode: '', postcode_district: '', current_position: [], search_type: '', organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\t}\r\n\r\n\t// postcodeSearch\r\n\tpostcodeSearch = (postcode) => {\r\n\r\n\t\tif (postcode === '') {\r\n\t\t\tthis.setState({ snackbar_open: true, snackbar_message: 'You must enter a postcode', postcode_district: '' });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet new_state = { search_type: 'postcode', loading_postcode: true, postcode: postcode, organisation_filter: [], mobile_filter: [], route_filter: [] };\r\n\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tnew_state.position_update_interval = null;\r\n\t\t}\r\n\r\n\t\t// Get the postcode\r\n\t\tgeoHelper.getPostcode(postcode, postcode_data => {\r\n\t\t\tif (postcode_data.location && postcode_data.location.length === 2) {\r\n\t\t\t\tnew_state.search_type = 'postcode';\r\n\t\t\t\tnew_state.current_position = postcode_data.location;\r\n\t\t\t\tnew_state.position = postcode_data.location;\r\n\t\t\t\tnew_state.zoom = [11];\r\n\t\t\t\tnew_state.loading_postcode = false;\r\n\t\t\t\tnew_state.postcode_district = postcode_data.admin_district;\r\n\t\t\t\tthis.setState(new_state);\r\n\t\t\t\tthis.getMobilesNearest();\r\n\t\t\t} else {\r\n\t\t\t\tthis.setState({ snackbar_open: true, snackbar_message: 'Could not find postcode', postcode_district: '' });\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// toggleGPS\r\n\ttoggleGPS = () => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tthis.setState({ search_type: '', postcode: '', current_position: [], position_update_interval: null });\r\n\t\t} else {\r\n\t\t\tlet position_update_interval = setInterval(this.logPosition, 10000);\r\n\t\t\tthis.setState({ position_update_interval: position_update_interval, search_type: 'gps', postcode: '', organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\t\t\tthis.logPosition(true);\r\n\t\t}\r\n\t}\r\n\r\n\tcloseSnackbar = (event, reason) => {\r\n\t\tif (reason === 'clickaway') {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.setState({ snackbar_open: false });\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t<BrowserRouter>\r\n\t\t\t\t\t<div className={classes.root}>\r\n\t\t\t\t\t\t<CssBaseline />\r\n\t\t\t\t\t\t<AppHeader\r\n\t\t\t\t\t\t\tloading={this.state.loading_mobiles || this.state.loading_organisations || this.state.loading_routes}\r\n\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t\t\tclearSearch={this.clearSearch}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<main className={classes.content}>\r\n\t\t\t\t\t\t\t<div className={classes.toolbar} />\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/'\r\n\t\t\t\t\t\t\t\texact\r\n\t\t\t\t\t\t\t\trender={() => {\r\n\t\t\t\t\t\t\t\t\treturn (<Mobiles\r\n\t\t\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\t\t\tmobile_location_lookup={this.state.mobile_location_lookup}\r\n\t\t\t\t\t\t\t\t\t\tmobiles_nearest_lookup={this.state.mobiles_nearest_lookup}\r\n\t\t\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t\tviewStopsByOrganisation={this.viewStopsByOrganisation}\r\n\t\t\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\t\t\t\tpostcode_district={this.state.postcode_district}\r\n\t\t\t\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t\t\t\t\t\tclearSearch={this.clearSearch}\r\n\t\t\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/stops'\r\n\t\t\t\t\t\t\t\trender={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<Stops\r\n\t\t\t\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t\t\t\t\tviewMapStop={this.viewMapStop}\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\t\t\t\t\tpostcode_district={this.state.postcode_district}\r\n\t\t\t\t\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t\t\t\t\t\t\tclearSearch={this.clearSearch}\r\n\t\t\t\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<Route\r\n\t\t\t\t\t\t\t\tpath='/map'\r\n\t\t\t\t\t\t\t\trender={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<MobileMap\r\n\t\t\t\t\t\t\t\t\t\t\tbearing={this.state.bearing}\r\n\t\t\t\t\t\t\t\t\t\t\tfit_bounds={this.state.fit_bounds}\r\n\t\t\t\t\t\t\t\t\t\t\tpitch={this.state.pitch}\r\n\t\t\t\t\t\t\t\t\t\t\tposition={this.state.position}\r\n\t\t\t\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\t\t\t\tmobile_locations={this.state.mobile_locations.filter(l => l.geox !== null)}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t\t\t\t\tviewTrip={this.viewTrip}\r\n\t\t\t\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</main>\r\n\t\t\t\t\t\t<StopDetails\r\n\t\t\t\t\t\t\tstop={this.state.current_stop}\r\n\t\t\t\t\t\t\topen={this.state.stop_dialog_open}\r\n\t\t\t\t\t\t\tclose={() => this.closeStopDialog()}\r\n\t\t\t\t\t\t\tviewMapStop={this.viewMapStop}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<TripDetails\r\n\t\t\t\t\t\t\ttrip={this.state.current_trip}\r\n\t\t\t\t\t\t\topen={this.state.trip_dialog_open}\r\n\t\t\t\t\t\t\tclose={() => this.closeTripDialog()}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Snackbar\r\n\t\t\t\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\t\t\t\tvertical: 'bottom',\r\n\t\t\t\t\t\t\t\thorizontal: 'left'\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\topen={this.state.snackbar_open}\r\n\t\t\t\t\t\t\tautoHideDuration={4000}\r\n\t\t\t\t\t\t\tonClose={this.closeSnackbar}\r\n\t\t\t\t\t\t\tContentProps={{\r\n\t\t\t\t\t\t\t\t'aria-describedby': 'message-id',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tmessage={<span id=\"message-id\">{this.state.snackbar_message}</span>}\r\n\t\t\t\t\t\t\taction={[\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\tkey=\"close\"\r\n\t\t\t\t\t\t\t\t\taria-label=\"close\"\r\n\t\t\t\t\t\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\t\t\t\t\t\tclassName={classes.close}\r\n\t\t\t\t\t\t\t\t\tonClick={this.closeSnackbar}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<CloseIcon />\r\n\t\t\t\t\t\t\t\t</IconButton>,\r\n\t\t\t\t\t\t\t]}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</BrowserRouter>\r\n\t\t\t</MuiThemeProvider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nApp.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(App);","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11';\r\nimport 'react-app-polyfill/stable';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\n// Our app entry point\r\nimport App from './App';\r\n\r\n// Service worker for PWA behaviour\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}