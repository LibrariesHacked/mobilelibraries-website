{"version":3,"sources":["PostcodeSearch.js","AppHeader.js","Filters.js","helpers/mobiles.js","MobileCard.js","Mobiles.js","MeAvatar.js","MobileAvatar.js","MobileMap.js","helpers/stops.js","Stops.js","helpers/organisations.js","helpers/routes.js","App.js","helpers/geo.js","serviceWorker.js","index.js"],"names":["PostcodeSearch","state","postcode","_this","props","anchor","openSettingsMenu","e","setState","currentTarget","closeSettingsMenu","setSearchDistance","distance","setDistance","_this2","this","_this$props","classes","search_type","postcodeSearch","toggleGPS","react_default","a","createElement","className","search","InputBase","placeholder","root","inputRoot","input","inputInput","value","onChange","target","Tooltip","title","IconButton","iconButton","onClick","Search_default","Divider","divider","color","MyLocation_default","LocationSearching_default","Settings_default","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","React","Component","withStyles","theme","width","height","margin","padding","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","&:hover","marginLeft","marginRight","display","AppHeader","loading","page","AppBar","elevation","appBarTransparent","appBar","Toolbar","Hidden","xsDown","Typography","variant","noWrap","grow","CircularProgress","progress","size","src_PostcodeSearch","smDown","Fragment","Button","setPage","Dashboard_default","leftIcon","LocationOn_default","Map_default","mdUp","zIndex","drawer","flexGrow","hide","withTheme","Filters","organisation_menu_anchor","mobile_menu_anchor","route_menu_anchor","openOrganisationMenu","element","closeOrganisationMenu","chooseOrganisation","organisation_id","setOrganisationFilter","openMobileMenu","closeMobileMenu","chooseMobile","mobile_id","setMobileFilter","openRouteMenu","closeRouteMenu","chooseRoute","route_id","setRouteFilter","organisations","organisation_lookup","organisation_filter","clearOrganisationFilter","mobiles","mobile_lookup","mobile_filter","clearMobileFilter","routes","route_lookup","route_filter","clearRouteFilter","bull","bullet","Grid","grid","container","item","xs","sm","md","lg","xl","Card","card","CardContent","gutterBottom","length","CardActions","button","Business_default","Chip","onDelete","label","name","DirectionsBus_default","Directions_default","sort","b","localeCompare","map","org","key","filter","mob","indexOf","route","transform","minWidth","marginBottom","fontSize","fontWeight","config","require","getMobileStatus","mobile","location","statuses","current_stop_id","previous_stop_id","next_stop_id","moment","next_stop_arrival","isSame","arrival","fromNow","util","format","next_stop_name","stop_remaining","current_stop_departure","current_stop_name","previous_stop_departure","MobileCard","organisation","status","mobilesHelper","number_routes","number_stops","component","viewStopsByMobile","verticalDivider","Mobiles","viewStopsByOrganisation","mobile_location_lookup","src_Filters","displayStopLink","idx","replace","src_MobileCard","LinearProgress","MeAvatar","Avatar","avatarOn","avatar","Face_default","cursor","primary","main","MobileAvatar","Fab","fab","boxShadow","Map","ReactMapboxGl","minZoom","maxZoom","scrollZoom","interactive","dragRotate","attributionControl","stop_tiles","trip_tiles","MobileMap","time_update_interval","current_time","componentDidMount","setInterval","setCurrentTime","zoom","pitch","bearing","fit_bounds","mobile_locations","MobileMap_Map","style","center","fitBounds","containerStyle","top","bottom","right","left","l","location_point","geox","geoy","route_section","coordinates","updated","milliseconds_passed","diff","index","Math","round","coords","lib_esm","src_MobileAvatar","tileJsonSource","type","tiles","sourceId","sourceLayer","layout","line-join","line-cap","paint","line-color","line-opacity","line-width","line-dasharray","circle-radius","circle-color","circle-stroke-width","circle-stroke-color","circle-opacity","text-ignore-placement","text-field","text-font","text-line-height","text-size","text-offset","text-halo-color","text-halo-width","text-halo-blur","text-color","current_position","src_MeAvatar","Stops","tableRef","createRef","current","onQueryChange","getStopCalendar","row","window","api","getStopPdf","nextProps","orgText","Object","keys","forEach","mobileText","routeText","maxWidth","dist_default","components","Container","Paper","assign","table","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","options","isWidthUp","loadingType","actionsColumnIndex","filtering","headerStyle","columns","field","render","rowData","departure","actions","icon","Event_default","tooltip","SaveAlt_default","data","query","Promise","resolve","reject","organisation_filters","mobile_filters","route_filters","callback","url","pageSize","orderBy","orderDirection","join","axios","get","then","response","stops","total","parseInt","headers","catch","err","stopsHelper","stopData","totalCount","compose","withWidth","formControl","createMuiTheme","deepOrange","secondary","blueGrey","overrides","MuiButton","text","textTransform","App","location_timer","gps_loading","postcode_loading","position_update_interval","loading_organisations","loading_mobiles","loading_routes","loading_locations","getOrganisations","getMobiles","getRoutes","getMobileLocations","locations","viewStopsByRoute","logPosition","arguments","undefined","navigator","geolocation","getCurrentPosition","pos","longitude","latitude","enableHighAccuracy","timeout","maximumAge","new_state","clearInterval","result","geoHelper","MuiThemeProvider","CssBaseline","src_AppHeader","content","toolbar","src_Mobiles","src_Stops","src_MobileMap","objectSpread","alignItems","justifyContent","mixins","hostname","match","ReactDOM","src_App","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.ae8907a2.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Material icons\r\nimport LocationSearchingIcon from '@material-ui/icons/LocationSearching';\r\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\n\r\nconst styles = theme => ({\r\n\tdivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\ticonButton: {\r\n\t\tpadding: 10\r\n\t},\r\n\tinputRoot: {\r\n\t\tcolor: 'inherit'\r\n\t},\r\n\tinputInput: {\r\n\t\tpaddingTop: theme.spacing(),\r\n\t\tpaddingRight: theme.spacing(),\r\n\t\tpaddingBottom: theme.spacing(),\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\twidth: 100\r\n\t},\r\n\tsearch: {\r\n\t\tposition: 'relative',\r\n\t\tborder: '1px solid #e5e5e5',\r\n\t\tborderRadius: theme.shape.borderRadius,\r\n\t\tbackgroundColor: fade(theme.palette.common.white, 0.8),\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: fade(theme.palette.common.white, 0.9),\r\n\t\t},\r\n\t\tmarginLeft: 0,\r\n\t\tmarginRight: theme.spacing(),\r\n\t\tdisplay: 'flex'\r\n\t}\r\n});\r\n\r\nclass PostcodeSearch extends React.Component {\r\n\tstate = {\r\n\t\tpostcode: this.props.postcode,\r\n\t\tanchor: null\r\n\t}\r\n\r\n\topenSettingsMenu = (e) => this.setState({ anchor: e.currentTarget })\r\n\tcloseSettingsMenu = () => this.setState({ anchor: null })\r\n\r\n\tsetSearchDistance = (distance) => {\r\n\t\tthis.closeSettingsMenu();\r\n\t\tthis.props.setDistance(distance);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, search_type, postcodeSearch, toggleGPS } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.search}>\r\n\t\t\t\t<InputBase\r\n\t\t\t\t\tplaceholder=\"Postcode\"\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.inputRoot,\r\n\t\t\t\t\t\tinput: classes.inputInput,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={this.state.postcode}\r\n\t\t\t\t\tonChange={(e) => this.setState({ postcode: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<Tooltip title={'Search by postcode'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tonClick={() => postcodeSearch(this.state.postcode)}>\r\n\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Divider className={classes.divider} />\r\n\t\t\t\t<Tooltip title={'Track my location'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\tonClick={() => { toggleGPS() }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{search_type === 'gps' ? <MyLocationIcon /> : <LocationSearchingIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Change search settings'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\tonClick={(e) => { this.openSettingsMenu(e) }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SettingsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"mnu-settings\"\r\n\t\t\t\t\tanchorEl={this.state.anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.anchor)}\r\n\t\t\t\t\tonClose={() => this.closeSettingsMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ListSubheader disableSticky={true}>Search distance</ListSubheader>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(1609)}>1 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(3219)}>2 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(4828)}>3 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(8047)}>5 miles</MenuItem>\r\n\t\t\t\t</Menu>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPostcodeSearch.propTypes = {\r\n\tclasses: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(PostcodeSearch);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material Icons\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport MapIcon from '@material-ui/icons/Map';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = theme => ({\r\n\tappBar: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tbackgroundColor: 'rgba(250, 250, 250, 1)'\r\n\t},\r\n\tappBarTransparent: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tbackgroundColor: 'rgba(250, 250, 250, 0)'\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\thide: {\r\n\t\tdisplay: 'none'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(1),\r\n\t}\r\n});\r\n\r\nclass AppHeader extends Component {\r\n\r\n\trender() {\r\n\t\tconst { loading, classes, search_type, postcode, distance, toggleGPS, postcodeSearch, setDistance, page } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<AppBar\r\n\t\t\t\tposition=\"fixed\"\r\n\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\televation={0}\r\n\t\t\t\tclassName={(page === 'map' ? classes.appBarTransparent : classes.appBar)}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{page !== 'map' ?\r\n\t\t\t\t\t\t<Hidden xsDown>\r\n\t\t\t\t\t\t\t<Typography color=\"secondary\" variant=\"h6\" noWrap>Mobiles</Typography>\r\n\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t\t{loading ? <CircularProgress className={classes.progress} color=\"secondary\" size={30} /> : null}\r\n\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Hidden smDown>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'mobiles' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('mobiles')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<DashboardIcon className={classes.leftIcon} />Mobile dashboard\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'stops' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('stops')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Find a stop\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'map' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('map')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MapIcon className={classes.leftIcon} />Map\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t<Hidden mdUp>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('mobiles')}>\r\n\t\t\t\t\t\t\t\t<DashboardIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('stops')}>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('map')}>\r\n\t\t\t\t\t\t\t\t<MapIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nAppHeader.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(AppHeader);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport BusinessIcon from '@material-ui/icons/Business';\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\nimport DirectionsIcon from '@material-ui/icons/Directions';\r\n\r\n// Our components\r\n\r\n\r\nconst styles = (theme) => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tposition: 'relative',\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t},\r\n\tgrid: {\r\n\t\tmarginBottom: 10\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t}\r\n});\r\n\r\nclass Filters extends Component {\r\n\r\n\tstate = {\r\n\t\torganisation_menu_anchor: null,\r\n\t\tmobile_menu_anchor: null,\r\n\t\troute_menu_anchor: null\r\n\t};\r\n\r\n\topenOrganisationMenu = (element) => {\r\n\t\tthis.setState({ organisation_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseOrganisationMenu = () => {\r\n\t\tthis.setState({ organisation_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseOrganisation = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.closeOrganisationMenu();\r\n\t}\r\n\r\n\topenMobileMenu = (element) => {\r\n\t\tthis.setState({ mobile_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseMobileMenu = () => {\r\n\t\tthis.setState({ mobile_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseMobile = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.closeMobileMenu();\r\n\t}\r\n\r\n\topenRouteMenu = (element) => {\r\n\t\tthis.setState({ route_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseRouteMenu = () => {\r\n\t\tthis.setState({ route_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseRoute = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.closeRouteMenu();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter,\r\n\t\t\tclearOrganisationFilter, mobiles, mobile_lookup, mobile_filter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, clearRouteFilter\r\n\t\t} = this.props;\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\r\n\t\treturn (\r\n\t\t\t<Grid className={classes.grid} container spacing={3}>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{organisations.length + ' library services'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{mobiles.length + ' mobile libraries'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{routes.length + ' routes'}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t\t{organisation_filter.length === 0 ? <Tooltip title=\"Choose library service\">\r\n\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"secondary\" className={classes.button} onClick={(e) => this.openOrganisationMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t<BusinessIcon className={classes.leftIcon} />Service\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={clearOrganisationFilter} label={organisation_lookup[organisation_filter[0]].name} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{organisation_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(mobile_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose mobile library\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"secondary\" className={classes.button} onClick={(e) => this.openMobileMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionBusIcon className={classes.leftIcon} />Mobile\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearMobileFilter()} label={mobile_lookup[mobile_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t\t{mobile_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(route_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose route\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"secondary\" className={classes.button} onClick={(e) => this.openRouteMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionsIcon className={classes.leftIcon} />Route\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearRouteFilter()} label={route_lookup[route_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardActions>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-library-service\"\r\n\t\t\t\t\tanchorEl={this.state.organisation_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.organisation_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeOrganisationMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{organisations\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(org => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => this.chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-mobile-library\"\r\n\t\t\t\t\tanchorEl={this.state.mobile_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.mobile_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeMobileMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(mob => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => this.chooseMobile(mob.id)}>{mob.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-route\"\r\n\t\t\t\t\tanchorEl={this.state.route_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.route_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeRouteMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{routes\r\n\t\t\t\t\t\t.filter(route => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(route.mobile_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => this.chooseRoute(route.id)}>{route.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nFilters.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Filters);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// Moment for time calculations\r\nimport moment from 'moment';\r\n\r\nimport util from 'util';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllMobiles(callback) {\r\n\taxios.get(config.api + '/mobiles')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileLocations(callback) {\r\n\taxios.get(config.api + '/mobiles/locations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileStatus(mobile, location) {\r\n\r\n\tlet statuses = {\r\n\t\toff_road: {\r\n\t\t\tlabel: \"Not out today\"\r\n\t\t},\r\n\t\tpre_route: {\r\n\t\t\tlabel: \"Arriving at %s %s\"\r\n\t\t},\r\n\t\tat_stop: {\r\n\t\t\tlabel: \"At %s for %s\"\r\n\t\t},\r\n\t\tbetween_stops: {\r\n\t\t\tlabel: \"Arriving at %s %s\"\r\n\t\t},\r\n\t\tpost_route: {\r\n\t\t\tlabel: \"Finished for the day\"\r\n\t\t}\r\n\t}\r\n\r\n\t// The mobile is not due out today\r\n\tif (location && !location.current_stop_id &&\r\n\t\t!location.previous_stop_id && location.next_stop_id &&\r\n\t\t!moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\treturn statuses.off_road.label;\r\n\t}\r\n\r\n\t// The mobile is due out today\r\n\tif (location && !location.current_stop_id &&\r\n\t\t!location.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\tconst arrival = moment(location.next_stop_arrival).fromNow()\r\n\t\treturn util.format(statuses.pre_route.label, location.next_stop_name, arrival);\r\n\t}\r\n\r\n\t// The mobile is at a stop, and will be for a certain amount of time\r\n\tif (location && location.current_stop_id) {\r\n\t\tconst stop_remaining = moment(location.current_stop_departure).fromNow(true);\r\n\t\treturn util.format(statuses.at_stop.label, location.current_stop_name, stop_remaining);\r\n\t}\r\n\r\n\t// The mobile is between stops\r\n\tif (location && !location.current_stop_id &&\r\n\t\tlocation.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n\t\tmoment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\tconst arrival = moment(location.next_stop_arrival).fromNow();\r\n\t\treturn util.format(statuses.between_stops.label, location.next_stop_name, arrival);\r\n\r\n\t}\r\n\r\n\t// The mobile has finished for the day\r\n\tif (location &&\r\n\t\tlocation.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n\t\t!moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\treturn statuses.post_route.label;\r\n\t}\r\n\r\n\treturn null;\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// MUI Icons\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t},\r\n\tverticalDivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(2),\r\n\t}\r\n});\r\n\r\nclass MobileCard extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, mobile, organisation, location } = this.props;\r\n\t\tconst status = mobilesHelper.getMobileStatus(mobile, location);\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\t\treturn (\r\n\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t{mobile.number_routes + ' route' + (mobile.number_routes > 1 ? 's' : '')}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_stops + ' stop' + (mobile.number_stops > 1 ? 's' : '')}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n\t\t\t\t\t{status ?\r\n\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" label={status} /> :\r\n\t\t\t\t\t\t<CircularProgress className={classes.progress} color=\"secondary\" size={30} />}\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<Divider variant=\"middle\" />\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<Tooltip title=\"Mobile library stops\">\r\n\t\t\t\t\t\t<Button size=\"small\" color=\"secondary\" className={classes.button} onClick={() => this.props.viewStopsByMobile(mobile.id)}>\r\n\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileCard.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileCard);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\nimport MobileCard from './MobileCard';\r\n\r\nconst styles = () => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t}\r\n});\r\n\r\nclass Mobiles extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, organisations, organisation_lookup, organisation_filter, setOrganisationFilter, clearOrganisationFilter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_location_lookup, mobile_filter, setMobileFilter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, setRouteFilter, clearRouteFilter } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={true}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={clearRouteFilter}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>Mobile library dashboard</ListSubheader>\r\n\t\t\t\t{mobiles && mobiles.length > 0 ?\r\n\t\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((mobile, idx) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\t\t\t\tkey={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n\t\t\t\t\t\t\t\t\t\titem xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t\t\t\t\t\t<MobileCard\r\n\t\t\t\t\t\t\t\t\t\t\tmobile={mobile}\r\n\t\t\t\t\t\t\t\t\t\t\tlocation={mobile_location_lookup[mobile.id]}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation={organisation_lookup[mobile.organisation_id]}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.props.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t</Grid> :\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<LinearProgress color=\"secondary\" />\r\n\t\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobiles.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(Mobiles);","// React and additional\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Icons\r\nimport Face from '@material-ui/icons/Face';\r\n\r\nconst styles = theme => ({\r\n    avatar: {\r\n        margin: 0\r\n    },\r\n    avatarOn: {\r\n        margin: 0,\r\n        cursor: 'pointer',\r\n        backgroundColor: theme.palette.primary.main\r\n    }\r\n});\r\n\r\nclass MeAvatar extends React.Component {\r\n    state = {\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        return (\r\n            <Tooltip title={'Me'}>\r\n                <Avatar\r\n                    className={this.props.search_type === 'gps' ? classes.avatarOn : classes.avatar}>\r\n                    <Face />\r\n                </Avatar>\r\n            </Tooltip>\r\n        );\r\n    }\r\n}\r\n\r\nMeAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(MeAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// MUI Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tfab: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tboxShadow: 'none'\r\n\t}\r\n});\r\n\r\nclass MobileAvatar extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, location, mobile } = this.props;\r\n\t\treturn (\r\n\t\t\t<Tooltip\r\n\t\t\t\ttitle={mobilesHelper.getMobileStatus(mobile, location)}>\r\n\t\t\t\t<Fab size=\"small\" color=\"primary\" className={classes.fab}>\r\n\t\t\t\t\t<DirectionBusIcon />\r\n\t\t\t\t</Fab>\r\n\t\t\t</Tooltip>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileAvatar.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Mapbox GL\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from \"react-mapbox-gl\";\r\n\r\n// Our components\r\nimport MeAvatar from './MeAvatar';\r\nimport MobileAvatar from './MobileAvatar';\r\n\r\nimport moment from 'moment';\r\n\r\nconst Map = ReactMapboxGl({\r\n\tminZoom: 5,\r\n\tmaxZoom: 18,\r\n\tscrollZoom: true,\r\n\tinteractive: true,\r\n\tdragRotate: true,\r\n\tattributionControl: true\r\n});\r\n\r\nconst stop_tiles = ['https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt'];\r\nconst trip_tiles = ['https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt'];\r\n\r\nclass MobileMap extends Component {\r\n\r\n\tstate = {\r\n\t\ttime_update_interval: null,\r\n\t\tcurrent_time: null\r\n\t}\r\n\r\n\tcomponentDidMount = () => {\r\n\t\t// Set up interval to provide a date every 500 milliseconds\r\n\t\tlet time_update_interval = setInterval(this.setCurrentTime, 500);\r\n\t\tthis.setState({ time_update_interval: time_update_interval });\r\n\t}\r\n\r\n\tsetCurrentTime = () => this.setState({ current_time: moment() });\r\n\r\n\trender() {\r\n\t\tconst { position, zoom, pitch, bearing, fit_bounds, mobile_locations, mobile_lookup } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Map\r\n\t\t\t\tstyle='style.json'  // eslint-disable-line react/style-prop-object\r\n\t\t\t\tcenter={position}\r\n\t\t\t\tzoom={zoom}\r\n\t\t\t\tmaxZoom={17}\r\n\t\t\t\tpitch={pitch}\r\n\t\t\t\tbearing={bearing}\r\n\t\t\t\tfitBounds={fit_bounds}\r\n\t\t\t\tcontainerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n\t\t\t>\r\n\t\t\t\t{ // The mobile library locations\r\n\t\t\t\t\tmobile_locations && mobile_locations.length > 0 ?\r\n\t\t\t\t\t\tmobile_locations.map(l => {\r\n\t\t\t\t\t\t\tlet location_point = [l.geox, l.geoy];\r\n\t\t\t\t\t\t\tif (this.state.current_time && l.route_section && l.route_section.coordinates && l.updated) {\r\n\t\t\t\t\t\t\t\tconst milliseconds_passed = moment(this.state.current_time).diff(l.updated);\r\n\t\t\t\t\t\t\t\tconst index = Math.round(milliseconds_passed / 500);\r\n\t\t\t\t\t\t\t\tconst coords = l.route_section.coordinates;\r\n\t\t\t\t\t\t\t\tif (coords.length > index && index > 0) location_point = coords[index];\r\n\t\t\t\t\t\t\t\tif (coords.length <= index && index > 0) location_point = coords[coords.length - 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn <Marker\r\n\t\t\t\t\t\t\t\tkey={'mkr_' + l.id}\r\n\t\t\t\t\t\t\t\tcoordinates={location_point}\r\n\t\t\t\t\t\t\t\tanchor=\"bottom\">\r\n\t\t\t\t\t\t\t\t<MobileAvatar\r\n\t\t\t\t\t\t\t\t\tmobile={mobile_lookup[l.mobile_id]}\r\n\t\t\t\t\t\t\t\t\tlocation={l}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t}) : null\r\n\t\t\t\t}\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_stops'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: stop_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_trips'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: trip_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_trips_lines'\r\n\t\t\t\t\ttype='line'\r\n\t\t\t\t\tsourceId='src_trips'\r\n\t\t\t\t\tsourceLayer='trip'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t\"line-join\": \"round\",\r\n\t\t\t\t\t\t\"line-cap\": \"square\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"line-color\": \"#a7a39b\",\r\n\t\t\t\t\t\t\"line-opacity\": 1,\r\n\t\t\t\t\t\t\"line-width\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 0.5,\r\n\t\t\t\t\t\t\t14, 1,\r\n\t\t\t\t\t\t\t15, 2,\r\n\t\t\t\t\t\t\t16, 3,\r\n\t\t\t\t\t\t\t18, 10,\r\n\t\t\t\t\t\t\t22, 20\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"line-dasharray\": [\r\n\t\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t\t0.5\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_circles'\r\n\t\t\t\t\ttype='circle'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={7}\r\n\t\t\t\t\tlayout={{}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t'circle-radius': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 2,\r\n\t\t\t\t\t\t\t17, 10\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-color': '#607d8b',\r\n\t\t\t\t\t\t'circle-stroke-width': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 1,\r\n\t\t\t\t\t\t\t14, 2\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-stroke-color': '#FFFFFF',\r\n\t\t\t\t\t\t'circle-opacity': 0.8\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_labels'\r\n\t\t\t\t\ttype='symbol'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t'text-ignore-placement': false,\r\n\t\t\t\t\t\t'text-field': ['to-string', ['get', 'name']],\r\n\t\t\t\t\t\t\"text-font\": [\r\n\t\t\t\t\t\t\t\"Source Sans Pro Bold\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-line-height\": 1,\r\n\t\t\t\t\t\t\"text-size\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 10,\r\n\t\t\t\t\t\t\t17, 22\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-offset\": [0, 1.7],\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n\t\t\t\t\t\t\"text-halo-width\": 1,\r\n\t\t\t\t\t\t\"text-halo-blur\": 1,\r\n\t\t\t\t\t\t\"text-color\": \"#6a6f73\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.props.current_position && this.props.current_position.length > 1 ?\r\n\t\t\t\t\t<Marker\r\n\t\t\t\t\t\tkey={'mk_me'}\r\n\t\t\t\t\t\tcoordinates={[this.props.current_position[0], this.props.current_position[1]]}>\r\n\t\t\t\t\t\t<MeAvatar search_type={this.props.search_type} />\r\n\t\t\t\t\t</Marker>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<ZoomControl position=\"bottom-right\" />\r\n\t\t\t</Map>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileMap.propTypes = {\r\n\tcurrent_position: PropTypes.array\r\n}\r\n\r\nexport default MobileMap;","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getQueryStops(query, organisation_filters, mobile_filters, route_filters, current_position, distance, callback) {\r\n\r\n\tlet url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize;\r\n\tif (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection;\r\n\r\n\tif (mobile_filters.length > 0) url = url + '&mobile_ids=' + mobile_filters.join('|');\r\n\tif (organisation_filters.length > 0) url = url + '&organisation_ids=' + organisation_filters.join('|');\r\n\tif (route_filters.length > 0) url = url + '&route_ids=' + route_filters.join('|');\r\n\r\n\tif (current_position && current_position.length > 1) url = url + '&longitude=' + current_position[0] + '&latitude=' + current_position[1];\r\n\tif (distance && distance !== '') url = url + '&distance=' + distance;\r\n\r\n\taxios.get(url)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tstops: response.data,\r\n\t\t\t\t\ttotal: parseInt(response.headers['x-total-count']),\r\n\t\t\t\t\tpage: parseInt(response.headers['x-page'])\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({ stops: [], total: 0, page: 1 });\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({ stops: [], total: 0, page: 1 }));\r\n}\r\n\r\nexport function getAllStops(callback) {\r\n\taxios.get(config.api + '/stops')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}","// React\r\nimport compose from 'recompose/compose';\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport withWidth, { isWidthUp } from '@material-ui/core/withWidth';\r\n\r\n// Material Table\r\nimport MaterialTable from 'material-table';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport Event from '@material-ui/icons/Event';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\nimport SaveAltIcon from '@material-ui/icons/SaveAlt';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\n// Our Helpers\r\nimport * as stopsHelper from './helpers/stops';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = (theme) => ({\r\n\tformControl: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tminWidth: 200\r\n\t},\r\n\tmargin: {\r\n\t\tmargin: theme.spacing(1)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t\tmaxWidth: '100%'\r\n\t},\r\n\ttable: {\r\n\t\tborder: '1px solid rgba(0, 0, 0, 0.12)'\r\n\t}\r\n});\r\n\r\nclass Stops extends Component {\r\n\r\n\tstate = {\r\n\t\ttitle: 'All stops'\r\n\t};\r\n\r\n\ttableRef = React.createRef();\r\n\r\n\tcomponentWillReceiveProps(nextProps) {\r\n\t\tif (this.props.postcode !== nextProps.postcode || this.props.distance !== nextProps.distance) this.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetOrganisationFilter = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearOrganisationFilter = () => {\r\n\t\tthis.props.clearOrganisationFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetMobileFilter = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearMobileFilter = () => {\r\n\t\tthis.props.clearMobileFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetRouteFilter = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearRouteFilter = () => {\r\n\t\tthis.props.clearRouteFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tgetStopCalendar = (e, row) => window.open(config.api + '/stops/' + row.id + '/ics');\r\n\tgetStopPdf = (e, row) => window.open(config.api + '/stops/' + row.id + '/pdf', '_blank');\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_filter,\r\n\t\t\troutes, route_lookup, route_filter, current_position, distance, width } = this.props;\r\n\t\tlet orgText = {}\r\n\t\tObject.keys(organisation_lookup).forEach(key => {\r\n\t\t\torgText[key] = organisation_lookup[key].name;\r\n\t\t});\r\n\t\tlet mobileText = {}\r\n\t\tObject.keys(mobile_lookup).forEach(key => {\r\n\t\t\tmobileText[key] = mobile_lookup[key].name;\r\n\t\t});\r\n\t\tlet routeText = {}\r\n\t\tObject.keys(route_lookup).forEach(key => {\r\n\t\t\trouteText[key] = route_lookup[key].name;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ maxWidth: '100%' }}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={false}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={this.setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={this.setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={this.setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t/>\r\n\t\t\t\t<MaterialTable\r\n\t\t\t\t\ttableRef={this.tableRef}\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tContainer: props => <Paper {...props} elevation={0} className={classes.table} />\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ticons={{\r\n\t\t\t\t\t\tFilter: FilterList,\r\n\t\t\t\t\t\tFirstPage: FirstPage,\r\n\t\t\t\t\t\tLastPage: LastPage,\r\n\t\t\t\t\t\tNextPage: ChevronRight,\r\n\t\t\t\t\t\tPreviousPage: ChevronLeft\r\n\t\t\t\t\t}}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tpadding: isWidthUp('sm', width) ? 'default' : 'dense',\r\n\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\tloadingType: 'linear',\r\n\t\t\t\t\t\tactionsColumnIndex: 4,\r\n\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\theaderStyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: '#ff5722',\r\n\t\t\t\t\t\t\tcolor: '#ffffff'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Name',\r\n\t\t\t\t\t\t\tfield: 'name', filtering: false,\r\n\t\t\t\t\t\t\trender: rowData => <Button color='primary'>{rowData.name}</Button>\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ title: 'Community', field: 'community', filtering: false },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Time',\r\n\t\t\t\t\t\t\tfield: 'arrival',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\trender: (rowData) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\tmoment(rowData.arrival, 'HH:mm:ssZ').format('HH:mma') + ' - ' +\r\n\t\t\t\t\t\t\t\t\tmoment(rowData.departure, 'HH:mm:ssZ').format('HH:mma')\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tactions={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ticon: () => <Event color='primary' fontSize='small' />,\r\n\t\t\t\t\t\t\ttooltip: 'Download stop calendar',\r\n\t\t\t\t\t\t\tonClick: this.getStopCalendar\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ticon: () => <SaveAltIcon color='primary' fontSize='small' />,\r\n\t\t\t\t\t\t\ttooltip: 'Download stop as PDF',\r\n\t\t\t\t\t\t\tonClick: this.getStopPdf\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tdata={query =>\r\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tstopsHelper.getQueryStops(query, organisation_filter, mobile_filter, route_filter, current_position, distance, stopData => {\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tdata: stopData.stops,\r\n\t\t\t\t\t\t\t\t\tpage: (stopData.page - 1),\r\n\t\t\t\t\t\t\t\t\ttotalCount: stopData.total,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttitle={this.state.title}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nStops.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(Stops);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllOrganisations(callback) {\r\n\taxios.get(config.api + '/organisations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllRoutes(callback) {\r\n\taxios.get(config.api + '/routes')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\n// MUI Style\r\nimport deepOrange from '@material-ui/core/colors/deepOrange';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport { MuiThemeProvider, createMuiTheme, withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport AppHeader from './AppHeader';\r\nimport Mobiles from './Mobiles';\r\nimport MobileMap from './MobileMap';\r\nimport Stops from './Stops';\r\n\r\n// Our helpers\r\nimport * as geoHelper from './helpers/geo';\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as organisationsHelper from './helpers/organisations';\r\nimport * as routesHelper from './helpers/routes';\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: deepOrange,\r\n\t\tsecondary: blueGrey\r\n\t},\r\n\toverrides: {\r\n\t\tMuiButton: {\r\n\t\t\ttext: {\r\n\t\t\t\ttextTransform: 'inherit'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\tpadding: '0 8px',\r\n\t\t...theme.mixins.toolbar\r\n\t},\r\n\tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: theme.spacing(3)\r\n\t}\r\n});\r\n\r\nclass App extends Component {\r\n\tstate = {\r\n\t\tpage: 'mobiles',\r\n\t\torganisations: [],\r\n\t\torganisation_lookup: {},\r\n\t\torganisation_filter: [],\r\n\t\tmobiles: [],\r\n\t\tmobile_lookup: {},\r\n\t\tmobile_filter: [],\r\n\t\tmobile_locations: [],\r\n\t\tmobile_location_lookup: {},\r\n\t\tlocation_timer: null,\r\n\t\troutes: [],\r\n\t\troute_lookup: {},\r\n\t\troute_filter: [],\r\n\t\tfit_bounds: null,\r\n\t\tposition: [-2.1000, 53.6138],\r\n\t\tzoom: [7],\r\n\t\tpitch: [0],\r\n\t\tbearing: [0],\r\n\t\tgps_loading: true,\r\n\t\tdistance: 1609,\r\n\t\tpostcode: '',\r\n\t\tpostcode_loading: true,\r\n\t\tcurrent_position: [],\r\n\t\tposition_update_interval: '',\r\n\t\tsearch_type: '',\r\n\t\tloading_organisations: false,\r\n\t\tloading_mobiles: false,\r\n\t\tloading_routes: false,\r\n\t\tloading_locations: false\r\n\t};\r\n\r\n\tgetOrganisations = () => {\r\n\t\tthis.setState({ loading_organisations: true });\r\n\t\torganisationsHelper.getAllOrganisations(organisations => {\r\n\t\t\tlet organisation_lookup = {};\r\n\t\t\torganisations.forEach(organisation => organisation_lookup[organisation.id] = organisation);\r\n\t\t\tthis.setState({ organisations: organisations, organisation_lookup: organisation_lookup, loading_organisations: false })\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobiles = () => {\r\n\t\tthis.setState({ loading_mobiles: true });\r\n\t\tmobilesHelper.getAllMobiles(mobiles => {\r\n\t\t\tlet mobile_lookup = {};\r\n\t\t\tmobiles.forEach(mobile => mobile_lookup[mobile.id] = mobile);\r\n\t\t\tthis.setState({ mobiles: mobiles, mobile_lookup: mobile_lookup, loading_mobiles: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetRoutes = () => {\r\n\t\tthis.setState({ loading_routes: true });\r\n\t\troutesHelper.getAllRoutes(routes => {\r\n\t\t\tlet route_lookup = {};\r\n\t\t\troutes.forEach(route => route_lookup[route.id] = route);\r\n\t\t\tthis.setState({ routes: routes, route_lookup: route_lookup, loading_routes: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobileLocations = () => {\r\n\t\tthis.setState({ loading_locations: true });\r\n\t\tmobilesHelper.getMobileLocations(locations => {\r\n\t\t\tlet mobile_location_lookup = {};\r\n\t\t\tlocations.forEach(location => mobile_location_lookup[location.mobile_id] = location);\r\n\t\t\tthis.setState({ mobile_locations: locations, mobile_location_lookup: mobile_location_lookup, loading_locations: false });\r\n\t\t});\r\n\t}\r\n\r\n\t// componentDidMount: sets up data and any logging\r\n\tcomponentDidMount = () => {\r\n\t\tthis.getOrganisations();\r\n\t\tthis.getMobiles();\r\n\t\tthis.getRoutes();\r\n\t\t// Set up a timer for the mobile locations\r\n\t\tthis.getMobileLocations();\r\n\t\tconst location_timer = setInterval(() => {\r\n\t\t\tthis.getMobileLocations();\r\n\t\t}, 15000);\r\n\t\tthis.setState({ location_timer: location_timer });\r\n\t}\r\n\r\n\tsetPage = (page) => this.setState({ page: page })\r\n\r\n\tviewStopsByOrganisation = (organisation_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [], route_filter: [] });\r\n\tviewStopsByMobile = (mobile_id) => this.setState({ page: 'stops', organisation_filter: [], mobile_filter: [mobile_id], route_filter: [] });\r\n\tviewStopsByRoute = (route_id) => this.setState({ page: 'stops', organisation_filter: [], mobile_filter: [], route_filter: [route_id] });\r\n\r\n\tclearOrganisationFilter = () => this.setState({ organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\tclearMobileFilter = () => this.setState({ mobile_filter: [], route_filter: [] });\r\n\tclearRouteFilter = () => this.setState({ route_filter: [] });\r\n\r\n\t// logPosition: Retrieve position from gps\r\n\tlogPosition = (fit = false) => {\r\n\t\tthis.setState({ loading: true, gps_loading: true });\r\n\t\tgeoHelper.getCurrentPosition(position => {\r\n\t\t\tthis.setState({ current_position: position, position: position, zoom: [11], gps_loading: false });\r\n\t\t});\r\n\t}\r\n\r\n\tsetDistance = (distance) => this.setState({ distance: distance});\r\n\r\n\t// postcodeSearch\r\n\tpostcodeSearch = (postcode) => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tlet new_state = { search_type: 'postcode', loading: true, postcode_loading: true, postcode: postcode };\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tnew_state.position_update_interval = null;\r\n\t\t}\r\n\r\n\t\t// Get the postcode\r\n\t\tgeoHelper.getPostcode(postcode, location => {\r\n\t\t\tif (location.length === 2) {\r\n\t\t\t\tnew_state.search_type = 'postcode';\r\n\t\t\t\tnew_state.current_position = location;\r\n\t\t\t\tnew_state.position = location;\r\n\t\t\t\tnew_state.zoom = [11];\r\n\t\t\t\tnew_state.loading = false;\r\n\t\t\t\tthis.setState(new_state);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// toggleGPS\r\n\ttoggleGPS = () => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tthis.setState({ search_type: '', postcode: '', position_update_interval: null });\r\n\t\t} else {\r\n\t\t\tlet position_update_interval = setInterval(this.logPosition, 10000);\r\n\t\t\tthis.setState({ position_update_interval: position_update_interval, search_type: 'gps', postcode: '' });\r\n\t\t\tthis.logPosition(true);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t<div className={classes.root}>\r\n\t\t\t\t\t<CssBaseline />\r\n\t\t\t\t\t<AppHeader\r\n\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\tpage={this.state.page}\r\n\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\tloading={this.state.loading_locations || this.state.loading_mobiles || this.state.loading_organisations || this.state.loading_routes}\r\n\t\t\t\t\t\tsetPage={this.setPage}\r\n\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<main className={classes.content}>\r\n\t\t\t\t\t\t<div className={classes.toolbar} />\r\n\t\t\t\t\t\t{this.state.page === 'mobiles' ?\r\n\t\t\t\t\t\t\t<Mobiles\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_location_lookup={this.state.mobile_location_lookup}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\tviewStopsByMobile={this.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\tviewStopsByOrganisation={this.viewStopsByOrganisation}\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'stops' ?\r\n\t\t\t\t\t\t\t<Stops\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'map' ?\r\n\t\t\t\t\t\t\t<MobileMap\r\n\t\t\t\t\t\t\t\tbearing={this.state.bearing}\r\n\t\t\t\t\t\t\t\tfit_bounds={this.state.fit_bounds}\r\n\t\t\t\t\t\t\t\tpitch={this.state.pitch}\r\n\t\t\t\t\t\t\t\tposition={this.state.position}\r\n\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_locations={this.state.mobile_locations.filter(l => l.geox !== null)}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t</main>\r\n\t\t\t\t</div>\r\n\t\t\t</MuiThemeProvider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nApp.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(App);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// getCurrentLocation: \r\nexport function getCurrentPosition(callback) {\r\n\tvar options = {\r\n\t\tenableHighAccuracy: true,\r\n\t\ttimeout: 10000,\r\n\t\tmaximumAge: 0\r\n\t};\r\n\tnavigator.geolocation.getCurrentPosition((pos) => {\r\n\t\tcallback([pos.coords.longitude, pos.coords.latitude]);\r\n\t}, err => {\r\n\t\tcallback([]);\r\n\t}, options);\r\n};\r\n\r\n// Get postcode data\r\nexport function getPostcode(postcode, callback) {\r\n\taxios.get('https://api.postcodes.io/postcodes/' + postcode)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data && response.data.result) {\r\n\t\t\t\tcallback([response.data.result.longitude, response.data.result.latitude]);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n};","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n// Our app entry point\nimport App from './App';\n\n// Service worker for PWA behaviour\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}