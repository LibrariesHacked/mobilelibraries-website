{"version":3,"sources":["context/applicationState.js","context/searchState.js","context/viewState.js","helpers/geo.js","helpers/url.js","models/mobiles.js","PostcodeSearch.js","ServiceFilter.js","AppHeader.js","Footer.js","MarkdownPage.js","Filters.js","MobileCard.js","Mobiles.js","MobileLibraryDetails.js","MeAvatar.js","MapSettings.js","helpers/utils.js","MobileAvatar.js","MobileMap.js","Notification.js","models/stops.js","Stops.js","StopDetails.js","models/trips.js","TripDetails.js","pages/accessibility.md","pages/data.md","pages/privacy.md","models/organisations.js","models/routes.js","MobilesApplication.js","App.js","serviceWorker.js","index.js"],"names":["ApplicationStateContext","createContext","ApplicationStateProvider","reducer","initialState","children","Provider","value","useReducer","useApplicationStateValue","useContext","SearchStateContext","SearchStateProvider","useSearchStateValue","ViewStateContext","ViewStateProvider","useViewStateValue","config","require","getPosition","options","Promise","resolve","reject","navigator","geolocation","getCurrentPosition","a","enableHighAccuracy","timeout","maximumAge","position","coords","longitude","latitude","getCurrentPostcode","lon","lat","uri","axios","get","res","status","postcodes","data","result","length","postcode","console","log","getPostcode","postcodeApi","response","location","library_service_name","library_service","getServiceDataFromPostcode","services","postcodeData","servicesFiltered","filter","s","code","service","getNearestLibrary","libraryApi","getNearestMobileLibrary","mobileLibraryApi","validatePostcode","test","trim","addService","history","systemName","currentUrlParams","URLSearchParams","window","search","set","push","pathname","toString","Mobile","obj","Object","assign","this","json","id","organisationId","organisation_id","name","timetable","numberRoutes","number_routes","numberStops","number_stops","MobileNearestStop","mobileId","mobile_id","stopId","stop_id","stopName","stop_name","stopDistance","stop_distance","MobileLocation","currentStopId","current_stop_id","currentStopDeparture","moment","current_stop_departure","currentStopName","current_stop_name","previousStopId","previous_stop_id","previousStopDeparture","previous_stop_departure","previousStopName","previous_stop_name","nextStopId","next_stop_id","nextStopArrival","next_stop_arrival","nextStopName","next_stop_name","updated","updateType","update_type","geoX","geox","geoY","geoy","routeSection","route_section","now","statuses","isSame","type","textFormat","message","arrival","fromNow","args","stopRemaining","text_format","getAllMobiles","api","mobiles","map","m","fromJson","getMobileLocations","locations","ml","getMobilesNearest","distance","useStyles","makeStyles","theme","grow","flexGrow","iconButton","padding","spacing","iconProgress","margin","inputInput","paddingTop","paddingRight","paddingBottom","paddingLeft","fontWeight","typography","fontWeightBold","border","borderColor","palette","outline","main","borderRadius","shape","backgroundColor","fade","common","white","marginLeft","marginRight","display","maxWidth","withRouter","props","settings","organisations","dispatchApplication","searchType","searchPostcode","searchDistance","searchPosition","dispatchSearch","loadingPostcode","loadingLocation","dispatchView","useState","tempPostcode","setTempPostcode","anchor","setAnchor","prevProps","ref","useRef","useEffect","current","usePrevious","getLocation","geoHelper","pos","getLocationPostcode","postcodeSearch","closeSettingsMenu","setSearchDistance","clearSearch","delete","notificationMessage","notificationSeverity","mobilesModel","mobilesNearest","mobilesNearestLookup","forEach","mobile","urlHelper","classes","className","InputBase","placeholder","input","onChange","e","target","toUpperCase","onKeyDown","keyCode","inputProps","Tooltip","title","IconButton","aria-label","onClick","Box","CircularProgress","size","color","Divider","orientation","flexItem","currentTarget","openSettingsMenu","Menu","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","button","chip","leftIcon","alignContent","textAlign","marginBottom","subtitle","Filters","organisationLookup","mobileLookup","routeLookup","routes","organisationFilter","mobileFilter","routeFilter","organisationMenuAnchor","setOrganisationMenuAnchor","mobileMenuAnchor","setMobileMenuAnchor","routeMenuAnchor","setRouteMenuAnchor","closeOrganisationMenu","closeMobileMenu","closeRouteMenu","countries","Set","org","country","Button","element","Chip","variant","onDelete","label","Array","from","sort","b","localeCompare","idx","menuItems","orgList","concat","mob","indexOf","route","routeId","appBar","zIndex","drawer","appBarTransparent","topIcon","topTitle","AppHeader","site","currentServiceSystemName","appsOpen","setAppsOpen","tabValue","setTabValue","useLocation","currentServicePath","path","sites","url","icon","links","short","to","appBarClass","Toolbar","ServiceFilter","AppBar","elevation","Tabs","v","scrollButtons","indicatorColor","textColor","Tab","Hidden","mdUp","link","component","Link","disableRipple","disableFocusRipple","startIcon","smDown","root","marginTop","width","bullet","grid","footerText","verticalAlign","footerRight","tapTarget","lineHeight","fontSize","Footer","Grid","container","item","xs","sm","md","lg","xl","Typography","href","listItem","wordBreak","overflowX","WebkitOverflowScrolling","borderCollapse","borderSpacing","overflow","fontFamily","borderBottom","divider","body2","text","primary","pxToRem","fontWeightMedium","whiteSpace","overrides","h1","gutterBottom","h2","h3","h4","paragraph","p","li","withStyles","MarkdownPage","page","pageText","setPageText","fetch","pageData","fetchPage","MemoMarkdownPage","React","memo","transform","card","minWidth","cardHeader","align","verticalDivider","height","progress","MobileCard","organisation","stopButton","stop","stopDialogOpen","statusMessage","getStatus","offRoadMessage","preRouteMessage","atStopMessage","betweenStopsMessage","postRouteMessage","bull","Card","CardContent","CardActions","mobileLibraryId","mobileLibraryDialogOpen","goToWebsite","Mobiles","mobileLocationLookup","loadingMobileLocations","openTab","setOpenTab","filteredMobiles","activeMobiles","organisationName","mobileName","routeName","Math","round","mobilesView","changeTab","tab","Badge","badgeContent","showZero","replace","dialog","dialogContentActions","list","background","paper","MobileLibraryDetails","currentMobileLibraryId","mobileLibrary","setMobileLibrary","close","useTheme","fullScreen","useMediaQuery","breakpoints","down","Dialog","disableBackdropClick","aria-labelledby","BackdropProps","invisible","PaperProps","DialogTitle","DialogContent","DialogActions","endIcon","avatar","avatarOn","cursor","MeAvatar","Avatar","MapSettings","mapSettings","mapSettingsDialogOpen","closeDialog","FormControlLabel","control","Switch","checked","authorityBoundary","mapSetting","hextoRGBA","hex","alpha","c","substring","split","join","Error","fab","boxShadow","MobileAvatar","mapZoom","Fab","style","utilsHelper","colour","bottom","right","Map","ReactMapboxGl","minZoom","maxZoom","customAttribution","stopTiles","tripTiles","libraryAuthorityTiles","MobileMap","mobileLocations","mapPosition","currentTime","setCurrentTime","setMap","setInterval","clickStop","features","properties","organisationColourMatch","l","center","zoom","pitch","bearing","fitBounds","containerStyle","top","left","onStyleLoad","locationPoint","coordinates","millisecondsPassed","diff","index","getZoom","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","tripId","tripDialogOpen","Notification","notificationOpen","handleClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","action","Stop","routeIds","route_ids","routeNames","route_names","mobileIds","mobile_ids","mobileNames","mobile_names","organisation_name","community","address","arrivalTimes","arrival_times","departureTimes","departure_times","routeStart","route_start","routeEnd","route_end","routeDays","route_days","routeFrequencies","route_frequencies","routeSchedule","route_schedule","getQueryStops","query","organisationFilters","mobileFilters","routeFilters","pageSize","orderBy","field","orderDirection","stops","total","parseInt","headers","getStopById","formControl","table","Stops","tableRef","createRef","onQueryChange","orgText","keys","key","mobileText","routeText","components","Container","Paper","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","up","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","render","rowData","mdDown","cellStyle","hidden","format","stopsModel","stopData","totalCount","getStops","StopDetails","setStop","getStop","Trip","originStopId","origin_stop_id","originStopName","origin_stop_name","destinationStopId","destination_stop_id","destinationStopName","destination_stop_name","duration","routeLine","route_line","getTripById","TripDetails","currentTripId","trip","setTrip","tripsModel","getTrip","estimatedDuration","Organisation","service_code","website","email","logo","numberMobiles","number_mobiles","getAllOrganisations","o","Route","frequency","start","end","getAllRoutes","r","content","MobilesApplication","loadingOrganisations","loadingMobiles","loadingRoutes","loadingNearestMobiles","dispatchApplicationState","organisationsModel","routesModel","getOrganisations","getMobiles","getRoutes","loading","exact","Accessibility","Data","Privacy","substr","initialApplicationState","trips","applicationReducer","state","initialSearchState","searchPositionUpdateInterval","searchReducer","initialViewState","viewReducer","createMuiTheme","green","secondary","blueGrey","MuiButton","textTransform","MuiTab","MuiTypography","MuiTableCell","App","ThemeProvider","CssBaseline","hostname","match","ReactDOM","document","getElementById","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.aa2eb7c8.chunk.js","sourcesContent":["import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ApplicationStateContext = createContext()\r\n\r\nexport const ApplicationStateProvider = ({ reducer, initialState, children }) => (\r\n  <ApplicationStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ApplicationStateContext.Provider>\r\n)\r\n\r\nexport const useApplicationStateValue = () => useContext(ApplicationStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const SearchStateContext = createContext()\r\n\r\nexport const SearchStateProvider = ({ reducer, initialState, children }) => (\r\n  <SearchStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </SearchStateContext.Provider>\r\n)\r\n\r\nexport const useSearchStateValue = () => useContext(SearchStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ViewStateContext = createContext()\r\n\r\nexport const ViewStateProvider = ({ reducer, initialState, children }) => (\r\n  <ViewStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ViewStateContext.Provider>\r\n)\r\n\r\nexport const useViewStateValue = () => useContext(ViewStateContext)\r\n","import axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport const getPosition = (options = {}) => {\r\n  return new Promise((resolve, reject) => {\r\n    navigator.geolocation.getCurrentPosition(resolve, reject, options)\r\n  })\r\n}\r\n\r\nexport const getCurrentPosition = async () => {\r\n  var options = {\r\n    enableHighAccuracy: true,\r\n    timeout: 10000,\r\n    maximumAge: 0\r\n  }\r\n\r\n  const position = await getPosition(options)\r\n  return [position.coords.longitude, position.coords.latitude]\r\n}\r\n\r\nexport const getCurrentPostcode = async (lon, lat) => {\r\n  const uri = `https://api.postcodes.io/postcodes?lon=${lon}&lat=${lat}`\r\n  try {\r\n    const res = await axios.get(uri)\r\n    if (res.status === 200) {\r\n      const postcodes = res.data.result\r\n      if (postcodes.length > 0) {\r\n        return postcodes[0].postcode\r\n      }\r\n    }\r\n  } catch (e) {\r\n    console.log(e)\r\n  }\r\n}\r\n\r\nexport const getPostcode = async (postcode) => {\r\n  const response = await axios.get(config.postcodeApi + postcode)\r\n  return {\r\n    location: [response.data.longitude, response.data.latitude],\r\n    library_service_name: response.data.library_service_name,\r\n    library_service: response.data.library_service\r\n  }\r\n}\r\n\r\nexport const getServiceDataFromPostcode = async (postcode, services) => {\r\n  const postcodeData = await getPostcode(postcode)\r\n  const servicesFiltered = services.filter(s => s.code === postcodeData.library_service)\r\n  if (servicesFiltered.length > 0) return { service: servicesFiltered[0], location: postcodeData.location }\r\n  return {}\r\n}\r\n\r\nexport const getNearestLibrary = async (location) => {\r\n  const response = await axios.get(config.libraryApi + '?latitude=' + location[1] + '&longitude=' + location[0])\r\n  return (response && response.data && response.data.length > 0 ? response.data[0] : null)\r\n}\r\n\r\nexport const getNearestMobileLibrary = async (location) => {\r\n  const response = await axios.get(config.mobileLibraryApi + '?latitude=' + location[1] + '&longitude=' + location[0])\r\n  return (response && response.data && response.data.length > 0 ? response.data[0] : null)\r\n}\r\n\r\nexport const validatePostcode = (postcode) => {\r\n  return /^[A-Z]{1,2}\\d[A-Z\\d]? ?\\d[A-Z]{2}$/.test(postcode.trim())\r\n}\r\n","export const addService = (history, systemName) => {\r\n  const currentUrlParams = new URLSearchParams(window.location.search)\r\n  currentUrlParams.set('service', systemName)\r\n  history.push(window.location.pathname + '?' + currentUrlParams.toString())\r\n}\r\n\r\nexport const clearService = (history) => {\r\n  const currentUrlParams = new URLSearchParams(window.location.search)\r\n  currentUrlParams.delete('service')\r\n  history.push(window.location.pathname)\r\n}\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Mobile {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileNearestStop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.stopId = json.stop_id\r\n    this.stopName = json.stop_name\r\n    this.stopDistance = json.stop_distance\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileLocation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.currentStopId = json.current_stop_id\r\n    this.currentStopDeparture = moment(json.current_stop_departure)\r\n    this.currentStopName = json.current_stop_name\r\n    this.previousStopId = json.previous_stop_id\r\n    this.previousStopDeparture = moment(json.previous_stop_departure)\r\n    this.previousStopName = json.previous_stop_name\r\n    this.nextStopId = json.next_stop_id\r\n    this.nextStopArrival = moment(json.next_stop_arrival)\r\n    this.nextStopName = json.next_stop_name\r\n    this.updated = moment(json.updated)\r\n    this.updateType = json.update_type\r\n    this.geoX = json.geox\r\n    this.geoY = json.geoy\r\n    this.routeSection = json.route_section\r\n    return this\r\n  }\r\n\r\n  getStatus () {\r\n    const now = moment()\r\n    const statuses = {\r\n      offRoad: 'Not out today',\r\n      preRoute: 'Arriving at ',\r\n      atStop: 'At ',\r\n      betweenStops: 'Arriving at ',\r\n      postRoute: 'Finished for the day'\r\n    }\r\n    // The mobile is not due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'offRoad',\r\n        textFormat: statuses.offRoad,\r\n        message: statuses.offRoad\r\n      }\r\n    }\r\n    // The mobile is due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'preRoute',\r\n        message: statuses.preRoute,\r\n        textFormat: statuses.preRoute + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is at a stop, and will be for a certain amount of time\r\n    if (this.currentStopId) {\r\n      const stopRemaining = this.currentStopDeparture.fromNow(true)\r\n      return {\r\n        type: 'atStop',\r\n        message: statuses.atStop,\r\n        textFormat: statuses.atStop + this.currentStopName + ' for ' + stopRemaining,\r\n        args: [\r\n          { stopName: this.currentStopName, stopId: this.currentStopId },\r\n          stopRemaining\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is between stops\r\n    if (!this.currentStopId && this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'betweenStops',\r\n        message: statuses.betweenStops,\r\n        textFormat: statuses.betweenStops + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile has finished for the day\r\n    if (this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'postRoute',\r\n        message: statuses.postRoute,\r\n        text_format: statuses.postRoute\r\n      }\r\n    }\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getAllMobiles () {\r\n  const response = await axios.get(config.api + '/mobiles')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const mobiles = response.data.map(m => (new Mobile()).fromJson(m))\r\n    return mobiles\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobileLocations () {\r\n  const response = await axios.get(config.api + '/mobiles/locations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const locations = response.data.map(ml => (new MobileLocation()).fromJson(ml))\r\n    return locations\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobilesNearest (location, distance) {\r\n  const response = await axios.get(config.api + '/mobiles/nearest?longitude=' + location[0] + '&latitude=' + location[1] + '&distance=' + distance)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(m => (new MobileNearestStop()).fromJson(m))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\nimport { withRouter } from 'react-router'\r\n\r\nimport Box from '@material-ui/core/Box'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport ClearIcon from '@material-ui/icons/ClearTwoTone'\r\nimport MyLocationIcon from '@material-ui/icons/MyLocationTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as geoHelper from './helpers/geo'\r\nimport * as urlHelper from './helpers/url'\r\nimport * as mobilesModel from './models/mobiles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  iconButton: {\r\n    padding: theme.spacing()\r\n  },\r\n  iconProgress: {\r\n    margin: theme.spacing()\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing(),\r\n    paddingRight: theme.spacing(),\r\n    paddingBottom: theme.spacing(),\r\n    paddingLeft: theme.spacing(2),\r\n    fontWeight: theme.typography.fontWeightBold\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    border: '1px solid #E0E0E0',\r\n    borderColor: theme.palette.outline.main,\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.8),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.9)\r\n    },\r\n    marginLeft: 0,\r\n    marginRight: theme.spacing(),\r\n    display: 'flex',\r\n    maxWidth: 240\r\n  }\r\n}))\r\n\r\nfunction usePrevious (value) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}\r\n\r\nfunction PostcodeSearch (props) {\r\n  const { settings } = props\r\n  const [{ organisations }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ loadingPostcode, loadingLocation }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [tempPostcode, setTempPostcode] = useState(searchPostcode || '')\r\n  const [anchor, setAnchor] = useState(null)\r\n\r\n  const prevProps = usePrevious({ searchPostcode })\r\n\r\n  useEffect(() => {\r\n    if (prevProps && searchPostcode !== prevProps.searchPostcode) setTempPostcode(searchPostcode)\r\n  }, [searchPostcode, prevProps])\r\n\r\n  const getLocation = async () => {\r\n    if (!loadingLocation) {\r\n      dispatchView({ type: 'ToggleLoadingLocation' })\r\n      const pos = (searchPosition.length > 0 ? searchPosition : (await geoHelper.getCurrentPosition()))\r\n      dispatchSearch({ type: 'SetLocation', searchPosition: pos })\r\n      const postcode = await getLocationPostcode(pos)\r\n      dispatchView({ type: 'ToggleLoadingLocation' })\r\n      if (postcode && postcode !== '') postcodeSearch(postcode)\r\n    }\r\n  }\r\n\r\n  const getLocationPostcode = async (location) => {\r\n    if (location.length > 0) {\r\n      const postcode = await geoHelper.getCurrentPostcode(...location)\r\n      setTempPostcode(postcode)\r\n      return postcode\r\n    }\r\n  }\r\n\r\n  const openSettingsMenu = (e) => setAnchor(e.currentTarget)\r\n\r\n  const closeSettingsMenu = () => setAnchor(null)\r\n\r\n  const setSearchDistance = (searchDistance) => {\r\n    closeSettingsMenu()\r\n    dispatchSearch({ type: 'SetSearchDistance', searchDistance: searchDistance })\r\n    if (searchType === 'postcode') postcodeSearch(tempPostcode)\r\n  }\r\n\r\n  const clearSearch = () => {\r\n    setTempPostcode('')\r\n    dispatchSearch({ type: 'ClearAll' })\r\n    urlHelper.clearService(props.history)\r\n  }\r\n\r\n  const postcodeSearch = async (postcode = tempPostcode) => {\r\n    if (!postcode || postcode === '') {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'Please enter a postcode before searching', notificationSeverity: 'warning' })\r\n      return\r\n    }\r\n    dispatchView({ type: 'ToggleLoadingPostcode' })\r\n    dispatchView({ type: 'LoadingPostcode' })\r\n    if (geoHelper.validatePostcode(postcode)) {\r\n      const service = await geoHelper.getServiceDataFromPostcode(postcode.trim(), organisations)\r\n      dispatchSearch({ type: 'SetPostcodeSearch', searchPostcode: postcode, searchPosition: service.location })\r\n      dispatchSearch({ type: 'SetService', service: service.service })\r\n      const mobilesNearest = await mobilesModel.getMobilesNearest(service.location, searchDistance)\r\n      const mobilesNearestLookup = {}\r\n      mobilesNearest.forEach(mobile => { mobilesNearestLookup[mobile.mobileId] = mobile })\r\n      dispatchApplication({ type: 'UpdateMobilesNearest', mobilesNearest: mobilesNearest, mobilesNearestLookup: mobilesNearestLookup })\r\n      urlHelper.addService(props.history, service.service.systemName)\r\n    } else {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'We could not find that postcode', notificationSeverity: 'error' })\r\n    }\r\n    dispatchView({ type: 'ToggleLoadingPostcode' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.search}>\r\n      <InputBase\r\n        placeholder='Postcode'\r\n        classes={{\r\n          input: classes.inputInput\r\n        }}\r\n        value={tempPostcode}\r\n        onChange={(e) => setTempPostcode(e.target.value.toUpperCase())}\r\n        onKeyDown={(e) => { if (e.keyCode === 13) postcodeSearch() }}\r\n        inputProps={{ 'aria-label': 'search by postcode' }}\r\n      />\r\n      {searchType === 'postcode'\r\n        ? (\r\n          <Tooltip title='Clear search'>\r\n            <IconButton\r\n              aria-label='Clear search'\r\n              className={classes.iconButton}\r\n              onClick={() => clearSearch()}\r\n            >\r\n              <ClearIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        )\r\n        : null}\r\n      <div className={classes.grow} />\r\n      <Tooltip title='Search by postcode'>\r\n        {!loadingPostcode\r\n          ? (\r\n            <IconButton\r\n              aria-label='Search'\r\n              color='primary'\r\n              className={classes.iconButton}\r\n              onClick={() => postcodeSearch()}\r\n            >\r\n              <SearchIcon />\r\n            </IconButton>\r\n          ) : <Box position='relative' display='inline-flex' className={classes.iconProgress}><CircularProgress size={22} /></Box>}\r\n      </Tooltip>\r\n      <Divider orientation='vertical' flexItem />\r\n      <Tooltip title='Use your current location'>\r\n        {!loadingLocation\r\n          ? (\r\n            <IconButton\r\n              aria-label='Search by current location'\r\n              color='primary'\r\n              className={classes.iconButton}\r\n              onClick={() => getLocation()}\r\n            >\r\n              <MyLocationIcon />\r\n            </IconButton>\r\n          ) : <Box position='relative' display='inline-flex' className={classes.iconProgress}><CircularProgress size={22} /></Box>}\r\n      </Tooltip>\r\n      {settings\r\n        ? (\r\n          <Tooltip title='Change search settings'>\r\n            <IconButton\r\n              aria-label='Open search settings menu'\r\n              className={classes.iconButton}\r\n              color='secondary'\r\n              onClick={(e) => { openSettingsMenu(e) }}\r\n            >\r\n              <SettingsIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        ) : null}\r\n      <Menu\r\n        id='mnu-settings'\r\n        anchorEl={anchor}\r\n        keepMounted\r\n        open={Boolean(anchor)}\r\n        onClose={() => closeSettingsMenu()}\r\n      >\r\n        <ListSubheader disableSticky>Search distance</ListSubheader>\r\n        <MenuItem onClick={() => setSearchDistance(1609)}>1 mile</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(4827)}>3 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(8045)}>5 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(16090)}>10 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(32180)}>20 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(80450)}>50 miles</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(PostcodeSearch)\r\n","import React, { useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BusinessIcon from '@material-ui/icons/BusinessTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport DirectionsIcon from '@material-ui/icons/DirectionsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  chip: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const [{ organisations, organisationLookup, mobiles, mobileLookup, routeLookup, routes }] = useApplicationStateValue()\r\n  const [{ organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue()\r\n\r\n  const [organisationMenuAnchor, setOrganisationMenuAnchor] = useState(null)\r\n  const [mobileMenuAnchor, setMobileMenuAnchor] = useState(null)\r\n  const [routeMenuAnchor, setRouteMenuAnchor] = useState(null)\r\n\r\n  const openOrganisationMenu = (element) => setOrganisationMenuAnchor(element)\r\n\r\n  const closeOrganisationMenu = () => setOrganisationMenuAnchor(null)\r\n\r\n  const chooseOrganisation = (organisationId) => {\r\n    dispatchSearch({ type: 'FilterByOrganisation', organisationId: organisationId })\r\n    closeOrganisationMenu()\r\n  }\r\n\r\n  const clearOrganisationFilter = () => {\r\n    dispatchSearch({ type: 'ClearAll' })\r\n  }\r\n\r\n  const openMobileMenu = (element) => setMobileMenuAnchor(element)\r\n\r\n  const closeMobileMenu = () => setMobileMenuAnchor(null)\r\n\r\n  const chooseMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n    closeMobileMenu()\r\n  }\r\n\r\n  const clearMobileFilter = () => {\r\n    dispatchSearch({ type: 'ClearMobileFilter' })\r\n  }\r\n\r\n  const openRouteMenu = (element) => setRouteMenuAnchor(element)\r\n\r\n  const closeRouteMenu = () => setRouteMenuAnchor(null)\r\n\r\n  const chooseRoute = (routeId) => {\r\n    dispatchSearch({ type: 'FilterByRoute', routeId: routeId })\r\n    closeRouteMenu()\r\n  }\r\n\r\n  const clearRouteFilter = () => {\r\n    dispatchSearch({ type: 'ClearRouteFilter' })\r\n  }\r\n\r\n  const countries = new Set(organisations.map(org => org.country))\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.search}>\r\n        {organisationFilter.length === 0 ? (\r\n          <Tooltip title='Choose library service'>\r\n            <Button color='primary' className={classes.button} onClick={(e) => openOrganisationMenu(e.currentTarget)}>\r\n              <BusinessIcon className={classes.leftIcon} />Select service\r\n            </Button>\r\n          </Tooltip>\r\n        ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearOrganisationFilter} label={organisationLookup[organisationFilter[0]].name} />}\r\n        {organisationFilter.length > 0\r\n          ? (mobileFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose mobile library'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openMobileMenu(e.currentTarget)}>\r\n                  <DirectionBusIcon className={classes.leftIcon} />Select mobile\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearMobileFilter} label={mobileLookup[mobileFilter[0]].name} />\r\n          ) : null}\r\n        {mobileFilter.length > 0\r\n          ? (routeFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose route'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openRouteMenu(e.currentTarget)}>\r\n                  <DirectionsIcon className={classes.leftIcon} />Select route\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearRouteFilter} label={routeLookup[routeFilter[0]].name} />\r\n          )\r\n          : null}\r\n      </div>\r\n      <Menu\r\n        id='menu-library-service'\r\n        anchorEl={organisationMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(organisationMenuAnchor)}\r\n        onClose={() => closeOrganisationMenu()}\r\n      >\r\n        {\r\n          Array.from(countries)\r\n            .sort((a, b) => a.localeCompare(b))\r\n            .map((country, idx) => {\r\n              const menuItems = [<ListSubheader key={'lst_' + idx} disableSticky>{country}</ListSubheader>]\r\n              const orgList = organisations\r\n                .sort((a, b) => a.name.localeCompare(b.name))\r\n                .filter(org => org.country === country)\r\n                .map(org => {\r\n                  return <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n                })\r\n              return menuItems.concat(orgList)\r\n            })\r\n        }\r\n      </Menu>\r\n      <Menu\r\n        id='menu-mobile-library'\r\n        anchorEl={mobileMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(mobileMenuAnchor)}\r\n        onClose={() => closeMobileMenu()}\r\n      >\r\n        {mobiles\r\n          .filter(mob => {\r\n            let display = true\r\n            if (organisationFilter.length > 0 &&\r\n              organisationFilter.indexOf(mob.organisationId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(mob => {\r\n            return <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => chooseMobile(mob.organisationId, mob.id)}>{mob.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n      <Menu\r\n        id='menu-route'\r\n        anchorEl={routeMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(routeMenuAnchor)}\r\n        onClose={() => closeRouteMenu()}\r\n      >\r\n        {routes\r\n          .filter(route => {\r\n            let display = true\r\n            if (mobileFilter.length > 0 &&\r\n              mobileFilter.indexOf(route.mobileId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(route => {\r\n            return <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => chooseRoute(route.id)}>{route.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React, { useState } from 'react'\r\n\r\nimport { Link, useLocation } from 'react-router-dom'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Button from '@material-ui/core/Button'\r\nimport Container from '@material-ui/core/Container'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BookIcon from '@material-ui/icons/BookTwoTone'\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport GridOnIcon from '@material-ui/icons/GridOnTwoTone'\r\nimport HeadsetIcon from '@material-ui/icons/HeadsetTwoTone'\r\nimport LocalLibraryIcon from '@material-ui/icons/LocalLibraryTwoTone'\r\nimport MapIcon from '@material-ui/icons/MapTwoTone'\r\nimport MovieIcon from '@material-ui/icons/MovieTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport PetsIcon from '@material-ui/icons/PetsTwoTone'\r\nimport WarningIcon from '@material-ui/icons/WarningTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    position: 'relative'\r\n  },\r\n  appBarTransparent: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    position: 'relative'\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  topIcon: {\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    '&:hover': {\r\n      backgroundColor: 'rgba(250, 250, 250, 0.8)'\r\n    }\r\n  },\r\n  topTitle: {\r\n    position: 'relative',\r\n    zIndex: theme.zIndex.drawer + 1\r\n  }\r\n}))\r\n\r\nfunction AppHeader (props) {\r\n  const { site } = props\r\n  const [{ currentServiceSystemName }] = useSearchStateValue() //eslint-disable-line\r\n\r\n  const [appsOpen, setAppsOpen] = useState(false)\r\n  const [tabValue, setTabValue] = useState(site)\r\n\r\n  const location = useLocation()\r\n  const classes = useStyles()\r\n\r\n  const currentServicePath = (path) => {\r\n    if (currentServiceSystemName) return path + '?service=' + currentServiceSystemName\r\n    return path\r\n  }\r\n\r\n  const sites = [\r\n    {\r\n      title: 'Library lab',\r\n      url: 'https://www.librarylab.uk',\r\n      icon: <PetsIcon />,\r\n      links: [\r\n        {\r\n          title: 'About library lab',\r\n          short: 'Lab',\r\n          icon: <PetsIcon />,\r\n          to: '/'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Libraries at home',\r\n      url: 'https://www.librariesathome.co.uk',\r\n      icon: <LocalLibraryIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find service',\r\n          short: 'Find',\r\n          icon: <SearchIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Watch library TV',\r\n          short: 'Watch',\r\n          icon: <MovieIcon />,\r\n          to: '/watch'\r\n        },\r\n        {\r\n          title: 'Read blogs',\r\n          short: 'Read',\r\n          icon: <BookIcon />,\r\n          to: '/read'\r\n        },\r\n        {\r\n          title: 'Listen podcasts',\r\n          short: 'Listen',\r\n          icon: <HeadsetIcon />,\r\n          to: '/listen'\r\n        },\r\n        {\r\n          title: 'Check alerts',\r\n          short: 'Alerts',\r\n          icon: <WarningIcon />,\r\n          to: '/alerts'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Mobile libraries',\r\n      url: 'https://www.mobilelibraries.org',\r\n      icon: <DirectionBusIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my stop',\r\n          short: 'Stops',\r\n          icon: <GridOnIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: 'Mobile vans',\r\n          short: 'Vans',\r\n          icon: <DirectionBusIcon />,\r\n          to: '/mobiles'\r\n        },\r\n        {\r\n          title: 'Map of stops',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: '/map'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Library map',\r\n      url: 'https://www.librarymap.co.uk',\r\n      icon: <MapIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my library',\r\n          short: 'Find',\r\n          icon: <GridOnIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Map of libraries',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: currentServicePath('/map')\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n\r\n  const appBarClass = (location.pathname === '/map' ? classes.appBarTransparent : classes.appBar)\r\n\r\n  return (\r\n    <>\r\n      <Container maxWidth='lg' className={classes.topTitle}>\r\n        <Toolbar>\r\n          <IconButton aria-label='Toggle site menu' className={classes.topIcon} color='primary' onClick={() => { setAppsOpen(!appsOpen); setTabValue(site) }}>\r\n            {appsOpen ? <CancelIcon /> : <PetsIcon />}\r\n          </IconButton>\r\n          <span className={classes.grow} />\r\n          {location.pathname === '/map' ? <ServiceFilter /> : null}\r\n        </Toolbar>\r\n      </Container>\r\n      {appsOpen ? (\r\n        <AppBar position='static' color='transparent' elevation={0} className={appBarClass}>\r\n          <Container maxWidth='lg'>\r\n            <Tabs\r\n              value={tabValue}\r\n              onChange={(e, v) => { setTabValue(v) }}\r\n              variant='scrollable'\r\n              scrollButtons='on'\r\n              indicatorColor='primary'\r\n              textColor='secondary'\r\n            >\r\n              {sites.map((s, idx) => {\r\n                return (\r\n                  <Tab key={'tb_site_' + idx} label={s.title} icon={s.icon} />\r\n                )\r\n              })}\r\n            </Tabs>\r\n          </Container>\r\n        </AppBar>\r\n      ) : null}\r\n      <AppBar\r\n        position='static'\r\n        color='transparent'\r\n        elevation={0}\r\n        className={appBarClass}\r\n      >\r\n        <Container maxWidth='lg'>\r\n          <Toolbar>\r\n            <Hidden mdUp>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.short}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <Hidden smDown>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.title}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <span className={classes.grow} />\r\n            {location.pathname === '/map' ? <PostcodeSearch /> : null}\r\n          </Toolbar>\r\n        </Container>\r\n      </AppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default AppHeader\r\n","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport MaterialLink from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingTop: theme.spacing(5),\r\n    marginTop: theme.spacing(3),\r\n    marginBottom: theme.spacing(5),\r\n    width: '100%'\r\n  },\r\n  bullet: {\r\n    margin: theme.spacing(2)\r\n  },\r\n  grid: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  footerText: {\r\n    verticalAlign: 'middle',\r\n    display: 'inline-flex'\r\n  },\r\n  footerRight: {\r\n    textAlign: 'right'\r\n  },\r\n  tapTarget: {\r\n    lineHeight: 2.2,\r\n    fontSize: 16\r\n  }\r\n}))\r\n\r\nfunction Footer () {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider />\r\n      <Grid container spacing={3} className={classes.grid}>\r\n        <Grid item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='button'>\r\n            <MaterialLink component={Link} to='/accessibility' title='How we make this site accessible' className={classes.tapTarget}>Accessibility</MaterialLink>\r\n            <span className={classes.bullet}> &#8226; </span>\r\n            <MaterialLink component={Link} to='/privacy' title='Your privacy on this site' className={classes.tapTarget}>Privacy</MaterialLink>\r\n            <span className={classes.bullet}> &#8226; </span>\r\n            <MaterialLink component={Link} to='/data' title='Data used on this site and licensing' className={classes.tapTarget}>Data</MaterialLink>\r\n          </Typography>\r\n          <br />\r\n          <Typography variant='body2' className={classes.footerText}>A Library Lab project by Libraries Hacked.</Typography>\r\n        </Grid>\r\n        <Grid className={classes.footerRight} item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='button'>\r\n            <MaterialLink href='https://github.com/LibrariesHacked/mobilelibraries-website' target='_blank' title='Project on GitHub' className={classes.tapTarget}>Open Source on GitHub</MaterialLink>\r\n            <span className={classes.bullet}> &#8226; </span>\r\n            <MaterialLink href='https://www.librarylab.uk/docs/mobile-libraries' target='_blank' title='About the library lab projects and documentation for this project' className={classes.tapTarget}>About this project</MaterialLink>\r\n          </Typography>\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Footer\r\n","import React, { useEffect, useState } from 'react'\r\nimport ReactMarkdown from 'markdown-to-jsx'\r\n\r\nimport { withStyles, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport Link from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  listItem: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  root: {\r\n    '& table': {\r\n      display: 'block',\r\n      wordBreak: 'normal',\r\n      width: '100%',\r\n      overflowX: 'auto',\r\n      WebkitOverflowScrolling: 'touch',\r\n      borderCollapse: 'collapse',\r\n      marginBottom: '16px',\r\n      borderSpacing: 0,\r\n      overflow: 'hidden',\r\n      '& .prop-name': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace'\r\n      },\r\n      '& .required': {\r\n        color: theme.palette.type === 'light' ? '#006500' : '#a5ffa5'\r\n      },\r\n      '& .prop-type': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        color: theme.palette.type === 'light' ? '#932981' : '#ffb6ec'\r\n      },\r\n      '& .prop-default': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        borderBottom: `1px dotted ${theme.palette.divider}`\r\n      }\r\n    },\r\n    '& td': {\r\n      ...theme.typography.body2,\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16,\r\n      color: theme.palette.text.primary\r\n    },\r\n    '& th': {\r\n      fontSize: 14,\r\n      lineHeight: theme.typography.pxToRem(24),\r\n      fontWeight: theme.typography.fontWeightMedium,\r\n      color: theme.palette.text.primary,\r\n      whiteSpace: 'pre',\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16\r\n    }\r\n  }\r\n}))\r\n\r\nconst options = {\r\n  overrides: {\r\n    h1: {\r\n      component: Typography,\r\n      props: {\r\n        gutterBottom: true,\r\n        variant: 'h4',\r\n        color: 'secondary'\r\n      }\r\n    },\r\n    h2: { component: Typography, props: { gutterBottom: true, variant: 'h5', color: 'textPrimary' } },\r\n    h3: { component: Typography, props: { gutterBottom: true, variant: 'h6', color: 'textPrimary' } },\r\n    h4: {\r\n      component: Typography,\r\n      props: { gutterBottom: true, variant: 'h6', paragraph: true, color: 'textPrimary' }\r\n    },\r\n    p: { component: Typography, props: { paragraph: true, color: 'textPrimary' } },\r\n    a: { component: Link },\r\n    li: {\r\n      component: withStyles(useStyles)(({ classes, ...props }) => (\r\n        <li className={classes.listItem}>\r\n          <Typography component='span' {...props} />\r\n        </li>\r\n      ))\r\n    }\r\n  }\r\n}\r\n\r\nexport function MarkdownPage (props) {\r\n  const { page } = props\r\n  const [pageText, setPageText] = useState('')\r\n  const classes = useStyles()\r\n\r\n  useEffect(() => {\r\n    async function fetchPage () {\r\n      const pageData = await window.fetch(page)\r\n      const pageText = await pageData.text()\r\n      setPageText(pageText)\r\n    }\r\n    fetchPage()\r\n  }, [page])\r\n\r\n  return <ReactMarkdown className={classes.root} options={options} {...props}>{pageText}</ReactMarkdown>\r\n}\r\n\r\nexport const MemoMarkdownPage = React.memo(MarkdownPage)\r\n","import React from 'react'\r\n\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <Typography color='secondary' component='h2' variant='h3' className={classes.title}>Mobile libraries</Typography>\r\n      <Typography component='p' variant='body1' className={classes.subtitle}>Search by postcode or library service</Typography>\r\n      <div className={classes.search}>\r\n        <PostcodeSearch settings />\r\n      </div>\r\n      <ServiceFilter />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React from 'react'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardActions from '@material-ui/core/CardActions'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport GridOnIcon from '@material-ui/icons/GridOnTwoTone'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone'\r\nimport WebIcon from '@material-ui/icons/WebTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  bullet: {\r\n    display: 'inline-block',\r\n    margin: '0 2px',\r\n    transform: 'scale(1.2)'\r\n  },\r\n  card: {\r\n    minWidth: 275,\r\n    border: '2px solid #c8e6c9'\r\n  },\r\n  cardHeader: {\r\n    backgroundColor: '#e8f5e9',\r\n    color: '#388e3c'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  title: {\r\n    fontSize: 12,\r\n    fontWeight: 500,\r\n    align: 'right'\r\n  },\r\n  verticalDivider: {\r\n    width: 1,\r\n    height: 28,\r\n    margin: 8\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction MobileCard (props) {\r\n  const { mobile, organisation, location } = props\r\n  const [{ }, dispatchSearch] = useSearchStateValue() // eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() // eslint-disable-line\r\n\r\n  const viewStopsByMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n  }\r\n\r\n  const viewStop = (stopId) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stopId })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const displayMobileLibraryInfo = (mobileId) => {\r\n    dispatchSearch({ type: 'SetCurrentMobileLibrary', mobileLibraryId: mobileId })\r\n    dispatchView({ type: 'SetMobileLibraryDialog', mobileLibraryDialogOpen: true })\r\n  }\r\n\r\n  const stopButton = (stop) => {\r\n    return <Button color='secondary' onClick={() => viewStop(stop.stopId)}>{stop.stopName}</Button>\r\n  }\r\n\r\n  const offRoadMessage = (status) => {\r\n    return (\r\n      <Typography>{status.message}</Typography>\r\n    )\r\n  }\r\n\r\n  const preRouteMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const atStopMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {' for ' + status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const betweenStopsMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const postRouteMessage = (status) => <Typography>{status.message}</Typography>\r\n\r\n  const classes = useStyles()\r\n\r\n  let statusMessage = null\r\n  if (location) {\r\n    const status = location.getStatus()\r\n    if (status && status.type === 'offRoad') statusMessage = offRoadMessage(status)\r\n    if (status && status.type === 'preRoute') statusMessage = preRouteMessage(status)\r\n    if (status && status.type === 'atStop') statusMessage = atStopMessage(status)\r\n    if (status && status.type === 'betweenStops') statusMessage = betweenStopsMessage(status)\r\n    if (status && status.type === 'postRoute') statusMessage = postRouteMessage(status)\r\n  }\r\n\r\n  const bull = <span className={classes.bullet}>•</span>\r\n\r\n  return (\r\n    <Card className={classes.card} elevation={0}>\r\n      <CardContent className={classes.cardHeader}>\r\n        <Typography className={classes.title} gutterBottom>\r\n          {mobile.numberRoutes + ' route' + (mobile.numberRoutes > 1 ? 's' : '')}\r\n          {bull}\r\n          {mobile.numberStops + ' stop' + (mobile.numberStops > 1 ? 's' : '')}\r\n        </Typography>\r\n      </CardContent>\r\n      <CardContent>\r\n        <Typography variant='h6' component='h2'>{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n        {statusMessage}\r\n      </CardContent>\r\n      <CardActions>\r\n        <Tooltip title='See more mobile details'>\r\n          <IconButton size='small' onClick={() => displayMobileLibraryInfo(mobile.id)}>\r\n            <MoreVertIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n        <Divider className={classes.verticalDivider} />\r\n        <Tooltip title='Mobile library stops'>\r\n          <Button component={Link} to='/' size='small' color='primary' className={classes.button} onClick={() => viewStopsByMobile(organisation.id, mobile.id)}>\r\n            <GridOnIcon className={classes.leftIcon} />View stops\r\n          </Button>\r\n        </Tooltip>\r\n        {mobile.timetable ? (\r\n          <>\r\n            <Divider className={classes.verticalDivider} />\r\n            <Tooltip title='Website timetable'>\r\n              <IconButton className={classes.button} onClick={() => this.goToWebsite()}>\r\n                <WebIcon />\r\n              </IconButton>\r\n            </Tooltip>\r\n          </>\r\n        ) : null}\r\n      </CardActions>\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default MobileCard\r\n","import React, { useState } from 'react'\r\n\r\nimport Badge from '@material-ui/core/Badge'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport Filters from './Filters'\r\nimport MobileCard from './MobileCard'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  padding: {\r\n    padding: theme.spacing(0, 2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction Mobiles () {\r\n  const [{ organisationLookup, mobiles, mobileLookup, mobileLocationLookup, mobilesNearestLookup, routes, routeLookup }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ organisationFilter, mobileFilter, routeFilter, searchType, searchDistance, searchPostcode }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ loadingMobileLocations }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [openTab, setOpenTab] = useState(0)\r\n\r\n  const changeTab = (value) => {\r\n    setOpenTab(value)\r\n  }\r\n\r\n  // Get all mobiles that are currently filtered\r\n  const filteredMobiles = mobiles.filter(mob => {\r\n    let display = true\r\n    if (searchType === 'gps' || searchType === 'postcode') {\r\n      display = mobilesNearestLookup[mob.id]\r\n    }\r\n    if (organisationFilter.length > 0 &&\r\n      organisationFilter.indexOf(mob.organisationId) === -1) {\r\n      display = false\r\n    }\r\n    if (mobileFilter.length > 0 &&\r\n      mobileFilter.indexOf(mob.id) === -1) {\r\n      display = false\r\n    }\r\n    return display\r\n  })\r\n\r\n  // Then get those that are currently active\r\n  const activeMobiles = filteredMobiles.filter(mob => {\r\n    if (mobileLocationLookup[mob.id]) {\r\n      const status = mobileLocationLookup[mob.id].getStatus()\r\n      return (status && status.type !== 'offRoad' && status.type !== 'postRoute')\r\n    }\r\n    return null\r\n  })\r\n\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n\r\n  let title = 'Mobile library vans'\r\n  if (organisationName !== '') title = 'Mobile library vans serving ' + organisationName\r\n  if (mobileName !== '') title = organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = organisationName + ' ' + routeName\r\n  if (searchPostcode !== '') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  if (searchType === 'gps') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const classes = useStyles()\r\n\r\n  const displayMobiles = (openTab === 0 ? activeMobiles : filteredMobiles)\r\n  const mobilesView = displayMobiles\r\n    .filter(mob => {\r\n      let display = true\r\n      if (organisationFilter.length > 0 &&\r\n        organisationFilter.indexOf(mob.organisationId) === -1) {\r\n        display = false\r\n      }\r\n      if (mobileFilter.length > 0 &&\r\n        mobileFilter.indexOf(mob.id) === -1) {\r\n        display = false\r\n      }\r\n      return display\r\n    })\r\n    .filter(mob => {\r\n      if (searchType === 'gps' || searchType === 'postcode') {\r\n        return mobilesNearestLookup[mob.id]\r\n      }\r\n      return true\r\n    })\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Filters />\r\n      <ListSubheader component='span' disableSticky>{title}</ListSubheader>\r\n      <Tabs\r\n        variant='standard'\r\n        scrollButtons='off'\r\n        value={openTab}\r\n        indicatorColor='secondary'\r\n        onChange={(e, value) => changeTab(value)}\r\n      >\r\n        <Tab\r\n          className={classes.tab}\r\n          label={\r\n            <Badge\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={activeMobiles.length}\r\n            >\r\n              On the road\r\n            </Badge>\r\n          }\r\n        />\r\n        <Tab\r\n          label={\r\n            <Badge\r\n              showZero\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={filteredMobiles.length}\r\n            >\r\n              All vans\r\n            </Badge>\r\n          }\r\n        />\r\n      </Tabs>\r\n      <br />\r\n      {\r\n        mobilesView.length > 0\r\n          ? (\r\n            <Grid container spacing={3}>\r\n              {\r\n                mobilesView.map((mobile, idx) => {\r\n                  return (\r\n                    <Grid\r\n                      key={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n                      item xs={12} sm={6} md={4} lg={3} xl={3}\r\n                    >\r\n                      <MobileCard\r\n                        mobile={mobile}\r\n                        location={mobileLocationLookup[mobile.id]}\r\n                        organisation={organisationLookup[mobile.organisationId]}\r\n                      />\r\n                    </Grid>\r\n                  )\r\n                })\r\n              }\r\n            </Grid>) : (\r\n            !loadingMobileLocations\r\n              ? <Typography component='p' variant='body1'>No mobile libraries currently on the road.</Typography>\r\n              : null\r\n          )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Mobiles\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  dialogContentActions: {\r\n    backgroundColor: '#e8f5e9',\r\n    border: '1px solid #c8e6c9',\r\n    borderRadius: 3,\r\n    padding: 4\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction MobileLibraryDetails () {\r\n  const [{ mobileLookup }] = useApplicationStateValue()\r\n  const [{ currentMobileLibraryId }] = useSearchStateValue()\r\n  const [{ mobileLibraryDialogOpen }, dispatchView] = useViewStateValue()\r\n\r\n  const [mobileLibrary, setMobileLibrary] = useState({})\r\n\r\n  useEffect(() => {\r\n    if (currentMobileLibraryId != null && mobileLookup) setMobileLibrary(mobileLookup[currentMobileLibraryId])\r\n  }, [currentMobileLibraryId, mobileLookup])\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetMobileLibraryDialog', mobileLibraryDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={mobileLibraryDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {mobileLibrary\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>{mobileLibrary.name}</DialogTitle>\r\n            <DialogContent>\r\n              <ListSubheader disableSticky>Actions</ListSubheader>\r\n              <div className={classes.dialogContentActions} />\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => close()} color='secondary' endIcon={<CancelIcon />}>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default MobileLibraryDetails\r\n","import React from 'react'\r\n\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport Face from '@material-ui/icons/FaceTwoTone'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    margin: 0\r\n  },\r\n  avatarOn: {\r\n    margin: 0,\r\n    cursor: 'pointer',\r\n    backgroundColor: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nfunction MeAvatar () {\r\n  const [{ searchType }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip title='Me'>\r\n      <Avatar\r\n        className={searchType === 'gps' ? classes.avatarOn : classes.avatar}\r\n      >\r\n        <Face />\r\n      </Avatar>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MeAvatar\r\n","import React from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\n\r\nimport { useTheme, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction MapSettings () {\r\n  const [{ mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue()\r\n\r\n  const closeDialog = () => {\r\n    dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: false })\r\n  }\r\n\r\n  const handleAuthorityBoundaryChange = () => {\r\n    dispatchView({ type: 'ToggleMapSetting', mapSetting: 'authorityBoundary' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={mapSettingsDialogOpen}\r\n      onClose={closeDialog}\r\n      BackdropProps={{\r\n        invisible: true\r\n      }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Map settings</DialogTitle>\r\n      <DialogContent>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={mapSettings.authorityBoundary}\r\n              onChange={handleAuthorityBoundaryChange}\r\n              name='sw_authority_boundary'\r\n              color='primary'\r\n            />\r\n          }\r\n          label='Library service boundaries'\r\n        />\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={closeDialog} color='secondary' endIcon={<CancelIcon />}>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default MapSettings\r\n","export function hextoRGBA (hex, alpha) {\r\n  var c\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('')\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]]\r\n    }\r\n    c = '0x' + c.join('')\r\n    return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ', ' + alpha + ')'\r\n  }\r\n  throw new Error('Bad Hex')\r\n}\r\n","import React from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as utilsHelper from './helpers/utils'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  fab: {\r\n    margin: theme.spacing(1),\r\n    boxShadow: 'none'\r\n  }\r\n}))\r\n\r\nfunction MobileAvatar (props) {\r\n  const [{ mapZoom }] = useViewStateValue()\r\n  const { location, organisation } = props\r\n\r\n  const status = location.getStatus()\r\n  const size = (mapZoom[0] < 8 ? 'small' : (mapZoom[0] < 12 ? 'medium' : 'large'))\r\n  const border = (mapZoom[0] < 8 ? 2 : (mapZoom[0] < 12 ? 3 : 4))\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip\r\n      title={(status ? status.textFormat : '')}\r\n    >\r\n      <Fab\r\n        size={size}\r\n        className={classes.fab}\r\n        color='primary'\r\n        style={{\r\n          backgroundColor: utilsHelper.hextoRGBA(organisation.colour, 0.8),\r\n          color: 'white',\r\n          border: (border + 'px solid #FFFFFF')\r\n        }}\r\n      >\r\n        <DirectionBusIcon />\r\n      </Fab>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MobileAvatar\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from 'react-mapbox-gl'\r\n\r\nimport LayersIcon from '@material-ui/icons/LayersTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport moment from 'moment'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport MeAvatar from './MeAvatar'\r\nimport MapSettings from './MapSettings'\r\nimport MobileAvatar from './MobileAvatar'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  settings: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4)\r\n  }\r\n}))\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst Map = ReactMapboxGl({\r\n  minZoom: 5,\r\n  maxZoom: 18,\r\n  customAttribution: 'Contains public sector information licensed under the Open Government Licence'\r\n})\r\n\r\nconst stopTiles = [config.stopTiles]\r\nconst tripTiles = [config.tripTiles]\r\nconst libraryAuthorityTiles = [config.libraryAuthorityTiles]\r\n\r\nfunction MobileMap () {\r\n  const [{ organisations, organisationLookup, mobileLookup, mobileLocations }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ mapZoom, mapPosition, mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [currentTime, setCurrentTime] = useState(null)\r\n  const [map, setMap] = useState(null)\r\n\r\n  useEffect(() => {\r\n    const setTime = () => setCurrentTime(moment())\r\n    setInterval(setTime, 500)\r\n  }, [])\r\n\r\n  const clickStop = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentStop', stopId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const clickTrip = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentTrip', tripId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetTripDialog', tripDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  // Build the colour match\r\n  const organisationColourMatch = ['match', ['get', 'utla19cd']]\r\n  organisations.forEach(org => {\r\n    organisationColourMatch.push(org.code)\r\n    organisationColourMatch.push(org.colour)\r\n  })\r\n  organisationColourMatch.push('#a7a39b')\r\n\r\n  const classes = useStyles()\r\n\r\n  const locations = mobileLocations.filter(l => l.geoX !== null && l.geoY !== null)\r\n\r\n  return (\r\n    <>\r\n      <Map\r\n        style='style.json' // eslint-disable-line\r\n        center={mapPosition}\r\n        zoom={mapZoom}\r\n        maxZoom={17}\r\n        pitch={[0]}\r\n        bearing={[0]}\r\n        fitBounds={null}\r\n        containerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n        onStyleLoad={map => setMap(map)}\r\n      >\r\n        {// The mobile library locations\r\n          locations && locations.length > 0\r\n            ? locations.map(l => {\r\n              let locationPoint = [l.geoX, l.geoY]\r\n              if (currentTime && l.routeSection && l.routeSection.coordinates && l.updated) {\r\n                const millisecondsPassed = moment(currentTime).diff(l.updated)\r\n                const index = Math.round(millisecondsPassed / 500)\r\n                const coords = l.routeSection.coordinates\r\n                if (coords.length > index && index > 0) locationPoint = coords[index]\r\n                if (coords.length <= index && index > 0) locationPoint = coords[coords.length - 1]\r\n              }\r\n              const mobile = mobileLookup[l.mobileId]\r\n              const organisation = (mobile ? organisationLookup[mobile.organisationId] : null)\r\n              return (\r\n                <Marker\r\n                  key={'mkr_' + l.id}\r\n                  coordinates={locationPoint}\r\n                  anchor='bottom'\r\n                >\r\n                  <MobileAvatar\r\n                    organisation={organisation}\r\n                    location={l}\r\n                    zoom={map ? map.getZoom() : 0}\r\n                  />\r\n                </Marker>)\r\n            }) : null\r\n        }\r\n        <Source\r\n          id='src_stops'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: stopTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_trips'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: tripTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_library_authorities'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryAuthorityTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_trips_lines'\r\n          type='line'\r\n          sourceId='src_trips'\r\n          sourceLayer='trip'\r\n          minZoom={13}\r\n          layout={{\r\n            'line-join': 'round',\r\n            'line-cap': 'square'\r\n          }}\r\n          paint={{\r\n            'line-color': '#a7a39b',\r\n            'line-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-opacity': 1,\r\n            'line-width': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-dasharray': [\r\n              2,\r\n              0.5\r\n            ]\r\n          }}\r\n          onClick={clickTrip}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_circles'\r\n          type='circle'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={5}\r\n          layout={{}}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 2,\r\n              17, 12\r\n            ],\r\n            'circle-color': ['get', 'organisation_colour'],\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 1,\r\n              17, 4\r\n            ],\r\n            'circle-stroke-color': '#FFFFFF',\r\n            'circle-opacity': 0.7\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_labels'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 12,\r\n              17, 22\r\n            ],\r\n            'text-offset': [0, 2]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_next_visiting'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'next_visiting']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 10,\r\n              17, 16\r\n            ],\r\n            'text-offset': [0, -2.8]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        {mapSettings.authorityBoundary\r\n          ? (\r\n            <>\r\n              <Layer\r\n                id='lyr_library_authorities_lines'\r\n                type='line'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                layout={{\r\n                  'line-join': 'round',\r\n                  'line-cap': 'square'\r\n                }}\r\n                paint={{\r\n                  'line-color': '#a7a39b',\r\n                  'line-opacity': 1,\r\n                  'line-width': [\r\n                    'interpolate',\r\n                    [\r\n                      'linear'\r\n                    ],\r\n                    [\r\n                      'zoom'\r\n                    ],\r\n                    6, 1,\r\n                    22, 4\r\n                  ]\r\n                }}\r\n              />\r\n              <Layer\r\n                id='lyr_library_authorities_fill'\r\n                type='fill'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                paint={{\r\n                  'fill-color': organisationColourMatch,\r\n                  'fill-opacity': 0.1\r\n                }}\r\n              />\r\n            </>\r\n          ) : null}\r\n        {searchPosition && searchPosition.length > 1\r\n          ? (\r\n            <Marker\r\n              key='mk_me'\r\n              coordinates={[searchPosition[0], searchPosition[1]]}\r\n            >\r\n              <MeAvatar searchType={searchType} />\r\n            </Marker>\r\n          )\r\n          : null}\r\n        <ZoomControl position='bottom-left' />\r\n      </Map>\r\n      <Tooltip\r\n        title='Map settings'\r\n      >\r\n        <Fab\r\n          size='small'\r\n          className={classes.settings}\r\n          color='primary'\r\n          style={{\r\n            color: 'white',\r\n            border: '1px solid #FFFFFF'\r\n          }}\r\n          onClick={() => dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: true })}\r\n        >\r\n          <LayersIcon />\r\n        </Fab>\r\n      </Tooltip>\r\n      <MapSettings\r\n        mapSettings={mapSettings}\r\n        mapSettingsDialogOpen={mapSettingsDialogOpen}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MobileMap\r\n","import React from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Snackbar from '@material-ui/core/Snackbar'\r\n\r\nimport CloseIcon from '@material-ui/icons/CloseTwoTone'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nfunction Notification () {\r\n  const [{ notificationOpen, notificationMessage }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const handleClose = () => {\r\n    dispatchView({ type: 'SetNotification', notificationOpen: false })\r\n  }\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left'\r\n      }}\r\n      open={notificationOpen}\r\n      autoHideDuration={3000}\r\n      onClose={handleClose}\r\n      ContentProps={{\r\n        'aria-describedby': 'message-id'\r\n      }}\r\n      message={<span id='message-id'>{notificationMessage}</span>}\r\n      action={[\r\n        <IconButton\r\n          key='close'\r\n          aria-label='close'\r\n          onClick={handleClose}\r\n          color='secondary'\r\n        >\r\n          <CloseIcon />\r\n        </IconButton>\r\n      ]}\r\n    />\r\n  )\r\n}\r\n\r\nexport default Notification\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Stop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.routeIds = json.route_ids\r\n    this.routeNames = json.route_names\r\n    this.mobileIds = json.mobile_ids\r\n    this.mobileNames = json.mobile_names\r\n    this.organisationId = json.organisation_id\r\n    this.organisationName = json.organisation_name\r\n    this.name = json.name\r\n    this.community = json.community\r\n    this.address = json.address\r\n    this.postcode = json.postcode\r\n    this.arrivalTimes = json.arrival_times\r\n    this.departureTimes = json.departure_times\r\n    this.routeStart = moment(json.route_start)\r\n    this.routeEnd = moment(json.route_end)\r\n    this.routeDays = json.route_days\r\n    this.routeFrequencies = json.route_frequencies\r\n    this.routeSchedule = json.route_schedule.map(s => moment(s))\r\n    this.timetable = json.timetable\r\n    this.longitude = json.longitude\r\n    this.latitude = json.latitude\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getQueryStops (query, organisationFilters, mobileFilters, routeFilters, searchPosition, distance) {\r\n  let url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (mobileFilters.length > 0) url = url + '&mobile_ids=' + mobileFilters.join('|')\r\n  if (organisationFilters.length > 0) url = url + '&organisation_ids=' + organisationFilters.join('|')\r\n  if (routeFilters.length > 0) url = url + '&route_ids=' + routeFilters.join('|')\r\n\r\n  if (searchPosition && searchPosition.length > 1) url = url + '&longitude=' + searchPosition[0] + '&latitude=' + searchPosition[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  const response = await axios.get(url)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return {\r\n      stops: response.data.map(s => (new Stop()).fromJson(s)),\r\n      total: parseInt(response.headers['x-total-count']),\r\n      page: parseInt(response.headers['x-page'])\r\n    }\r\n  } else {\r\n    return { stops: [], total: 0, page: 1 }\r\n  }\r\n}\r\n\r\nexport async function getAllStops () {\r\n  const response = await axios.get(config.api + '/stops')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(s => (new Stop()).fromJson(s))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getStopById (id) {\r\n  const response = await axios.get(config.api + '/stops/' + id)\r\n  if (response && response.data) {\r\n    return (new Stop()).fromJson(response.data)\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport MaterialTable from 'material-table'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpwardTwoTone'\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeftTwoTone'\r\nimport ChevronRight from '@material-ui/icons/ChevronRightTwoTone'\r\nimport FirstPage from '@material-ui/icons/FirstPageTwoTone'\r\nimport FilterList from '@material-ui/icons/FilterListTwoTone'\r\nimport LastPage from '@material-ui/icons/LastPageTwoTone'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone'\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport Filters from './Filters'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 200\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  root: {\r\n    flexGrow: 1,\r\n    maxWidth: '100%'\r\n  },\r\n  table: {\r\n    backgroundColor: 'rgba(0, 0, 0, 0)',\r\n    border: '2px solid #c8e6c9'\r\n  }\r\n}))\r\n\r\nfunction Stops () {\r\n  const [{ organisationLookup, mobileLookup, routeLookup }] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance, searchPosition, organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const tableRef = React.createRef()\r\n\r\n  const getStopCalendar = (stop) => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = (stop) => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  useEffect(() => {\r\n    tableRef.current.onQueryChange()\r\n  }, [searchPosition, searchDistance, organisationFilter, mobileFilter, routeFilter]) // eslint-disable-line\r\n\r\n  const displayStopInfo = (stop) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stop.id })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const displayMapStop = (longitude, latitude) => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [longitude, latitude], mapZoom: 15 })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  // Calculate title\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n  let title = 'All stops'\r\n  // Filter stops\r\n  if (organisationName !== '') title = 'Stops in ' + organisationName\r\n  if (mobileName !== '') title = 'Stops for ' + organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = 'Stops for ' + organisationName + ' ' + routeName\r\n  // Postcode search stops\r\n  if (searchPostcode !== '') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  // GPS search stops\r\n  if (searchType === 'gps') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const orgText = {}\r\n  Object.keys(organisationLookup).forEach(key => {\r\n    orgText[key] = organisationLookup[key].name\r\n  })\r\n  const mobileText = {}\r\n  Object.keys(mobileLookup).forEach(key => {\r\n    mobileText[key] = mobileLookup[key].name\r\n  })\r\n  const routeText = {}\r\n  Object.keys(routeLookup).forEach(key => {\r\n    routeText[key] = routeLookup[key].name\r\n  })\r\n\r\n  return (\r\n    <div style={{ maxWidth: '100%' }}>\r\n      <Filters />\r\n      <ListSubheader disableSticky>{title}</ListSubheader>\r\n      <MaterialTable\r\n        tableRef={tableRef}\r\n        components={{\r\n          Container: props => <Paper {...props} elevation={0} className={classes.table} />\r\n        }}\r\n        icons={{\r\n          Filter: FilterList,\r\n          FirstPage: FirstPage,\r\n          LastPage: LastPage,\r\n          NextPage: ChevronRight,\r\n          PreviousPage: ChevronLeft,\r\n          SortArrow: ArrowUpward\r\n        }}\r\n        options={{\r\n          padding: useMediaQuery(theme.breakpoints.up('sm')) ? 'default' : 'dense',\r\n          search: false,\r\n          loadingType: 'overlay',\r\n          actionsColumnIndex: 0,\r\n          filtering: false,\r\n          toolbar: false,\r\n          headerStyle: {\r\n            backgroundColor: '#e8f5e9',\r\n            color: '#388e3c',\r\n            border: '0px'\r\n          }\r\n        }}\r\n        columns={[\r\n          {\r\n            title: '',\r\n            field: 'name',\r\n            filtering: false,\r\n            render: rowData => {\r\n              return (\r\n                <>\r\n                  <Tooltip title='See more stop details'>\r\n                    <IconButton size='small' onClick={() => displayStopInfo(rowData)}>\r\n                      <MoreVertIcon />\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Add event to your device calendar'>\r\n                      <IconButton size='small' color='primary' onClick={() => getStopCalendar(rowData)}>\r\n                        <EventIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Download a PDF timetable for this stop'>\r\n                      <IconButton size='small' color='primary' onClick={() => getStopPdf(rowData)}>\r\n                        <PrintIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='See this stop on the map'>\r\n                      <IconButton size='small' color='primary' onClick={() => displayMapStop(rowData.longitude, rowData.latitude)} component={Link} to='/map'>\r\n                        <LocationOnIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                </>\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Community',\r\n            field: 'community',\r\n            filtering: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Name',\r\n            field: 'name',\r\n            filtering: false,\r\n            hidden: false,\r\n            render: rowData => {\r\n              return (\r\n                rowData.name\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Library service',\r\n            field: 'organisationName',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('sm')),\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Next due',\r\n            field: 'routeSchedule',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('xs')),\r\n            render: (rowData) => {\r\n              return (\r\n                rowData.routeSchedule.length > 0 ? rowData.routeSchedule[0].format('Do MMMM h:mma') : ''\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          }\r\n        ]}\r\n        data={query =>\r\n          new Promise((resolve, reject) => {\r\n            async function getStops () {\r\n              const stopData = await stopsModel.getQueryStops(query, organisationFilter, mobileFilter, routeFilter, searchPosition, searchDistance)\r\n              resolve({\r\n                data: stopData.stops,\r\n                page: (stopData.page - 1),\r\n                totalCount: stopData.total\r\n              })\r\n            }\r\n            getStops()\r\n          })}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Stops\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport WebIcon from '@material-ui/icons/WebTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  dialogContentActions: {\r\n    backgroundColor: '#e8f5e9',\r\n    border: '1px solid #c8e6c9',\r\n    borderRadius: 3,\r\n    padding: 4\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction StopDetails () {\r\n  const [{ currentStopId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ stopDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [stop, setStop] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getStop (stopId) {\r\n      const stopData = await stopsModel.getStopById(stopId)\r\n      setStop(stopData)\r\n    }\r\n    if (currentStopId != null) getStop(currentStopId)\r\n  }, [currentStopId])\r\n\r\n  const getStopCalendar = () => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = () => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  const goToWebsite = () => window.open(stop.timetable, '_blank')\r\n\r\n  const viewMapStop = () => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [stop.longitude, stop.latitude], mapZoom: 14 })\r\n  }\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={stopDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {stop && stop.routeDays\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>{stop.name + '. ' + stop.community}</DialogTitle>\r\n            <DialogContent>\r\n              <p>{(stop.routeSchedule && stop.routeSchedule.length > 0 ? stop.routeSchedule[0].format('dddd Do MMMM h:mma') : '')}</p>\r\n              <ListSubheader disableSticky>Actions</ListSubheader>\r\n              <div className={classes.dialogContentActions}>\r\n                <Button onClick={getStopCalendar} className={classes.button} color='primary' startIcon={<EventIcon />}>Calendar</Button>\r\n                <Button onClick={getStopPdf} className={classes.button} color='primary' startIcon={<PrintIcon />}>Timetable</Button>\r\n                <Button onClick={() => goToWebsite()} color='primary' startIcon={<WebIcon />}>Website</Button>\r\n                <Button onClick={viewMapStop} className={classes.button} color='primary' startIcon={<LocationOnIcon />} component={Link} to='/map'>Map</Button>\r\n              </div>\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => close()} color='secondary' endIcon={<CancelIcon />}>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default StopDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Trip {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.originStopId = json.origin_stop_id\r\n    this.originStopName = json.origin_stop_name\r\n    this.destinationStopId = json.destination_stop_id\r\n    this.destinationStopName = json.destination_stop_name\r\n    this.distance = json.distance\r\n    this.duration = json.duration\r\n    this.routeLine = json.route_line\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllTrips () {\r\n  const response = await axios.get(config.api + '/trips')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(t => (new Trip()).fromJson(t))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getTripById (id) {\r\n  const response = await axios.get(config.api + '/trips/' + id)\r\n  if (response && response.data) {\r\n    return (new Trip()).fromJson(response.data)\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as tripsModel from './models/trips'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction TripDetails () {\r\n  const [{ currentTripId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ tripDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [trip, setTrip] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getTrip (tripId) {\r\n      const trip = await tripsModel.getTripById(tripId)\r\n      setTrip(trip)\r\n    }\r\n    if (currentTripId != null) getTrip(currentTripId)\r\n  }, [currentTripId])\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetTripDialog', tripDialogOpen: false })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n  const estimatedDuration = Math.round(trip.duration / 60) + ' mins journey time.'\r\n  const distance = Math.round(trip.distance / 1609, 1) + ' mile(s)'\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={tripDialogOpen}\r\n      onClose={close}\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Trip details</DialogTitle>\r\n      <DialogContent>\r\n        <ListSubheader disableSticky>{'From ' + trip.originStopName + ' to ' + trip.destinationStopName}</ListSubheader>\r\n        <Typography variant='body2' component='p'>{estimatedDuration + ' ' + distance}</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close} color='secondary' endIcon={<CancelIcon />}>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default TripDetails\r\n","export default __webpack_public_path__ + \"static/media/accessibility.04c7e0c6.md\";","export default __webpack_public_path__ + \"static/media/data.c1063344.md\";","export default __webpack_public_path__ + \"static/media/privacy.d85474c9.md\";","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Organisation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.country = json.country\r\n    this.code = json.service_code\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.website = json.website\r\n    this.email = json.email\r\n    this.colour = json.colour\r\n    this.logo = json.logo\r\n    this.numberMobiles = json.number_mobiles\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllOrganisations () {\r\n  const response = await axios.get(config.api + '/organisations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(o => (new Organisation()).fromJson(o))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Route {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.mobileId = json.mobile_id\r\n    this.name = json.name\r\n    this.frequency = json.frequency\r\n    this.start = moment(json.start)\r\n    this.end = moment(json.end)\r\n    this.timetable = json.timetable\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllRoutes () {\r\n  const response = await axios.get(config.api + '/routes')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(r => (new Route()).fromJson(r))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { BrowserRouter, Route } from 'react-router-dom'\r\n\r\nimport Container from '@material-ui/core/Container'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport AppHeader from './AppHeader'\r\nimport Footer from './Footer'\r\nimport { MemoMarkdownPage } from './MarkdownPage'\r\nimport Mobiles from './Mobiles'\r\nimport MobileLibraryDetails from './MobileLibraryDetails'\r\nimport MobileMap from './MobileMap'\r\nimport Notification from './Notification'\r\nimport Stops from './Stops'\r\nimport StopDetails from './StopDetails'\r\nimport TripDetails from './TripDetails'\r\n\r\nimport Accessibility from './pages/accessibility.md'\r\nimport Data from './pages/data.md'\r\nimport Privacy from './pages/privacy.md'\r\n\r\nimport * as mobilesModel from './models/mobiles'\r\nimport * as organisationsModel from './models/organisations'\r\nimport * as routesModel from './models/routes'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction MobilesApplication () {\r\n  const [{ loadingOrganisations, loadingMobiles, loadingRoutes, loadingMobileLocations, loadingNearestMobiles, loadingPostcode }] = useViewStateValue()\r\n  const [{ }, dispatchApplicationState] = useApplicationStateValue() //eslint-disable-line\r\n\r\n  useEffect(() => {\r\n    async function getOrganisations () {\r\n      const organisations = await organisationsModel.getAllOrganisations()\r\n      const organisationLookup = {}\r\n      organisations.forEach(organisation => { organisationLookup[organisation.id] = organisation })\r\n      dispatchApplicationState({ type: 'AddOrganisations', organisations: organisations, organisationLookup: organisationLookup })\r\n    }\r\n    async function getMobiles () {\r\n      const mobiles = await mobilesModel.getAllMobiles()\r\n      const mobileLookup = {}\r\n      mobiles.forEach(mobile => { mobileLookup[mobile.id] = mobile })\r\n      dispatchApplicationState({ type: 'AddMobiles', mobiles: mobiles, mobileLookup: mobileLookup })\r\n    }\r\n    async function getRoutes () {\r\n      const routes = await routesModel.getAllRoutes()\r\n      const routeLookup = {}\r\n      routes.forEach(route => { routeLookup[route.id] = route })\r\n      dispatchApplicationState({ type: 'AddRoutes', routes: routes, routeLookup: routeLookup })\r\n    }\r\n    async function getMobileLocations () {\r\n      const locations = await mobilesModel.getMobileLocations()\r\n      const mobileLocationLookup = {}\r\n      locations.forEach(location => { mobileLocationLookup[location.mobileId] = location })\r\n      dispatchApplicationState({ type: 'AddMobileLocations', mobileLocations: locations, mobileLocationLookup: mobileLocationLookup })\r\n    }\r\n    getOrganisations()\r\n    getMobiles()\r\n    getRoutes()\r\n    getMobileLocations()\r\n\r\n    setInterval(() => {\r\n      getMobileLocations(false)\r\n    }, 15000)\r\n  }, []) //eslint-disable-line\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <div className={classes.root}>\r\n        <AppHeader\r\n          loading={loadingOrganisations || loadingMobiles || loadingRoutes || loadingMobileLocations || loadingNearestMobiles || loadingPostcode}\r\n          site={2}\r\n        />\r\n        <Container maxWidth='lg'>\r\n          <main className={classes.content}>\r\n            <Route path='/' exact render={() => <Stops />} />\r\n            <Route path='/mobiles' render={() => <Mobiles />} />\r\n            <Route path='/map' render={() => <MobileMap />} />\r\n            <Route path='/accessibility' exact render={() => <MemoMarkdownPage page={Accessibility} />} />\r\n            <Route path='/data' exact render={() => <MemoMarkdownPage page={Data} />} />\r\n            <Route path='/privacy' exact render={() => <MemoMarkdownPage page={Privacy} />} />\r\n            <Route path={['/http:', '/https:']} component={props => { window.location.replace(props.location.pathname.substr(1)); return null }} />\r\n          </main>\r\n        </Container>\r\n        <Container maxWidth='lg'>\r\n          <Footer />\r\n        </Container>\r\n        <StopDetails />\r\n        <MobileLibraryDetails />\r\n        <TripDetails />\r\n        <Notification />\r\n      </div>\r\n    </BrowserRouter>\r\n  )\r\n}\r\n\r\nexport default MobilesApplication\r\n","import React from 'react'\r\n\r\nimport CssBaseline from '@material-ui/core/CssBaseline'\r\n\r\nimport blueGrey from '@material-ui/core/colors/blueGrey'\r\nimport green from '@material-ui/core/colors/green'\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\r\n\r\nimport { ApplicationStateProvider } from './context/applicationState'\r\nimport { SearchStateProvider } from './context/searchState'\r\nimport { ViewStateProvider } from './context/viewState'\r\n\r\nimport MobilesApplication from './MobilesApplication'\r\n\r\nconst initialApplicationState = {\r\n  organisations: [],\r\n  organisationLookup: {},\r\n  mobiles: [],\r\n  mobileLookup: {},\r\n  mobileLocations: [],\r\n  mobileLocationLookup: {},\r\n  mobilesNearest: [],\r\n  mobilesNearestLookup: {},\r\n  routes: [],\r\n  routeLookup: {},\r\n  stops: [],\r\n  trips: []\r\n}\r\n\r\nconst applicationReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'AddOrganisations':\r\n      return {\r\n        ...state,\r\n        organisations: action.organisations,\r\n        organisationLookup: action.organisationLookup\r\n      }\r\n    case 'AddMobileLocations':\r\n      return {\r\n        ...state,\r\n        mobileLocations: action.mobileLocations,\r\n        mobileLocationLookup: action.mobileLocationLookup\r\n      }\r\n    case 'AddRoutes':\r\n      return {\r\n        ...state,\r\n        routes: action.routes,\r\n        routeLookup: action.routeLookup\r\n      }\r\n    case 'AddMobiles':\r\n      return {\r\n        ...state,\r\n        mobiles: action.mobiles,\r\n        mobileLookup: action.mobileLookup\r\n      }\r\n    case 'UpdateMobilesNearest':\r\n      return {\r\n        ...state,\r\n        mobilesNearest: action.mobilesNearest,\r\n        mobilesNearestLookup: action.mobilesNearestLookup\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialSearchState = {\r\n  searchPostcode: '',\r\n  searchType: '',\r\n  searchDistance: 1609,\r\n  searchPosition: [],\r\n  searchPositionUpdateInterval: null,\r\n  organisationFilter: [],\r\n  mobileFilter: [],\r\n  routeFilter: [],\r\n  currentStopId: null,\r\n  currentMobileLibraryId: null,\r\n  currentTripId: null\r\n}\r\n\r\nconst searchReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetCurrentStop':\r\n      return {\r\n        ...state,\r\n        currentStopId: action.stopId\r\n      }\r\n    case 'SetCurrentMobileLibrary':\r\n      return {\r\n        ...state,\r\n        currentMobileLibraryId: action.mobileLibraryId\r\n      }\r\n    case 'SetCurrentTrip':\r\n      return {\r\n        ...state,\r\n        currentTripId: action.tripId\r\n      }\r\n    case 'SetSearchDistance':\r\n      return {\r\n        ...state,\r\n        searchDistance: action.searchDistance\r\n      }\r\n    case 'SetPostcodeSearch':\r\n      return {\r\n        ...state,\r\n        searchPostcode: action.searchPostcode,\r\n        searchPosition: action.searchPosition,\r\n        searchType: 'postcode',\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: []\r\n      }\r\n    case 'FilterByOrganisation':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByMobile':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [action.mobileId],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByRoute':\r\n      return {\r\n        ...state,\r\n        routeFilter: [action.routeId],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearAll':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearMobileFilter':\r\n      return {\r\n        ...state,\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearRouteFilter':\r\n      return {\r\n        ...state,\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialViewState = {\r\n  stopDialogOpen: false,\r\n  mobileLibraryDialogOpen: false,\r\n  tripDialogOpen: false,\r\n  notificationOpen: false,\r\n  notificationMessage: '',\r\n  mapZoom: [7],\r\n  mapPosition: [-1.155414, 52.691432],\r\n  mapSettings: {\r\n    authorityBoundary: false\r\n  },\r\n  mapSettingsDialogOpen: false,\r\n  loadingOrganisations: false,\r\n  loadingMobiles: false,\r\n  loadingRoutes: false,\r\n  loadingMobileLocations: false,\r\n  loadingNearestMobiles: false,\r\n  loadingPostcode: false\r\n}\r\n\r\nconst viewReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetNotificationMessage':\r\n      return { ...state, notificationMessage: action.notificationMessage }\r\n    case 'SetNotification':\r\n      return { ...state, notificationOpen: action.notificationOpen }\r\n    case 'ShowNotification':\r\n      return { ...state, notificationOpen: true, notificationMessage: action.notificationMessage }\r\n    case 'SetStopDialog':\r\n      return { ...state, stopDialogOpen: action.stopDialogOpen }\r\n    case 'SetMobileLibraryDialog':\r\n      return { ...state, mobileLibraryDialogOpen: action.mobileLibraryDialogOpen }\r\n    case 'SetTripDialog':\r\n      return { ...state, tripDialogOpen: action.tripDialogOpen }\r\n    case 'SetMapSettingsDialog':\r\n      return { ...state, mapSettingsDialogOpen: action.mapSettingsDialogOpen }\r\n    case 'ToggleMapSetting': {\r\n      const settings = state.mapSettings\r\n      settings[action.mapSetting] = !settings[action.mapSetting]\r\n      return { ...state, mapSettings: settings }\r\n    }\r\n    case 'SetPostcodeSearch':\r\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [13] }\r\n    case 'ToggleLoadingPostcode':\r\n      return { ...state, loadingPostcode: !state.loadingPostcode }\r\n    case 'SetMapPosition':\r\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [action.mapZoom] }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: green[700]\r\n    },\r\n    secondary: {\r\n      main: blueGrey[700]\r\n    },\r\n    outline: {\r\n      main: blueGrey[50]\r\n    }\r\n  },\r\n  overrides: {\r\n    MuiButton: {\r\n      text: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTab: {\r\n      root: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTypography: {\r\n      button: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTableCell: {\r\n      root: {\r\n        borderBottom: 'none'\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nfunction App () {\r\n  return (\r\n    <ApplicationStateProvider initialState={initialApplicationState} reducer={applicationReducer}>\r\n      <SearchStateProvider initialState={initialSearchState} reducer={searchReducer}>\r\n        <ViewStateProvider initialState={initialViewState} reducer={viewReducer}>\r\n          <ThemeProvider theme={theme}>\r\n            <CssBaseline />\r\n            <MobilesApplication />\r\n          </ThemeProvider>\r\n        </ViewStateProvider>\r\n      </SearchStateProvider>\r\n    </ApplicationStateProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n)\r\n\r\nexport function register (config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config)\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          )\r\n        })\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction registerValidSW (swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing\r\n        if (installingWorker == null) {\r\n          return\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              )\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration)\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.')\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error)\r\n    })\r\n}\r\n\r\nfunction checkValidServiceWorker (swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  window.fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type')\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload()\r\n          })\r\n        })\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      )\r\n    })\r\n}\r\n\r\nexport function unregister () {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister()\r\n    })\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11'\r\nimport 'react-app-polyfill/stable'\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './App'\r\n\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nimport 'mapbox-gl/dist/mapbox-gl.css'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}