{"version":3,"sources":["../node_modules/jspdf/dist sync","pages/accessibility.md","pages/data.md","pages/privacy.md","context/applicationState.js","context/searchState.js","context/viewState.js","helpers/geo.js","models/mobiles.js","PostcodeSearch.js","ServiceFilter.js","AppHeader.js","Footer.js","MarkdownPage.js","Filters.js","MobileCard.js","Mobiles.js","MeAvatar.js","MapSettings.js","helpers/utils.js","MobileAvatar.js","MobileMap.js","Notification.js","models/stops.js","Stops.js","StopDetails.js","models/trips.js","TripDetails.js","models/organisations.js","models/routes.js","MobilesApplication.js","App.js","serviceWorker.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","ApplicationStateContext","createContext","ApplicationStateProvider","reducer","initialState","children","Provider","value","useReducer","useApplicationStateValue","useContext","SearchStateContext","SearchStateProvider","useSearchStateValue","ViewStateContext","ViewStateProvider","useViewStateValue","config","require","getPostcode","postcode","a","axios","get","postcodeApi","response","location","data","longitude","latitude","organisation","library_service_name","Mobile","obj","Object","assign","this","json","organisationId","organisation_id","name","timetable","numberRoutes","number_routes","numberStops","number_stops","MobileNearestStop","mobileId","mobile_id","stopId","stop_id","stopName","stop_name","stopDistance","stop_distance","MobileLocation","currentStopId","current_stop_id","currentStopDeparture","moment","current_stop_departure","currentStopName","current_stop_name","previousStopId","previous_stop_id","previousStopDeparture","previous_stop_departure","previousStopName","previous_stop_name","nextStopId","next_stop_id","nextStopArrival","next_stop_arrival","nextStopName","next_stop_name","updated","updateType","update_type","geoX","geox","geoY","geoy","routeSection","route_section","now","statuses","isSame","type","textFormat","message","arrival","fromNow","args","stopRemaining","text_format","getAllMobiles","api","length","mobiles","map","m","fromJson","getMobileLocations","locations","ml","getMobilesNearest","distance","useStyles","makeStyles","theme","grow","flexGrow","iconButton","padding","inputInput","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","fontWeight","search","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","marginRight","display","maxWidth","PostcodeSearch","dispatchApplication","searchType","searchPostcode","searchDistance","dispatchSearch","dispatchView","useState","tempPostcode","setTempPostcode","anchor","setAnchor","prevProps","ref","useRef","useEffect","current","usePrevious","closeSettingsMenu","setSearchDistance","postcodeSearch","notificationMessage","geoHelper","postcodeData","searchPosition","mapPosition","mobilesModel","mobilesNearest","mobilesNearestLookup","forEach","mobile","classes","className","InputBase","placeholder","input","onChange","target","Tooltip","title","IconButton","onClick","color","currentTarget","openSettingsMenu","Menu","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","button","chip","leftIcon","alignContent","textAlign","marginBottom","subtitle","Filters","organisations","organisationLookup","mobileLookup","routeLookup","routes","organisationFilter","mobileFilter","routeFilter","organisationMenuAnchor","setOrganisationMenuAnchor","mobileMenuAnchor","setMobileMenuAnchor","routeMenuAnchor","setRouteMenuAnchor","closeOrganisationMenu","closeMobileMenu","closeRouteMenu","countries","Set","org","country","Button","element","Chip","variant","onDelete","label","Array","from","sort","b","localeCompare","idx","menuItems","key","orgList","filter","concat","mob","indexOf","route","routeId","appBar","zIndex","drawer","appBarTransparent","siteTitle","margin","verticalAlign","primary","main","siteTitleIcon","topIcon","topTitle","AppHeader","props","site","currentServiceSystemName","appsOpen","setAppsOpen","tabValue","setTabValue","useLocation","currentServicePath","path","sites","url","icon","links","short","to","appBarClass","pathname","Toolbar","ServiceFilter","AppBar","elevation","Tabs","centered","v","scrollButtons","indicatorColor","textColor","s","Tab","Hidden","mdUp","link","component","Link","disableRipple","disableFocusRipple","size","startIcon","smDown","root","marginTop","width","grid","loveIcon","footerText","footerRight","tapTarget","lineHeight","fontSize","Footer","Divider","Grid","container","item","xs","sm","md","lg","xl","Typography","RouteLink","href","listItem","wordBreak","overflowX","WebkitOverflowScrolling","borderCollapse","borderSpacing","overflow","fontFamily","borderBottom","divider","typography","body2","text","pxToRem","fontWeightMedium","whiteSpace","options","overrides","h1","gutterBottom","h2","h3","h4","paragraph","p","li","withStyles","MemoMarkdownPage","React","memo","page","pageText","setPageText","window","fetch","pageData","fetchPage","bullet","transform","card","minWidth","align","verticalDivider","height","progress","MobileCard","stopButton","stop","stopDialogOpen","statusMessage","status","getStatus","offRoadMessage","preRouteMessage","atStopMessage","betweenStopsMessage","postRouteMessage","CircularProgress","bull","Card","CardContent","CardActions","goToWebsite","Mobiles","mobileLocationLookup","loadingMobileLocations","openTab","setOpenTab","filteredMobiles","activeMobiles","organisationName","mobileName","routeName","Math","round","mobilesView","changeTab","tab","Badge","badgeContent","showZero","replace","avatar","avatarOn","cursor","MeAvatar","Avatar","dialog","MapSettings","mapSettings","mapSettingsDialogOpen","closeDialog","useTheme","fullScreen","useMediaQuery","breakpoints","down","Dialog","disableBackdropClick","BackdropProps","invisible","PaperProps","DialogTitle","DialogContent","FormControlLabel","control","Switch","checked","authorityBoundary","mapSetting","DialogActions","hextoRGBA","hex","alpha","c","test","substring","split","join","fab","boxShadow","MobileAvatar","mapZoom","Fab","style","utilsHelper","colour","settings","bottom","right","Map","ReactMapboxGl","minZoom","maxZoom","customAttribution","stopTiles","tripTiles","libraryAuthorityTiles","MobileMap","mobileLocations","currentTime","setCurrentTime","setMap","setInterval","setTime","clickStop","features","properties","organisationColourMatch","push","l","center","zoom","pitch","bearing","fitBounds","containerStyle","top","left","onStyleLoad","locationPoint","coordinates","millisecondsPassed","diff","index","coords","getZoom","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","tripId","tripDialogOpen","Notification","notificationOpen","handleClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","ContentProps","action","aria-label","Stop","routeIds","route_ids","routeNames","route_names","mobileIds","mobile_ids","mobileNames","mobile_names","organisation_name","community","address","arrivalTimes","arrival_times","departureTimes","departure_times","routeStart","route_start","routeEnd","route_end","routeDays","route_days","routeFrequencies","route_frequencies","routeSchedule","route_schedule","getQueryStops","query","organisationFilters","mobileFilters","routeFilters","pageSize","orderBy","field","orderDirection","stops","total","parseInt","headers","getStopById","formControl","table","Stops","tableRef","createRef","onQueryChange","orgText","mobileText","routeText","components","Container","Paper","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","up","loadingType","actionsColumnIndex","filtering","toolbar","headerStyle","columns","render","rowData","mdDown","cellStyle","hidden","format","Promise","reject","stopsModel","stopData","totalCount","getStops","list","background","paper","StopDetails","setStop","getStop","close","aria-labelledby","Trip","originStopId","origin_stop_id","originStopName","origin_stop_name","destinationStopId","destination_stop_id","destinationStopName","destination_stop_name","duration","routeLine","route_line","getTripById","TripDetails","currentTripId","trip","setTrip","tripsModel","getTrip","estimatedDuration","Organisation","website","email","logo","numberMobiles","number_mobiles","getAllOrganisations","o","Route","frequency","start","end","getAllRoutes","r","content","MobilesApplication","loadingOrganisations","loadingMobiles","loadingRoutes","loadingNearestMobiles","loadingPostcode","dispatchApplicationState","organisationsModel","routesModel","getOrganisations","getMobiles","getRoutes","loading","exact","Accessibility","Data","Privacy","substr","initialApplicationState","trips","applicationReducer","state","initialSearchState","searchPositionUpdateInterval","searchReducer","initialViewState","viewReducer","createMuiTheme","red","secondary","blueGrey","MuiButton","textTransform","MuiTab","MuiTypography","MuiTableCell","App","ThemeProvider","CssBaseline","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.17b369f6.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 524;","module.exports = __webpack_public_path__ + \"static/media/accessibility.83399c29.md\";","module.exports = __webpack_public_path__ + \"static/media/data.e9cc0a7b.md\";","module.exports = __webpack_public_path__ + \"static/media/privacy.a013c74b.md\";","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ApplicationStateContext = createContext()\r\n\r\nexport const ApplicationStateProvider = ({ reducer, initialState, children }) => (\r\n  <ApplicationStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ApplicationStateContext.Provider>\r\n)\r\n\r\nexport const useApplicationStateValue = () => useContext(ApplicationStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const SearchStateContext = createContext()\r\n\r\nexport const SearchStateProvider = ({ reducer, initialState, children }) => (\r\n  <SearchStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </SearchStateContext.Provider>\r\n)\r\n\r\nexport const useSearchStateValue = () => useContext(SearchStateContext)\r\n","import React, { createContext, useContext, useReducer } from 'react'\r\n\r\nexport const ViewStateContext = createContext()\r\n\r\nexport const ViewStateProvider = ({ reducer, initialState, children }) => (\r\n  <ViewStateContext.Provider value={useReducer(reducer, initialState)}>\r\n    {children}\r\n  </ViewStateContext.Provider>\r\n)\r\n\r\nexport const useViewStateValue = () => useContext(ViewStateContext)\r\n","import axios from 'axios'\r\n\r\nconst config = require('./config.json')\r\n\r\nexport function getPosition (options = {}) {\r\n  return new Promise((resolve, reject) => {\r\n    navigator.geolocation.getCurrentPosition(resolve, reject, options)\r\n  })\r\n}\r\n\r\nexport async function getCurrentPosition () {\r\n  var options = {\r\n    enableHighAccuracy: true,\r\n    timeout: 10000,\r\n    maximumAge: 0\r\n  }\r\n\r\n  const position = await getPosition(options)\r\n  return [position.coords.longitude, position.coords.latitude]\r\n}\r\n\r\nexport async function getPostcode (postcode) {\r\n  const response = await axios.get(config.postcodeApi + postcode)\r\n  return {\r\n    location: [response.data.longitude, response.data.latitude],\r\n    organisation: response.data.library_service_name\r\n  }\r\n};\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Mobile {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileNearestStop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.stopId = json.stop_id\r\n    this.stopName = json.stop_name\r\n    this.stopDistance = json.stop_distance\r\n    return this\r\n  }\r\n}\r\n\r\nexport class MobileLocation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.mobileId = json.mobile_id\r\n    this.currentStopId = json.current_stop_id\r\n    this.currentStopDeparture = moment(json.current_stop_departure)\r\n    this.currentStopName = json.current_stop_name\r\n    this.previousStopId = json.previous_stop_id\r\n    this.previousStopDeparture = moment(json.previous_stop_departure)\r\n    this.previousStopName = json.previous_stop_name\r\n    this.nextStopId = json.next_stop_id\r\n    this.nextStopArrival = moment(json.next_stop_arrival)\r\n    this.nextStopName = json.next_stop_name\r\n    this.updated = moment(json.updated)\r\n    this.updateType = json.update_type\r\n    this.geoX = json.geox\r\n    this.geoY = json.geoy\r\n    this.routeSection = json.route_section\r\n    return this\r\n  }\r\n\r\n  getStatus () {\r\n    const now = moment()\r\n    const statuses = {\r\n      offRoad: 'Not out today',\r\n      preRoute: 'Arriving at ',\r\n      atStop: 'At ',\r\n      betweenStops: 'Arriving at ',\r\n      postRoute: 'Finished for the day'\r\n    }\r\n    // The mobile is not due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'offRoad',\r\n        textFormat: statuses.offRoad,\r\n        message: statuses.offRoad\r\n      }\r\n    }\r\n    // The mobile is due out today\r\n    if (!this.currentStopId && !this.previousStopId && this.nextStopId && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'preRoute',\r\n        message: statuses.preRoute,\r\n        textFormat: statuses.preRoute + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is at a stop, and will be for a certain amount of time\r\n    if (this.currentStopId) {\r\n      const stopRemaining = this.currentStopDeparture.fromNow(true)\r\n      return {\r\n        type: 'atStop',\r\n        message: statuses.atStop,\r\n        textFormat: statuses.atStop + this.currentStopName + ' for ' + stopRemaining,\r\n        args: [\r\n          { stopName: this.currentStopName, stopId: this.currentStopId },\r\n          stopRemaining\r\n        ]\r\n      }\r\n    }\r\n    // The mobile is between stops\r\n    if (!this.currentStopId && this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && this.nextStopArrival.isSame(now, 'day')) {\r\n      const arrival = this.nextStopArrival.fromNow()\r\n      return {\r\n        type: 'betweenStops',\r\n        message: statuses.betweenStops,\r\n        textFormat: statuses.betweenStops + this.nextStopName + ' ' + arrival,\r\n        args: [\r\n          { stopName: this.nextStopName, stopId: this.nextStopId },\r\n          arrival\r\n        ]\r\n      }\r\n    }\r\n    // The mobile has finished for the day\r\n    if (this.previousStopId && this.nextStopId && this.previousStopDeparture.isSame(now, 'day') && !this.nextStopArrival.isSame(now, 'day')) {\r\n      return {\r\n        type: 'postRoute',\r\n        message: statuses.postRoute,\r\n        text_format: statuses.postRoute\r\n      }\r\n    }\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getAllMobiles () {\r\n  const response = await axios.get(config.api + '/mobiles')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const mobiles = response.data.map(m => (new Mobile()).fromJson(m))\r\n    return mobiles\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobileLocations () {\r\n  const response = await axios.get(config.api + '/mobiles/locations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    const locations = response.data.map(ml => (new MobileLocation()).fromJson(ml))\r\n    return locations\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getMobilesNearest (location, distance) {\r\n  const response = await axios.get(config.api + '/mobiles/nearest?longitude=' + location[0] + '&latitude=' + location[1] + '&distance=' + distance)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(m => (new MobileNearestStop()).fromJson(m))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useState, useEffect, useRef } from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport InputBase from '@material-ui/core/InputBase'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport ClearIcon from '@material-ui/icons/ClearTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport SettingsIcon from '@material-ui/icons/SettingsTwoTone'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as geoHelper from './helpers/geo'\r\nimport * as mobilesModel from './models/mobiles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  iconButton: {\r\n    padding: 10\r\n  },\r\n  inputInput: {\r\n    paddingTop: theme.spacing(),\r\n    paddingRight: theme.spacing(),\r\n    paddingBottom: theme.spacing(),\r\n    paddingLeft: theme.spacing(2),\r\n    fontWeight: 500\r\n  },\r\n  search: {\r\n    position: 'relative',\r\n    border: '1px solid #E0E0E0',\r\n    borderRadius: theme.shape.borderRadius,\r\n    backgroundColor: fade(theme.palette.common.white, 0.8),\r\n    '&:hover': {\r\n      backgroundColor: fade(theme.palette.common.white, 0.9)\r\n    },\r\n    marginLeft: 0,\r\n    marginRight: theme.spacing(),\r\n    display: 'flex',\r\n    maxWidth: 240\r\n  }\r\n}))\r\n\r\nfunction usePrevious (value) {\r\n  const ref = useRef()\r\n  useEffect(() => {\r\n    ref.current = value\r\n  })\r\n  return ref.current\r\n}\r\n\r\nfunction PostcodeSearch () {\r\n  const [{ }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [tempPostcode, setTempPostcode] = useState(searchPostcode)\r\n  const [anchor, setAnchor] = useState(null)\r\n\r\n  const prevProps = usePrevious({ searchPostcode })\r\n  useEffect(() => {\r\n    if (prevProps && searchPostcode !== prevProps.searchPostcode) setTempPostcode(searchPostcode)\r\n  }, [searchPostcode]) // eslint-disable-line\r\n\r\n  const openSettingsMenu = (e) => setAnchor(e.currentTarget)\r\n\r\n  const closeSettingsMenu = () => setAnchor(null)\r\n\r\n  const setSearchDistance = (searchDistance) => {\r\n    closeSettingsMenu()\r\n    dispatchSearch({ type: 'SetSearchDistance', searchDistance: searchDistance })\r\n    if (searchType === 'postcode') postcodeSearch()\r\n  }\r\n\r\n  const postcodeSearch = async () => {\r\n    if (tempPostcode === '') {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'You must enter a postcode' })\r\n      return\r\n    }\r\n\r\n    dispatchView({ type: 'LoadingPostcode' })\r\n    const postcodeData = await geoHelper.getPostcode(tempPostcode)\r\n    if (postcodeData.location && postcodeData.location.length === 2) {\r\n      dispatchSearch({ type: 'SetPostcodeSearch', searchPostcode: tempPostcode, searchPosition: postcodeData.location })\r\n      dispatchView({ type: 'SetPostcodeSearch', mapPosition: postcodeData.location })\r\n      const mobilesNearest = await mobilesModel.getMobilesNearest(postcodeData.location, searchDistance)\r\n      const mobilesNearestLookup = {}\r\n      mobilesNearest.forEach(mobile => { mobilesNearestLookup[mobile.mobileId] = mobile })\r\n      dispatchApplication({ type: 'UpdateMobilesNearest', mobilesNearest: mobilesNearest, mobilesNearestLookup: mobilesNearestLookup })\r\n    } else {\r\n      dispatchView({ type: 'ShowNotification', notificationMessage: 'Could not find postcode' })\r\n    }\r\n  }\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.search}>\r\n      <InputBase\r\n        placeholder='Postcode'\r\n        classes={{\r\n          input: classes.inputInput\r\n        }}\r\n        value={tempPostcode}\r\n        onChange={(e) => setTempPostcode(e.target.value)}\r\n      />\r\n      <div className={classes.grow} />\r\n      {searchType === 'postcode'\r\n        ? (\r\n          <Tooltip title='Clear search'>\r\n            <IconButton\r\n              className={classes.iconButton}\r\n              onClick={() => dispatchSearch({ type: 'ClearAll' })}\r\n            >\r\n              <ClearIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        )\r\n        : null}\r\n      <Tooltip title='Search by postcode'>\r\n        <IconButton\r\n          color='primary'\r\n          className={classes.iconButton}\r\n          onClick={() => postcodeSearch()}\r\n        >\r\n          <SearchIcon />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Tooltip title='Change search settings'>\r\n        <IconButton\r\n          className={classes.iconButton}\r\n          color='secondary'\r\n          onClick={(e) => { openSettingsMenu(e) }}\r\n        >\r\n          <SettingsIcon />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        id='mnu-settings'\r\n        anchorEl={anchor}\r\n        keepMounted\r\n        open={Boolean(anchor)}\r\n        onClose={() => closeSettingsMenu()}\r\n      >\r\n        <ListSubheader disableSticky>Search distance</ListSubheader>\r\n        <MenuItem onClick={() => setSearchDistance(1609)}>1 mile</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(4827)}>3 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(8045)}>5 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(16090)}>10 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(32180)}>20 miles</MenuItem>\r\n        <MenuItem onClick={() => setSearchDistance(80450)}>50 miles</MenuItem>\r\n      </Menu>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PostcodeSearch\r\n","import React, { useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Menu from '@material-ui/core/Menu'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BusinessIcon from '@material-ui/icons/BusinessTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport DirectionsIcon from '@material-ui/icons/DirectionsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  chip: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const [{ organisations, organisationLookup, mobiles, mobileLookup, routeLookup, routes }] = useApplicationStateValue()\r\n  const [{ organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue()\r\n\r\n  const [organisationMenuAnchor, setOrganisationMenuAnchor] = useState(null)\r\n  const [mobileMenuAnchor, setMobileMenuAnchor] = useState(null)\r\n  const [routeMenuAnchor, setRouteMenuAnchor] = useState(null)\r\n\r\n  const openOrganisationMenu = (element) => setOrganisationMenuAnchor(element)\r\n\r\n  const closeOrganisationMenu = () => setOrganisationMenuAnchor(null)\r\n\r\n  const chooseOrganisation = (organisationId) => {\r\n    dispatchSearch({ type: 'FilterByOrganisation', organisationId: organisationId })\r\n    closeOrganisationMenu()\r\n  }\r\n\r\n  const clearOrganisationFilter = () => {\r\n    dispatchSearch({ type: 'ClearAll' })\r\n  }\r\n\r\n  const openMobileMenu = (element) => setMobileMenuAnchor(element)\r\n\r\n  const closeMobileMenu = () => setMobileMenuAnchor(null)\r\n\r\n  const chooseMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n    closeMobileMenu()\r\n  }\r\n\r\n  const clearMobileFilter = () => {\r\n    dispatchSearch({ type: 'ClearMobileFilter' })\r\n  }\r\n\r\n  const openRouteMenu = (element) => setRouteMenuAnchor(element)\r\n\r\n  const closeRouteMenu = () => setRouteMenuAnchor(null)\r\n\r\n  const chooseRoute = (routeId) => {\r\n    dispatchSearch({ type: 'FilterByRoute', routeId: routeId })\r\n    closeRouteMenu()\r\n  }\r\n\r\n  const clearRouteFilter = () => {\r\n    dispatchSearch({ type: 'ClearRouteFilter' })\r\n  }\r\n\r\n  const countries = new Set(organisations.map(org => org.country))\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <div className={classes.search}>\r\n        {organisationFilter.length === 0 ? (\r\n          <Tooltip title='Choose library service'>\r\n            <Button color='primary' className={classes.button} onClick={(e) => openOrganisationMenu(e.currentTarget)}>\r\n              <BusinessIcon className={classes.leftIcon} />Select service\r\n            </Button>\r\n          </Tooltip>\r\n        ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearOrganisationFilter} label={organisationLookup[organisationFilter[0]].name} />}\r\n        {organisationFilter.length > 0\r\n          ? (mobileFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose mobile library'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openMobileMenu(e.currentTarget)}>\r\n                  <DirectionBusIcon className={classes.leftIcon} />Select mobile\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearMobileFilter} label={mobileLookup[mobileFilter[0]].name} />\r\n          ) : null}\r\n        {mobileFilter.length > 0\r\n          ? (routeFilter.length === 0\r\n            ? (\r\n              <Tooltip title='Choose route'>\r\n                <Button color='primary' className={classes.button} onClick={(e) => openRouteMenu(e.currentTarget)}>\r\n                  <DirectionsIcon className={classes.leftIcon} />Select route\r\n                </Button>\r\n              </Tooltip>\r\n            ) : <Chip className={classes.chip} color='primary' variant='outlined' onDelete={clearRouteFilter} label={routeLookup[routeFilter[0]].name} />\r\n          )\r\n          : null}\r\n      </div>\r\n      <Menu\r\n        id='menu-library-service'\r\n        anchorEl={organisationMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(organisationMenuAnchor)}\r\n        onClose={() => closeOrganisationMenu()}\r\n      >\r\n        {\r\n          Array.from(countries)\r\n            .sort((a, b) => a.localeCompare(b))\r\n            .map((country, idx) => {\r\n              const menuItems = [<ListSubheader key={'lst_' + idx} disableSticky>{country}</ListSubheader>]\r\n              const orgList = organisations\r\n                .sort((a, b) => a.name.localeCompare(b.name))\r\n                .filter(org => org.country === country)\r\n                .map(org => {\r\n                  return <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n                })\r\n              return menuItems.concat(orgList)\r\n            })\r\n        }\r\n      </Menu>\r\n      <Menu\r\n        id='menu-mobile-library'\r\n        anchorEl={mobileMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(mobileMenuAnchor)}\r\n        onClose={() => closeMobileMenu()}\r\n      >\r\n        {mobiles\r\n          .filter(mob => {\r\n            let display = true\r\n            if (organisationFilter.length > 0 &&\r\n              organisationFilter.indexOf(mob.organisationId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(mob => {\r\n            return <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => chooseMobile(mob.organisationId, mob.id)}>{mob.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n      <Menu\r\n        id='menu-route'\r\n        anchorEl={routeMenuAnchor}\r\n        keepMounted\r\n        open={Boolean(routeMenuAnchor)}\r\n        onClose={() => closeRouteMenu()}\r\n      >\r\n        {routes\r\n          .filter(route => {\r\n            let display = true\r\n            if (mobileFilter.length > 0 &&\r\n              mobileFilter.indexOf(route.mobileId) === -1) {\r\n              display = false\r\n            }\r\n            return display\r\n          })\r\n          .sort((a, b) => a.name.localeCompare(b.name))\r\n          .map(route => {\r\n            return <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => chooseRoute(route.id)}>{route.name}</MenuItem>\r\n          })}\r\n      </Menu>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React, { useState } from 'react'\r\n\r\nimport { Link, useLocation } from 'react-router-dom'\r\n\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Button from '@material-ui/core/Button'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport Container from '@material-ui/core/Container'\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport BookIcon from '@material-ui/icons/BookTwoTone'\r\nimport CancelIcon from '@material-ui/icons/CancelTwoTone'\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\nimport GridOnIcon from '@material-ui/icons/GridOnTwoTone'\r\nimport HeadsetIcon from '@material-ui/icons/HeadsetTwoTone'\r\nimport ImportContactsIcon from '@material-ui/icons/ImportContactsTwoTone'\r\nimport MapIcon from '@material-ui/icons/MapTwoTone'\r\nimport MovieIcon from '@material-ui/icons/MovieTwoTone'\r\nimport SearchIcon from '@material-ui/icons/SearchTwoTone'\r\nimport PetsIcon from '@material-ui/icons/PetsTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'white',\r\n    position: 'relative'\r\n  },\r\n  appBarTransparent: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    position: 'relative'\r\n  },\r\n  grow: {\r\n    flexGrow: 1\r\n  },\r\n  siteTitle: {\r\n    margin: theme.spacing(1),\r\n    padding: theme.spacing(1),\r\n    display: 'inline-block',\r\n    verticalAlign: 'middle',\r\n    color: theme.palette.primary.main,\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    border: '1px solid #e5e5e5',\r\n    borderRadius: 26\r\n  },\r\n  siteTitleIcon: {\r\n    verticalAlign: 'sub'\r\n  },\r\n  title: {\r\n    margin: theme.spacing(2),\r\n    display: 'inline-block',\r\n    verticalAlign: 'middle'\r\n  },\r\n  topIcon: {\r\n    backgroundColor: 'rgba(250, 250, 250, 0.8)',\r\n    border: '1px solid #e5e5e5',\r\n    '&:hover': {\r\n      backgroundColor: 'rgba(250, 250, 250, 0.8)'\r\n    }\r\n  },\r\n  topTitle: {\r\n    position: 'relative',\r\n    zIndex: theme.zIndex.drawer + 1\r\n  }\r\n}))\r\n\r\nfunction AppHeader (props) {\r\n  const { site } = props\r\n  const [{ currentServiceSystemName }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n\r\n  const [appsOpen, setAppsOpen] = useState(false)\r\n  const [tabValue, setTabValue] = useState(site)\r\n\r\n  const location = useLocation()\r\n  const classes = useStyles()\r\n\r\n  const currentServicePath = (path) => {\r\n    if (currentServiceSystemName) return path + '?service=' + currentServiceSystemName\r\n    return path\r\n  }\r\n\r\n  const sites = [\r\n    {\r\n      title: 'Library lab',\r\n      url: 'https://www.librarylab.uk',\r\n      icon: <PetsIcon />,\r\n      links: [\r\n        {\r\n          title: 'About library lab',\r\n          short: 'Lab',\r\n          icon: <PetsIcon />,\r\n          to: '/'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Libraries at home',\r\n      url: 'https://www.librariesathome.co.uk',\r\n      icon: <ImportContactsIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find service',\r\n          short: 'Find',\r\n          icon: <SearchIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Watch library TV',\r\n          short: 'Watch',\r\n          icon: <MovieIcon />,\r\n          to: '/watch'\r\n        },\r\n        {\r\n          title: 'Read blogs',\r\n          short: 'Read',\r\n          icon: <BookIcon />,\r\n          to: '/read'\r\n        },\r\n        {\r\n          title: 'Listen podcasts',\r\n          short: 'Listen',\r\n          icon: <HeadsetIcon />,\r\n          to: '/listen'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Mobile libraries',\r\n      url: 'https://www.mobilelibraries.org',\r\n      icon: <DirectionBusIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my stop',\r\n          short: 'Stops',\r\n          icon: <GridOnIcon />,\r\n          to: '/'\r\n        },\r\n        {\r\n          title: 'Mobile vans',\r\n          short: 'Vans',\r\n          icon: <DirectionBusIcon />,\r\n          to: '/mobiles'\r\n        },\r\n        {\r\n          title: 'Map of stops',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: '/map'\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: 'Library map',\r\n      url: 'https://www.librarymap.co.uk',\r\n      icon: <MapIcon />,\r\n      links: [\r\n        {\r\n          title: 'Find my library',\r\n          short: 'Find',\r\n          icon: <GridOnIcon />,\r\n          to: currentServicePath('/')\r\n        },\r\n        {\r\n          title: 'Map of libraries',\r\n          short: 'Map',\r\n          icon: <MapIcon />,\r\n          to: currentServicePath('/map')\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n\r\n  const appBarClass = (location.pathname === '/map' ? classes.appBarTransparent : classes.appBar)\r\n\r\n  return (\r\n    <>\r\n      <Container maxWidth='lg' className={classes.topTitle}>\r\n        <Toolbar>\r\n          <IconButton className={classes.topIcon} color='primary' onClick={() => { setAppsOpen(!appsOpen); setTabValue(site) }}>\r\n            {appsOpen ? <CancelIcon /> : <PetsIcon />}\r\n          </IconButton>\r\n          <span className={classes.grow} />\r\n          {location.pathname === '/map' ? <ServiceFilter /> : null}\r\n          <Chip\r\n            label={sites[site].title}\r\n            color='secondary'\r\n          />\r\n        </Toolbar>\r\n      </Container>\r\n      {appsOpen ? (\r\n        <AppBar position='static' color='default' elevation={0} className={appBarClass}>\r\n          <Container maxWidth='lg'>\r\n            <Tabs\r\n              centered\r\n              value={tabValue}\r\n              onChange={(e, v) => { setTabValue(v) }}\r\n              variant='scrollable'\r\n              scrollButtons='on'\r\n              indicatorColor='primary'\r\n              textColor='secondary'\r\n            >\r\n              {sites.map((s, idx) => {\r\n                return (\r\n                  <Tab key={'tb_site_' + idx} label={s.title} icon={s.icon} />\r\n                )\r\n              })}\r\n            </Tabs>\r\n          </Container>\r\n        </AppBar>\r\n      ) : null}\r\n      <AppBar\r\n        position='static'\r\n        color='inherit'\r\n        elevation={0}\r\n        className={appBarClass}\r\n      >\r\n        <Container maxWidth='lg'>\r\n          <Toolbar>\r\n            <Hidden mdUp>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.short}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <Hidden smDown>\r\n              {sites[tabValue].links.map((link, idx) => {\r\n                return (\r\n                  <Tooltip title={link.title} key={'icnb_menu_lg_' + idx}>\r\n                    <Button\r\n                      component={Link}\r\n                      to={(tabValue === site ? link.to : sites[tabValue].url + link.to)}\r\n                      disableRipple={location.pathname === link.to}\r\n                      disableFocusRipple={location.pathname === link.to}\r\n                      color='secondary'\r\n                      size='large'\r\n                      startIcon={link.icon}\r\n                    >\r\n                      {link.title}\r\n                    </Button>\r\n                  </Tooltip>\r\n                )\r\n              })}\r\n            </Hidden>\r\n            <span className={classes.grow} />\r\n            {location.pathname === '/map' ? <PostcodeSearch /> : null}\r\n          </Toolbar>\r\n        </Container>\r\n      </AppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default AppHeader\r\n","import React from 'react'\r\nimport RouteLink from 'react-router-dom/Link'\r\n\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Link from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport FavoriteIcon from '@material-ui/icons/FavoriteTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    paddingTop: theme.spacing(5),\r\n    marginTop: theme.spacing(3),\r\n    marginBottom: theme.spacing(5),\r\n    width: '100%'\r\n  },\r\n  grid: {\r\n    marginTop: theme.spacing(2)\r\n  },\r\n  loveIcon: {\r\n    marginLeft: theme.spacing(1),\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  footerText: {\r\n    verticalAlign: 'middle',\r\n    display: 'inline-flex'\r\n  },\r\n  footerRight: {\r\n    textAlign: 'right'\r\n  },\r\n  tapTarget: {\r\n    lineHeight: 2.2,\r\n    fontSize: 16\r\n  }\r\n}))\r\n\r\nfunction Footer () {\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Divider />\r\n      <Grid container spacing={3} className={classes.grid}>\r\n        <Grid item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='body1' className={classes.footerText}>A library lab project built by Libraries Hacked.</Typography><br />\r\n          <Typography variant='button'>\r\n            <Link component={RouteLink} to='/accessibility' title='How we make this site accessible' className={classes.tapTarget}>Accessibility</Link><br />\r\n            <Link component={RouteLink} to='/privacy' title='Your privacy on this site' className={classes.tapTarget}>Privacy</Link><br />\r\n            <Link component={RouteLink} to='/data' title='Data used on this site and licensing' className={classes.tapTarget}>Data</Link>\r\n          </Typography>\r\n        </Grid>\r\n        <Grid className={classes.footerRight} item xs={12} sm={6} md={6} lg={6} xl={6}>\r\n          <Typography variant='button'>\r\n            <Link href='https://github.com/LibrariesHacked/mobilelibraries-website' target='_blank' title='Project on GitHub' className={classes.tapTarget}>Open Source on GitHub</Link><br />\r\n            <Link href='https://www.librarylab.uk/docs/mobile-libraries' target='_blank' title='About the library lab projects and documentation for this project' className={classes.tapTarget}>About this project</Link><br />\r\n            <FavoriteIcon color='error' className={classes.loveIcon} />\r\n          </Typography>\r\n        </Grid>\r\n      </Grid>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Footer\r\n","import React, { useEffect, useState } from 'react'\r\nimport ReactMarkdown from 'markdown-to-jsx'\r\n\r\nimport { withStyles, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport Link from '@material-ui/core/Link'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  listItem: {\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  root: {\r\n    '& table': {\r\n      display: 'block',\r\n      wordBreak: 'normal',\r\n      width: '100%',\r\n      overflowX: 'auto',\r\n      WebkitOverflowScrolling: 'touch',\r\n      borderCollapse: 'collapse',\r\n      marginBottom: '16px',\r\n      borderSpacing: 0,\r\n      overflow: 'hidden',\r\n      '& .prop-name': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace'\r\n      },\r\n      '& .required': {\r\n        color: theme.palette.type === 'light' ? '#006500' : '#a5ffa5'\r\n      },\r\n      '& .prop-type': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        color: theme.palette.type === 'light' ? '#932981' : '#ffb6ec'\r\n      },\r\n      '& .prop-default': {\r\n        fontSize: 13,\r\n        fontFamily: 'Consolas, \"Liberation Mono\", Menlo, monospace',\r\n        borderBottom: `1px dotted ${theme.palette.divider}`\r\n      }\r\n    },\r\n    '& td': {\r\n      ...theme.typography.body2,\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16,\r\n      color: theme.palette.text.primary\r\n    },\r\n    '& th': {\r\n      fontSize: 14,\r\n      lineHeight: theme.typography.pxToRem(24),\r\n      fontWeight: theme.typography.fontWeightMedium,\r\n      color: theme.palette.text.primary,\r\n      whiteSpace: 'pre',\r\n      borderBottom: `1px solid ${theme.palette.divider}`,\r\n      padding: 16\r\n    }\r\n  }\r\n}))\r\n\r\nconst options = {\r\n  overrides: {\r\n    h1: {\r\n      component: Typography,\r\n      props: {\r\n        gutterBottom: true,\r\n        variant: 'h4',\r\n        color: 'secondary'\r\n      }\r\n    },\r\n    h2: { component: Typography, props: { gutterBottom: true, variant: 'h5', color: 'textPrimary' } },\r\n    h3: { component: Typography, props: { gutterBottom: true, variant: 'h6', color: 'textPrimary' } },\r\n    h4: {\r\n      component: Typography,\r\n      props: { gutterBottom: true, variant: 'h6', paragraph: true, color: 'textPrimary' }\r\n    },\r\n    p: { component: Typography, props: { paragraph: true, color: 'textPrimary' } },\r\n    a: { component: Link },\r\n    li: {\r\n      component: withStyles(useStyles)(({ classes, ...props }) => (\r\n        <li className={classes.listItem}>\r\n          <Typography component='span' {...props} />\r\n        </li>\r\n      ))\r\n    }\r\n  }\r\n}\r\n\r\nexport function MarkdownPage (props) {\r\n  const { page } = props\r\n  const [pageText, setPageText] = useState('')\r\n  const classes = useStyles()\r\n\r\n  useEffect(() => {\r\n    async function fetchPage () {\r\n      const pageData = await window.fetch(page)\r\n      const pageText = await pageData.text()\r\n      setPageText(pageText)\r\n    }\r\n    fetchPage()\r\n  }, [page])\r\n\r\n  return <ReactMarkdown className={classes.root} options={options} {...props}>{pageText}</ReactMarkdown>\r\n}\r\n\r\nexport const MemoMarkdownPage = React.memo(MarkdownPage)\r\n","import React from 'react'\r\n\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport PostcodeSearch from './PostcodeSearch'\r\nimport ServiceFilter from './ServiceFilter'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  search: {\r\n    alignContent: 'center',\r\n    textAlign: 'center',\r\n    display: 'table',\r\n    marginLeft: 'auto',\r\n    marginRight: 'auto',\r\n    marginBottom: '10px'\r\n  },\r\n  subtitle: {\r\n    textAlign: 'center',\r\n    marginBottom: '5px'\r\n  },\r\n  title: {\r\n    textAlign: 'center'\r\n  }\r\n}))\r\n\r\nfunction Filters () {\r\n  const [{ searchDistance }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <>\r\n      <Typography component='h2' variant='h6' className={classes.title}>Your mobile service</Typography>\r\n      <Typography component='p' variant='body1' className={classes.subtitle}>Search by postcode (within {searchDistance / 1609} mile/s) or select service</Typography>\r\n      <div className={classes.search}>\r\n        <PostcodeSearch />\r\n      </div>\r\n      <ServiceFilter />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Filters\r\n","import React from 'react'\r\n\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Card from '@material-ui/core/Card'\r\nimport CardActions from '@material-ui/core/CardActions'\r\nimport CardContent from '@material-ui/core/CardContent'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\nimport WebIcon from '@material-ui/icons/WebTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  bullet: {\r\n    display: 'inline-block',\r\n    margin: '0 2px',\r\n    transform: 'scale(1.2)'\r\n  },\r\n  card: {\r\n    minWidth: 275\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  title: {\r\n    fontSize: 12,\r\n    fontWeight: 500,\r\n    align: 'right'\r\n  },\r\n  verticalDivider: {\r\n    width: 1,\r\n    height: 28,\r\n    margin: 8\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction MobileCard (props) {\r\n  const { mobile, organisation, location } = props\r\n  const [{ }, dispatchSearch] = useSearchStateValue() // eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() // eslint-disable-line\r\n\r\n  const viewStopsByMobile = (organisationId, mobileId) => {\r\n    dispatchSearch({ type: 'FilterByMobile', organisationId: organisationId, mobileId: mobileId })\r\n  }\r\n\r\n  const viewStop = (stopId) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stopId })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const stopButton = (stop) => {\r\n    return <Button color='secondary' onClick={() => viewStop(stop.stopId)}>{stop.stopName}</Button>\r\n  }\r\n\r\n  const offRoadMessage = (status) => {\r\n    return (\r\n      <Typography>{status.message}</Typography>\r\n    )\r\n  }\r\n\r\n  const preRouteMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const atStopMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {' for ' + status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const betweenStopsMessage = (status) => {\r\n    const button = stopButton(status.args[0])\r\n    return (\r\n      <>\r\n        <Typography>\r\n          {status.message}\r\n          {button}\r\n          {status.args[1]}\r\n        </Typography>\r\n      </>\r\n    )\r\n  }\r\n\r\n  const postRouteMessage = (status) => <Typography>{status.message}</Typography>\r\n\r\n  const classes = useStyles()\r\n\r\n  let statusMessage = null\r\n  if (location) {\r\n    const status = location.getStatus()\r\n    if (status && status.type === 'offRoad') statusMessage = offRoadMessage(status)\r\n    if (status && status.type === 'preRoute') statusMessage = preRouteMessage(status)\r\n    if (status && status.type === 'atStop') statusMessage = atStopMessage(status)\r\n    if (status && status.type === 'betweenStops') statusMessage = betweenStopsMessage(status)\r\n    if (status && status.type === 'postRoute') statusMessage = postRouteMessage(status)\r\n  }\r\n\r\n  if (!statusMessage) statusMessage = <CircularProgress className={classes.progress} color='primary' size={30} />\r\n  const bull = <span className={classes.bullet}>•</span>\r\n\r\n  return (\r\n    <Card className={classes.card} elevation={0}>\r\n      <CardContent>\r\n        <Typography className={classes.title} gutterBottom>\r\n          {mobile.numberRoutes + ' route' + (mobile.numberRoutes > 1 ? 's' : '')}\r\n          {bull}\r\n          {mobile.numberStops + ' stop' + (mobile.numberStops > 1 ? 's' : '')}\r\n        </Typography>\r\n        <Typography variant='h6' component='h2'>{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n        {statusMessage}\r\n      </CardContent>\r\n      <CardActions>\r\n        <Tooltip title='Mobile library stops'>\r\n          <Button component={Link} to='/stops' size='small' color='primary' className={classes.button} onClick={() => viewStopsByMobile(organisation.id, mobile.id)}>\r\n            <LocationOnIcon className={classes.leftIcon} />View stops\r\n          </Button>\r\n        </Tooltip>\r\n        <Divider className={classes.verticalDivider} />\r\n        {mobile.timetable ? (\r\n          <Tooltip title='Website timetable'>\r\n            <IconButton className={classes.button} onClick={() => this.goToWebsite()}>\r\n              <WebIcon />\r\n            </IconButton>\r\n          </Tooltip>\r\n        ) : null}\r\n      </CardActions>\r\n    </Card>\r\n  )\r\n}\r\n\r\nexport default MobileCard\r\n","import React, { useState } from 'react'\r\n\r\nimport Badge from '@material-ui/core/Badge'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport Filters from './Filters'\r\nimport MobileCard from './MobileCard'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  padding: {\r\n    padding: theme.spacing(0, 2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction Mobiles () {\r\n  const [{ organisationLookup, mobiles, mobileLookup, mobileLocationLookup, mobilesNearestLookup, routes, routeLookup }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ organisationFilter, mobileFilter, routeFilter, searchType, searchDistance, searchPostcode }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ loadingMobileLocations }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [openTab, setOpenTab] = useState(0)\r\n\r\n  const changeTab = (value) => {\r\n    setOpenTab(value)\r\n  }\r\n\r\n  // Get all mobiles that are currently filtered\r\n  const filteredMobiles = mobiles.filter(mob => {\r\n    let display = true\r\n    if (searchType === 'gps' || searchType === 'postcode') {\r\n      display = mobilesNearestLookup[mob.id]\r\n    }\r\n    if (organisationFilter.length > 0 &&\r\n      organisationFilter.indexOf(mob.organisationId) === -1) {\r\n      display = false\r\n    }\r\n    if (mobileFilter.length > 0 &&\r\n      mobileFilter.indexOf(mob.id) === -1) {\r\n      display = false\r\n    }\r\n    return display\r\n  })\r\n\r\n  // Then get those that are currently active\r\n  const activeMobiles = filteredMobiles.filter(mob => {\r\n    if (mobileLocationLookup[mob.id]) {\r\n      const status = mobileLocationLookup[mob.id].getStatus()\r\n      return (status && status.type !== 'offRoad' && status.type !== 'postRoute')\r\n    }\r\n    return null\r\n  })\r\n\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n\r\n  let title = 'Mobile library vans'\r\n  if (organisationName !== '') title = 'Mobile library vans serving ' + organisationName\r\n  if (mobileName !== '') title = organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = organisationName + ' ' + routeName\r\n  if (searchPostcode !== '') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  if (searchType === 'gps') title = 'Mobile library vans with stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const classes = useStyles()\r\n\r\n  const displayMobiles = (openTab === 0 ? activeMobiles : filteredMobiles)\r\n  const mobilesView = displayMobiles\r\n    .filter(mob => {\r\n      let display = true\r\n      if (organisationFilter.length > 0 &&\r\n        organisationFilter.indexOf(mob.organisationId) === -1) {\r\n        display = false\r\n      }\r\n      if (mobileFilter.length > 0 &&\r\n        mobileFilter.indexOf(mob.id) === -1) {\r\n        display = false\r\n      }\r\n      return display\r\n    })\r\n    .filter(mob => {\r\n      if (searchType === 'gps' || searchType === 'postcode') {\r\n        return mobilesNearestLookup[mob.id]\r\n      }\r\n      return true\r\n    })\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <Filters />\r\n      <ListSubheader component='span' disableSticky>{title}</ListSubheader>\r\n      <Tabs\r\n        variant='standard'\r\n        scrollButtons='off'\r\n        value={openTab}\r\n        indicatorColor='secondary'\r\n        onChange={(e, value) => changeTab(value)}\r\n      >\r\n        <Tab\r\n          className={classes.tab}\r\n          label={\r\n            <Badge\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={activeMobiles.length}\r\n            >\r\n              On the road\r\n            </Badge>\r\n          }\r\n        />\r\n        <Tab\r\n          label={\r\n            <Badge\r\n              showZero\r\n              className={classes.padding}\r\n              color='secondary'\r\n              badgeContent={filteredMobiles.length}\r\n            >\r\n              All vans\r\n            </Badge>\r\n          }\r\n        />\r\n      </Tabs>\r\n      <br />\r\n      {\r\n        mobilesView.length > 0\r\n          ? (\r\n            <Grid container spacing={3}>\r\n              {\r\n                mobilesView.map((mobile, idx) => {\r\n                  return (\r\n                    <Grid\r\n                      key={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n                      item xs={12} sm={6} md={4} lg={3} xl={3}\r\n                    >\r\n                      <MobileCard\r\n                        mobile={mobile}\r\n                        location={mobileLocationLookup[mobile.id]}\r\n                        organisation={organisationLookup[mobile.organisationId]}\r\n                      />\r\n                    </Grid>\r\n                  )\r\n                })\r\n              }\r\n            </Grid>) : (\r\n            !loadingMobileLocations\r\n              ? <Typography component='p' variant='body1'>No mobile libraries currently on the road.</Typography>\r\n              : null\r\n          )\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Mobiles\r\n","import React from 'react'\r\n\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\n\r\nimport Face from '@material-ui/icons/FaceTwoTone'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  avatar: {\r\n    margin: 0\r\n  },\r\n  avatarOn: {\r\n    margin: 0,\r\n    cursor: 'pointer',\r\n    backgroundColor: theme.palette.primary.main\r\n  }\r\n}))\r\n\r\nfunction MeAvatar () {\r\n  const [{ searchType }] = useSearchStateValue()\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip title='Me'>\r\n      <Avatar\r\n        className={searchType === 'gps' ? classes.avatarOn : classes.avatar}\r\n      >\r\n        <Face />\r\n      </Avatar>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MeAvatar\r\n","import React from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\r\nimport Switch from '@material-ui/core/Switch'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport { useTheme, makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction MapSettings () {\r\n  const [{ mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue()\r\n\r\n  const closeDialog = () => {\r\n    dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: false })\r\n  }\r\n\r\n  const handleAuthorityBoundaryChange = () => {\r\n    dispatchView({ type: 'ToggleMapSetting', mapSetting: 'authorityBoundary' })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={mapSettingsDialogOpen}\r\n      onClose={closeDialog}\r\n      BackdropProps={{\r\n        invisible: true\r\n      }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Map settings</DialogTitle>\r\n      <DialogContent>\r\n        <FormControlLabel\r\n          control={\r\n            <Switch\r\n              checked={mapSettings.authorityBoundary}\r\n              onChange={handleAuthorityBoundaryChange}\r\n              name='sw_authority_boundary'\r\n              color='primary'\r\n            />\r\n          }\r\n          label='Library service boundaries'\r\n        />\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={closeDialog} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default MapSettings\r\n","export function hextoRGBA (hex, alpha) {\r\n  var c\r\n  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\r\n    c = hex.substring(1).split('')\r\n    if (c.length === 3) {\r\n      c = [c[0], c[0], c[1], c[1], c[2], c[2]]\r\n    }\r\n    c = '0x' + c.join('')\r\n    return 'rgba(' + [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',') + ', ' + alpha + ')'\r\n  }\r\n  throw new Error('Bad Hex')\r\n}\r\n","import React from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBusTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as utilsHelper from './helpers/utils'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  fab: {\r\n    margin: theme.spacing(1),\r\n    boxShadow: 'none'\r\n  }\r\n}))\r\n\r\nfunction MobileAvatar (props) {\r\n  const [{ mapZoom }] = useViewStateValue()\r\n  const { location, organisation } = props\r\n\r\n  const status = location.getStatus()\r\n  const size = (mapZoom[0] < 8 ? 'small' : (mapZoom[0] < 12 ? 'medium' : 'large'))\r\n  const border = (mapZoom[0] < 8 ? 2 : (mapZoom[0] < 12 ? 3 : 4))\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <Tooltip\r\n      title={(status ? status.textFormat : '')}\r\n    >\r\n      <Fab\r\n        size={size}\r\n        className={classes.fab}\r\n        color='primary'\r\n        style={{\r\n          backgroundColor: utilsHelper.hextoRGBA(organisation.colour, 0.8),\r\n          color: 'white',\r\n          border: (border + 'px solid #FFFFFF')\r\n        }}\r\n      >\r\n        <DirectionBusIcon />\r\n      </Fab>\r\n    </Tooltip>\r\n  )\r\n}\r\n\r\nexport default MobileAvatar\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Fab from '@material-ui/core/Fab'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from 'react-mapbox-gl'\r\n\r\nimport LayersIcon from '@material-ui/icons/LayersTwoTone'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport moment from 'moment'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport MeAvatar from './MeAvatar'\r\nimport MapSettings from './MapSettings'\r\nimport MobileAvatar from './MobileAvatar'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  settings: {\r\n    position: 'absolute',\r\n    bottom: theme.spacing(4),\r\n    right: theme.spacing(4)\r\n  }\r\n}))\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst Map = ReactMapboxGl({\r\n  minZoom: 5,\r\n  maxZoom: 18,\r\n  customAttribution: 'Contains public sector information licensed under the Open Government Licence'\r\n})\r\n\r\nconst stopTiles = [config.stopTiles]\r\nconst tripTiles = [config.tripTiles]\r\nconst libraryAuthorityTiles = [config.libraryAuthorityTiles]\r\n\r\nfunction MobileMap () {\r\n  const [{ organisations, organisationLookup, mobileLookup, mobileLocations }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPosition }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ mapZoom, mapPosition, mapSettings, mapSettingsDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [currentTime, setCurrentTime] = useState(null)\r\n  const [map, setMap] = useState(null)\r\n\r\n  useEffect(() => {\r\n    setInterval(setTime, 500)\r\n  }, [])\r\n\r\n  const clickStop = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentStop', stopId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const clickTrip = (map) => {\r\n    if (map && map.features && map.features.length > 0 && map.features[0].properties) {\r\n      dispatchSearch({ type: 'SetCurrentTrip', tripId: map.features[0].properties.id })\r\n      dispatchView({ type: 'SetTripDialog', tripDialogOpen: true })\r\n    }\r\n  }\r\n\r\n  const setTime = () => setCurrentTime(moment())\r\n\r\n  // Build the colour match\r\n  const organisationColourMatch = ['match', ['get', 'utla19cd']]\r\n  organisations.forEach(org => {\r\n    organisationColourMatch.push(org.code)\r\n    organisationColourMatch.push(org.colour)\r\n  })\r\n  organisationColourMatch.push('#a7a39b')\r\n\r\n  const classes = useStyles()\r\n\r\n  const locations = mobileLocations.filter(l => l.geoX !== null && l.geoY !== null)\r\n\r\n  return (\r\n    <>\r\n      <Map\r\n        style='style.json' // eslint-disable-line\r\n        center={mapPosition}\r\n        zoom={mapZoom}\r\n        maxZoom={17}\r\n        pitch={[0]}\r\n        bearing={[0]}\r\n        fitBounds={null}\r\n        containerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n        onStyleLoad={map => setMap(map)}\r\n      >\r\n        {// The mobile library locations\r\n          locations && locations.length > 0\r\n            ? locations.map(l => {\r\n              let locationPoint = [l.geoX, l.geoY]\r\n              if (currentTime && l.routeSection && l.routeSection.coordinates && l.updated) {\r\n                const millisecondsPassed = moment(currentTime).diff(l.updated)\r\n                const index = Math.round(millisecondsPassed / 500)\r\n                const coords = l.routeSection.coordinates\r\n                if (coords.length > index && index > 0) locationPoint = coords[index]\r\n                if (coords.length <= index && index > 0) locationPoint = coords[coords.length - 1]\r\n              }\r\n              const mobile = mobileLookup[l.mobileId]\r\n              const organisation = (mobile ? organisationLookup[mobile.organisationId] : null)\r\n              return (\r\n                <Marker\r\n                  key={'mkr_' + l.id}\r\n                  coordinates={locationPoint}\r\n                  anchor='bottom'\r\n                >\r\n                  <MobileAvatar\r\n                    organisation={organisation}\r\n                    location={l}\r\n                    zoom={map ? map.getZoom() : 0}\r\n                  />\r\n                </Marker>)\r\n            }) : null\r\n        }\r\n        <Source\r\n          id='src_stops'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: stopTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_trips'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: tripTiles\r\n          }}\r\n        />\r\n        <Source\r\n          id='src_library_authorities'\r\n          tileJsonSource={{\r\n            type: 'vector',\r\n            tiles: libraryAuthorityTiles\r\n          }}\r\n        />\r\n        <Layer\r\n          id='lyr_trips_lines'\r\n          type='line'\r\n          sourceId='src_trips'\r\n          sourceLayer='trip'\r\n          minZoom={13}\r\n          layout={{\r\n            'line-join': 'round',\r\n            'line-cap': 'square'\r\n          }}\r\n          paint={{\r\n            'line-color': '#a7a39b',\r\n            'line-offset': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-opacity': 1,\r\n            'line-width': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 0.5,\r\n              14, 1,\r\n              15, 2,\r\n              16, 3,\r\n              18, 10,\r\n              22, 20\r\n            ],\r\n            'line-dasharray': [\r\n              2,\r\n              0.5\r\n            ]\r\n          }}\r\n          onClick={clickTrip}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_circles'\r\n          type='circle'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={5}\r\n          layout={{}}\r\n          paint={{\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 2,\r\n              17, 12\r\n            ],\r\n            'circle-color': ['get', 'organisation_colour'],\r\n            'circle-stroke-width': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              5, 1,\r\n              17, 4\r\n            ],\r\n            'circle-stroke-color': '#FFFFFF',\r\n            'circle-opacity': 0.7\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_labels'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'name']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 12,\r\n              17, 22\r\n            ],\r\n            'text-offset': [0, 2]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        <Layer\r\n          id='lyr_stops_next_visiting'\r\n          type='symbol'\r\n          sourceId='src_stops'\r\n          sourceLayer='stop'\r\n          minZoom={13}\r\n          layout={{\r\n            'text-ignore-placement': false,\r\n            'text-field': ['to-string', ['get', 'next_visiting']],\r\n            'text-font': [\r\n              'Source Sans Pro Bold'\r\n            ],\r\n            'text-line-height': 1,\r\n            'text-size': [\r\n              'interpolate',\r\n              [\r\n                'linear'\r\n              ],\r\n              [\r\n                'zoom'\r\n              ],\r\n              13, 10,\r\n              17, 16\r\n            ],\r\n            'text-offset': [0, -2.8]\r\n          }}\r\n          paint={{\r\n            'text-halo-color': 'hsl(0, 0%, 100%)',\r\n            'text-halo-width': 1,\r\n            'text-halo-blur': 1,\r\n            'text-color': '#6a6f73'\r\n          }}\r\n          onClick={clickStop}\r\n        />\r\n        {mapSettings.authorityBoundary\r\n          ? (\r\n            <>\r\n              <Layer\r\n                id='lyr_library_authorities_lines'\r\n                type='line'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                layout={{\r\n                  'line-join': 'round',\r\n                  'line-cap': 'square'\r\n                }}\r\n                paint={{\r\n                  'line-color': '#a7a39b',\r\n                  'line-opacity': 1,\r\n                  'line-width': [\r\n                    'interpolate',\r\n                    [\r\n                      'linear'\r\n                    ],\r\n                    [\r\n                      'zoom'\r\n                    ],\r\n                    6, 1,\r\n                    22, 4\r\n                  ]\r\n                }}\r\n              />\r\n              <Layer\r\n                id='lyr_library_authorities_fill'\r\n                type='fill'\r\n                sourceId='src_library_authorities'\r\n                sourceLayer='library_authority_boundaries'\r\n                minZoom={6}\r\n                paint={{\r\n                  'fill-color': organisationColourMatch,\r\n                  'fill-opacity': 0.1\r\n                }}\r\n              />\r\n            </>\r\n          ) : null}\r\n        {searchPosition && searchPosition.length > 1\r\n          ? (\r\n            <Marker\r\n              key='mk_me'\r\n              coordinates={[searchPosition[0], searchPosition[1]]}\r\n            >\r\n              <MeAvatar searchType={searchType} />\r\n            </Marker>\r\n          )\r\n          : null}\r\n        <ZoomControl position='bottom-left' />\r\n      </Map>\r\n      <Tooltip\r\n        title='Map settings'\r\n      >\r\n        <Fab\r\n          size='small'\r\n          className={classes.settings}\r\n          color='primary'\r\n          style={{\r\n            color: 'white',\r\n            border: '1px solid #FFFFFF'\r\n          }}\r\n          onClick={() => dispatchView({ type: 'SetMapSettingsDialog', mapSettingsDialogOpen: true })}\r\n        >\r\n          <LayersIcon />\r\n        </Fab>\r\n      </Tooltip>\r\n      <MapSettings\r\n        mapSettings={mapSettings}\r\n        mapSettingsDialogOpen={mapSettingsDialogOpen}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MobileMap\r\n","import React from 'react'\r\n\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport Snackbar from '@material-ui/core/Snackbar'\r\n\r\nimport CloseIcon from '@material-ui/icons/CloseTwoTone'\r\n\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nfunction Notification () {\r\n  const [{ notificationOpen, notificationMessage }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const handleClose = () => {\r\n    dispatchView({ type: 'SetNotification', notificationOpen: false })\r\n  }\r\n\r\n  return (\r\n    <Snackbar\r\n      anchorOrigin={{\r\n        vertical: 'bottom',\r\n        horizontal: 'left'\r\n      }}\r\n      open={notificationOpen}\r\n      autoHideDuration={3000}\r\n      onClose={handleClose}\r\n      ContentProps={{\r\n        'aria-describedby': 'message-id'\r\n      }}\r\n      message={<span id='message-id'>{notificationMessage}</span>}\r\n      action={[\r\n        <IconButton\r\n          key='close'\r\n          aria-label='close'\r\n          onClick={handleClose}\r\n        >\r\n          <CloseIcon color='inherit' />\r\n        </IconButton>\r\n      ]}\r\n    />\r\n  )\r\n}\r\n\r\nexport default Notification\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Stop {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.routeIds = json.route_ids\r\n    this.routeNames = json.route_names\r\n    this.mobileIds = json.mobile_ids\r\n    this.mobileNames = json.mobile_names\r\n    this.organisationId = json.organisation_id\r\n    this.organisationName = json.organisation_name\r\n    this.name = json.name\r\n    this.community = json.community\r\n    this.address = json.address\r\n    this.postcode = json.postcode\r\n    this.arrivalTimes = json.arrival_times\r\n    this.departureTimes = json.departure_times\r\n    this.routeStart = moment(json.route_start)\r\n    this.routeEnd = moment(json.route_end)\r\n    this.routeDays = json.route_days\r\n    this.routeFrequencies = json.route_frequencies\r\n    this.routeSchedule = json.route_schedule.map(s => moment(s))\r\n    this.timetable = json.timetable\r\n    this.longitude = json.longitude\r\n    this.latitude = json.latitude\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getQueryStops (query, organisationFilters, mobileFilters, routeFilters, searchPosition, distance) {\r\n  let url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize\r\n  if (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection\r\n\r\n  if (mobileFilters.length > 0) url = url + '&mobile_ids=' + mobileFilters.join('|')\r\n  if (organisationFilters.length > 0) url = url + '&organisation_ids=' + organisationFilters.join('|')\r\n  if (routeFilters.length > 0) url = url + '&route_ids=' + routeFilters.join('|')\r\n\r\n  if (searchPosition && searchPosition.length > 1) url = url + '&longitude=' + searchPosition[0] + '&latitude=' + searchPosition[1]\r\n  if (distance && distance !== '') url = url + '&distance=' + distance\r\n\r\n  const response = await axios.get(url)\r\n  if (response && response.data && response.data.length > 0) {\r\n    return {\r\n      stops: response.data.map(s => (new Stop()).fromJson(s)),\r\n      total: parseInt(response.headers['x-total-count']),\r\n      page: parseInt(response.headers['x-page'])\r\n    }\r\n  } else {\r\n    return { stops: [], total: 0, page: 1 }\r\n  }\r\n}\r\n\r\nexport async function getAllStops () {\r\n  const response = await axios.get(config.api + '/stops')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(s => (new Stop()).fromJson(s))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getStopById (id) {\r\n  const response = await axios.get(config.api + '/stops/' + id)\r\n  if (response && response.data) {\r\n    return (new Stop()).fromJson(response.data)\r\n  } else {\r\n    return {}\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Hidden from '@material-ui/core/Hidden'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Tooltip from '@material-ui/core/Tooltip'\r\n\r\nimport MaterialTable from 'material-table'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpwardTwoTone'\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeftTwoTone'\r\nimport ChevronRight from '@material-ui/icons/ChevronRightTwoTone'\r\nimport FirstPage from '@material-ui/icons/FirstPageTwoTone'\r\nimport FilterList from '@material-ui/icons/FilterListTwoTone'\r\nimport LastPage from '@material-ui/icons/LastPageTwoTone'\r\nimport MoreVertIcon from '@material-ui/icons/MoreVertTwoTone'\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport Filters from './Filters'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 200\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  root: {\r\n    flexGrow: 1,\r\n    maxWidth: '100%'\r\n  },\r\n  table: {\r\n    backgroundColor: 'rgba(0, 0, 0, 0)',\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction Stops () {\r\n  const [{ organisations, organisationLookup, mobiles, mobileLookup, routeLookup }, dispatchApplication] = useApplicationStateValue() //eslint-disable-line\r\n  const [{ searchType, searchPostcode, searchDistance, searchPosition, organisationFilter, mobileFilter, routeFilter }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const tableRef = React.createRef()\r\n\r\n  const getStopCalendar = (stop) => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = (stop) => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  useEffect(() => {\r\n    tableRef.current.onQueryChange()\r\n  }, [searchPosition, searchDistance, organisationFilter, mobileFilter, routeFilter]) // eslint-disable-line\r\n\r\n  const displayStopInfo = (stop) => {\r\n    dispatchSearch({ type: 'SetCurrentStop', stopId: stop.id })\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: true })\r\n  }\r\n\r\n  const displayMapStop = (longitude, latitude) => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [longitude, latitude], mapZoom: 15 })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  // Calculate title\r\n  const organisationName = (organisationFilter.length > 0 ? organisationLookup[organisationFilter[0]].name : '')\r\n  const mobileName = (mobileFilter.length > 0 ? mobileLookup[mobileFilter[0]].name : '')\r\n  const routeName = (routeFilter.length > 0 ? routeLookup[routeFilter[0]].name : '')\r\n  let title = 'All stops'\r\n  // Filter stops\r\n  if (organisationName !== '') title = 'Stops in ' + organisationName\r\n  if (mobileName !== '') title = 'Stops for ' + organisationName + ' ' + mobileName\r\n  if (routeName !== '') title = 'Stops for ' + organisationName + ' ' + routeName\r\n  // Postcode search stops\r\n  if (searchPostcode !== '') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of ' + searchPostcode\r\n  // GPS search stops\r\n  if (searchType === 'gps') title = 'Stops within ' + Math.round(searchDistance / 1609) + ' mile(s) of your location'\r\n\r\n  const orgText = {}\r\n  Object.keys(organisationLookup).forEach(key => {\r\n    orgText[key] = organisationLookup[key].name\r\n  })\r\n  const mobileText = {}\r\n  Object.keys(mobileLookup).forEach(key => {\r\n    mobileText[key] = mobileLookup[key].name\r\n  })\r\n  const routeText = {}\r\n  Object.keys(routeLookup).forEach(key => {\r\n    routeText[key] = routeLookup[key].name\r\n  })\r\n\r\n  return (\r\n    <div style={{ maxWidth: '100%' }}>\r\n      <Filters />\r\n      <ListSubheader disableSticky>{title}</ListSubheader>\r\n      <MaterialTable\r\n        tableRef={tableRef}\r\n        components={{\r\n          Container: props => <Paper {...props} elevation={0} className={classes.table} />\r\n        }}\r\n        icons={{\r\n          Filter: FilterList,\r\n          FirstPage: FirstPage,\r\n          LastPage: LastPage,\r\n          NextPage: ChevronRight,\r\n          PreviousPage: ChevronLeft,\r\n          SortArrow: ArrowUpward\r\n        }}\r\n        options={{\r\n          padding: useMediaQuery(theme.breakpoints.up('sm')) ? 'default' : 'dense',\r\n          search: false,\r\n          loadingType: 'overlay',\r\n          actionsColumnIndex: 0,\r\n          filtering: false,\r\n          toolbar: false,\r\n          headerStyle: {\r\n            backgroundColor: '#fafafa',\r\n            color: '#737373',\r\n            border: '0px'\r\n          }\r\n        }}\r\n        columns={[\r\n          {\r\n            title: '',\r\n            field: 'name',\r\n            filtering: false,\r\n            render: rowData => {\r\n              return (\r\n                <>\r\n                  <Tooltip title='See more stop details'>\r\n                    <IconButton onClick={() => displayStopInfo(rowData)}>\r\n                      <MoreVertIcon />\r\n                    </IconButton>\r\n                  </Tooltip>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Add event to your device calendar'>\r\n                      <IconButton onClick={() => getStopCalendar(rowData)}>\r\n                        <EventIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='Download a PDF timetable for this stop'>\r\n                      <IconButton onClick={() => getStopPdf(rowData)}>\r\n                        <PrintIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                  <Hidden mdDown>\r\n                    <Tooltip title='See this stop on the map'>\r\n                      <IconButton onClick={() => displayMapStop(rowData.longitude, rowData.latitude)} component={Link} to='/map'>\r\n                        <LocationOnIcon />\r\n                      </IconButton>\r\n                    </Tooltip>\r\n                  </Hidden>\r\n                </>\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Name',\r\n            field: 'name',\r\n            filtering: false,\r\n            hidden: false,\r\n            render: rowData => {\r\n              return (\r\n                rowData.name\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Community',\r\n            field: 'community',\r\n            filtering: false,\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Library service',\r\n            field: 'organisationName',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('sm')),\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          },\r\n          {\r\n            title: 'Next due',\r\n            field: 'routeSchedule',\r\n            filtering: false,\r\n            hidden: useMediaQuery(theme.breakpoints.down('xs')),\r\n            render: (rowData) => {\r\n              return (\r\n                rowData.routeSchedule.length > 0 ? rowData.routeSchedule[0].format('Do MMMM h:mma') : ''\r\n              )\r\n            },\r\n            cellStyle: {\r\n              borderBottom: '1px solid #f5f5f5',\r\n              backgroundColor: '#ffffff'\r\n            }\r\n          }\r\n        ]}\r\n        data={query =>\r\n          new Promise((resolve, reject) => {\r\n            async function getStops () {\r\n              const stopData = await stopsModel.getQueryStops(query, organisationFilter, mobileFilter, routeFilter, searchPosition, searchDistance)\r\n              resolve({\r\n                data: stopData.stops,\r\n                page: (stopData.page - 1),\r\n                totalCount: stopData.total\r\n              })\r\n            }\r\n            getStops()\r\n          })}\r\n      />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Stops\r\n","import React, { useEffect, useState } from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport CircularProgress from '@material-ui/core/CircularProgress'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport EventIcon from '@material-ui/icons/EventTwoTone'\r\nimport PrintIcon from '@material-ui/icons/PrintTwoTone'\r\nimport LocationOnIcon from '@material-ui/icons/LocationOnTwoTone'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as stopsModel from './models/stops'\r\n\r\nconst config = require('./helpers/config.json')\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1)\r\n  },\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  },\r\n  leftIcon: {\r\n    marginRight: theme.spacing(1)\r\n  },\r\n  list: {\r\n    width: '100%',\r\n    maxWidth: 360,\r\n    backgroundColor: theme.palette.background.paper\r\n  },\r\n  progress: {\r\n    margin: theme.spacing(2)\r\n  }\r\n}))\r\n\r\nfunction StopDetails () {\r\n  const [{ currentStopId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ stopDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [stop, setStop] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getStop (stopId) {\r\n      const stopData = await stopsModel.getStopById(stopId)\r\n      setStop(stopData)\r\n    }\r\n    if (currentStopId != null) getStop(currentStopId)\r\n  }, [currentStopId])\r\n\r\n  const getStopCalendar = () => window.open(config.api + '/stops/' + stop.id + '/ics')\r\n\r\n  const getStopPdf = () => window.open(config.api + '/stops/' + stop.id + '/pdf', '_blank')\r\n\r\n  const goToWebsite = () => window.open(stop.timetable, '_blank')\r\n\r\n  const viewMapStop = () => {\r\n    dispatchView({ type: 'SetMapPosition', mapPosition: [stop.longitude, stop.latitude], mapZoom: 14 })\r\n  }\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetStopDialog', stopDialogOpen: false })\r\n  }\r\n\r\n  const theme = useTheme()\r\n  const classes = useStyles()\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={stopDialogOpen}\r\n      onClose={close}\r\n      aria-labelledby='dlg-title'\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      {stop && stop.routeDays\r\n        ? (\r\n          <>\r\n            <DialogTitle id='dlg-title'>{stop.name + '. ' + stop.community}</DialogTitle>\r\n            <DialogContent>\r\n              <ListSubheader>{(stop.routeSchedule && stop.routeSchedule.length > 0 ? stop.routeSchedule[0].format('dddd Do MMMM h:mma') : '')}</ListSubheader>\r\n              <br />\r\n              <Divider />\r\n              <br />\r\n              <Button onClick={getStopCalendar} className={classes.button} color='primary' startIcon={<EventIcon />}>Calendar</Button>\r\n              <Button onClick={getStopPdf} className={classes.button} color='primary' startIcon={<PrintIcon />}>Timetable</Button>\r\n              <Button onClick={viewMapStop} className={classes.button} color='primary' startIcon={<LocationOnIcon />} component={Link} to='/map'>Map</Button>\r\n            </DialogContent>\r\n          </>\r\n        ) : <CircularProgress className={classes.progress} color='primary' size={30} />}\r\n      <DialogActions>\r\n        <Button onClick={() => goToWebsite()} color='primary'>Website</Button>\r\n        <Button onClick={() => close()} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default StopDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Trip {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.originStopId = json.origin_stop_id\r\n    this.originStopName = json.origin_stop_name\r\n    this.destinationStopId = json.destination_stop_id\r\n    this.destinationStopName = json.destination_stop_name\r\n    this.distance = json.distance\r\n    this.duration = json.duration\r\n    this.routeLine = json.route_line\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllTrips () {\r\n  const response = await axios.get(config.api + '/trips')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(t => (new Trip()).fromJson(t))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getTripById (id) {\r\n  const response = await axios.get(config.api + '/trips/' + id)\r\n  if (response && response.data) {\r\n    return (new Trip()).fromJson(response.data)\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect, useState } from 'react'\r\n\r\nimport Button from '@material-ui/core/Button'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport DialogContent from '@material-ui/core/DialogContent'\r\nimport DialogTitle from '@material-ui/core/DialogTitle'\r\nimport ListSubheader from '@material-ui/core/ListSubheader'\r\nimport Typography from '@material-ui/core/Typography'\r\n\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\r\nimport useMediaQuery from '@material-ui/core/useMediaQuery'\r\n\r\nimport { useSearchStateValue } from './context/searchState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nimport * as tripsModel from './models/trips'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  dialog: {\r\n    border: '1px solid #E0E0E0'\r\n  }\r\n}))\r\n\r\nfunction TripDetails () {\r\n  const [{ currentTripId }, dispatchSearch] = useSearchStateValue() //eslint-disable-line\r\n  const [{ tripDialogOpen }, dispatchView] = useViewStateValue() //eslint-disable-line\r\n\r\n  const [trip, setTrip] = useState({})\r\n\r\n  useEffect(() => {\r\n    async function getTrip (tripId) {\r\n      const trip = await tripsModel.getTripById(tripId)\r\n      setTrip(trip)\r\n    }\r\n    if (currentTripId != null) getTrip(currentTripId)\r\n  }, [currentTripId])\r\n\r\n  const close = () => {\r\n    dispatchView({ type: 'SetTripDialog', tripDialogOpen: false })\r\n  }\r\n\r\n  const classes = useStyles()\r\n  const theme = useTheme()\r\n\r\n  const fullScreen = useMediaQuery(theme.breakpoints.down('sm'))\r\n  const estimatedDuration = Math.round(trip.duration / 60) + ' mins journey time.'\r\n  const distance = Math.round(trip.distance / 1609, 1) + ' mile(s)'\r\n\r\n  return (\r\n    <Dialog\r\n      fullScreen={fullScreen}\r\n      disableBackdropClick\r\n      open={tripDialogOpen}\r\n      onClose={close}\r\n      BackdropProps={{ invisible: true }}\r\n      PaperProps={{ elevation: 0, className: classes.dialog }}\r\n    >\r\n      <DialogTitle>Trip details</DialogTitle>\r\n      <DialogContent>\r\n        <ListSubheader disableSticky>{'From ' + trip.originStopName + ' to ' + trip.destinationStopName}</ListSubheader>\r\n        <Typography variant='body2' component='p'>{estimatedDuration + ' ' + distance}</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={close} color='secondary'>Close</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nexport default TripDetails\r\n","import axios from 'axios'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Organisation {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.country = json.country\r\n    this.code = json.code\r\n    this.name = json.name\r\n    this.timetable = json.timetable\r\n    this.website = json.website\r\n    this.email = json.email\r\n    this.colour = json.colour\r\n    this.logo = json.logo\r\n    this.numberMobiles = json.number_mobiles\r\n    this.numberRoutes = json.number_routes\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllOrganisations () {\r\n  const response = await axios.get(config.api + '/organisations')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(o => (new Organisation()).fromJson(o))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import axios from 'axios'\r\nimport moment from 'moment'\r\n\r\nconst config = require('../helpers/config.json')\r\n\r\nexport class Route {\r\n  constructor (obj) {\r\n    Object.assign(this, obj)\r\n  }\r\n\r\n  fromJson (json) {\r\n    this.id = json.id\r\n    this.organisationId = json.organisation_id\r\n    this.mobileId = json.mobile_id\r\n    this.name = json.name\r\n    this.frequency = json.frequency\r\n    this.start = moment(json.start)\r\n    this.end = moment(json.end)\r\n    this.timetable = json.timetable\r\n    this.numberStops = json.number_stops\r\n    return this\r\n  }\r\n}\r\n\r\nexport async function getAllRoutes () {\r\n  const response = await axios.get(config.api + '/routes')\r\n  if (response && response.data && response.data.length > 0) {\r\n    return response.data.map(r => (new Route()).fromJson(r))\r\n  } else {\r\n    return []\r\n  }\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport { BrowserRouter, Route } from 'react-router-dom'\r\n\r\nimport Container from '@material-ui/core/Container'\r\n\r\nimport { makeStyles } from '@material-ui/core/styles'\r\n\r\nimport AppHeader from './AppHeader'\r\nimport Footer from './Footer'\r\nimport { MemoMarkdownPage } from './MarkdownPage'\r\nimport Mobiles from './Mobiles'\r\nimport MobileMap from './MobileMap'\r\nimport Notification from './Notification'\r\nimport Stops from './Stops'\r\nimport StopDetails from './StopDetails'\r\nimport TripDetails from './TripDetails'\r\n\r\nimport Accessibility from './pages/accessibility.md'\r\nimport Data from './pages/data.md'\r\nimport Privacy from './pages/privacy.md'\r\n\r\nimport * as mobilesModel from './models/mobiles'\r\nimport * as organisationsModel from './models/organisations'\r\nimport * as routesModel from './models/routes'\r\n\r\nimport { useApplicationStateValue } from './context/applicationState'\r\nimport { useViewStateValue } from './context/viewState'\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(2)\r\n  },\r\n  root: {\r\n    flexGrow: 1\r\n  }\r\n}))\r\n\r\nfunction MobilesApplication () {\r\n  const [{ loadingOrganisations, loadingMobiles, loadingRoutes, loadingMobileLocations, loadingNearestMobiles, loadingPostcode }] = useViewStateValue()\r\n  const [{ }, dispatchApplicationState] = useApplicationStateValue() //eslint-disable-line\r\n\r\n  useEffect(() => {\r\n    async function getOrganisations () {\r\n      const organisations = await organisationsModel.getAllOrganisations()\r\n      const organisationLookup = {}\r\n      organisations.forEach(organisation => { organisationLookup[organisation.id] = organisation })\r\n      dispatchApplicationState({ type: 'AddOrganisations', organisations: organisations, organisationLookup: organisationLookup })\r\n    }\r\n    async function getMobiles () {\r\n      const mobiles = await mobilesModel.getAllMobiles()\r\n      const mobileLookup = {}\r\n      mobiles.forEach(mobile => { mobileLookup[mobile.id] = mobile })\r\n      dispatchApplicationState({ type: 'AddMobiles', mobiles: mobiles, mobileLookup: mobileLookup })\r\n    }\r\n    async function getRoutes () {\r\n      const routes = await routesModel.getAllRoutes()\r\n      const routeLookup = {}\r\n      routes.forEach(route => { routeLookup[route.id] = route })\r\n      dispatchApplicationState({ type: 'AddRoutes', routes: routes, routeLookup: routeLookup })\r\n    }\r\n    async function getMobileLocations () {\r\n      const locations = await mobilesModel.getMobileLocations()\r\n      const mobileLocationLookup = {}\r\n      locations.forEach(location => { mobileLocationLookup[location.mobileId] = location })\r\n      dispatchApplicationState({ type: 'AddMobileLocations', mobileLocations: locations, mobileLocationLookup: mobileLocationLookup })\r\n    }\r\n    getOrganisations()\r\n    getMobiles()\r\n    getRoutes()\r\n    getMobileLocations()\r\n\r\n    setInterval(() => {\r\n      getMobileLocations(false)\r\n    }, 15000)\r\n  }, []) //eslint-disable-line\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <BrowserRouter>\r\n      <div className={classes.root}>\r\n        <AppHeader\r\n          loading={loadingOrganisations || loadingMobiles || loadingRoutes || loadingMobileLocations || loadingNearestMobiles || loadingPostcode}\r\n          site={2}\r\n        />\r\n        <Container maxWidth='lg'>\r\n          <main className={classes.content}>\r\n            <Route path='/' exact render={() => <Stops />} />\r\n            <Route path='/mobiles' render={() => <Mobiles />} />\r\n            <Route path='/map' render={() => <MobileMap />} />\r\n            <Route path='/accessibility' exact render={() => <MemoMarkdownPage page={Accessibility} />} />\r\n            <Route path='/data' exact render={() => <MemoMarkdownPage page={Data} />} />\r\n            <Route path='/privacy' exact render={() => <MemoMarkdownPage page={Privacy} />} />\r\n            <Route path={['/http:', '/https:']} component={props => { window.location.replace(props.location.pathname.substr(1)); return null }} />\r\n          </main>\r\n        </Container>\r\n        <Container maxWidth='lg'>\r\n          <Footer />\r\n        </Container>\r\n        <StopDetails />\r\n        <TripDetails />\r\n        <Notification />\r\n      </div>\r\n    </BrowserRouter>\r\n  )\r\n}\r\n\r\nexport default MobilesApplication\r\n","import React from 'react'\r\n\r\nimport CssBaseline from '@material-ui/core/CssBaseline'\r\n\r\nimport blueGrey from '@material-ui/core/colors/blueGrey'\r\nimport red from '@material-ui/core/colors/red'\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles'\r\n\r\nimport { ApplicationStateProvider } from './context/applicationState'\r\nimport { SearchStateProvider } from './context/searchState'\r\nimport { ViewStateProvider } from './context/viewState'\r\n\r\nimport MobilesApplication from './MobilesApplication'\r\n\r\nconst initialApplicationState = {\r\n  organisations: [],\r\n  organisationLookup: {},\r\n  mobiles: [],\r\n  mobileLookup: {},\r\n  mobileLocations: [],\r\n  mobileLocationLookup: {},\r\n  mobilesNearest: [],\r\n  mobilesNearestLookup: {},\r\n  routes: [],\r\n  routeLookup: {},\r\n  stops: [],\r\n  trips: []\r\n}\r\n\r\nconst applicationReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'AddOrganisations':\r\n      return {\r\n        ...state,\r\n        organisations: action.organisations,\r\n        organisationLookup: action.organisationLookup\r\n      }\r\n    case 'AddMobileLocations':\r\n      return {\r\n        ...state,\r\n        mobileLocations: action.mobileLocations,\r\n        mobileLocationLookup: action.mobileLocationLookup\r\n      }\r\n    case 'AddRoutes':\r\n      return {\r\n        ...state,\r\n        routes: action.routes,\r\n        routeLookup: action.routeLookup\r\n      }\r\n    case 'AddMobiles':\r\n      return {\r\n        ...state,\r\n        mobiles: action.mobiles,\r\n        mobileLookup: action.mobileLookup\r\n      }\r\n    case 'UpdateMobilesNearest':\r\n      return {\r\n        ...state,\r\n        mobilesNearest: action.mobilesNearest,\r\n        mobilesNearestLookup: action.mobilesNearestLookup\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialSearchState = {\r\n  searchPostcode: '',\r\n  searchType: '',\r\n  searchDistance: 1609,\r\n  searchPosition: [],\r\n  searchPositionUpdateInterval: null,\r\n  organisationFilter: [],\r\n  mobileFilter: [],\r\n  routeFilter: [],\r\n  currentStopId: null,\r\n  currentTripId: null\r\n}\r\n\r\nconst searchReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetCurrentStop':\r\n      return {\r\n        ...state,\r\n        currentStopId: action.stopId\r\n      }\r\n    case 'SetCurrentTrip':\r\n      return {\r\n        ...state,\r\n        currentTripId: action.tripId\r\n      }\r\n    case 'SetSearchDistance':\r\n      return {\r\n        ...state,\r\n        searchDistance: action.searchDistance\r\n      }\r\n    case 'SetPostcodeSearch':\r\n      return {\r\n        ...state,\r\n        searchPostcode: action.searchPostcode,\r\n        searchPosition: action.searchPosition,\r\n        searchType: 'postcode',\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: []\r\n      }\r\n    case 'FilterByOrganisation':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByMobile':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [action.organisationId],\r\n        mobileFilter: [action.mobileId],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'FilterByRoute':\r\n      return {\r\n        ...state,\r\n        routeFilter: [action.routeId],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearAll':\r\n      return {\r\n        ...state,\r\n        organisationFilter: [],\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearMobileFilter':\r\n      return {\r\n        ...state,\r\n        mobileFilter: [],\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    case 'ClearRouteFilter':\r\n      return {\r\n        ...state,\r\n        routeFilter: [],\r\n        searchPostcode: '',\r\n        searchPosition: [],\r\n        searchType: ''\r\n      }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst initialViewState = {\r\n  stopDialogOpen: false,\r\n  tripDialogOpen: false,\r\n  notificationOpen: false,\r\n  notificationMessage: '',\r\n  mapZoom: [7],\r\n  mapPosition: [-1.155414, 52.691432],\r\n  mapSettings: {\r\n    authorityBoundary: false\r\n  },\r\n  mapSettingsDialogOpen: false,\r\n  loadingOrganisations: false,\r\n  loadingMobiles: false,\r\n  loadingRoutes: false,\r\n  loadingMobileLocations: false,\r\n  loadingNearestMobiles: false,\r\n  loadingPostcode: false\r\n}\r\n\r\nconst viewReducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'SetNotificationMessage':\r\n      return { ...state, notificationMessage: action.notificationMessage }\r\n    case 'SetNotification':\r\n      return { ...state, notificationOpen: action.notificationOpen }\r\n    case 'ShowNotification':\r\n      return { ...state, notificationOpen: true, notificationMessage: action.notificationMessage }\r\n    case 'SetStopDialog':\r\n      return { ...state, stopDialogOpen: action.stopDialogOpen }\r\n    case 'SetTripDialog':\r\n      return { ...state, tripDialogOpen: action.tripDialogOpen }\r\n    case 'SetMapSettingsDialog':\r\n      return { ...state, mapSettingsDialogOpen: action.mapSettingsDialogOpen }\r\n    case 'ToggleMapSetting': {\r\n      const settings = state.mapSettings\r\n      settings[action.mapSetting] = !settings[action.mapSetting]\r\n      return { ...state, mapSettings: settings }\r\n    }\r\n    case 'LoadingPostcode':\r\n      return { ...state, loadingPostcode: true }\r\n    case 'SetPostcodeSearch':\r\n      return { ...state, loadingPostcode: false, mapPosition: action.mapPosition, mapZoom: [13] }\r\n    case 'SetMapPosition':\r\n      return { ...state, mapPosition: action.mapPosition, mapZoom: [action.mapZoom] }\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      main: red[900]\r\n    },\r\n    secondary: {\r\n      main: blueGrey[700]\r\n    }\r\n  },\r\n  overrides: {\r\n    MuiButton: {\r\n      text: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTab: {\r\n      root: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTypography: {\r\n      button: {\r\n        textTransform: 'none'\r\n      }\r\n    },\r\n    MuiTableCell: {\r\n      root: {\r\n        borderBottom: 'none'\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\nfunction App () {\r\n  return (\r\n    <ApplicationStateProvider initialState={initialApplicationState} reducer={applicationReducer}>\r\n      <SearchStateProvider initialState={initialSearchState} reducer={searchReducer}>\r\n        <ViewStateProvider initialState={initialViewState} reducer={viewReducer}>\r\n          <ThemeProvider theme={theme}>\r\n            <CssBaseline />\r\n            <MobilesApplication />\r\n          </ThemeProvider>\r\n        </ViewStateProvider>\r\n      </SearchStateProvider>\r\n    </ApplicationStateProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n)\r\n\r\nexport function register (config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config)\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          )\r\n        })\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\nfunction registerValidSW (swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing\r\n        if (installingWorker == null) {\r\n          return\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              )\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration)\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.')\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error)\r\n    })\r\n}\r\n\r\nfunction checkValidServiceWorker (swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  window.fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type')\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload()\r\n          })\r\n        })\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config)\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      )\r\n    })\r\n}\r\n\r\nexport function unregister () {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister()\r\n    })\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11'\r\nimport 'react-app-polyfill/stable'\r\n\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\n\r\nimport App from './App'\r\n\r\nimport * as serviceWorker from './serviceWorker'\r\n\r\nReactDOM.render(<App />, document.getElementById('root'))\r\n\r\nserviceWorker.unregister()\r\n"],"sourceRoot":""}