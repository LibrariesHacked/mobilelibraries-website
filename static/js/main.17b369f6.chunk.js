(this["webpackJsonpmobilelibraries-website"]=this["webpackJsonpmobilelibraries-website"]||[]).push([[0],{134:function(e){e.exports=JSON.parse('{"api":"https://api.mobilelibraries.org/api","postcodeApi":"https://api-geography.librarydata.uk/rest/postcodes/","stopTiles":"https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt","tripTiles":"https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt","libraryAuthorityTiles":"https://api-geography.librarydata.uk/rest/libraryauthorities/{z}/{x}/{y}.mvt"}')},524:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=524},558:function(e,t,a){e.exports=a.p+"static/media/accessibility.83399c29.md"},559:function(e,t,a){e.exports=a.p+"static/media/data.e9cc0a7b.md"},560:function(e,t,a){e.exports=a.p+"static/media/privacy.a013c74b.md"},569:function(e,t,a){e.exports=a(853)},853:function(e,t,a){"use strict";a.r(t);a(570),a(579);var n=a(0),r=a.n(n),o=a(21),i=a.n(o),c=a(19),l=a(895),s=a(561),u=a.n(s),p=a(367),m=a.n(p),d=a(182),b=a(894),f=Object(n.createContext)(),h=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(f.Provider,{value:Object(n.useReducer)(t,a)},o)},g=function(){return Object(n.useContext)(f)},y=Object(n.createContext)(),E=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(y.Provider,{value:Object(n.useReducer)(t,a)},o)},v=function(){return Object(n.useContext)(y)},O=Object(n.createContext)(),j=function(e){var t=e.reducer,a=e.initialState,o=e.children;return r.a.createElement(O.Provider,{value:Object(n.useReducer)(t,a)},o)},S=function(){return Object(n.useContext)(O)},x=a(18),k=a.n(x),w=a(27),_=a(127),C=a(15),N=a(112),I=a(45),F=a(875),M=a(495),L=a(876),P=a(498),D=a(530),T=a(529),B=a(365),R=a(878),A=a(896),z=a(499),W=a(496),J=a(540),Z=a.n(J),G=a(542),H=a.n(G),q=a(163),U=a.n(q),Y=a(375),X=a.n(Y),V=a(541),$=a.n(V),Q=a(538),K=a.n(Q),ee=a(302),te=a.n(ee),ae=a(539),ne=a.n(ae),re=a(283),oe=a.n(re),ie=a(301),ce=a.n(ie),le=a(564),se=a(874),ue=a(273),pe=a(497),me=a(159),de=a(534),be=a.n(de),fe=a(535),he=a.n(fe),ge=a(61),ye=a.n(ge),Ee=a(134);function ve(e){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Ee.postcodeApi+t);case 2:return a=e.sent,e.abrupt("return",{location:[a.data.longitude,a.data.latitude],organisation:a.data.library_service_name});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var je=a(72),Se=a(73),xe=a(75),ke=a.n(xe),we=a(134),_e=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.organisationId=e.organisation_id,this.name=e.name,this.timetable=e.timetable,this.numberRoutes=e.number_routes,this.numberStops=e.number_stops,this}}]),e}(),Ce=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.mobileId=e.mobile_id,this.stopId=e.stop_id,this.stopName=e.stop_name,this.stopDistance=e.stop_distance,this}}]),e}(),Ne=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.mobileId=e.mobile_id,this.currentStopId=e.current_stop_id,this.currentStopDeparture=ke()(e.current_stop_departure),this.currentStopName=e.current_stop_name,this.previousStopId=e.previous_stop_id,this.previousStopDeparture=ke()(e.previous_stop_departure),this.previousStopName=e.previous_stop_name,this.nextStopId=e.next_stop_id,this.nextStopArrival=ke()(e.next_stop_arrival),this.nextStopName=e.next_stop_name,this.updated=ke()(e.updated),this.updateType=e.update_type,this.geoX=e.geox,this.geoY=e.geoy,this.routeSection=e.route_section,this}},{key:"getStatus",value:function(){var e=ke()(),t="Not out today",a="Arriving at ",n="At ",r="Arriving at ",o="Finished for the day";if(!this.currentStopId&&!this.previousStopId&&this.nextStopId&&!this.nextStopArrival.isSame(e,"day"))return{type:"offRoad",textFormat:t,message:t};if(!this.currentStopId&&!this.previousStopId&&this.nextStopId&&this.nextStopArrival.isSame(e,"day")){var i=this.nextStopArrival.fromNow();return{type:"preRoute",message:a,textFormat:a+this.nextStopName+" "+i,args:[{stopName:this.nextStopName,stopId:this.nextStopId},i]}}if(this.currentStopId){var c=this.currentStopDeparture.fromNow(!0);return{type:"atStop",message:n,textFormat:n+this.currentStopName+" for "+c,args:[{stopName:this.currentStopName,stopId:this.currentStopId},c]}}if(!this.currentStopId&&this.previousStopId&&this.nextStopId&&this.previousStopDeparture.isSame(e,"day")&&this.nextStopArrival.isSame(e,"day")){var l=this.nextStopArrival.fromNow();return{type:"betweenStops",message:r,textFormat:r+this.nextStopName+" "+l,args:[{stopName:this.nextStopName,stopId:this.nextStopId},l]}}return this.previousStopId&&this.nextStopId&&this.previousStopDeparture.isSame(e,"day")&&!this.nextStopArrival.isSame(e,"day")?{type:"postRoute",message:o,text_format:o}:null}}]),e}();function Ie(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(we.api+"/mobiles");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=8;break}return a=t.data.map((function(e){return(new _e).fromJson(e)})),e.abrupt("return",a);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(){return Le.apply(this,arguments)}function Le(){return(Le=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(we.api+"/mobiles/locations");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=8;break}return a=t.data.map((function(e){return(new Ne).fromJson(e)})),e.abrupt("return",a);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e,t){return De.apply(this,arguments)}function De(){return(De=Object(w.a)(k.a.mark((function e(t,a){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(we.api+"/mobiles/nearest?longitude="+t[0]+"&latitude="+t[1]+"&distance="+a);case 2:if(!((n=e.sent)&&n.data&&n.data.length>0)){e.next=7;break}return e.abrupt("return",n.data.map((function(e){return(new Ce).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=Object(M.a)((function(e){return{grow:{flexGrow:1},iconButton:{padding:10},inputInput:{paddingTop:e.spacing(),paddingRight:e.spacing(),paddingBottom:e.spacing(),paddingLeft:e.spacing(2),fontWeight:500},search:{position:"relative",border:"1px solid #E0E0E0",borderRadius:e.shape.borderRadius,backgroundColor:Object(me.fade)(e.palette.common.white,.8),"&:hover":{backgroundColor:Object(me.fade)(e.palette.common.white,.9)},marginLeft:0,marginRight:e.spacing(),display:"flex",maxWidth:240}}}));var Be=function(){var e=g(),t=Object(C.a)(e,2);Object(_.a)(t[0]);var a=t[1],o=v(),i=Object(C.a)(o,2),c=i[0],l=c.searchType,s=c.searchPostcode,u=c.searchDistance,p=i[1],m=S(),d=Object(C.a)(m,2);Object(_.a)(d[0]);var b=d[1],f=Object(n.useState)(s),h=Object(C.a)(f,2),y=h[0],E=h[1],O=Object(n.useState)(null),j=Object(C.a)(O,2),x=j[0],N=j[1],I=function(e){var t=Object(n.useRef)();return Object(n.useEffect)((function(){t.current=e})),t.current}({searchPostcode:s});Object(n.useEffect)((function(){I&&s!==I.searchPostcode&&E(s)}),[s]);var F=function(){return N(null)},M=function(e){F(),p({type:"SetSearchDistance",searchDistance:e}),"postcode"===l&&L()},L=function(){var e=Object(w.a)(k.a.mark((function e(){var t,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==y){e.next=3;break}return b({type:"ShowNotification",notificationMessage:"You must enter a postcode"}),e.abrupt("return");case 3:return b({type:"LoadingPostcode"}),e.next=6,ve(y);case 6:if(!(t=e.sent).location||2!==t.location.length){e.next=18;break}return p({type:"SetPostcodeSearch",searchPostcode:y,searchPosition:t.location}),b({type:"SetPostcodeSearch",mapPosition:t.location}),e.next=12,Pe(t.location,u);case 12:n=e.sent,r={},n.forEach((function(e){r[e.mobileId]=e})),a({type:"UpdateMobilesNearest",mobilesNearest:n,mobilesNearestLookup:r}),e.next=19;break;case 18:b({type:"ShowNotification",notificationMessage:"Could not find postcode"});case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=Te();return r.a.createElement("div",{className:P.search},r.a.createElement(le.a,{placeholder:"Postcode",classes:{input:P.inputInput},value:y,onChange:function(e){return E(e.target.value)}}),r.a.createElement("div",{className:P.grow}),"postcode"===l?r.a.createElement(W.a,{title:"Clear search"},r.a.createElement(B.a,{className:P.iconButton,onClick:function(){return p({type:"ClearAll"})}},r.a.createElement(be.a,null))):null,r.a.createElement(W.a,{title:"Search by postcode"},r.a.createElement(B.a,{color:"primary",className:P.iconButton,onClick:function(){return L()}},r.a.createElement(oe.a,null))),r.a.createElement(W.a,{title:"Change search settings"},r.a.createElement(B.a,{className:P.iconButton,color:"secondary",onClick:function(e){!function(e){N(e.currentTarget)}(e)}},r.a.createElement(he.a,null))),r.a.createElement(ue.a,{id:"mnu-settings",anchorEl:x,keepMounted:!0,open:Boolean(x),onClose:function(){return F()}},r.a.createElement(se.a,{disableSticky:!0},"Search distance"),r.a.createElement(pe.a,{onClick:function(){return M(1609)}},"1 mile"),r.a.createElement(pe.a,{onClick:function(){return M(4827)}},"3 miles"),r.a.createElement(pe.a,{onClick:function(){return M(8045)}},"5 miles"),r.a.createElement(pe.a,{onClick:function(){return M(16090)}},"10 miles"),r.a.createElement(pe.a,{onClick:function(){return M(32180)}},"20 miles"),r.a.createElement(pe.a,{onClick:function(){return M(80450)}},"50 miles")))},Re=a(536),Ae=a.n(Re),ze=a(537),We=a.n(ze),Je=Object(M.a)((function(e){return{button:{marginRight:e.spacing(1)},chip:{marginRight:e.spacing(1)},leftIcon:{marginRight:e.spacing(1)},search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var Ze=function(){var e=g(),t=Object(C.a)(e,1)[0],a=t.organisations,o=t.organisationLookup,i=t.mobiles,c=t.mobileLookup,l=t.routeLookup,s=t.routes,u=v(),p=Object(C.a)(u,2),m=p[0],d=m.organisationFilter,b=m.mobileFilter,f=m.routeFilter,h=p[1],y=Object(n.useState)(null),E=Object(C.a)(y,2),O=E[0],j=E[1],S=Object(n.useState)(null),x=Object(C.a)(S,2),k=x[0],w=x[1],_=Object(n.useState)(null),N=Object(C.a)(_,2),I=N[0],F=N[1],M=function(){return j(null)},L=function(){return w(null)},T=function(){return F(null)},B=new Set(a.map((function(e){return e.country}))),R=Je();return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:R.search},0===d.length?r.a.createElement(W.a,{title:"Choose library service"},r.a.createElement(P.a,{color:"primary",className:R.button,onClick:function(e){return t=e.currentTarget,j(t);var t}},r.a.createElement(Ae.a,{className:R.leftIcon}),"Select service")):r.a.createElement(D.a,{className:R.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearAll"})},label:o[d[0]].name}),d.length>0?0===b.length?r.a.createElement(W.a,{title:"Choose mobile library"},r.a.createElement(P.a,{color:"primary",className:R.button,onClick:function(e){return t=e.currentTarget,w(t);var t}},r.a.createElement(U.a,{className:R.leftIcon}),"Select mobile")):r.a.createElement(D.a,{className:R.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearMobileFilter"})},label:c[b[0]].name}):null,b.length>0?0===f.length?r.a.createElement(W.a,{title:"Choose route"},r.a.createElement(P.a,{color:"primary",className:R.button,onClick:function(e){return t=e.currentTarget,F(t);var t}},r.a.createElement(We.a,{className:R.leftIcon}),"Select route")):r.a.createElement(D.a,{className:R.chip,color:"primary",variant:"outlined",onDelete:function(){h({type:"ClearRouteFilter"})},label:l[f[0]].name}):null),r.a.createElement(ue.a,{id:"menu-library-service",anchorEl:O,keepMounted:!0,open:Boolean(O),onClose:function(){return M()}},Array.from(B).sort((function(e,t){return e.localeCompare(t)})).map((function(e,t){var n=[r.a.createElement(se.a,{key:"lst_"+t,disableSticky:!0},e)],o=a.sort((function(e,t){return e.name.localeCompare(t.name)})).filter((function(t){return t.country===e})).map((function(e){return r.a.createElement(pe.a,{key:"mnu_itm_org_"+e.id,onClick:function(){return t=e.id,h({type:"FilterByOrganisation",organisationId:t}),void M();var t}},e.name)}));return n.concat(o)}))),r.a.createElement(ue.a,{id:"menu-mobile-library",anchorEl:k,keepMounted:!0,open:Boolean(k),onClose:function(){return L()}},i.filter((function(e){var t=!0;return d.length>0&&-1===d.indexOf(e.organisationId)&&(t=!1),t})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return r.a.createElement(pe.a,{key:"mnu_itm_mob_"+e.id,onClick:function(){return t=e.organisationId,a=e.id,h({type:"FilterByMobile",organisationId:t,mobileId:a}),void L();var t,a}},e.name)}))),r.a.createElement(ue.a,{id:"menu-route",anchorEl:I,keepMounted:!0,open:Boolean(I),onClose:function(){return T()}},s.filter((function(e){var t=!0;return b.length>0&&-1===b.indexOf(e.mobileId)&&(t=!1),t})).sort((function(e,t){return e.name.localeCompare(t.name)})).map((function(e){return r.a.createElement(pe.a,{key:"mnu_itm_route_"+e.id,onClick:function(){return t=e.id,h({type:"FilterByRoute",routeId:t}),void T();var t}},e.name)}))))},Ge=Object(M.a)((function(e){return{appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"white",position:"relative"},appBarTransparent:{zIndex:e.zIndex.drawer+1,backgroundColor:"rgba(250, 250, 250, 0.8)",position:"relative"},grow:{flexGrow:1},siteTitle:{margin:e.spacing(1),padding:e.spacing(1),display:"inline-block",verticalAlign:"middle",color:e.palette.primary.main,backgroundColor:"rgba(250, 250, 250, 0.8)",border:"1px solid #e5e5e5",borderRadius:26},siteTitleIcon:{verticalAlign:"sub"},title:{margin:e.spacing(2),display:"inline-block",verticalAlign:"middle"},topIcon:{backgroundColor:"rgba(250, 250, 250, 0.8)",border:"1px solid #e5e5e5","&:hover":{backgroundColor:"rgba(250, 250, 250, 0.8)"}},topTitle:{position:"relative",zIndex:e.zIndex.drawer+1}}}));var He=function(e){var t=e.site,a=v(),o=Object(C.a)(a,2),i=o[0].currentServiceSystemName,c=(o[1],Object(n.useState)(!1)),l=Object(C.a)(c,2),s=l[0],u=l[1],p=Object(n.useState)(t),m=Object(C.a)(p,2),d=m[0],b=m[1],f=Object(I.useLocation)(),h=Ge(),g=function(e){return i?e+"?service="+i:e},y=[{title:"Library lab",url:"https://www.librarylab.uk",icon:r.a.createElement(ce.a,null),links:[{title:"About library lab",short:"Lab",icon:r.a.createElement(ce.a,null),to:"/"}]},{title:"Libraries at home",url:"https://www.librariesathome.co.uk",icon:r.a.createElement(K.a,null),links:[{title:"Find service",short:"Find",icon:r.a.createElement(oe.a,null),to:g("/")},{title:"Watch library TV",short:"Watch",icon:r.a.createElement(ne.a,null),to:"/watch"},{title:"Read blogs",short:"Read",icon:r.a.createElement(Z.a,null),to:"/read"},{title:"Listen podcasts",short:"Listen",icon:r.a.createElement($.a,null),to:"/listen"}]},{title:"Mobile libraries",url:"https://www.mobilelibraries.org",icon:r.a.createElement(U.a,null),links:[{title:"Find my stop",short:"Stops",icon:r.a.createElement(X.a,null),to:"/"},{title:"Mobile vans",short:"Vans",icon:r.a.createElement(U.a,null),to:"/mobiles"},{title:"Map of stops",short:"Map",icon:r.a.createElement(te.a,null),to:"/map"}]},{title:"Library map",url:"https://www.librarymap.co.uk",icon:r.a.createElement(te.a,null),links:[{title:"Find my library",short:"Find",icon:r.a.createElement(X.a,null),to:g("/")},{title:"Map of libraries",short:"Map",icon:r.a.createElement(te.a,null),to:g("/map")}]}],E="/map"===f.pathname?h.appBarTransparent:h.appBar;return r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{maxWidth:"lg",className:h.topTitle},r.a.createElement(z.a,null,r.a.createElement(B.a,{className:h.topIcon,color:"primary",onClick:function(){u(!s),b(t)}},s?r.a.createElement(H.a,null):r.a.createElement(ce.a,null)),r.a.createElement("span",{className:h.grow}),"/map"===f.pathname?r.a.createElement(Ze,null):null,r.a.createElement(D.a,{label:y[t].title,color:"secondary"}))),s?r.a.createElement(L.a,{position:"static",color:"default",elevation:0,className:E},r.a.createElement(F.a,{maxWidth:"lg"},r.a.createElement(A.a,{centered:!0,value:d,onChange:function(e,t){b(t)},variant:"scrollable",scrollButtons:"on",indicatorColor:"primary",textColor:"secondary"},y.map((function(e,t){return r.a.createElement(R.a,{key:"tb_site_"+t,label:e.title,icon:e.icon})}))))):null,r.a.createElement(L.a,{position:"static",color:"inherit",elevation:0,className:E},r.a.createElement(F.a,{maxWidth:"lg"},r.a.createElement(z.a,null,r.a.createElement(T.a,{mdUp:!0},y[d].links.map((function(e,a){return r.a.createElement(W.a,{title:e.title,key:"icnb_menu_lg_"+a},r.a.createElement(P.a,{component:N.b,to:d===t?e.to:y[d].url+e.to,disableRipple:f.pathname===e.to,disableFocusRipple:f.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon},e.short))}))),r.a.createElement(T.a,{smDown:!0},y[d].links.map((function(e,a){return r.a.createElement(W.a,{title:e.title,key:"icnb_menu_lg_"+a},r.a.createElement(P.a,{component:N.b,to:d===t?e.to:y[d].url+e.to,disableRipple:f.pathname===e.to,disableFocusRipple:f.pathname===e.to,color:"secondary",size:"large",startIcon:e.icon},e.title))}))),r.a.createElement("span",{className:h.grow}),"/map"===f.pathname?r.a.createElement(Be,null):null))))},qe=a(303),Ue=a.n(qe),Ye=a(879),Xe=a(880),Ve=a(881),$e=a(130),Qe=a(543),Ke=a.n(Qe),et=Object(M.a)((function(e){return{root:{paddingTop:e.spacing(5),marginTop:e.spacing(3),marginBottom:e.spacing(5),width:"100%"},grid:{marginTop:e.spacing(2)},loveIcon:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},footerText:{verticalAlign:"middle",display:"inline-flex"},footerRight:{textAlign:"right"},tapTarget:{lineHeight:2.2,fontSize:16}}}));var tt=function(){var e=et();return r.a.createElement("div",{className:e.root},r.a.createElement(Ye.a,null),r.a.createElement(Xe.a,{container:!0,spacing:3,className:e.grid},r.a.createElement(Xe.a,{item:!0,xs:12,sm:6,md:6,lg:6,xl:6},r.a.createElement($e.a,{variant:"body1",className:e.footerText},"A library lab project built by Libraries Hacked."),r.a.createElement("br",null),r.a.createElement($e.a,{variant:"button"},r.a.createElement(Ve.a,{component:Ue.a,to:"/accessibility",title:"How we make this site accessible",className:e.tapTarget},"Accessibility"),r.a.createElement("br",null),r.a.createElement(Ve.a,{component:Ue.a,to:"/privacy",title:"Your privacy on this site",className:e.tapTarget},"Privacy"),r.a.createElement("br",null),r.a.createElement(Ve.a,{component:Ue.a,to:"/data",title:"Data used on this site and licensing",className:e.tapTarget},"Data"))),r.a.createElement(Xe.a,{className:e.footerRight,item:!0,xs:12,sm:6,md:6,lg:6,xl:6},r.a.createElement($e.a,{variant:"button"},r.a.createElement(Ve.a,{href:"https://github.com/LibrariesHacked/mobilelibraries-website",target:"_blank",title:"Project on GitHub",className:e.tapTarget},"Open Source on GitHub"),r.a.createElement("br",null),r.a.createElement(Ve.a,{href:"https://www.librarylab.uk/docs/mobile-libraries",target:"_blank",title:"About the library lab projects and documentation for this project",className:e.tapTarget},"About this project"),r.a.createElement("br",null),r.a.createElement(Ke.a,{color:"error",className:e.loveIcon})))))},at=a(562),nt=a(544),rt=a(4),ot=Object(M.a)((function(e){return{listItem:{marginTop:e.spacing(1)},root:{"& table":{display:"block",wordBreak:"normal",width:"100%",overflowX:"auto",WebkitOverflowScrolling:"touch",borderCollapse:"collapse",marginBottom:"16px",borderSpacing:0,overflow:"hidden","& .prop-name":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace'},"& .required":{color:"light"===e.palette.type?"#006500":"#a5ffa5"},"& .prop-type":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',color:"light"===e.palette.type?"#932981":"#ffb6ec"},"& .prop-default":{fontSize:13,fontFamily:'Consolas, "Liberation Mono", Menlo, monospace',borderBottom:"1px dotted ".concat(e.palette.divider)}},"& td":Object(c.a)(Object(c.a)({},e.typography.body2),{},{borderBottom:"1px solid ".concat(e.palette.divider),padding:16,color:e.palette.text.primary}),"& th":{fontSize:14,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium,color:e.palette.text.primary,whiteSpace:"pre",borderBottom:"1px solid ".concat(e.palette.divider),padding:16}}}})),it={overrides:{h1:{component:$e.a,props:{gutterBottom:!0,variant:"h4",color:"secondary"}},h2:{component:$e.a,props:{gutterBottom:!0,variant:"h5",color:"textPrimary"}},h3:{component:$e.a,props:{gutterBottom:!0,variant:"h6",color:"textPrimary"}},h4:{component:$e.a,props:{gutterBottom:!0,variant:"h6",paragraph:!0,color:"textPrimary"}},p:{component:$e.a,props:{paragraph:!0,color:"textPrimary"}},a:{component:Ve.a},li:{component:Object(rt.a)(ot)((function(e){var t=e.classes,a=Object(at.a)(e,["classes"]);return r.a.createElement("li",{className:t.listItem},r.a.createElement($e.a,Object.assign({component:"span"},a)))}))}}};var ct=r.a.memo((function(e){var t=e.page,a=Object(n.useState)(""),o=Object(C.a)(a,2),i=o[0],c=o[1],l=ot();return Object(n.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(){var a,n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.fetch(t);case 2:return a=e.sent,e.next=5,a.text();case 5:n=e.sent,c(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]),r.a.createElement(nt.a,Object.assign({className:l.root,options:it},e),i)})),lt=a(885),st=Object(M.a)((function(e){return{search:{alignContent:"center",textAlign:"center",display:"table",marginLeft:"auto",marginRight:"auto",marginBottom:"10px"},subtitle:{textAlign:"center",marginBottom:"5px"},title:{textAlign:"center"}}}));var ut=function(){var e=v(),t=Object(C.a)(e,1)[0].searchDistance,a=st();return r.a.createElement(r.a.Fragment,null,r.a.createElement($e.a,{component:"h2",variant:"h6",className:a.title},"Your mobile service"),r.a.createElement($e.a,{component:"p",variant:"body1",className:a.subtitle},"Search by postcode (within ",t/1609," mile/s) or select service"),r.a.createElement("div",{className:a.search},r.a.createElement(Be,null)),r.a.createElement(Ze,null))},pt=a(882),mt=a(884),dt=a(883),bt=a(500),ft=a(191),ht=a.n(ft),gt=a(545),yt=a.n(gt),Et=Object(M.a)((function(e){return{bullet:{display:"inline-block",margin:"0 2px",transform:"scale(1.2)"},card:{minWidth:275},leftIcon:{marginRight:e.spacing(1)},title:{fontSize:12,fontWeight:500,align:"right"},verticalDivider:{width:1,height:28,margin:8},progress:{margin:e.spacing(2)}}}));var vt=function(e){var t=this,a=e.mobile,n=e.organisation,o=e.location,i=v(),c=Object(C.a)(i,2);Object(_.a)(c[0]);var l=c[1],s=S(),u=Object(C.a)(s,2);Object(_.a)(u[0]);var p=u[1],m=function(e){return r.a.createElement(P.a,{color:"secondary",onClick:function(){return t=e.stopId,l({type:"SetCurrentStop",stopId:t}),void p({type:"SetStopDialog",stopDialogOpen:!0});var t}},e.stopName)},d=Et(),b=null;if(o){var f=o.getStatus();f&&"offRoad"===f.type&&(b=function(e){return r.a.createElement($e.a,null,e.message)}(f)),f&&"preRoute"===f.type&&(b=function(e){var t=m(e.args[0]);return r.a.createElement(r.a.Fragment,null,r.a.createElement($e.a,null,e.message,t,e.args[1]))}(f)),f&&"atStop"===f.type&&(b=function(e){var t=m(e.args[0]);return r.a.createElement(r.a.Fragment,null,r.a.createElement($e.a,null,e.message,t," for "+e.args[1]))}(f)),f&&"betweenStops"===f.type&&(b=function(e){var t=m(e.args[0]);return r.a.createElement(r.a.Fragment,null,r.a.createElement($e.a,null,e.message,t,e.args[1]))}(f)),f&&"postRoute"===f.type&&(b=function(e){return r.a.createElement($e.a,null,e.message)}(f))}b||(b=r.a.createElement(bt.a,{className:d.progress,color:"primary",size:30}));var h=r.a.createElement("span",{className:d.bullet},"\u2022");return r.a.createElement(pt.a,{className:d.card,elevation:0},r.a.createElement(dt.a,null,r.a.createElement($e.a,{className:d.title,gutterBottom:!0},a.numberRoutes+" route"+(a.numberRoutes>1?"s":""),h,a.numberStops+" stop"+(a.numberStops>1?"s":"")),r.a.createElement($e.a,{variant:"h6",component:"h2"},(n?n.name+" ":"")+a.name),b),r.a.createElement(mt.a,null,r.a.createElement(W.a,{title:"Mobile library stops"},r.a.createElement(P.a,{component:N.b,to:"/stops",size:"small",color:"primary",className:d.button,onClick:function(){return e=n.id,t=a.id,void l({type:"FilterByMobile",organisationId:e,mobileId:t});var e,t}},r.a.createElement(ht.a,{className:d.leftIcon}),"View stops")),r.a.createElement(Ye.a,{className:d.verticalDivider}),a.timetable?r.a.createElement(W.a,{title:"Website timetable"},r.a.createElement(B.a,{className:d.button,onClick:function(){return t.goToWebsite()}},r.a.createElement(yt.a,null))):null))},Ot=Object(M.a)((function(e){return{padding:{padding:e.spacing(0,2)},root:{flexGrow:1}}}));var jt=function(){var e=g(),t=Object(C.a)(e,2),a=t[0],o=a.organisationLookup,i=a.mobiles,c=a.mobileLookup,l=a.mobileLocationLookup,s=a.mobilesNearestLookup,u=(a.routes,a.routeLookup),p=(t[1],v()),m=Object(C.a)(p,2),d=m[0],b=d.organisationFilter,f=d.mobileFilter,h=d.routeFilter,y=d.searchType,E=d.searchDistance,O=d.searchPostcode,j=(m[1],S()),x=Object(C.a)(j,2),k=x[0].loadingMobileLocations,w=(x[1],Object(n.useState)(0)),_=Object(C.a)(w,2),N=_[0],I=_[1],F=i.filter((function(e){var t=!0;return"gps"!==y&&"postcode"!==y||(t=s[e.id]),b.length>0&&-1===b.indexOf(e.organisationId)&&(t=!1),f.length>0&&-1===f.indexOf(e.id)&&(t=!1),t})),M=F.filter((function(e){if(l[e.id]){var t=l[e.id].getStatus();return t&&"offRoad"!==t.type&&"postRoute"!==t.type}return null})),L=b.length>0?o[b[0]].name:"",P=f.length>0?c[f[0]].name:"",D=h.length>0?u[h[0]].name:"",T="Mobile library vans";""!==L&&(T="Mobile library vans serving "+L),""!==P&&(T=L+" "+P),""!==D&&(T=L+" "+D),""!==O&&(T="Mobile library vans with stops within "+Math.round(E/1609)+" mile(s) of "+O),"gps"===y&&(T="Mobile library vans with stops within "+Math.round(E/1609)+" mile(s) of your location");var B=Ot(),z=(0===N?M:F).filter((function(e){var t=!0;return b.length>0&&-1===b.indexOf(e.organisationId)&&(t=!1),f.length>0&&-1===f.indexOf(e.id)&&(t=!1),t})).filter((function(e){return"gps"!==y&&"postcode"!==y||s[e.id]}));return r.a.createElement("div",{className:B.root},r.a.createElement(ut,null),r.a.createElement(se.a,{component:"span",disableSticky:!0},T),r.a.createElement(A.a,{variant:"standard",scrollButtons:"off",value:N,indicatorColor:"secondary",onChange:function(e,t){return function(e){I(e)}(t)}},r.a.createElement(R.a,{className:B.tab,label:r.a.createElement(lt.a,{className:B.padding,color:"secondary",badgeContent:M.length},"On the road")}),r.a.createElement(R.a,{label:r.a.createElement(lt.a,{showZero:!0,className:B.padding,color:"secondary",badgeContent:F.length},"All vans")})),r.a.createElement("br",null),z.length>0?r.a.createElement(Xe.a,{container:!0,spacing:3},z.map((function(e,t){return r.a.createElement(Xe.a,{key:"grd_"+e.name.replace(" ","")+"_"+t,item:!0,xs:12,sm:6,md:4,lg:3,xl:3},r.a.createElement(vt,{mobile:e,location:l[e.id],organisation:o[e.organisationId]}))}))):k?null:r.a.createElement($e.a,{component:"p",variant:"body1"},"No mobile libraries currently on the road."))},St=a(891),xt=a(85),kt=a(547),wt=a.n(kt),_t=a(897),Ct=a(546),Nt=a.n(Ct),It=Object(M.a)((function(e){return{avatar:{margin:0},avatarOn:{margin:0,cursor:"pointer",backgroundColor:e.palette.primary.main}}}));var Ft=function(){var e=v(),t=Object(C.a)(e,1)[0].searchType,a=It();return r.a.createElement(W.a,{title:"Me"},r.a.createElement(_t.a,{className:"gps"===t?a.avatarOn:a.avatar},r.a.createElement(Nt.a,null)))},Mt=a(886),Lt=a(890),Pt=a(888),Dt=a(887),Tt=a(501),Bt=a(889),Rt=a(862),At=a(23),zt=Object(M.a)((function(){return{dialog:{border:"1px solid #E0E0E0"}}}));var Wt=function(){var e=S(),t=Object(C.a)(e,2),a=t[0],n=a.mapSettings,o=a.mapSettingsDialogOpen,i=t[1],c=function(){i({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!1})},l=zt(),s=Object(At.a)(),u=Object(Rt.a)(s.breakpoints.down("sm"));return r.a.createElement(Mt.a,{fullScreen:u,disableBackdropClick:!0,open:o,onClose:c,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:l.dialog}},r.a.createElement(Dt.a,null,"Map settings"),r.a.createElement(Pt.a,null,r.a.createElement(Tt.a,{control:r.a.createElement(Bt.a,{checked:n.authorityBoundary,onChange:function(){i({type:"ToggleMapSetting",mapSetting:"authorityBoundary"})},name:"sw_authority_boundary",color:"primary"}),label:"Library service boundaries"})),r.a.createElement(Lt.a,null,r.a.createElement(P.a,{onClick:c,color:"secondary"},"Close")))};function Jt(e,t){var a;if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(e))return 3===(a=e.substring(1).split("")).length&&(a=[a[0],a[0],a[1],a[1],a[2],a[2]]),"rgba("+[(a="0x"+a.join(""))>>16&255,a>>8&255,255&a].join(",")+", "+t+")";throw new Error("Bad Hex")}var Zt=Object(M.a)((function(e){return{fab:{margin:e.spacing(1),boxShadow:"none"}}}));var Gt=function(e){var t=S(),a=Object(C.a)(t,1)[0].mapZoom,n=e.location,o=e.organisation,i=n.getStatus(),c=a[0]<8?"small":a[0]<12?"medium":"large",l=a[0]<8?2:a[0]<12?3:4,s=Zt();return r.a.createElement(W.a,{title:i?i.textFormat:""},r.a.createElement(St.a,{size:c,className:s.fab,color:"primary",style:{backgroundColor:Jt(o.colour,.8),color:"white",border:l+"px solid #FFFFFF"}},r.a.createElement(U.a,null)))},Ht=Object(M.a)((function(e){return{settings:{position:"absolute",bottom:e.spacing(4),right:e.spacing(4)}}})),qt=a(134),Ut=Object(xt.e)({minZoom:5,maxZoom:18,customAttribution:"Contains public sector information licensed under the Open Government Licence"}),Yt=[qt.stopTiles],Xt=[qt.tripTiles],Vt=[qt.libraryAuthorityTiles];var $t=function(){var e=g(),t=Object(C.a)(e,2),a=t[0],o=a.organisations,i=a.organisationLookup,c=a.mobileLookup,l=a.mobileLocations,s=(t[1],v()),u=Object(C.a)(s,2),p=u[0],m=p.searchType,d=p.searchPosition,b=u[1],f=S(),h=Object(C.a)(f,2),y=h[0],E=y.mapZoom,O=y.mapPosition,j=y.mapSettings,x=y.mapSettingsDialogOpen,k=h[1],w=Object(n.useState)(null),_=Object(C.a)(w,2),N=_[0],I=_[1],F=Object(n.useState)(null),M=Object(C.a)(F,2),L=M[0],P=M[1];Object(n.useEffect)((function(){setInterval(T,500)}),[]);var D=function(e){e&&e.features&&e.features.length>0&&e.features[0].properties&&(b({type:"SetCurrentStop",stopId:e.features[0].properties.id}),k({type:"SetStopDialog",stopDialogOpen:!0}))},T=function(){return I(ke()())},B=["match",["get","utla19cd"]];o.forEach((function(e){B.push(e.code),B.push(e.colour)})),B.push("#a7a39b");var R=Ht(),A=l.filter((function(e){return null!==e.geoX&&null!==e.geoY}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ut,{style:"style.json",center:O,zoom:E,maxZoom:17,pitch:[0],bearing:[0],fitBounds:null,containerStyle:{top:0,bottom:0,right:0,left:0,height:"100vh",width:"100vw",position:"absolute"},onStyleLoad:function(e){return P(e)}},A&&A.length>0?A.map((function(e){var t=[e.geoX,e.geoY];if(N&&e.routeSection&&e.routeSection.coordinates&&e.updated){var a=ke()(N).diff(e.updated),n=Math.round(a/500),o=e.routeSection.coordinates;o.length>n&&n>0&&(t=o[n]),o.length<=n&&n>0&&(t=o[o.length-1])}var l=c[e.mobileId],s=l?i[l.organisationId]:null;return r.a.createElement(xt.b,{key:"mkr_"+e.id,coordinates:t,anchor:"bottom"},r.a.createElement(Gt,{organisation:s,location:e,zoom:L?L.getZoom():0}))})):null,r.a.createElement(xt.c,{id:"src_stops",tileJsonSource:{type:"vector",tiles:Yt}}),r.a.createElement(xt.c,{id:"src_trips",tileJsonSource:{type:"vector",tiles:Xt}}),r.a.createElement(xt.c,{id:"src_library_authorities",tileJsonSource:{type:"vector",tiles:Vt}}),r.a.createElement(xt.a,{id:"lyr_trips_lines",type:"line",sourceId:"src_trips",sourceLayer:"trip",minZoom:13,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-offset":["interpolate",["linear"],["zoom"],13,.5,14,1,15,2,16,3,18,10,22,20],"line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],13,.5,14,1,15,2,16,3,18,10,22,20],"line-dasharray":[2,.5]},onClick:function(e){e&&e.features&&e.features.length>0&&e.features[0].properties&&(b({type:"SetCurrentTrip",tripId:e.features[0].properties.id}),k({type:"SetTripDialog",tripDialogOpen:!0}))}}),r.a.createElement(xt.a,{id:"lyr_stops_circles",type:"circle",sourceId:"src_stops",sourceLayer:"stop",minZoom:5,layout:{},paint:{"circle-radius":["interpolate",["linear"],["zoom"],5,2,17,12],"circle-color":["get","organisation_colour"],"circle-stroke-width":["interpolate",["linear"],["zoom"],5,1,17,4],"circle-stroke-color":"#FFFFFF","circle-opacity":.7},onClick:D}),r.a.createElement(xt.a,{id:"lyr_stops_labels",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","name"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,12,17,22],"text-offset":[0,2]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:D}),r.a.createElement(xt.a,{id:"lyr_stops_next_visiting",type:"symbol",sourceId:"src_stops",sourceLayer:"stop",minZoom:13,layout:{"text-ignore-placement":!1,"text-field":["to-string",["get","next_visiting"]],"text-font":["Source Sans Pro Bold"],"text-line-height":1,"text-size":["interpolate",["linear"],["zoom"],13,10,17,16],"text-offset":[0,-2.8]},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"text-halo-blur":1,"text-color":"#6a6f73"},onClick:D}),j.authorityBoundary?r.a.createElement(r.a.Fragment,null,r.a.createElement(xt.a,{id:"lyr_library_authorities_lines",type:"line",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,layout:{"line-join":"round","line-cap":"square"},paint:{"line-color":"#a7a39b","line-opacity":1,"line-width":["interpolate",["linear"],["zoom"],6,1,22,4]}}),r.a.createElement(xt.a,{id:"lyr_library_authorities_fill",type:"fill",sourceId:"src_library_authorities",sourceLayer:"library_authority_boundaries",minZoom:6,paint:{"fill-color":B,"fill-opacity":.1}})):null,d&&d.length>1?r.a.createElement(xt.b,{key:"mk_me",coordinates:[d[0],d[1]]},r.a.createElement(Ft,{searchType:m})):null,r.a.createElement(xt.d,{position:"bottom-left"})),r.a.createElement(W.a,{title:"Map settings"},r.a.createElement(St.a,{size:"small",className:R.settings,color:"primary",style:{color:"white",border:"1px solid #FFFFFF"},onClick:function(){return k({type:"SetMapSettingsDialog",mapSettingsDialogOpen:!0})}},r.a.createElement(wt.a,null))),r.a.createElement(Wt,{mapSettings:j,mapSettingsDialogOpen:x}))},Qt=a(892),Kt=a(548),ea=a.n(Kt);var ta=function(){var e=S(),t=Object(C.a)(e,2),a=t[0],n=a.notificationOpen,o=a.notificationMessage,i=t[1],c=function(){i({type:"SetNotification",notificationOpen:!1})};return r.a.createElement(Qt.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:n,autoHideDuration:3e3,onClose:c,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},o),action:[r.a.createElement(B.a,{key:"close","aria-label":"close",onClick:c},r.a.createElement(ea.a,{color:"inherit"}))]})},aa=a(165),na=a(366),ra=a.n(na),oa=a(556),ia=a.n(oa),ca=a(555),la=a.n(ca),sa=a(554),ua=a.n(sa),pa=a(552),ma=a.n(pa),da=a(551),ba=a.n(da),fa=a(553),ha=a.n(fa),ga=a(557),ya=a.n(ga),Ea=a(293),va=a.n(Ea),Oa=a(294),ja=a.n(Oa),Sa=a(134),xa=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.routeIds=e.route_ids,this.routeNames=e.route_names,this.mobileIds=e.mobile_ids,this.mobileNames=e.mobile_names,this.organisationId=e.organisation_id,this.organisationName=e.organisation_name,this.name=e.name,this.community=e.community,this.address=e.address,this.postcode=e.postcode,this.arrivalTimes=e.arrival_times,this.departureTimes=e.departure_times,this.routeStart=ke()(e.route_start),this.routeEnd=ke()(e.route_end),this.routeDays=e.route_days,this.routeFrequencies=e.route_frequencies,this.routeSchedule=e.route_schedule.map((function(e){return ke()(e)})),this.timetable=e.timetable,this.longitude=e.longitude,this.latitude=e.latitude,this}}]),e}();function ka(e,t,a,n,r,o){return wa.apply(this,arguments)}function wa(){return(wa=Object(w.a)(k.a.mark((function e(t,a,n,r,o,i){var c,l;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Sa.api+"/stops?page="+(t.page+1)+"&limit="+t.pageSize,t.orderBy&&t.orderBy.field&&(c=c+"&sort="+t.orderBy.field+"&direction="+t.orderDirection),n.length>0&&(c=c+"&mobile_ids="+n.join("|")),a.length>0&&(c=c+"&organisation_ids="+a.join("|")),r.length>0&&(c=c+"&route_ids="+r.join("|")),o&&o.length>1&&(c=c+"&longitude="+o[0]+"&latitude="+o[1]),i&&""!==i&&(c=c+"&distance="+i),e.next=9,ye.a.get(c);case 9:if(!((l=e.sent)&&l.data&&l.data.length>0)){e.next=14;break}return e.abrupt("return",{stops:l.data.map((function(e){return(new xa).fromJson(e)})),total:parseInt(l.headers["x-total-count"]),page:parseInt(l.headers["x-page"])});case 14:return e.abrupt("return",{stops:[],total:0,page:1});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _a(e){return Ca.apply(this,arguments)}function Ca(){return(Ca=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Sa.api+"/stops/"+t);case 2:if(!(a=e.sent)||!a.data){e.next=7;break}return e.abrupt("return",(new xa).fromJson(a.data));case 7:return e.abrupt("return",{});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Na=a(134),Ia=Object(M.a)((function(e){return{formControl:{margin:e.spacing(1),minWidth:200},margin:{margin:e.spacing(1)},root:{flexGrow:1,maxWidth:"100%"},table:{backgroundColor:"rgba(0, 0, 0, 0)",border:"1px solid #E0E0E0"}}}));var Fa=function(){var e=g(),t=Object(C.a)(e,2),a=t[0],o=(a.organisations,a.organisationLookup),i=(a.mobiles,a.mobileLookup),c=a.routeLookup,l=(t[1],v()),s=Object(C.a)(l,2),u=s[0],p=u.searchType,m=u.searchPostcode,d=u.searchDistance,b=u.searchPosition,f=u.organisationFilter,h=u.mobileFilter,y=u.routeFilter,E=s[1],O=S(),j=Object(C.a)(O,2);Object(_.a)(j[0]);var x=j[1],I=r.a.createRef();Object(n.useEffect)((function(){I.current.onQueryChange()}),[b,d,f,h,y]);var F=Ia(),M=Object(At.a)(),L=f.length>0?o[f[0]].name:"",P=h.length>0?i[h[0]].name:"",D=y.length>0?c[y[0]].name:"",R="All stops";""!==L&&(R="Stops in "+L),""!==P&&(R="Stops for "+L+" "+P),""!==D&&(R="Stops for "+L+" "+D),""!==m&&(R="Stops within "+Math.round(d/1609)+" mile(s) of "+m),"gps"===p&&(R="Stops within "+Math.round(d/1609)+" mile(s) of your location");var A={};Object.keys(o).forEach((function(e){A[e]=o[e].name}));var z={};Object.keys(i).forEach((function(e){z[e]=i[e].name}));var J={};return Object.keys(c).forEach((function(e){J[e]=c[e].name})),r.a.createElement("div",{style:{maxWidth:"100%"}},r.a.createElement(ut,null),r.a.createElement(se.a,{disableSticky:!0},R),r.a.createElement(ra.a,{tableRef:I,components:{Container:function(e){return r.a.createElement(aa.a,Object.assign({},e,{elevation:0,className:F.table}))}},icons:{Filter:ba.a,FirstPage:ma.a,LastPage:ha.a,NextPage:ua.a,PreviousPage:la.a,SortArrow:ia.a},options:{padding:Object(Rt.a)(M.breakpoints.up("sm"))?"default":"dense",search:!1,loadingType:"overlay",actionsColumnIndex:0,filtering:!1,toolbar:!1,headerStyle:{backgroundColor:"#fafafa",color:"#737373",border:"0px"}},columns:[{title:"",field:"name",filtering:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(W.a,{title:"See more stop details"},r.a.createElement(B.a,{onClick:function(){return E({type:"SetCurrentStop",stopId:e.id}),void x({type:"SetStopDialog",stopDialogOpen:!0})}},r.a.createElement(ya.a,null))),r.a.createElement(T.a,{mdDown:!0},r.a.createElement(W.a,{title:"Add event to your device calendar"},r.a.createElement(B.a,{onClick:function(){return t=e,window.open(Na.api+"/stops/"+t.id+"/ics");var t}},r.a.createElement(va.a,null)))),r.a.createElement(T.a,{mdDown:!0},r.a.createElement(W.a,{title:"Download a PDF timetable for this stop"},r.a.createElement(B.a,{onClick:function(){return t=e,window.open(Na.api+"/stops/"+t.id+"/pdf","_blank");var t}},r.a.createElement(ja.a,null)))),r.a.createElement(T.a,{mdDown:!0},r.a.createElement(W.a,{title:"See this stop on the map"},r.a.createElement(B.a,{onClick:function(){return t=e.longitude,a=e.latitude,void x({type:"SetMapPosition",mapPosition:[t,a],mapZoom:15});var t,a},component:N.b,to:"/map"},r.a.createElement(ht.a,null)))))},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Name",field:"name",filtering:!1,hidden:!1,render:function(e){return e.name},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Community",field:"community",filtering:!1,cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Library service",field:"organisationName",filtering:!1,hidden:Object(Rt.a)(M.breakpoints.down("sm")),cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}},{title:"Next due",field:"routeSchedule",filtering:!1,hidden:Object(Rt.a)(M.breakpoints.down("xs")),render:function(e){return e.routeSchedule.length>0?e.routeSchedule[0].format("Do MMMM h:mma"):""},cellStyle:{borderBottom:"1px solid #f5f5f5",backgroundColor:"#ffffff"}}],data:function(e){return new Promise((function(t,a){function n(){return(n=Object(w.a)(k.a.mark((function a(){var n;return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,ka(e,f,h,y,b,d);case 2:n=a.sent,t({data:n.stops,page:n.page-1,totalCount:n.total});case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}))}}))},Ma=a(134),La=Object(M.a)((function(e){return{button:{margin:e.spacing(1)},dialog:{border:"1px solid #E0E0E0"},leftIcon:{marginRight:e.spacing(1)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},progress:{margin:e.spacing(2)}}}));var Pa=function(){var e=v(),t=Object(C.a)(e,2),a=t[0].currentStopId,o=(t[1],S()),i=Object(C.a)(o,2),c=i[0].stopDialogOpen,l=i[1],s=Object(n.useState)({}),u=Object(C.a)(s,2),p=u[0],m=u[1];Object(n.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_a(t);case 2:a=e.sent,m(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=a&&function(t){e.apply(this,arguments)}(a)}),[a]);var d=function(){l({type:"SetStopDialog",stopDialogOpen:!1})},b=Object(At.a)(),f=La(),h=Object(Rt.a)(b.breakpoints.down("sm"));return r.a.createElement(Mt.a,{fullScreen:h,disableBackdropClick:!0,open:c,onClose:d,"aria-labelledby":"dlg-title",BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:f.dialog}},p&&p.routeDays?r.a.createElement(r.a.Fragment,null,r.a.createElement(Dt.a,{id:"dlg-title"},p.name+". "+p.community),r.a.createElement(Pt.a,null,r.a.createElement(se.a,null,p.routeSchedule&&p.routeSchedule.length>0?p.routeSchedule[0].format("dddd Do MMMM h:mma"):""),r.a.createElement("br",null),r.a.createElement(Ye.a,null),r.a.createElement("br",null),r.a.createElement(P.a,{onClick:function(){return window.open(Ma.api+"/stops/"+p.id+"/ics")},className:f.button,color:"primary",startIcon:r.a.createElement(va.a,null)},"Calendar"),r.a.createElement(P.a,{onClick:function(){return window.open(Ma.api+"/stops/"+p.id+"/pdf","_blank")},className:f.button,color:"primary",startIcon:r.a.createElement(ja.a,null)},"Timetable"),r.a.createElement(P.a,{onClick:function(){l({type:"SetMapPosition",mapPosition:[p.longitude,p.latitude],mapZoom:14})},className:f.button,color:"primary",startIcon:r.a.createElement(ht.a,null),component:N.b,to:"/map"},"Map"))):r.a.createElement(bt.a,{className:f.progress,color:"primary",size:30}),r.a.createElement(Lt.a,null,r.a.createElement(P.a,{onClick:function(){return window.open(p.timetable,"_blank")},color:"primary"},"Website"),r.a.createElement(P.a,{onClick:function(){return d()},color:"secondary"},"Close")))},Da=a(134),Ta=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.originStopId=e.origin_stop_id,this.originStopName=e.origin_stop_name,this.destinationStopId=e.destination_stop_id,this.destinationStopName=e.destination_stop_name,this.distance=e.distance,this.duration=e.duration,this.routeLine=e.route_line,this}}]),e}();function Ba(e){return Ra.apply(this,arguments)}function Ra(){return(Ra=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Da.api+"/trips/"+t);case 2:if(!(a=e.sent)||!a.data){e.next=7;break}return e.abrupt("return",(new Ta).fromJson(a.data));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Aa=Object(M.a)((function(e){return{dialog:{border:"1px solid #E0E0E0"}}}));var za=function(){var e=v(),t=Object(C.a)(e,2),a=t[0].currentTripId,o=(t[1],S()),i=Object(C.a)(o,2),c=i[0].tripDialogOpen,l=i[1],s=Object(n.useState)({}),u=Object(C.a)(s,2),p=u[0],m=u[1];Object(n.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(t){var a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ba(t);case 2:a=e.sent,m(a);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}null!=a&&function(t){e.apply(this,arguments)}(a)}),[a]);var d=function(){l({type:"SetTripDialog",tripDialogOpen:!1})},b=Aa(),f=Object(At.a)(),h=Object(Rt.a)(f.breakpoints.down("sm")),g=Math.round(p.duration/60)+" mins journey time.",y=Math.round(p.distance/1609,1)+" mile(s)";return r.a.createElement(Mt.a,{fullScreen:h,disableBackdropClick:!0,open:c,onClose:d,BackdropProps:{invisible:!0},PaperProps:{elevation:0,className:b.dialog}},r.a.createElement(Dt.a,null,"Trip details"),r.a.createElement(Pt.a,null,r.a.createElement(se.a,{disableSticky:!0},"From "+p.originStopName+" to "+p.destinationStopName),r.a.createElement($e.a,{variant:"body2",component:"p"},g+" "+y)),r.a.createElement(Lt.a,null,r.a.createElement(P.a,{onClick:d,color:"secondary"},"Close")))},Wa=a(558),Ja=a.n(Wa),Za=a(559),Ga=a.n(Za),Ha=a(560),qa=a.n(Ha),Ua=a(134),Ya=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.country=e.country,this.code=e.code,this.name=e.name,this.timetable=e.timetable,this.website=e.website,this.email=e.email,this.colour=e.colour,this.logo=e.logo,this.numberMobiles=e.number_mobiles,this.numberRoutes=e.number_routes,this.numberStops=e.number_stops,this}}]),e}();function Xa(){return Va.apply(this,arguments)}function Va(){return(Va=Object(w.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get(Ua.api+"/organisations");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new Ya).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $a=a(134),Qa=function(){function e(t){Object(je.a)(this,e),Object.assign(this,t)}return Object(Se.a)(e,[{key:"fromJson",value:function(e){return this.id=e.id,this.organisationId=e.organisation_id,this.mobileId=e.mobile_id,this.name=e.name,this.frequency=e.frequency,this.start=ke()(e.start),this.end=ke()(e.end),this.timetable=e.timetable,this.numberStops=e.number_stops,this}}]),e}();function Ka(){return en.apply(this,arguments)}function en(){return(en=Object(w.a)(k.a.mark((function e(){var t;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye.a.get($a.api+"/routes");case 2:if(!((t=e.sent)&&t.data&&t.data.length>0)){e.next=7;break}return e.abrupt("return",t.data.map((function(e){return(new Qa).fromJson(e)})));case 7:return e.abrupt("return",[]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var tn=Object(M.a)((function(e){return{content:{flexGrow:1,padding:e.spacing(2)},root:{flexGrow:1}}}));var an=function(){var e=S(),t=Object(C.a)(e,1)[0],a=t.loadingOrganisations,o=t.loadingMobiles,i=t.loadingRoutes,c=t.loadingMobileLocations,l=t.loadingNearestMobiles,s=t.loadingPostcode,u=g(),p=Object(C.a)(u,2);Object(_.a)(p[0]);var m=p[1];Object(n.useEffect)((function(){function e(){return(e=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xa();case 2:t=e.sent,a={},t.forEach((function(e){a[e.id]=e})),m({type:"AddOrganisations",organisations:t,organisationLookup:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function t(){return(t=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ie();case 2:t=e.sent,a={},t.forEach((function(e){a[e.id]=e})),m({type:"AddMobiles",mobiles:t,mobileLookup:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function a(){return(a=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ka();case 2:t=e.sent,a={},t.forEach((function(e){a[e.id]=e})),m({type:"AddRoutes",routes:t,routeLookup:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(){return r.apply(this,arguments)}function r(){return(r=Object(w.a)(k.a.mark((function e(){var t,a;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Me();case 2:t=e.sent,a={},t.forEach((function(e){a[e.mobileId]=e})),m({type:"AddMobileLocations",mobileLocations:t,mobileLocationLookup:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),function(){t.apply(this,arguments)}(),function(){a.apply(this,arguments)}(),n(),setInterval((function(){n(!1)}),15e3)}),[]);var d=tn();return r.a.createElement(N.a,null,r.a.createElement("div",{className:d.root},r.a.createElement(He,{loading:a||o||i||c||l||s,site:2}),r.a.createElement(F.a,{maxWidth:"lg"},r.a.createElement("main",{className:d.content},r.a.createElement(I.Route,{path:"/",exact:!0,render:function(){return r.a.createElement(Fa,null)}}),r.a.createElement(I.Route,{path:"/mobiles",render:function(){return r.a.createElement(jt,null)}}),r.a.createElement(I.Route,{path:"/map",render:function(){return r.a.createElement($t,null)}}),r.a.createElement(I.Route,{path:"/accessibility",exact:!0,render:function(){return r.a.createElement(ct,{page:Ja.a})}}),r.a.createElement(I.Route,{path:"/data",exact:!0,render:function(){return r.a.createElement(ct,{page:Ga.a})}}),r.a.createElement(I.Route,{path:"/privacy",exact:!0,render:function(){return r.a.createElement(ct,{page:qa.a})}}),r.a.createElement(I.Route,{path:["/http:","/https:"],component:function(e){return window.location.replace(e.location.pathname.substr(1)),null}}))),r.a.createElement(F.a,{maxWidth:"lg"},r.a.createElement(tt,null)),r.a.createElement(Pa,null),r.a.createElement(za,null),r.a.createElement(ta,null)))},nn={organisations:[],organisationLookup:{},mobiles:[],mobileLookup:{},mobileLocations:[],mobileLocationLookup:{},mobilesNearest:[],mobilesNearestLookup:{},routes:[],routeLookup:{},stops:[],trips:[]},rn=function(e,t){switch(t.type){case"AddOrganisations":return Object(c.a)(Object(c.a)({},e),{},{organisations:t.organisations,organisationLookup:t.organisationLookup});case"AddMobileLocations":return Object(c.a)(Object(c.a)({},e),{},{mobileLocations:t.mobileLocations,mobileLocationLookup:t.mobileLocationLookup});case"AddRoutes":return Object(c.a)(Object(c.a)({},e),{},{routes:t.routes,routeLookup:t.routeLookup});case"AddMobiles":return Object(c.a)(Object(c.a)({},e),{},{mobiles:t.mobiles,mobileLookup:t.mobileLookup});case"UpdateMobilesNearest":return Object(c.a)(Object(c.a)({},e),{},{mobilesNearest:t.mobilesNearest,mobilesNearestLookup:t.mobilesNearestLookup});default:return e}},on={searchPostcode:"",searchType:"",searchDistance:1609,searchPosition:[],searchPositionUpdateInterval:null,organisationFilter:[],mobileFilter:[],routeFilter:[],currentStopId:null,currentTripId:null},cn=function(e,t){switch(t.type){case"SetCurrentStop":return Object(c.a)(Object(c.a)({},e),{},{currentStopId:t.stopId});case"SetCurrentTrip":return Object(c.a)(Object(c.a)({},e),{},{currentTripId:t.tripId});case"SetSearchDistance":return Object(c.a)(Object(c.a)({},e),{},{searchDistance:t.searchDistance});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{searchPostcode:t.searchPostcode,searchPosition:t.searchPosition,searchType:"postcode",organisationFilter:[],mobileFilter:[],routeFilter:[]});case"FilterByOrganisation":return Object(c.a)(Object(c.a)({},e),{},{organisationFilter:[t.organisationId],mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"FilterByMobile":return Object(c.a)(Object(c.a)({},e),{},{organisationFilter:[t.organisationId],mobileFilter:[t.mobileId],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"FilterByRoute":return Object(c.a)(Object(c.a)({},e),{},{routeFilter:[t.routeId],searchPostcode:"",searchPosition:[],searchType:""});case"ClearAll":return Object(c.a)(Object(c.a)({},e),{},{organisationFilter:[],mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"ClearMobileFilter":return Object(c.a)(Object(c.a)({},e),{},{mobileFilter:[],routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});case"ClearRouteFilter":return Object(c.a)(Object(c.a)({},e),{},{routeFilter:[],searchPostcode:"",searchPosition:[],searchType:""});default:return e}},ln={stopDialogOpen:!1,tripDialogOpen:!1,notificationOpen:!1,notificationMessage:"",mapZoom:[7],mapPosition:[-1.155414,52.691432],mapSettings:{authorityBoundary:!1},mapSettingsDialogOpen:!1,loadingOrganisations:!1,loadingMobiles:!1,loadingRoutes:!1,loadingMobileLocations:!1,loadingNearestMobiles:!1,loadingPostcode:!1},sn=function(e,t){switch(t.type){case"SetNotificationMessage":return Object(c.a)(Object(c.a)({},e),{},{notificationMessage:t.notificationMessage});case"SetNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:t.notificationOpen});case"ShowNotification":return Object(c.a)(Object(c.a)({},e),{},{notificationOpen:!0,notificationMessage:t.notificationMessage});case"SetStopDialog":return Object(c.a)(Object(c.a)({},e),{},{stopDialogOpen:t.stopDialogOpen});case"SetTripDialog":return Object(c.a)(Object(c.a)({},e),{},{tripDialogOpen:t.tripDialogOpen});case"SetMapSettingsDialog":return Object(c.a)(Object(c.a)({},e),{},{mapSettingsDialogOpen:t.mapSettingsDialogOpen});case"ToggleMapSetting":var a=e.mapSettings;return a[t.mapSetting]=!a[t.mapSetting],Object(c.a)(Object(c.a)({},e),{},{mapSettings:a});case"LoadingPostcode":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!0});case"SetPostcodeSearch":return Object(c.a)(Object(c.a)({},e),{},{loadingPostcode:!1,mapPosition:t.mapPosition,mapZoom:[13]});case"SetMapPosition":return Object(c.a)(Object(c.a)({},e),{},{mapPosition:t.mapPosition,mapZoom:[t.mapZoom]});default:return e}},un=Object(d.a)({palette:{primary:{main:m.a[900]},secondary:{main:u.a[700]}},overrides:{MuiButton:{text:{textTransform:"none"}},MuiTab:{root:{textTransform:"none"}},MuiTypography:{button:{textTransform:"none"}},MuiTableCell:{root:{borderBottom:"none"}}}});var pn=function(){return r.a.createElement(h,{initialState:nn,reducer:rn},r.a.createElement(E,{initialState:on,reducer:cn},r.a.createElement(j,{initialState:ln,reducer:sn},r.a.createElement(b.a,{theme:un},r.a.createElement(l.a,null),r.a.createElement(an,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(pn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[569,1,2]]]);
//# sourceMappingURL=main.17b369f6.chunk.js.map