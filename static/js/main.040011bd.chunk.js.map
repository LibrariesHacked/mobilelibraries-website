{"version":3,"sources":["PostcodeSearch.js","AppHeader.js","Filters.js","helpers/mobiles.js","MobileCard.js","Mobiles.js","MeAvatar.js","MobileAvatar.js","MobileMap.js","StopDetails.js","helpers/stops.js","Stops.js","helpers/geo.js","helpers/organisations.js","helpers/routes.js","App.js","serviceWorker.js","index.js"],"names":["PostcodeSearch","state","postcode","props","anchor","openSettingsMenu","e","setState","currentTarget","closeSettingsMenu","setSearchDistance","distance","setDistance","this","classes","search_type","postcodeSearch","toggleGPS","className","search","InputBase","placeholder","root","inputRoot","input","inputInput","value","onChange","target","Tooltip","title","IconButton","iconButton","onClick","color","Menu","id","anchorEl","keepMounted","open","Boolean","onClose","ListSubheader","disableSticky","MenuItem","React","Component","withStyles","theme","padding","paddingTop","spacing","paddingRight","paddingBottom","paddingLeft","width","position","border","borderRadius","shape","backgroundColor","fade","palette","common","white","marginLeft","marginRight","display","AppHeader","loading","page","AppBar","elevation","appBarTransparent","appBar","Toolbar","Hidden","xsDown","Typography","variant","noWrap","grow","CircularProgress","progress","size","smDown","Fragment","Button","setPage","leftIcon","mdUp","zIndex","drawer","borderBottom","flexGrow","hide","margin","withTheme","Filters","organisation_menu_anchor","mobile_menu_anchor","route_menu_anchor","openOrganisationMenu","element","closeOrganisationMenu","chooseOrganisation","organisation_id","setOrganisationFilter","openMobileMenu","closeMobileMenu","chooseMobile","mobile_id","setMobileFilter","openRouteMenu","closeRouteMenu","chooseRoute","route_id","setRouteFilter","organisations","organisation_lookup","organisation_filter","clearOrganisationFilter","mobiles","mobile_lookup","mobile_filter","clearMobileFilter","routes","route_lookup","route_filter","clearRouteFilter","bull","bullet","Grid","grid","container","item","xs","sm","md","lg","xl","Card","card","CardContent","gutterBottom","length","component","CardActions","button","Chip","onDelete","label","name","Math","round","sort","a","b","localeCompare","map","org","key","filter","mob","indexOf","route","transform","minWidth","marginBottom","fontSize","fontWeight","config","require","getMobileStatus","location","statuses","current_stop_id","previous_stop_id","next_stop_id","moment","next_stop_arrival","isSame","type","message","arrival","fromNow","args","stop_name","next_stop_name","stop_id","stop_remaining","current_stop_departure","current_stop_name","previous_stop_departure","MobileCard","stopButton","stop","viewStop","offRoadMessage","status","preRouteMessage","stop_button","atStopMessage","betweenStopsMessage","postRouteMessage","mobile","organisation","mobilesHelper","number_routes","number_stops","Divider","viewStopsByMobile","verticalDivider","align","height","Mobiles","viewStopsByOrganisation","mobile_location_lookup","displayStopLink","idx","replace","LinearProgress","MeAvatar","Avatar","avatarOn","avatar","cursor","primary","main","MobileAvatar","Fab","fab","boxShadow","Map","ReactMapboxGl","minZoom","maxZoom","scrollZoom","interactive","dragRotate","attributionControl","stop_tiles","trip_tiles","MobileMap","time_update_interval","current_time","componentDidMount","setInterval","setCurrentTime","clickStop","features","properties","zoom","pitch","bearing","fit_bounds","mobile_locations","style","center","fitBounds","containerStyle","top","bottom","right","left","l","location_point","geox","geoy","route_section","coordinates","updated","milliseconds_passed","diff","index","coords","tileJsonSource","tiles","sourceId","sourceLayer","layout","paint","current_position","StopDetails","getStopCalendar","window","api","getStopPdf","close","fullScreen","isWidthDown","departure","duration","humanize","Dialog","disableBackdropClick","aria-labelledby","BackdropProps","invisible","PaperProps","dialog","DialogTitle","DialogContent","List","list","ListItem","ListItemText","address","format","DialogActions","compose","withWidth","maxWidth","background","paper","Stops","tableRef","createRef","current","onQueryChange","displayStopInfo","row","prevProps","orgText","Object","keys","forEach","mobileText","routeText","components","Container","Paper","table","icons","Filter","FilterList","FirstPage","LastPage","NextPage","ChevronRight","PreviousPage","ChevronLeft","SortArrow","ArrowUpward","options","isWidthUp","loadingType","actionsColumnIndex","filtering","headerStyle","columns","field","render","rowData","Link","data","query","Promise","resolve","reject","organisation_filters","mobile_filters","route_filters","callback","url","pageSize","orderBy","orderDirection","join","axios","get","then","response","stops","total","parseInt","headers","catch","err","stopsHelper","stopData","totalCount","formControl","getCurrentPosition","navigator","geolocation","pos","longitude","latitude","enableHighAccuracy","timeout","maximumAge","createMuiTheme","blue","secondary","blueGrey","overrides","MuiButton","text","textTransform","App","stop_dialog_open","current_stop","location_timer","position_update_interval","loading_gps","loading_mobiles","loading_organisations","loading_postcode","loading_routes","getOrganisations","getMobiles","getRoutes","getMobileLocations","locations","openStopDialog","closeStopDialog","viewStopsByRoute","logPosition","geoHelper","new_state","clearInterval","result","MuiThemeProvider","CssBaseline","content","toolbar","alignItems","justifyContent","mixins","hostname","match","ReactDOM","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.040011bd.chunk.js","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputBase from '@material-ui/core/InputBase';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport { fade } from '@material-ui/core/styles/colorManipulator';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Material icons\r\nimport LocationSearchingIcon from '@material-ui/icons/LocationSearching';\r\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\n\r\nconst styles = theme => ({\r\n\ticonButton: {\r\n\t\tpadding: 10\r\n\t},\r\n\tinputRoot: {\r\n\t\tcolor: 'inherit'\r\n\t},\r\n\tinputInput: {\r\n\t\tpaddingTop: theme.spacing(),\r\n\t\tpaddingRight: theme.spacing(),\r\n\t\tpaddingBottom: theme.spacing(),\r\n\t\tpaddingLeft: theme.spacing(2),\r\n\t\twidth: 80\r\n\t},\r\n\tsearch: {\r\n\t\tposition: 'relative',\r\n\t\tborder: '1px solid #e5e5e5',\r\n\t\tborderRadius: theme.shape.borderRadius,\r\n\t\tbackgroundColor: fade(theme.palette.common.white, 0.8),\r\n\t\t'&:hover': {\r\n\t\t\tbackgroundColor: fade(theme.palette.common.white, 0.9),\r\n\t\t},\r\n\t\tmarginLeft: 0,\r\n\t\tmarginRight: theme.spacing(),\r\n\t\tdisplay: 'flex'\r\n\t}\r\n});\r\n\r\nclass PostcodeSearch extends React.Component {\r\n\tstate = {\r\n\t\tpostcode: this.props.postcode,\r\n\t\tanchor: null\r\n\t}\r\n\r\n\topenSettingsMenu = (e) => this.setState({ anchor: e.currentTarget })\r\n\tcloseSettingsMenu = () => this.setState({ anchor: null })\r\n\r\n\tsetSearchDistance = (distance) => {\r\n\t\tthis.closeSettingsMenu();\r\n\t\tthis.props.setDistance(distance);\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, search_type, postcodeSearch, toggleGPS } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.search}>\r\n\t\t\t\t<InputBase\r\n\t\t\t\t\tplaceholder=\"Postcode\"\r\n\t\t\t\t\tclasses={{\r\n\t\t\t\t\t\troot: classes.inputRoot,\r\n\t\t\t\t\t\tinput: classes.inputInput\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tvalue={this.state.postcode}\r\n\t\t\t\t\tonChange={(e) => this.setState({ postcode: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t<Tooltip title={'Search by postcode'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tonClick={() => postcodeSearch(this.state.postcode)}>\r\n\t\t\t\t\t\t<SearchIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Track my location'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor={search_type === 'gps' ? 'primary' : 'secondary'}\r\n\t\t\t\t\t\tonClick={() => { toggleGPS() }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{search_type === 'gps' ? <MyLocationIcon /> : <LocationSearchingIcon />}\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Tooltip title={'Change search settings'}>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tclassName={classes.iconButton}\r\n\t\t\t\t\t\tcolor=\"secondary\"\r\n\t\t\t\t\t\tonClick={(e) => { this.openSettingsMenu(e) }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<SettingsIcon />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Tooltip>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"mnu-settings\"\r\n\t\t\t\t\tanchorEl={this.state.anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.anchor)}\r\n\t\t\t\t\tonClose={() => this.closeSettingsMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ListSubheader disableSticky={true}>Search distance</ListSubheader>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(1609)}>1 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(3219)}>2 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(4828)}>3 mile</MenuItem>\r\n\t\t\t\t\t<MenuItem onClick={() => this.setSearchDistance(8047)}>5 miles</MenuItem>\r\n\t\t\t\t</Menu>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nPostcodeSearch.propTypes = {\r\n\tclasses: PropTypes.object.isRequired,\r\n};\r\n\r\nexport default withStyles(styles)(PostcodeSearch);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Hidden from '@material-ui/core/Hidden';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material Icons\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\nimport MapIcon from '@material-ui/icons/Map';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = theme => ({\r\n\tappBar: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tborderBottom: '1px solid #F5F5F5'\r\n\t},\r\n\tappBarTransparent: {\r\n\t\tzIndex: theme.zIndex.drawer + 1,\r\n\t\tbackgroundColor: 'rgba(250, 250, 250, 0.5)',\r\n\t\tborderBottom: '1px solid #F5F5F5'\r\n\t},\r\n\tgrow: {\r\n\t\tflexGrow: 1\r\n\t},\r\n\thide: {\r\n\t\tdisplay: 'none'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(1)\r\n\t}\r\n});\r\n\r\nclass AppHeader extends Component {\r\n\r\n\trender() {\r\n\t\tconst { loading, classes, search_type, postcode, distance, toggleGPS, postcodeSearch, setDistance, page } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<AppBar\r\n\t\t\t\tposition=\"fixed\"\r\n\t\t\t\tcolor=\"inherit\"\r\n\t\t\t\televation={0}\r\n\t\t\t\tclassName={(page === 'map' ? classes.appBarTransparent : classes.appBar)}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar>\r\n\t\t\t\t\t{page !== 'map' ?\r\n\t\t\t\t\t\t<Hidden xsDown>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" noWrap>Mobiles</Typography>\r\n\t\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t\t<div className={classes.grow} />\r\n\t\t\t\t\t{loading ? <CircularProgress className={classes.progress} color=\"secondary\" size={30} /> : null}\r\n\t\t\t\t\t{page === 'map' ? \r\n\t\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t<Hidden smDown>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'mobiles' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('mobiles')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<DashboardIcon className={classes.leftIcon} />Dashboard\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'stops' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('stops')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t<Button color=\"secondary\" variant={this.props.page === 'map' ? 'text' : 'text'}\r\n\t\t\t\t\t\t\t\tonClick={() => this.props.setPage('map')}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<MapIcon className={classes.leftIcon} />Map\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t\t<Hidden mdUp>\r\n\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('mobiles')}>\r\n\t\t\t\t\t\t\t\t<DashboardIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('stops')}>\r\n\t\t\t\t\t\t\t\t<LocationOnIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t<IconButton onClick={() => this.props.setPage('map')}>\r\n\t\t\t\t\t\t\t\t<MapIcon />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t</Hidden>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t</AppBar>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nAppHeader.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(AppHeader);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport Chip from '@material-ui/core/Chip';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Menu from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport BusinessIcon from '@material-ui/icons/Business';\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\nimport DirectionsIcon from '@material-ui/icons/Directions';\r\n\r\nimport PostcodeSearch from './PostcodeSearch';\r\n\r\nconst styles = (theme) => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tposition: 'relative',\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid #F5F5F5'\r\n\t},\r\n\tgrid: {\r\n\t\tmarginBottom: 10\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500\r\n\t}\r\n});\r\n\r\nclass Filters extends Component {\r\n\r\n\tstate = {\r\n\t\torganisation_menu_anchor: null,\r\n\t\tmobile_menu_anchor: null,\r\n\t\troute_menu_anchor: null\r\n\t};\r\n\r\n\topenOrganisationMenu = (element) => {\r\n\t\tthis.setState({ organisation_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseOrganisationMenu = () => {\r\n\t\tthis.setState({ organisation_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseOrganisation = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.closeOrganisationMenu();\r\n\t}\r\n\r\n\topenMobileMenu = (element) => {\r\n\t\tthis.setState({ mobile_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseMobileMenu = () => {\r\n\t\tthis.setState({ mobile_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseMobile = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.closeMobileMenu();\r\n\t}\r\n\r\n\topenRouteMenu = (element) => {\r\n\t\tthis.setState({ route_menu_anchor: element });\r\n\t}\r\n\r\n\tcloseRouteMenu = () => {\r\n\t\tthis.setState({ route_menu_anchor: null });\r\n\t}\r\n\r\n\tchooseRoute = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.closeRouteMenu();\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter,\r\n\t\t\tclearOrganisationFilter, mobiles, mobile_lookup, mobile_filter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, distance, toggleGPS, postcodeSearch, setDistance\r\n\t\t} = this.props;\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\r\n\t\treturn (\r\n\t\t\t<Grid className={classes.grid} container spacing={3}>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{organisations.length + ' library services'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{mobiles.length + ' mobile libraries'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{routes.length + ' routes'}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">Select by service</Typography>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t<CardActions>\r\n\t\t\t\t\t\t\t{organisation_filter.length === 0 ? <Tooltip title=\"Choose library service\">\r\n\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openOrganisationMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t<BusinessIcon className={classes.leftIcon} />Service\r\n\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={clearOrganisationFilter} label={organisation_lookup[organisation_filter[0]].name} />\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t{organisation_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(mobile_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose mobile library\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openMobileMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionBusIcon className={classes.leftIcon} />Mobile\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearMobileFilter()} label={mobile_lookup[mobile_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t\t{mobile_filter.length > 0 ?\r\n\t\t\t\t\t\t\t\t(route_filter.length === 0 ?\r\n\t\t\t\t\t\t\t\t\t<Tooltip title=\"Choose route\">\r\n\t\t\t\t\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={(e) => this.openRouteMenu(e.currentTarget)}>\r\n\t\t\t\t\t\t\t\t\t\t\t<DirectionsIcon className={classes.leftIcon} />Route\r\n\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t</Tooltip> :\r\n\t\t\t\t\t\t\t\t\t<Chip size=\"small\" color=\"secondary\" onDelete={(e) => clearRouteFilter()} label={route_lookup[route_filter[0]].name} />\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t: null}\r\n\t\t\t\t\t\t</CardActions>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Grid item xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t\t\t{Math.round(distance / 1609) + ' mile radius'}\r\n\t\t\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t\t\t{'GPS tracking ' + (search_type === 'gps' ? 'on' : 'off')}\r\n\t\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">Search by location</Typography>\r\n\t\t\t\t\t\t\t<PostcodeSearch\r\n\t\t\t\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Grid>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-library-service\"\r\n\t\t\t\t\tanchorEl={this.state.organisation_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.organisation_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeOrganisationMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{organisations\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(org => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_org_' + org.id} onClick={() => this.chooseOrganisation(org.id)}>{org.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-mobile-library\"\r\n\t\t\t\t\tanchorEl={this.state.mobile_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.mobile_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeMobileMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(mob => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_mob_' + mob.id} onClick={() => this.chooseMobile(mob.id)}>{mob.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\t\t\t\t<Menu\r\n\t\t\t\t\tid=\"menu-route\"\r\n\t\t\t\t\tanchorEl={this.state.route_menu_anchor}\r\n\t\t\t\t\tkeepMounted\r\n\t\t\t\t\topen={Boolean(this.state.route_menu_anchor)}\r\n\t\t\t\t\tonClose={() => this.closeRouteMenu()}\r\n\t\t\t\t>\r\n\t\t\t\t\t{routes\r\n\t\t\t\t\t\t.filter(route => {\r\n\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\tmobile_filter.indexOf(route.mobile_id) === -1) {\r\n\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name))\r\n\t\t\t\t\t\t.map(route => {\r\n\t\t\t\t\t\t\treturn <MenuItem key={'mnu_itm_route_' + route.id} onClick={() => this.chooseRoute(route.id)}>{route.name}</MenuItem>\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t</Menu>\r\n\r\n\t\t\t</Grid>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nFilters.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(Filters);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// Moment for time calculations\r\nimport moment from 'moment';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllMobiles(callback) {\r\n\taxios.get(config.api + '/mobiles')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileLocations(callback) {\r\n\taxios.get(config.api + '/mobiles/locations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}\r\n\r\nexport function getMobileStatus(location) {\r\n\r\n\tlet statuses = {\r\n\t\toff_road: {\r\n\t\t\tlabel: \"Not out today\"\r\n\t\t},\r\n\t\tpre_route: {\r\n\t\t\tlabel: \"Arriving at \",\r\n\t\t},\r\n\t\tat_stop: {\r\n\t\t\tlabel: \"At\"\r\n\t\t},\r\n\t\tbetween_stops: {\r\n\t\t\tlabel: \"Arriving at \"\r\n\t\t},\r\n\t\tpost_route: {\r\n\t\t\tlabel: \"Finished for the day\"\r\n\t\t}\r\n\t}\r\n\r\n\t// The mobile is not due out today\r\n\tif (location && !location.current_stop_id &&\r\n\t\t!location.previous_stop_id && location.next_stop_id &&\r\n\t\t!moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\treturn {\r\n\t\t\ttype: 'off_road',\r\n\t\t\tmessage: statuses.off_road.label\r\n\t\t};\r\n\t}\r\n\r\n\t// The mobile is due out today\r\n\tif (location && !location.current_stop_id &&\r\n\t\t!location.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\tconst arrival = moment(location.next_stop_arrival).fromNow();\r\n\t\treturn {\r\n\t\t\ttype: 'pre_route',\r\n\t\t\tmessage: statuses.pre_route.label,\r\n\t\t\targs: [\r\n\t\t\t\t{ stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n\t\t\t\tarrival\r\n\t\t\t]\r\n\t\t};\r\n\t}\r\n\r\n\t// The mobile is at a stop, and will be for a certain amount of time\r\n\tif (location && location.current_stop_id) {\r\n\t\tconst stop_remaining = moment(location.current_stop_departure).fromNow(true);\r\n\t\treturn {\r\n\t\t\ttype: 'at_stop',\r\n\t\t\tmessage: statuses.at_stop.label,\r\n\t\t\targs: [\r\n\t\t\t\t{ stop_name: location.current_stop_name, stop_id: location.current_stop_id },\r\n\t\t\t\tstop_remaining\r\n\t\t\t]\r\n\t\t};\r\n\t}\r\n\r\n\t// The mobile is between stops\r\n\tif (location && !location.current_stop_id &&\r\n\t\tlocation.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n\t\tmoment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\tconst arrival = moment(location.next_stop_arrival).fromNow();\r\n\t\treturn {\r\n\t\t\ttype: 'between_stops',\r\n\t\t\tmessage: statuses.between_stops.label,\r\n\t\t\targs: [\r\n\t\t\t\t{ stop_name: location.next_stop_name, stop_id: location.next_stop_id },\r\n\t\t\t\tarrival\r\n\t\t\t]\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t// The mobile has finished for the day\r\n\tif (location &&\r\n\t\tlocation.previous_stop_id && location.next_stop_id &&\r\n\t\tmoment(location.previous_stop_departure).isSame(moment(), 'day') &&\r\n\t\t!moment(location.next_stop_arrival).isSame(moment(), 'day')) {\r\n\t\treturn {\r\n\t\t\ttype: 'post_route',\r\n\t\t\tmessage: statuses.post_route.label\r\n\t\t};\r\n\r\n\t}\r\n\r\n\treturn null;\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Button from '@material-ui/core/Button';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Typography from '@material-ui/core/Typography';\r\n\r\n// MUI Icons\r\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tbullet: {\r\n\t\tdisplay: 'inline-block',\r\n\t\tmargin: '0 2px',\r\n\t\ttransform: 'scale(0.8)'\r\n\t},\r\n\tcard: {\r\n\t\tminWidth: 275,\r\n\t\tborder: '1px solid #F5F5F5'\r\n\t},\r\n\tleftIcon: {\r\n\t\tmarginRight: theme.spacing(1)\r\n\t},\r\n\ttitle: {\r\n\t\tfontSize: 12,\r\n\t\tfontWeight: 500,\r\n\t\talign: 'right'\r\n\t},\r\n\tverticalDivider: {\r\n\t\twidth: 1,\r\n\t\theight: 28,\r\n\t\tmargin: 8\r\n\t},\r\n\tprogress: {\r\n\t\tmargin: theme.spacing(2),\r\n\t}\r\n});\r\n\r\nclass MobileCard extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\tstopButton = (stop) => {\r\n\t\treturn <Button color=\"secondary\" onClick={() => this.props.viewStop({ id: stop.stop_id })}>{stop.stop_name}</Button>\r\n\t}\r\n\r\n\toffRoadMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\tpreRouteMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tatStopMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tbetweenStopsMessage = (status) => {\r\n\t\tconst stop_button = this.stopButton(status.args[0]);\r\n\t\treturn (\r\n\t\t\t<React.Fragment>\r\n\t\t\t\t<Typography>\r\n\t\t\t\t\t{status.message}\r\n\t\t\t\t\t{stop_button}\r\n\t\t\t\t\t{status.args[1]}\r\n\t\t\t\t</Typography>\r\n\t\t\t</React.Fragment>\r\n\t\t)\r\n\t}\r\n\r\n\tpostRouteMessage = (status) => {\r\n\t\treturn (\r\n\t\t\t<Typography>{status.message}</Typography>\r\n\t\t)\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes, mobile, organisation, location } = this.props;\r\n\t\tlet status = mobilesHelper.getMobileStatus(location);\r\n\t\tif (status && status.type === 'off_road') status = this.offRoadMessage(status);\r\n\t\tif (status && status.type === 'pre_route') status = this.preRouteMessage(status);\r\n\t\tif (status && status.type === 'at_stop') status = this.atStopMessage(status);\r\n\t\tif (status && status.type === 'between_stops') status = this.betweenStopsMessage(status);\r\n\t\tif (status && status.type === 'post_route') status = this.postRouteMessage(status);\r\n\t\tif (!status) status = <CircularProgress className={classes.progress} color=\"secondary\" size={30} />\r\n\t\tconst bull = <span className={classes.bullet}>•</span>;\r\n\t\treturn (\r\n\t\t\t<Card className={classes.card} elevation={0}>\r\n\t\t\t\t<CardContent>\r\n\t\t\t\t\t<Typography className={classes.title} color=\"textSecondary\" gutterBottom>\r\n\t\t\t\t\t\t{mobile.number_routes + ' route' + (mobile.number_routes > 1 ? 's' : '')}\r\n\t\t\t\t\t\t{bull}\r\n\t\t\t\t\t\t{mobile.number_stops + ' stop' + (mobile.number_stops > 1 ? 's' : '')}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography variant=\"h6\" component=\"h2\">{(organisation ? organisation.name + ' ' : '') + mobile.name}</Typography>\r\n\t\t\t\t\t{status}\r\n\t\t\t\t</CardContent>\r\n\t\t\t\t<Divider variant=\"middle\" />\r\n\t\t\t\t<CardActions>\r\n\t\t\t\t\t<Tooltip title=\"Mobile library stops\">\r\n\t\t\t\t\t\t<Button size=\"small\" color=\"primary\" className={classes.button} onClick={() => this.props.viewStopsByMobile(organisation.id, mobile.id)}>\r\n\t\t\t\t\t\t\t<LocationOnIcon className={classes.leftIcon} />Stops\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t<Divider className={classes.verticalDivider} />\r\n\t\t\t\t</CardActions>\r\n\t\t\t</Card>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileCard.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileCard);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Grid from '@material-ui/core/Grid';\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\nimport MobileCard from './MobileCard';\r\n\r\nconst styles = () => ({\r\n\troot: {\r\n\t\tflexGrow: 1\r\n\t}\r\n});\r\n\r\nclass Mobiles extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, organisations, organisation_lookup, organisation_filter, setOrganisationFilter, clearOrganisationFilter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_location_lookup, mobile_filter, setMobileFilter, clearMobileFilter,\r\n\t\t\troutes, route_lookup, route_filter, setRouteFilter, clearRouteFilter,\r\n\t\t\tsearch_type, postcode, distance, toggleGPS, postcodeSearch, setDistance } = this.props;\r\n\t\treturn (\r\n\t\t\t<div className={classes.root}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={true}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListSubheader disableSticky={true}>Mobile library dashboard</ListSubheader>\r\n\t\t\t\t{mobiles && mobiles.length > 0 ?\r\n\t\t\t\t\t<Grid container spacing={3}>\r\n\t\t\t\t\t\t{mobiles\r\n\t\t\t\t\t\t\t.filter(mob => {\r\n\t\t\t\t\t\t\t\tlet display = true;\r\n\t\t\t\t\t\t\t\tif (organisation_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\torganisation_filter.indexOf(mob.organisation_id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (mobile_filter.length > 0 &&\r\n\t\t\t\t\t\t\t\t\tmobile_filter.indexOf(mob.id) === -1) {\r\n\t\t\t\t\t\t\t\t\tdisplay = false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn display;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.map((mobile, idx) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Grid\r\n\t\t\t\t\t\t\t\t\t\tkey={'grd_' + mobile.name.replace(' ', '') + '_' + idx}\r\n\t\t\t\t\t\t\t\t\t\titem xs={12} sm={6} md={4} lg={3} xl={2}>\r\n\t\t\t\t\t\t\t\t\t\t<MobileCard\r\n\t\t\t\t\t\t\t\t\t\t\tmobile={mobile}\r\n\t\t\t\t\t\t\t\t\t\t\tlocation={mobile_location_lookup[mobile.id]}\r\n\t\t\t\t\t\t\t\t\t\t\torganisation={organisation_lookup[mobile.organisation_id]}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStop={this.props.viewStop}\r\n\t\t\t\t\t\t\t\t\t\t\tviewStopsByMobile={this.props.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Grid>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t</Grid> :\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t<LinearProgress color=\"secondary\" />\r\n\t\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobiles.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(Mobiles);","// React and additional\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// Icons\r\nimport Face from '@material-ui/icons/Face';\r\n\r\nconst styles = theme => ({\r\n    avatar: {\r\n        margin: 0\r\n    },\r\n    avatarOn: {\r\n        margin: 0,\r\n        cursor: 'pointer',\r\n        backgroundColor: theme.palette.primary.main\r\n    }\r\n});\r\n\r\nclass MeAvatar extends React.Component {\r\n    state = {\r\n    }\r\n\r\n    render() {\r\n        const { classes } = this.props;\r\n\r\n        return (\r\n            <Tooltip title={'Me'}>\r\n                <Avatar\r\n                    className={this.props.search_type === 'gps' ? classes.avatarOn : classes.avatar}>\r\n                    <Face />\r\n                </Avatar>\r\n            </Tooltip>\r\n        );\r\n    }\r\n}\r\n\r\nMeAvatar.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default withStyles(styles, { withTheme: true })(MeAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\n// MUI Icons\r\nimport DirectionBusIcon from '@material-ui/icons/DirectionsBus';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Helpers\r\nimport * as mobilesHelper from './helpers/mobiles';\r\n\r\nconst styles = theme => ({\r\n\tfab: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tboxShadow: 'none'\r\n\t}\r\n});\r\n\r\nclass MobileAvatar extends Component {\r\n\tstate = {\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { classes, location, mobile } = this.props;\r\n\t\treturn (\r\n\t\t\t<Tooltip\r\n\t\t\t\ttitle={mobilesHelper.getMobileStatus(mobile, location)}>\r\n\t\t\t\t<Fab size=\"small\" color=\"primary\" className={classes.fab}>\r\n\t\t\t\t\t<DirectionBusIcon />\r\n\t\t\t\t</Fab>\r\n\t\t\t</Tooltip>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileAvatar.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(MobileAvatar);","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Mapbox GL\r\nimport ReactMapboxGl, { ZoomControl, Source, Layer, Marker } from \"react-mapbox-gl\";\r\n\r\n// Our components\r\nimport MeAvatar from './MeAvatar';\r\nimport MobileAvatar from './MobileAvatar';\r\n\r\nimport moment from 'moment';\r\n\r\nconst Map = ReactMapboxGl({\r\n\tminZoom: 5,\r\n\tmaxZoom: 18,\r\n\tscrollZoom: true,\r\n\tinteractive: true,\r\n\tdragRotate: true,\r\n\tattributionControl: true\r\n});\r\n\r\nconst stop_tiles = ['https://api.mobilelibraries.org/api/stops/{z}/{x}/{y}.mvt'];\r\nconst trip_tiles = ['https://api.mobilelibraries.org/api/trips/{z}/{x}/{y}.mvt'];\r\n\r\nclass MobileMap extends Component {\r\n\r\n\tstate = {\r\n\t\ttime_update_interval: null,\r\n\t\tcurrent_time: null\r\n\t}\r\n\r\n\tcomponentDidMount = () => {\r\n\t\t// Set up interval to provide a date every 500 milliseconds\r\n\t\tlet time_update_interval = setInterval(this.setCurrentTime, 500);\r\n\t\tthis.setState({ time_update_interval: time_update_interval });\r\n\t}\r\n\r\n\tclickStop = (map) => {\r\n\t\tif (map && map.features && map.features.length > 0 && map.features[0].properties){\r\n\t\t\tthis.props.viewStop({ id: map.features[0].properties.id });\r\n\t\t}\r\n\t}\r\n\r\n\tsetCurrentTime = () => this.setState({ current_time: moment() });\r\n\r\n\trender() {\r\n\t\tconst { position, zoom, pitch, bearing, fit_bounds, mobile_locations, mobile_lookup } = this.props;\r\n\r\n\t\treturn (\r\n\t\t\t<Map\r\n\t\t\t\tstyle='style.json'  // eslint-disable-line react/style-prop-object\r\n\t\t\t\tcenter={position}\r\n\t\t\t\tzoom={zoom}\r\n\t\t\t\tmaxZoom={17}\r\n\t\t\t\tpitch={pitch}\r\n\t\t\t\tbearing={bearing}\r\n\t\t\t\tfitBounds={fit_bounds}\r\n\t\t\t\tcontainerStyle={{ top: 0, bottom: 0, right: 0, left: 0, height: '100vh', width: '100vw', position: 'absolute' }}\r\n\t\t\t>\r\n\t\t\t\t{ // The mobile library locations\r\n\t\t\t\t\tmobile_locations && mobile_locations.length > 0 ?\r\n\t\t\t\t\t\tmobile_locations.map(l => {\r\n\t\t\t\t\t\t\tlet location_point = [l.geox, l.geoy];\r\n\t\t\t\t\t\t\tif (this.state.current_time && l.route_section && l.route_section.coordinates && l.updated) {\r\n\t\t\t\t\t\t\t\tconst milliseconds_passed = moment(this.state.current_time).diff(l.updated);\r\n\t\t\t\t\t\t\t\tconst index = Math.round(milliseconds_passed / 500);\r\n\t\t\t\t\t\t\t\tconst coords = l.route_section.coordinates;\r\n\t\t\t\t\t\t\t\tif (coords.length > index && index > 0) location_point = coords[index];\r\n\t\t\t\t\t\t\t\tif (coords.length <= index && index > 0) location_point = coords[coords.length - 1];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn <Marker\r\n\t\t\t\t\t\t\t\tkey={'mkr_' + l.id}\r\n\t\t\t\t\t\t\t\tcoordinates={location_point}\r\n\t\t\t\t\t\t\t\tanchor=\"bottom\">\r\n\t\t\t\t\t\t\t\t<MobileAvatar\r\n\t\t\t\t\t\t\t\t\tmobile={mobile_lookup[l.mobile_id]}\r\n\t\t\t\t\t\t\t\t\tlocation={l}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Marker>\r\n\t\t\t\t\t\t}) : null\r\n\t\t\t\t}\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_stops'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: stop_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Source\r\n\t\t\t\t\tid='src_trips'\r\n\t\t\t\t\ttileJsonSource={{\r\n\t\t\t\t\t\ttype: 'vector',\r\n\t\t\t\t\t\ttiles: trip_tiles\r\n\t\t\t\t\t}} />\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_trips_lines'\r\n\t\t\t\t\ttype='line'\r\n\t\t\t\t\tsourceId='src_trips'\r\n\t\t\t\t\tsourceLayer='trip'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t\"line-join\": \"round\",\r\n\t\t\t\t\t\t\"line-cap\": \"square\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"line-color\": \"#a7a39b\",\r\n\t\t\t\t\t\t\"line-opacity\": 1,\r\n\t\t\t\t\t\t\"line-width\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 0.5,\r\n\t\t\t\t\t\t\t14, 1,\r\n\t\t\t\t\t\t\t15, 2,\r\n\t\t\t\t\t\t\t16, 3,\r\n\t\t\t\t\t\t\t18, 10,\r\n\t\t\t\t\t\t\t22, 20\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"line-dasharray\": [\r\n\t\t\t\t\t\t\t2,\r\n\t\t\t\t\t\t\t0.5\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_circles'\r\n\t\t\t\t\ttype='circle'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={7}\r\n\t\t\t\t\tlayout={{}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t'circle-radius': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 2,\r\n\t\t\t\t\t\t\t17, 10\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-color': '#607d8b',\r\n\t\t\t\t\t\t'circle-stroke-width': [\r\n\t\t\t\t\t\t\t'interpolate',\r\n\t\t\t\t\t\t\t['linear'],\r\n\t\t\t\t\t\t\t['zoom'],\r\n\t\t\t\t\t\t\t5, 1,\r\n\t\t\t\t\t\t\t14, 2\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t'circle-stroke-color': '#FFFFFF',\r\n\t\t\t\t\t\t'circle-opacity': 0.8\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickStop}\r\n\t\t\t\t/>\r\n\t\t\t\t<Layer\r\n\t\t\t\t\tid='lyr_stops_labels'\r\n\t\t\t\t\ttype='symbol'\r\n\t\t\t\t\tsourceId='src_stops'\r\n\t\t\t\t\tsourceLayer='stop'\r\n\t\t\t\t\tminZoom={13}\r\n\t\t\t\t\tlayout={{\r\n\t\t\t\t\t\t'text-ignore-placement': false,\r\n\t\t\t\t\t\t'text-field': ['to-string', ['get', 'name']],\r\n\t\t\t\t\t\t\"text-font\": [\r\n\t\t\t\t\t\t\t\"Source Sans Pro Bold\"\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-line-height\": 1,\r\n\t\t\t\t\t\t\"text-size\": [\r\n\t\t\t\t\t\t\t\"interpolate\",\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"linear\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\"zoom\"\r\n\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t13, 10,\r\n\t\t\t\t\t\t\t17, 22\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"text-offset\": [0, 1.7],\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tpaint={{\r\n\t\t\t\t\t\t\"text-halo-color\": \"hsl(0, 0%, 100%)\",\r\n\t\t\t\t\t\t\"text-halo-width\": 1,\r\n\t\t\t\t\t\t\"text-halo-blur\": 1,\r\n\t\t\t\t\t\t\"text-color\": \"#6a6f73\"\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClick={this.clickStop}\r\n\t\t\t\t/>\r\n\t\t\t\t{this.props.current_position && this.props.current_position.length > 1 ?\r\n\t\t\t\t\t<Marker\r\n\t\t\t\t\t\tkey={'mk_me'}\r\n\t\t\t\t\t\tcoordinates={[this.props.current_position[0], this.props.current_position[1]]}>\r\n\t\t\t\t\t\t<MeAvatar search_type={this.props.search_type} />\r\n\t\t\t\t\t</Marker>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t<ZoomControl position=\"bottom-right\" />\r\n\t\t\t</Map>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nMobileMap.propTypes = {\r\n\tcurrent_position: PropTypes.array\r\n}\r\n\r\nexport default MobileMap;","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport compose from 'recompose/compose';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport ListSubheader from '@material-ui/core/ListSubheader';\r\n\r\nimport withWidth, { isWidthDown } from '@material-ui/core/withWidth';\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\nconst config = require('./helpers/config.json');\r\n\r\nconst styles = theme => ({\r\n    dialog: {\r\n        border: '1px solid #e5e5e5'\r\n    },\r\n    list: {\r\n        width: '100%',\r\n        maxWidth: 360,\r\n        backgroundColor: theme.palette.background.paper\r\n    },\r\n});\r\n\r\nclass StopDetails extends React.Component {\r\n    state = {}\r\n\r\n    getStopCalendar = () => window.open(config.api + '/stops/' + this.props.stop.id + '/ics');\r\n    getStopPdf = () => window.open(config.api + '/stops/' + this.props.stop.id + '/pdf', '_blank');\r\n\r\n    close = () => { this.props.close() }\r\n\r\n    render() {\r\n        const { classes, width, stop } = this.props;\r\n        const fullScreen = isWidthDown('sm', width);\r\n        const arrival = moment(stop.arrival, 'HH:mm:ssZ');\r\n        const departure = moment(stop.departure, 'HH:mm:ssZ');\r\n        const duration = moment.duration(departure.diff(arrival)).humanize()\r\n        return (\r\n            <Dialog\r\n                fullScreen={fullScreen}\r\n                disableBackdropClick={true}\r\n                open={this.props.open}\r\n                onClose={this.close}\r\n                aria-labelledby=\"responsive-dialog-title\"\r\n                BackdropProps={\r\n                    {\r\n                        invisible: true\r\n                    }\r\n                }\r\n                PaperProps={\r\n                    {\r\n                        elevation: 0,\r\n                        className: classes.dialog\r\n                    }\r\n                }\r\n            >\r\n                <DialogTitle id=\"responsive-dialog-title\">{stop.name}</DialogTitle>\r\n                <DialogContent>\r\n                    <List className={classes.list}>\r\n                        <ListSubheader>{duration + ' visit'}</ListSubheader>\r\n                        <ListItem>\r\n                            <ListItemText primary={stop.address} />\r\n                        </ListItem>\r\n                        <ListItem>\r\n                            <ListItemText primary={arrival.format('h:mma') + ' - ' + departure.format('h:mma')} />\r\n                        </ListItem>\r\n                    </List>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={() => this.getStopCalendar()} color=\"primary\">Add to calendar</Button>\r\n                    <Button onClick={() => this.getStopPdf()} color=\"primary\">Get PDF</Button>\r\n                    <Button onClick={() => this.close()} color=\"secondary\">Close</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        );\r\n    }\r\n}\r\n\r\nStopDetails.propTypes = {\r\n    classes: PropTypes.object.isRequired\r\n};\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(StopDetails);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getQueryStops(query, organisation_filters, mobile_filters, route_filters, current_position, distance, callback) {\r\n\r\n\tlet url = config.api + '/stops?page=' + (query.page + 1) + '&limit=' + query.pageSize;\r\n\tif (query.orderBy && query.orderBy.field) url = url + '&sort=' + query.orderBy.field + '&direction=' + query.orderDirection;\r\n\r\n\tif (mobile_filters.length > 0) url = url + '&mobile_ids=' + mobile_filters.join('|');\r\n\tif (organisation_filters.length > 0) url = url + '&organisation_ids=' + organisation_filters.join('|');\r\n\tif (route_filters.length > 0) url = url + '&route_ids=' + route_filters.join('|');\r\n\r\n\tif (current_position && current_position.length > 1) url = url + '&longitude=' + current_position[0] + '&latitude=' + current_position[1];\r\n\tif (distance && distance !== '') url = url + '&distance=' + distance;\r\n\r\n\taxios.get(url)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback({\r\n\t\t\t\t\tstops: response.data,\r\n\t\t\t\t\ttotal: parseInt(response.headers['x-total-count']),\r\n\t\t\t\t\tpage: parseInt(response.headers['x-page'])\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcallback({ stops: [], total: 0, page: 1 });\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({ stops: [], total: 0, page: 1 }));\r\n}\r\n\r\nexport function getAllStops(callback) {\r\n\taxios.get(config.api + '/stops')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}\r\n\r\nexport function getStopById(id, callback) {\r\n\taxios.get(config.api + '/stops/' + id)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback({});\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback({}));\r\n}","// React\r\nimport compose from 'recompose/compose';\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport Link from '@material-ui/core/Link';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport withWidth, { isWidthUp } from '@material-ui/core/withWidth';\r\n\r\n// Material Table\r\nimport MaterialTable from 'material-table';\r\n\r\n// Material UI Styles\r\nimport { withStyles } from '@material-ui/core/styles';\r\n\r\n// MUI Icons\r\nimport ArrowUpward from '@material-ui/icons/ArrowUpward';\r\nimport ChevronLeft from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRight from '@material-ui/icons/ChevronRight';\r\nimport FirstPage from '@material-ui/icons/FirstPage';\r\nimport FilterList from '@material-ui/icons/FilterList';\r\nimport LastPage from '@material-ui/icons/LastPage';\r\n\r\n// Our components\r\nimport Filters from './Filters';\r\n\r\n// Moment\r\nimport moment from 'moment';\r\n\r\n// Our Helpers\r\nimport * as stopsHelper from './helpers/stops';\r\n\r\n\r\nconst styles = (theme) => ({\r\n\tformControl: {\r\n\t\tmargin: theme.spacing(1),\r\n\t\tminWidth: 200\r\n\t},\r\n\tmargin: {\r\n\t\tmargin: theme.spacing(1)\r\n\t},\r\n\troot: {\r\n\t\tflexGrow: 1,\r\n\t\tmaxWidth: '100%'\r\n\t},\r\n\ttable: {\r\n\t\tborder: '1px solid #F5F5F5'\r\n\t}\r\n});\r\n\r\nclass Stops extends Component {\r\n\r\n\tstate = {\r\n\t\ttitle: 'All stops'\r\n\t};\r\n\r\n\ttableRef = React.createRef();\r\n\r\n\tcomponentDidUpdate(prevProps) {\r\n\t\tif (this.props.postcode !== prevProps.postcode || this.props.distance !== prevProps.distance) this.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetOrganisationFilter = (organisation_id) => {\r\n\t\tthis.props.setOrganisationFilter(organisation_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearOrganisationFilter = () => {\r\n\t\tthis.props.clearOrganisationFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetMobileFilter = (mobile_id) => {\r\n\t\tthis.props.setMobileFilter(mobile_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearMobileFilter = () => {\r\n\t\tthis.props.clearMobileFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tsetRouteFilter = (route_id) => {\r\n\t\tthis.props.setRouteFilter(route_id);\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tclearRouteFilter = () => {\r\n\t\tthis.props.clearRouteFilter();\r\n\t\tthis.tableRef.current.onQueryChange();\r\n\t}\r\n\r\n\tdisplayStopInfo = (row) => this.props.viewStop(row);\r\n\r\n\trender() {\r\n\t\tconst {\r\n\t\t\tclasses, organisations, organisation_lookup, organisation_filter, viewStopsByOrganisation,\r\n\t\t\tmobiles, mobile_lookup, mobile_filter,\r\n\t\t\troutes, route_lookup, route_filter, current_position, distance, width,\r\n\t\t\tsearch_type, postcode, toggleGPS, postcodeSearch, setDistance } = this.props;\r\n\t\tlet orgText = {}\r\n\t\tObject.keys(organisation_lookup).forEach(key => {\r\n\t\t\torgText[key] = organisation_lookup[key].name;\r\n\t\t});\r\n\t\tlet mobileText = {}\r\n\t\tObject.keys(mobile_lookup).forEach(key => {\r\n\t\t\tmobileText[key] = mobile_lookup[key].name;\r\n\t\t});\r\n\t\tlet routeText = {}\r\n\t\tObject.keys(route_lookup).forEach(key => {\r\n\t\t\trouteText[key] = route_lookup[key].name;\r\n\t\t});\r\n\t\treturn (\r\n\t\t\t<div style={{ maxWidth: '100%' }}>\r\n\t\t\t\t<Filters\r\n\t\t\t\t\tdisplayStopLink={false}\r\n\t\t\t\t\torganisations={organisations}\r\n\t\t\t\t\torganisation_lookup={organisation_lookup}\r\n\t\t\t\t\torganisation_filter={organisation_filter}\r\n\t\t\t\t\tsetOrganisationFilter={this.setOrganisationFilter}\r\n\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\tviewStopsByOrganisation={viewStopsByOrganisation}\r\n\t\t\t\t\tmobiles={mobiles}\r\n\t\t\t\t\tmobile_lookup={mobile_lookup}\r\n\t\t\t\t\tmobile_filter={mobile_filter}\r\n\t\t\t\t\tsetMobileFilter={this.setMobileFilter}\r\n\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\troutes={routes}\r\n\t\t\t\t\troute_lookup={route_lookup}\r\n\t\t\t\t\troute_filter={route_filter}\r\n\t\t\t\t\tsetRouteFilter={this.setRouteFilter}\r\n\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\tpostcode={postcode}\r\n\t\t\t\t\tdistance={distance}\r\n\t\t\t\t\tsearch_type={search_type}\r\n\t\t\t\t\tsetDistance={setDistance}\r\n\t\t\t\t\ttoggleGPS={toggleGPS}\r\n\t\t\t\t\tpostcodeSearch={postcodeSearch}\r\n\t\t\t\t/>\r\n\t\t\t\t<MaterialTable\r\n\t\t\t\t\ttableRef={this.tableRef}\r\n\t\t\t\t\tcomponents={{\r\n\t\t\t\t\t\tContainer: props => <Paper {...props} elevation={0} className={classes.table} />\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ticons={{\r\n\t\t\t\t\t\tFilter: FilterList,\r\n\t\t\t\t\t\tFirstPage: FirstPage,\r\n\t\t\t\t\t\tLastPage: LastPage,\r\n\t\t\t\t\t\tNextPage: ChevronRight,\r\n\t\t\t\t\t\tPreviousPage: ChevronLeft,\r\n\t\t\t\t\t\tSortArrow: ArrowUpward\r\n\t\t\t\t\t}}\r\n\t\t\t\t\toptions={{\r\n\t\t\t\t\t\tpadding: isWidthUp('sm', width) ? 'default' : 'dense',\r\n\t\t\t\t\t\tsearch: false,\r\n\t\t\t\t\t\tloadingType: 'linear',\r\n\t\t\t\t\t\tactionsColumnIndex: 4,\r\n\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\theaderStyle: {\r\n\t\t\t\t\t\t\tbackgroundColor: '#2196f3',\r\n\t\t\t\t\t\t\tcolor: '#ffffff'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tcolumns={[\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Name',\r\n\t\t\t\t\t\t\tfield: 'name', filtering: false,\r\n\t\t\t\t\t\t\trender: rowData => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t\t\t\t\t\t<Link component=\"button\" variant=\"body2\" onClick={() => this.displayStopInfo(rowData)}>{rowData.name}</Link>\r\n\t\t\t\t\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{ title: 'Community', field: 'community', filtering: false },\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttitle: 'Time',\r\n\t\t\t\t\t\t\tfield: 'arrival',\r\n\t\t\t\t\t\t\tfiltering: false,\r\n\t\t\t\t\t\t\trender: (rowData) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\tmoment(rowData.arrival, 'HH:mm:ssZ').format('h:mma')\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t]}\r\n\t\t\t\t\tdata={query =>\r\n\t\t\t\t\t\tnew Promise((resolve, reject) => {\r\n\t\t\t\t\t\t\tstopsHelper.getQueryStops(query, organisation_filter, mobile_filter, route_filter, current_position, distance, stopData => {\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tdata: stopData.stops,\r\n\t\t\t\t\t\t\t\t\tpage: (stopData.page - 1),\r\n\t\t\t\t\t\t\t\t\ttotalCount: stopData.total,\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttitle={this.state.title}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nStops.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default compose(withWidth(), withStyles(styles, { withTheme: true }))(Stops);","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\n// getCurrentLocation: \r\nexport function getCurrentPosition(callback) {\r\n\tvar options = {\r\n\t\tenableHighAccuracy: true,\r\n\t\ttimeout: 10000,\r\n\t\tmaximumAge: 0\r\n\t};\r\n\tnavigator.geolocation.getCurrentPosition((pos) => {\r\n\t\tcallback([pos.coords.longitude, pos.coords.latitude]);\r\n\t}, err => {\r\n\t\tcallback([]);\r\n\t}, options);\r\n};\r\n\r\n// Get postcode data\r\nexport function getPostcode(postcode, callback) {\r\n\taxios.get('https://api.postcodes.io/postcodes/' + postcode)\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data && response.data.result) {\r\n\t\t\t\tcallback([response.data.result.longitude, response.data.result.latitude]);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n};","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllOrganisations(callback) {\r\n\taxios.get(config.api + '/organisations')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// Axios for making requests\r\nimport axios from 'axios';\r\n\r\nconst config = require('./config.json');\r\n\r\nexport function getAllRoutes(callback) {\r\n\taxios.get(config.api + '/routes')\r\n\t\t.then(response => {\r\n\t\t\tif (response && response.data) {\r\n\t\t\t\tcallback(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tcallback([]);\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err => callback([]));\r\n}","// React\r\nimport React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\n// Material UI\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\n\r\n// MUI Style\r\nimport blue from '@material-ui/core/colors/blue';\r\nimport blueGrey from '@material-ui/core/colors/blueGrey';\r\nimport { MuiThemeProvider, createMuiTheme, withStyles } from '@material-ui/core/styles';\r\n\r\n// Our components\r\nimport AppHeader from './AppHeader';\r\nimport Mobiles from './Mobiles';\r\nimport MobileMap from './MobileMap';\r\nimport StopDetails from './StopDetails';\r\nimport Stops from './Stops';\r\n\r\n// Our helpers\r\nimport * as geoHelper from './helpers/geo';\r\nimport * as mobilesHelper from './helpers/mobiles';\r\nimport * as organisationsHelper from './helpers/organisations';\r\nimport * as routesHelper from './helpers/routes';\r\nimport * as stopsHelper from './helpers/stops';\r\n\r\nconst theme = createMuiTheme({\r\n\tpalette: {\r\n\t\tprimary: blue,\r\n\t\tsecondary: blueGrey\r\n\t},\r\n\toverrides: {\r\n\t\tMuiButton: {\r\n\t\t\ttext: {\r\n\t\t\t\ttextTransform: 'inherit'\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nconst styles = theme => ({\r\n\troot: {\r\n\t\tdisplay: 'flex'\r\n\t},\r\n\ttoolbar: {\r\n\t\tdisplay: 'flex',\r\n\t\talignItems: 'center',\r\n\t\tjustifyContent: 'flex-end',\r\n\t\tpadding: '0 8px',\r\n\t\t...theme.mixins.toolbar\r\n\t},\r\n\tcontent: {\r\n\t\tflexGrow: 1,\r\n\t\tpadding: theme.spacing(3)\r\n\t}\r\n});\r\n\r\nclass App extends Component {\r\n\tstate = {\r\n\t\tpage: 'mobiles',\r\n\t\tstop_dialog_open: false,\r\n\t\tcurrent_stop: {},\r\n\t\torganisations: [],\r\n\t\torganisation_lookup: {},\r\n\t\torganisation_filter: [],\r\n\t\tmobiles: [],\r\n\t\tmobile_lookup: {},\r\n\t\tmobile_filter: [],\r\n\t\tmobile_locations: [],\r\n\t\tmobile_location_lookup: {},\r\n\t\tlocation_timer: null,\r\n\t\troutes: [],\r\n\t\troute_lookup: {},\r\n\t\troute_filter: [],\r\n\t\tfit_bounds: null,\r\n\t\tposition: [-2.1000, 53.6138],\r\n\t\tzoom: [7],\r\n\t\tpitch: [0],\r\n\t\tbearing: [0],\r\n\t\tdistance: 1609,\r\n\t\tpostcode: '',\r\n\t\tcurrent_position: [],\r\n\t\tposition_update_interval: '',\r\n\t\tsearch_type: '', // search types can be gps, postcode, service\r\n\t\tloading_gps: true,\r\n\t\tloading_mobiles: false,\r\n\t\tloading_organisations: false,\r\n\t\tloading_postcode: true,\r\n\t\tloading_routes: false\r\n\t};\r\n\r\n\tgetOrganisations = () => {\r\n\t\tthis.setState({ loading_organisations: true });\r\n\t\torganisationsHelper.getAllOrganisations(organisations => {\r\n\t\t\tlet organisation_lookup = {};\r\n\t\t\torganisations.forEach(organisation => organisation_lookup[organisation.id] = organisation);\r\n\t\t\tthis.setState({ organisations: organisations, organisation_lookup: organisation_lookup, loading_organisations: false })\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobiles = () => {\r\n\t\tthis.setState({ loading_mobiles: true });\r\n\t\tmobilesHelper.getAllMobiles(mobiles => {\r\n\t\t\tlet mobile_lookup = {};\r\n\t\t\tmobiles.forEach(mobile => mobile_lookup[mobile.id] = mobile);\r\n\t\t\tthis.setState({ mobiles: mobiles, mobile_lookup: mobile_lookup, loading_mobiles: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetRoutes = () => {\r\n\t\tthis.setState({ loading_routes: true });\r\n\t\troutesHelper.getAllRoutes(routes => {\r\n\t\t\tlet route_lookup = {};\r\n\t\t\troutes.forEach(route => route_lookup[route.id] = route);\r\n\t\t\tthis.setState({ routes: routes, route_lookup: route_lookup, loading_routes: false });\r\n\t\t});\r\n\t}\r\n\r\n\tgetMobileLocations = () => {\r\n\t\tmobilesHelper.getMobileLocations(locations => {\r\n\t\t\tlet mobile_location_lookup = {};\r\n\t\t\tlocations.forEach(location => mobile_location_lookup[location.mobile_id] = location);\r\n\t\t\tthis.setState({ mobile_locations: locations, mobile_location_lookup: mobile_location_lookup });\r\n\t\t});\r\n\t}\r\n\r\n\tcomponentDidMount = () => {\r\n\t\tthis.getOrganisations();\r\n\t\tthis.getMobiles();\r\n\t\tthis.getRoutes();\r\n\t\t// Set up a timer for the mobile locations\r\n\t\tthis.getMobileLocations();\r\n\t\tconst location_timer = setInterval(() => {\r\n\t\t\tthis.getMobileLocations();\r\n\t\t}, 15000);\r\n\t\tthis.setState({ location_timer: location_timer });\r\n\t}\r\n\r\n\tsetPage = (page) => this.setState({ page: page })\r\n\r\n\tviewStop = (stop) => {\r\n\t\t// We may or may not have a complete stop object.\r\n\t\t// If calling from the stop table we do - if not we don't, all we have is ID\r\n\t\tif (stop.name) this.openStopDialog(stop);\r\n\t\tif (!stop.name) {\r\n\t\t\tstopsHelper.getStopById(stop.id, stop => {\r\n\t\t\t\tthis.openStopDialog(stop);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\topenStopDialog = (stop) => this.setState({ current_stop: stop, stop_dialog_open: true }) \r\n\tcloseStopDialog = () => this.setState({ stop_dialog_open: false })\r\n\r\n\tviewStopsByOrganisation = (organisation_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [], route_filter: [] });\r\n\tviewStopsByMobile = (organisation_id, mobile_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [] });\r\n\tviewStopsByRoute = (organisation_id, mobile_id, route_id) => this.setState({ page: 'stops', organisation_filter: [organisation_id], mobile_filter: [mobile_id], route_filter: [route_id] });\r\n\r\n\tclearMobileFilter = () => this.setState({ mobile_filter: [], route_filter: [] });\r\n\tclearRouteFilter = () => this.setState({ route_filter: [] });\r\n\tclearOrganisationFilter = () => this.setState({ organisation_filter: [], mobile_filter: [], route_filter: [] });\r\n\r\n\tlogPosition = (fit = false) => {\r\n\t\tthis.setState({ loading_gps: true });\r\n\t\tgeoHelper.getCurrentPosition(position => {\r\n\t\t\tthis.setState({ current_position: position, position: position, zoom: [11], loading_gps: false });\r\n\t\t});\r\n\t}\r\n\r\n\tsetDistance = (distance) => this.setState({ distance: distance });\r\n\r\n\t// postcodeSearch\r\n\tpostcodeSearch = (postcode) => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tlet new_state = { search_type: 'postcode', loading_postcode: true, postcode: postcode };\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tnew_state.position_update_interval = null;\r\n\t\t}\r\n\r\n\t\t// Get the postcode\r\n\t\tgeoHelper.getPostcode(postcode, location => {\r\n\t\t\tif (location.length === 2) {\r\n\t\t\t\tnew_state.search_type = 'postcode';\r\n\t\t\t\tnew_state.current_position = location;\r\n\t\t\t\tnew_state.position = location;\r\n\t\t\t\tnew_state.zoom = [11];\r\n\t\t\t\tnew_state.loading_postcode = false;\r\n\t\t\t\tthis.setState(new_state);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// toggleGPS\r\n\ttoggleGPS = () => {\r\n\t\t// If we're already tracking GPS then turn this off\r\n\t\tif (this.state.search_type === 'gps') {\r\n\t\t\tclearInterval(this.state.position_update_interval);\r\n\t\t\tthis.setState({ search_type: '', postcode: '', position_update_interval: null });\r\n\t\t} else {\r\n\t\t\tlet position_update_interval = setInterval(this.logPosition, 10000);\r\n\t\t\tthis.setState({ position_update_interval: position_update_interval, search_type: 'gps', postcode: '' });\r\n\t\t\tthis.logPosition(true);\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { classes } = this.props;\r\n\t\treturn (\r\n\t\t\t<MuiThemeProvider theme={theme}>\r\n\t\t\t\t<div className={classes.root}>\r\n\t\t\t\t\t<CssBaseline />\r\n\t\t\t\t\t<AppHeader\r\n\t\t\t\t\t\tpage={this.state.page}\r\n\t\t\t\t\t\tsetPage={this.setPage}\r\n\t\t\t\t\t\tloading={this.state.loading_mobiles || this.state.loading_organisations || this.state.loading_routes}\r\n\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<main className={classes.content}>\r\n\t\t\t\t\t\t<div className={classes.toolbar} />\r\n\t\t\t\t\t\t{this.state.page === 'mobiles' ?\r\n\t\t\t\t\t\t\t<Mobiles\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_location_lookup={this.state.mobile_location_lookup}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t\tviewStopsByMobile={this.viewStopsByMobile}\r\n\t\t\t\t\t\t\t\tviewStopsByOrganisation={this.viewStopsByOrganisation}\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'stops' ?\r\n\t\t\t\t\t\t\t<Stops\r\n\t\t\t\t\t\t\t\torganisations={this.state.organisations}\r\n\t\t\t\t\t\t\t\torganisation_lookup={this.state.organisation_lookup}\r\n\t\t\t\t\t\t\t\torganisation_filter={this.state.organisation_filter}\r\n\t\t\t\t\t\t\t\tsetOrganisationFilter={(organisation_id) => { this.setState({ organisation_filter: [organisation_id] }) }}\r\n\t\t\t\t\t\t\t\tclearOrganisationFilter={this.clearOrganisationFilter}\r\n\t\t\t\t\t\t\t\tmobiles={this.state.mobiles}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_filter={this.state.mobile_filter}\r\n\t\t\t\t\t\t\t\tsetMobileFilter={(mobile_id) => { this.setState({ mobile_filter: [mobile_id] }) }}\r\n\t\t\t\t\t\t\t\tclearMobileFilter={this.clearMobileFilter}\r\n\t\t\t\t\t\t\t\troutes={this.state.routes}\r\n\t\t\t\t\t\t\t\troute_lookup={this.state.route_lookup}\r\n\t\t\t\t\t\t\t\troute_filter={this.state.route_filter}\r\n\t\t\t\t\t\t\t\tsetRouteFilter={(route_id) => { this.setState({ route_filter: [route_id] }) }}\r\n\t\t\t\t\t\t\t\tclearRouteFilter={this.clearRouteFilter}\r\n\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\tpostcode={this.state.postcode}\r\n\t\t\t\t\t\t\t\tdistance={this.state.distance}\r\n\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\tsetDistance={this.setDistance}\r\n\t\t\t\t\t\t\t\ttoggleGPS={this.toggleGPS}\r\n\t\t\t\t\t\t\t\tpostcodeSearch={this.postcodeSearch}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t\t{this.state.page === 'map' ?\r\n\t\t\t\t\t\t\t<MobileMap\r\n\t\t\t\t\t\t\t\tbearing={this.state.bearing}\r\n\t\t\t\t\t\t\t\tfit_bounds={this.state.fit_bounds}\r\n\t\t\t\t\t\t\t\tpitch={this.state.pitch}\r\n\t\t\t\t\t\t\t\tposition={this.state.position}\r\n\t\t\t\t\t\t\t\tcurrent_position={this.state.current_position}\r\n\t\t\t\t\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\t\t\t\t\tsearch_type={this.state.search_type}\r\n\t\t\t\t\t\t\t\tmobile_lookup={this.state.mobile_lookup}\r\n\t\t\t\t\t\t\t\tmobile_locations={this.state.mobile_locations.filter(l => l.geox !== null)}\r\n\t\t\t\t\t\t\t\tviewStop={this.viewStop}\r\n\t\t\t\t\t\t\t/> : null}\r\n\t\t\t\t\t</main>\r\n\t\t\t\t\t<StopDetails\r\n\t\t\t\t\t\tstop={this.state.current_stop}\r\n\t\t\t\t\t\topen={this.state.stop_dialog_open}\r\n\t\t\t\t\t\tclose={() => this.closeStopDialog()}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</MuiThemeProvider>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nApp.propTypes = {\r\n\tclasses: PropTypes.object.isRequired\r\n}\r\n\r\nexport default withStyles(styles)(App);","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import 'react-app-polyfill/ie11';\r\nimport 'react-app-polyfill/stable';\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\n// Our app entry point\r\nimport App from './App';\r\n\r\n// Service worker for PWA behaviour\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}